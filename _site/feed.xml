<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Dusko Pijetlovic</title>
    <description>Dusko Pijetlovic - My Personal Web Space</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Mon, 23 Jan 2023 11:56:15 -0800</pubDate>
    <lastBuildDate>Mon, 23 Jan 2023 11:56:15 -0800</lastBuildDate>
    <generator>Jekyll v3.9.0</generator>
    
      <item>
        <title>Outgoing SMTP AUTH Mail with dma(8) from a FreeBSD System</title>
        <description>&lt;p&gt;OSs: &lt;br /&gt;
FreeBSD 13.1-RELEASE-p2, Shell: csh&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Set up a FreeBSD system to send mail from the command line.&lt;/p&gt;

&lt;p&gt;Task:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Configure a CLI mail client to securely submit messages via SMTP over
TLS (Transport Layer Security) protocol.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;SMTP use here is not MTA-to-MTA SMTP (Message Transfer Agent
[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;] to Message Transfer Agent SMTP), which is
normally on port 25.  It’s MUA-to-MSA (Mail User Agent
[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;] to Mail Submission Agent) &lt;em&gt;submission&lt;/em&gt; on
port 465. (The other secure submission method is STARTTLS on port 587;
connecting to the “cleartext” port and negotiating TLS using the STARTTLS
command). [&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;]&lt;/p&gt;

&lt;p&gt;The RFC 6409 Memo &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc6409&quot;&gt;Message Submission for Mail - RFC6409 - IETF&lt;/a&gt; provides definitions of MTA (Message Transfer
Agent), MSA (Message Submission Agent), MUA (Message User Agent) and
SMTP (SMTP-MTA). [&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;]&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;In this example, my SMTP server (smart host) requires the following:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;SMTP authentication (SMTP AUTH), with mechanisms LOGIN or PLAIN&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Implicit TLS&lt;/strong&gt; (or Enforced TLS) submission on port &lt;strong&gt;465&lt;/strong&gt;.
The initial connection is started with a Transport Layer Security (TLS)
(default port 465); that is, the MTA listens on port 465 for message
submissions from MUAs.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;From &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc8314#section-3.3&quot;&gt;RFC8314 Memo - Cleartext Considered Obsolete: Use of Transport Layer Security (TLS) for Email Submission and Access - IETF&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;3.3.  Implicit TLS for SMTP Submission&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;When a TCP connection is established for the “submissions” service
(default port 465), a TLS handshake begins immediately.  Clients MUST
implement the certificate validation mechanism described in
[&lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc7817&quot;&gt;RFC7817&lt;/a&gt;].  Once the TLS
session is established, Message Submission protocol data
[&lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc6409&quot;&gt;RFC6409&lt;/a&gt;] is exchanged as TLS
application data for the remainder of the TCP connection.
(Note: The “submissions” service name is defined in
&lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc8314#section-7.3&quot;&gt;Section 7.3&lt;/a&gt; of this
document and follows the usual convention that the name of a service
layered on top of Implicit TLS consists of the name of the service as
used without TLS, with an “s” appended.)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;In other words, in order to allow relaying mail, the remote SMTP server
(smart host) requires clients to be authenticated first.&lt;/p&gt;

&lt;p&gt;The IETF issued a one-time &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc8314#section-7.3&quot;&gt;amendment&lt;/a&gt; to reinstate port 465 for message submission over TLS protocol.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;dma-dragonfly-mail-agent&quot;&gt;dma (DragonFly Mail Agent)&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dma(8)&lt;/code&gt; is the DragonFly Mail Agent, and it is in base so you don’t
need to install anything.&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% command -v dma; type dma; which dma; whereis dma
dma: not found
dma: Command not found.
dma: /usr/libexec/dma /usr/share/man/man8/dma.8.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% file /usr/libexec/dma
/usr/libexec/dma: setgid ELF 64-bit LSB pie executable, x86-64, 
  version 1 (FreeBSD), dynamically linked, interpreter /libexec/ld-elf.so.1,
  for FreeBSD 13.1, FreeBSD-style, stripped
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% grep sendmail_enable /etc/rc.conf
sendmail_enable=&quot;YES&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo sed -i.bak -e &apos;s/sendmail_enable=&quot;YES&quot;/sendmail_enable=&quot;NONE&quot;/&apos; /etc/rc.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% grep sendmail_enable /etc/rc.conf                                
sendmail_enable=&quot;NONE&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo vi /etc/dma/dma.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo sed &apos;/^[[:space:]]*$/d&apos; /etc/dma/dma.conf | grep -v \^#
SMARTHOST your.isp.net
PORT 465
ALIASES /etc/aliases
SPOOLDIR /var/spool/dma
AUTHPATH /etc/dma/auth.conf
SECURETRANSFER
MASQUERADE domain.to.masquerade_as 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;where &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your.isp.net&lt;/code&gt; is the FQDN of the SMTP server (your ISP/smart host).&lt;/p&gt;

&lt;p&gt;From the man page for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dma(8)&lt;/code&gt;:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;If &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MASQUERADE&lt;/code&gt; variable does not contain a @ sign, the string is
interpreted as a host name.  For example, setting &lt;em&gt;MASQUERADE&lt;/em&gt; to
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;john@&lt;/code&gt; on host &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;hamlet&lt;/code&gt; will send all mails as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;john@hamlet&lt;/code&gt;;
setting it to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;percolator&lt;/code&gt; will send all mails as
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;username@percolator&lt;/code&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo chown root:mail /etc/dma/dma.conf
% sudo chown root:mail /etc/dma/auth.conf 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo chmod 0640 /etc/dma/dma.conf
% sudo chmod 0640 /etc/dma/auth.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo tee -a /etc/mail/mailer.conf &amp;lt;&amp;lt;EOF
sendmail        /usr/libexec/dma
send-mail       /usr/libexec/dma
mailq           /usr/libexec/dma
newaliases      /usr/libexec/dma
rmail           /usr/libexec/dma
EOF
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo tee -a /usr/local/etc/mail/mailer.conf &amp;lt;&amp;lt;EOF
sendmail        /usr/libexec/dma
send-mail       /usr/libexec/dma
mailq           /usr/libexec/dma
newaliases      /usr/libexec/dma
rmail           /usr/libexec/dma
EOF
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Send a test email message to a local account:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% printf %s\\n &quot;Testing.&quot; | mail -v -s &quot;Test 1&quot; dusko
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% mail
Mail version 8.1 6/6/93.  Type ? for help.
&quot;/var/mail/dusko&quot;: 1 message 1 new
&amp;gt;N  1 dusko@domain.to.masquerade_as    Tue Nov 15 18:34  13/378   &quot;Test 1&quot;
&amp;amp; 
Message 1:
From dusko@domain.to.masquerade_as Tue Nov 15 18:34:49 2022
To: dusko
Subject: Test 3
Date: Tue, 15 Nov 2022 18:34:49 -0800
From: &amp;lt;dusko@domain.to.masquerade_as&amp;gt;

Testing.
&amp;amp; q
Saved 1 message in mbox
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Send a test email message to a non-local account:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% printf %s\\n &quot;Testing.&quot; | mail -v -s &quot;Test 2&quot; dusko@example.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Return-Path: &amp;lt;dusko@domain.to.masquerade_as&amp;gt;
Received: from fbsd1.home.arpa (external.domain.name [123.45.67.89])
	(authenticated bits=0)
	by smarthost.domain.name (8.14.4/8.14.4) with ESMTP id 1ABCdQe2345678
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT)
	for &amp;lt;dusko@domain.to.masquerade_as&amp;gt;; Tue, 15 Nov 2022 18:35:26 -0800
Received: from dusko (uid 1001)
	(envelope-from dusko@domain.to.masquerade_as)
	id c7890
	by fbsd1.home.arpa (DragonFly Mail Agent v0.11+ on fbsd1.home.arpa);
	Tue, 15 Nov 2022 18:35:26 -0800
To: dusko@example.com
Subject: Test 2
Date: Tue, 15 Nov 2022 18:35:26 -0800
Message-Id: &amp;lt;12345a6b.c7890.123d45ef@fbsd1.home.arpa&amp;gt;
From: &amp;lt;dusko@domain.to.masquerade_as&amp;gt;

Testing.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Reference:&lt;/strong&gt;  &lt;br /&gt;
&lt;a href=&quot;https://jpmens.net/2020/03/05/simple-solution-for-outgoing-mail-from-a-freebsd-system/&quot;&gt;Simple solution for outgoing mail from a FreeBSD system&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;

&lt;p&gt;[1] Also known as Mail Transfer Agent.&lt;/p&gt;

&lt;p&gt;[2] Also known as User Agent (UA).&lt;/p&gt;

&lt;p&gt;Examples of MUAs (Mail User Agents): Thunderbird, Mutt, Pine/alpine,
Outlook, nail/malix.&lt;/p&gt;

&lt;p&gt;[3] &lt;em&gt;Sendmail&lt;/em&gt; refers to these two modes as the MTA (mail transmission
    agent) and the MSP (mail submission program) – From the
    &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail/SECURITY&lt;/code&gt; document (on FreeBSD 13, located in:
    &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local/share/doc/sendmail/SECURITY&lt;/code&gt;):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Summary
-------

This is a brief summary how the two configuration files are used:

sendmail.cf  For the MTA (mail transmission agent)
        The MTA is started by root as daemon:

                 /PATH/TO/sendmail -L sm-mta -bd -q1h

        it accepts SMTP connections (on ports 25 and 587 by default);
        it runs the main queue (/var/spool/mqueue by default).

submit.cf       For the MSP (mail submission program)
        The MSP is used to submit e-mails, hence it is invoked
        by programs (and maybe users); it does not run as SMTP
        daemon; it uses /var/spool/clientmqueue by default; it
        can be started to run that queue periodically:

                /PATH/TO/sendmail -L sm-msp-queue -Ac -q30m
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;[4] From 
&lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc6409&quot;&gt;Message Submission for Mail - RFC6409 - IETF&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;1.  Introduction&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;SMTP [&lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc6409#ref-SMTP-MTA&quot;&gt;SMTP-MTA&lt;/a&gt;
[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;]] was defined as a message &lt;em&gt;transfer&lt;/em&gt; protocol,
that is, a means to route (if needed) and deliver finished (complete)
messages.&lt;/p&gt;

  &lt;p&gt;Message Transfer Agents (MTAs) are not supposed to alter the message
text, except to add ‘Received’, ‘Return-Path’, and other header
fields as required by
[&lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc6409#ref-SMTP-MTA&quot;&gt;SMTP-MTA&lt;/a&gt;
[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;]].&lt;/p&gt;

  &lt;p&gt;However, SMTP is now also widely used as a message &lt;em&gt;submission&lt;/em&gt; protocol,
that is, a means for Message User Agents (MUAs) to introduce new
messages into the MTA routing network.  The process that accepts message
submissions from MUAs is termed a “Message Submission Agent” (MSA).&lt;/p&gt;

  &lt;p&gt;In order to permit unconstrained communications, SMTP is not often
authenticated during message relay.&lt;/p&gt;

  &lt;p&gt;Authentication and authorization of initial submissions have become
increasingly important, driven by changes in security requirements
and rising expectations that submission servers take responsibility
for the message traffic they originate.&lt;/p&gt;

  &lt;p&gt;For example, due to the prevalence of machines that have worms,
viruses, or other malicious software that generate large amounts of
spam, many sites now prohibit outbound traffic on the standard SMTP
port (port 25), funneling all mail submissions through submission
servers.&lt;/p&gt;

  &lt;p&gt;[ . . . ]&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;2.  Document Information&lt;/strong&gt; &lt;br /&gt;
&lt;strong&gt;2.1.  Definitions of Terms Used in This Memo&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;Message Submission Agent (MSA)&lt;/p&gt;

  &lt;p&gt;A process that conforms to this specification.  An MSA acts as a
submission server to accept messages from MUAs, and it either
delivers them or acts as an SMTP client to relay them to an MTA.&lt;/p&gt;

  &lt;p&gt;Message Transfer Agent (MTA)&lt;/p&gt;

  &lt;p&gt;A process that conforms to [SMTP-MTA].  An MTA acts as an SMTP server
to accept messages from an MSA or another MTA, and it either delivers
them or acts as an SMTP client to relay them to another MTA.&lt;/p&gt;

  &lt;p&gt;Message User Agent (MUA)&lt;/p&gt;

  &lt;p&gt;A process that acts (often on behalf of a user and with a user
interface) to compose and submit new messages, and to process
delivered messages.&lt;/p&gt;

  &lt;p&gt;For delivered messages, the receiving MUA may obtain and process the
message according to local conventions or, in what is commonly
referred to as a split-MUA model, Post Office Protocol [POP3] or IMAP
[IMAP4] is used to access delivered messages, whereas the protocol
defined here (or SMTP) is used to submit messages.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;[5] [SMTP-MTA] Klensin, J., “Simple Mail Transfer Protocol”,
    &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc5321&quot;&gt;RFC 5321&lt;/a&gt;, October 2008.&lt;/p&gt;

&lt;hr /&gt;

</description>
        <pubDate>Tue, 15 Nov 2022 08:31:24 -0800</pubDate>
        <link>http://localhost:4000/sendmail/smtp/mta/mailserver/cli/terminal/shell/freebsd/sysadmin/reference/2022/11/15/dma-freebsd-auth-smtps-starttls-email.html</link>
        <guid isPermaLink="true">http://localhost:4000/sendmail/smtp/mta/mailserver/cli/terminal/shell/freebsd/sysadmin/reference/2022/11/15/dma-freebsd-auth-smtps-starttls-email.html</guid>
        
        
        <category>sendmail</category>
        
        <category>smtp</category>
        
        <category>mta</category>
        
        <category>mailserver</category>
        
        <category>cli</category>
        
        <category>terminal</category>
        
        <category>shell</category>
        
        <category>freebsd</category>
        
        <category>sysadmin</category>
        
        <category>reference</category>
        
      </item>
    
      <item>
        <title>Sendmail SMTP AUTH Running As a Client [HOWTO]</title>
        <description>&lt;hr /&gt;

&lt;p&gt;Also known as: &lt;br /&gt;
Sendmail SMTP AUTH client with SSL-or-TLS over port 465
(submissions port) using Stunnel &lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 1 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;word-cloud&quot;&gt;Word Cloud&lt;/h3&gt;

&lt;!-- Markdown extension for really small tiny text? --&gt;
&lt;!--   https://meta.stackexchange.com/questions/53800/markdown-extension-for-really-small-tiny-text --&gt;

&lt;p&gt;&lt;sub&gt;&lt;sup&gt;
SMART_HOST, smart host, port 465, Implicit TLS submission on port 465,
TLS (Transport Layer Security), SSL (Secure Sockets Layer),
OpenSSL library, Base64,
SMTP (Simple Mail Transfer Protocol),&lt;br /&gt;
SMTP AUTH, RFC2554 (ESMTP AUTH),
authentication, encryption, masquerading, relaying,
TCP, TCP/IP, networking, DNS, MX record, IANA (Internet Assigned Numbers
Authority),&lt;br /&gt;
SASL (Simple Authentication and Security Layer), Cyrus SASL
library, sendmail, mailserver, postmaster, unix, CLI (command-line interface),
terminal, shell, csh, sh, FreeBSD, MTA (Mail Transfer Agent),&lt;br /&gt;
MTA (Mail Transport Agent), MSP (Message Submission Program),
MSA (Mail Submission Agent), stunnel,  &lt;br /&gt;
SMTP/S [SMTPS (SMTP over SSL-or-TLS on port 465)], SMTPS client,
SMTPS (Simple Mail Transfer Protocol Secure)
&lt;/sup&gt;&lt;/sub&gt;
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 2 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;OS: &lt;br /&gt;
FreeBSD 13.1-RELEASE-p2 with &lt;em&gt;sendmail&lt;/em&gt; 8.17.1, Shell: &lt;em&gt;csh&lt;/em&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Setup requirements in this configuration:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Local &lt;em&gt;sendmail&lt;/em&gt; server receives mails from local users or internal
applications.&lt;/li&gt;
  &lt;li&gt;After receiving the mail from local users or internal applications,
this &lt;em&gt;sendmail&lt;/em&gt; server:
    &lt;ul&gt;
      &lt;li&gt;relays the mail to your ISP (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your.isp.net&lt;/code&gt;), if it’s addressed
to an external email address (sending a message to non local adresses);&lt;/li&gt;
      &lt;li&gt;relays the mail to local system, if it’s addressed to a local user.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;The ISP’s server accepts message submission on port 465 (Implicit TLS-or-SSL,
aka Encrypted SMTP). &lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 3 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 4 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;tldr-version&quot;&gt;TL;DR Version&lt;/h2&gt;

&lt;p&gt;For &lt;strong&gt;detailed&lt;/strong&gt; instructions (&lt;strong&gt;non tl;dr&lt;/strong&gt; version), refer to the
section further below &lt;a href=&quot;#how-to-setup-sendmail-to-act-as-a-client-with-smtp-auth&quot;&gt;How To Setup Sendmail to Act As a Client with SMTP AUTH&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The system-built &lt;em&gt;sendmail&lt;/em&gt;:  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/libexec/sendmail/sendmail&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The package-installed &lt;em&gt;sendmail&lt;/em&gt;: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local/sbin/sendmail&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;From the man page for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mailwrapper(8)&lt;/code&gt;:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;The &lt;em&gt;mailwrapper&lt;/em&gt; program is designed to replace &lt;em&gt;/usr/sbin/sendmail&lt;/em&gt; and to
invoke an appropriate MTA (Mail Transfer Agent) based on configuration
information placed in
&lt;em&gt;${LOCALBASE}/etc/mail/mailer.conf&lt;/em&gt; (LOCALBASE=&lt;em&gt;/usr/local&lt;/em&gt;)
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 5 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt; falling back on &lt;em&gt;/etc/mail/mailer.conf&lt;/em&gt;.
This permits the administrator to configure which MTA is to be invoked on
the system at run time.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /usr/local/etc/mail/mailer.conf
sendmail        /usr/local/sbin/sendmail
send-mail       /usr/local/sbin/sendmail
mailq           /usr/local/sbin/sendmail
newaliases      /usr/local/sbin/sendmail
hoststat        /usr/local/sbin/sendmail
purgestat       /usr/local/sbin/sendmail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /etc/mail/mailer.conf
sendmail        /usr/local/sbin/sendmail
send-mail       /usr/local/sbin/sendmail
mailq           /usr/local/sbin/sendmail
newaliases      /usr/local/sbin/sendmail
hoststat        /usr/local/sbin/sendmail
purgestat       /usr/local/sbin/sendmail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;install-sendmail-and-cyrus-sasl-packages&quot;&gt;Install Sendmail and Cyrus SASL Packages&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo pkg install cyrus-sasl cyrus-sasl-saslauthd`

$ printf %s\\n &quot;pwcheck_method: saslauthd&quot; | sudo tee /usr/local/lib/sasl2/Sendmail.conf

$ printf %s\\n &apos;saslauthd_enable=&quot;YES&quot;&apos; | sudo tee -a /etc/rc.conf

$ sudo pkg install sendmail

$ printf %s\\n &apos;SENDMAIL_CF_DIR=/usr/local/share/sendmail/cf&apos; | sudo tee -a /etc/make.conf

$ printf %s\\n &apos;sendmail_enable=&quot;YES&quot;&apos; | sudo tee -a /etc/rc.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;configure-sendmail-configuration-files---submitcf-and-sendmailcf&quot;&gt;Configure Sendmail Configuration Files - submit.cf and sendmail.cf&lt;/h3&gt;

&lt;p&gt;Modify  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/mail/freebsd.submit.mc&lt;/code&gt;. &lt;br /&gt;
Changes:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;define(`confLOG_LEVEL&apos;, `14&apos;)dnl

define(`SMART_HOST&apos;,`smartrelay:[127.0.0.1]&apos;)dnl
FEATURE(`authinfo&apos;,`hash /etc/mail/authinfo&apos;)dnl

dnl dnl MASQUERADE_AS(`domain.to.masquerade_as&apos;)dnl dnl
dnl dnl MASQUERADE_DOMAIN(&apos;fbsd1.home.arpa&apos;)dnl dnl
dnl # Uncomment the next line (with masquerade_envelope) if 
dnl # you want messages to be delivered to SMART_HOST. 
dnl dnl FEATURE(`masquerade_envelope&apos;)dnl
dnl dnl FEATURE(`masquerade_entire_domain&apos;)dnl dnl

dnl Disable SMTP AUTH on the loopback interface.
DAEMON_OPTIONS(`Name=NoMTA, Addr=127.0.0.1, M=EA&apos;)dnl

MAILER_DEFINITIONS
dnl 
dnl     LR0relayST (Local Rule 0 relay Single Token)
dnl For addresses with only a single token (e.g. a username):  dusko 
MLR0relayST,	P=[IPC], F=mDFMuXa8k, S=EnvFromSMTP/HdrFromSMTP, R=MasqSMTP, E=\r\n, L=2040,
		T=DNS/RFC822/SMTP,
		A=TCP $h

dnl
dnl     LR0relayLH [Local Rule 0 relay Local (AND) Hostname]
dnl For addresses:  dusko@localhost, dusko@&amp;lt;hostname&amp;gt; (that is:  dusko@fbsd1.home.arpa)
MLR0relayLH,	P=[IPC], F=mDFMuXa8k, S=EnvFromSMTP/HdrFromSMTP, R=MasqSMTP, E=\r\n, L=2040,
		T=DNS/RFC822/SMTP,
		A=TCP $h

dnl
dnl     smartrelay 
dnl For nonlocal (external) addresses; for example: dusko@some.external.domain
Msmartrelay,    P=[IPC], F=mDFMuXa8k, S=EnvFromSMTP/HdrFromSMTP, R=MasqSMTP, E=\r\n, L=2040,
                T=DNS/RFC822/SMTP,
                A=TCP $h 1465

LOCAL_RULE_0
R$-	$#LR0relayST $@ $j $: $1 &amp;lt; @ $j. &amp;gt;
R$+ &amp;lt; @ $j. &amp;gt;	$#LR0relayLH $@ $j $: $1 &amp;lt; @ $j. &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  In two lines below &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LOCAL_RULE_0&lt;/code&gt;,&lt;br /&gt;
           there is a &lt;strong&gt;tab&lt;/strong&gt; character before &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#LR0relayST&lt;/code&gt; and
           before &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#LR0relayLH&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Modify &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/mail/freebsd.mc&lt;/code&gt;. &lt;br /&gt;
Changes:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;define(`confEBINDIR&apos;, `/usr/local/libexec&apos;)dnl
define(`UUCP_MAILER_PATH&apos;, `/usr/local/bin/uux&apos;)dnl

FEATURE(`nouucp&apos;,`reject&apos;)dnl

TRUST_AUTH_MECH(`DIGEST-MD5 CRAM-MD5 EXTERNAL GSSAPI LOGIN PLAIN&apos;)dnl
define(`confAUTH_MECHANISMS&apos;,`DIGEST-MD5 CRAM-MD5 EXTERNAL GSSAPI LOGIN PLAIN&apos;)dnl
define(`confDONT_BLAME_SENDMAIL&apos;,`GroupReadableSASLDBFile&apos;)dnl

LOCAL_RULESETS
SLocal_trust_auth
R$*     $: $&amp;amp;{auth_authen}
Rsmmsp  $# OK
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  In the two lines below &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SLocal_trust_auth&lt;/code&gt;, there is a &lt;strong&gt;tab&lt;/strong&gt;
           character before &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$:&lt;/code&gt; and before &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$#&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&quot;create-the-authinfo-file-for-storing-auth-authentication-credentials&quot;&gt;Create the authinfo File for Storing AUTH Authentication Credentials&lt;/h3&gt;

&lt;p&gt;Create the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/mail/authinfo&lt;/code&gt; file (for storing AUTH authentication
credentials in a file separate from the &lt;em&gt;access&lt;/em&gt; database).&lt;/p&gt;

&lt;p&gt;You need to store the client’s authentication credentials in that file
using the same &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AuthInfo:&lt;/code&gt; tag used in the &lt;em&gt;access&lt;/em&gt; database, and you need
to make sure that the &lt;em&gt;authinfo&lt;/em&gt; text file and database are not readable
by anyone except the &lt;strong&gt;smmsp&lt;/strong&gt; user.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo vi /etc/mail/authinfo
$ sudo chown smmsp:smmsp /etc/mail/authinfo
$ sudo chmod 0640 /etc/mail/authinfo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo cat /etc/mail/authinfo
AuthInfo:[127.0.0.1] &quot;U:smmsp&quot; &quot;I:dusko&quot; &quot;P:YourISPPassword&quot; &quot;M:LOGIN&quot;
AuthInfo:127.0.0.1 &quot;U:smmsp&quot; &quot;I:dusko&quot; &quot;P:YourISPPassword&quot; &quot;M:LOGIN&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;install-and-configure-stunnel&quot;&gt;Install and Configure stunnel&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo pkg install stunnel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /usr/local/etc/stunnel/stunnel.conf
include = /usr/local/etc/stunnel/conf.d

[smarthost]
client = yes
accept = 127.0.0.1:1465 
connect = your.isp.net:465
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf %s\\n &apos;stunnel_enable=&quot;YES&quot;&apos; | sudo tee -a /etc/rc.conf

$ sudo service stunnel start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;hr /&gt;

&lt;h2 id=&quot;how-to-setup-sendmail-to-act-as-a-client-with-smtp-auth&quot;&gt;How To Setup Sendmail to Act As a Client with SMTP AUTH&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;Sendmail&lt;/strong&gt; is the default MTA in FreeBSD base system (as of FreeBSD 13).&lt;/p&gt;

&lt;p&gt;FreeBSD 13 comes with &lt;em&gt;sendmail&lt;/em&gt;; that is, in FreeBSD 13, &lt;em&gt;sendmail&lt;/em&gt; is
in the base system (a.k.a. in the default setup of the base system).
That’s why it’s usually called the &lt;em&gt;system sendmail&lt;/em&gt; (or the &lt;em&gt;system-built
sendmail&lt;/em&gt;).&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  &lt;br /&gt;
&lt;em&gt;dma(8)&lt;/em&gt; (DragonFly Mail Agent) will &lt;strong&gt;replace&lt;/strong&gt; &lt;em&gt;sendmail&lt;/em&gt; as the
&lt;strong&gt;default MTA&lt;/strong&gt; in &lt;strong&gt;FreeBSD 14&lt;/strong&gt; &lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 6 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cgit.freebsd.org/src/commit/?id=4d184bd438&quot;&gt;RELNOTES: document the switch from sendmail to dma&lt;/a&gt;  (Author: Baptiste Daroussin &lt;bapt at=&quot;&quot; FreeBSD.org=&quot;&quot;&gt;  2022-11-07)&lt;/bapt&gt;&lt;/p&gt;

&lt;p&gt;Related &lt;strong&gt;&lt;a href=&quot;https://cgit.freebsd.org/src/diff/?id=4d184bd438&quot;&gt;diff&lt;/a&gt;&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;diff --git a/RELNOTES b/RELNOTES
index 00d97ea54820..29db15f412dd 100644
--- a/RELNOTES
+++ b/RELNOTES
@@ -10,6 +10,9 @@ newline.  Entries should be separated by a newline.
 
 Changes to this file should not be MFCed.
 
+a67b925ff3e5:
+	The default mail transport agent is now dma(8) replacing sendmail.
+
 22893e584032:
 	L3 filtering on if_bridge will do surprising things which aren&apos;t
 	fail-safe, so net.link.bridge.pfil_member and
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;mail: make The Dragonfly Mail Agent (dma) the default mta:&lt;/strong&gt; &lt;br /&gt;
&lt;a href=&quot;https://cgit.freebsd.org/src/commit/?id=a67b925ff3e58b072a60b633e442ee1d33e47f7f&quot;&gt;FreeBSD source tree - mail: make The DragonFly Mail Agent (dma) the default mta.&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;smtp-auth-support---sendmail-in-base-vs-sendmail-from-packages-ports-in-freebsd-13&quot;&gt;SMTP AUTH Support - Sendmail in Base vs. Sendmail from Packages (Ports) in FreeBSD 13&lt;/h2&gt;

&lt;p&gt;Support for the SMTP extension AUTH, as defined by RFC2554 (ESMTP AUTH), 
was first included in &lt;em&gt;sendmail&lt;/em&gt; beginning with V8.10.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Sendmail&lt;/em&gt; provides SMTP AUTH via &lt;a href=&quot;https://www.cyrusimap.org/sasl/&quot;&gt;Cyrus SASL (Simple Authentication and 
Security Layer) library&lt;/a&gt;. 
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 7 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;However, the system &lt;em&gt;sendmail&lt;/em&gt; in FreeBSD 13 base doesn’t support
SMTP AUTH; that is, it’s not compiled and configured with the Cyrus SASL
library.&lt;/p&gt;

&lt;p&gt;To add SMTP AUTH support to &lt;em&gt;sendmail&lt;/em&gt; in FreeBSD 13, you can either:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;re-compile the system &lt;em&gt;sendmail&lt;/em&gt; with SASL support enabled, or&lt;/li&gt;
  &lt;li&gt;install &lt;em&gt;sendmail&lt;/em&gt; as a package since the package provided &lt;em&gt;sendmail&lt;/em&gt;
comes with SASL enabled by default&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I chose to install &lt;em&gt;sendmail&lt;/em&gt; from packages (instructions are further
down below).&lt;/p&gt;

&lt;h3 id=&quot;managing-mta-mail-transfer-agent-in-freebsd-13-with-mailwrapper8&quot;&gt;Managing MTA (Mail Transfer Agent) in FreeBSD 13 with mailwrapper(8)&lt;/h3&gt;

&lt;p&gt;FreeBSD 13 uses &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mailwrapper(8)&lt;/code&gt; program for managing MTA (Mail Transfer Agent)
software and invoking appropriate MTA based on configuration file.&lt;/p&gt;

&lt;p&gt;From the man page for &lt;em&gt;mailwrapper&lt;/em&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;The mailwrapper program is designed to replace /usr/sbin/sendmail and to
invoke an appropriate MTA based on configuration information placed in
${LOCALBASE}/etc/mail/mailer.conf falling back on /etc/mail/mailer.conf.

This permits the administrator to configure which MTA is to be invoked on
the system at run time.

[ . . . ]

FILES
Configuration for mailwrapper is kept in
${LOCALBASE}/etc/mail/mailer.conf or /etc/mail/mailer.conf.
/usr/sbin/sendmail is typically set up as a symbolic link to mailwrapper
which is not usually invoked on its own.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -lh /usr/sbin/sendmail
lrwxr-xr-x  1 root  wheel    11B Oct 31  2019 /usr/sbin/sendmail -&amp;gt; mailwrapper
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ file /usr/sbin/sendmail
/usr/sbin/sendmail: symbolic link to mailwrapper
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ file /usr/sbin/mailwrapper 
/usr/sbin/mailwrapper: ELF 64-bit LSB pie executable, x86-64, 
  version 1 (FreeBSD), dynamically linked, interpreter /libexec/ld-elf.so.1, 
  for FreeBSD 13.1, FreeBSD-style, stripped
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ command -v sendmail; type sendmail; which sendmail; whereis sendmail
/usr/sbin/sendmail
sendmail is /usr/sbin/sendmail
/usr/sbin/sendmail
sendmail: /usr/sbin/sendmail /usr/share/man/man8/sendmail.8.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The location of the system &lt;em&gt;sendmail&lt;/em&gt; binary file shipped with FreeBSD 13
(provided in base) is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/libexec/sendmail/sendmail&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /usr/local/etc/mail/mailer.conf
# $FreeBSD$
#
# Execute the &quot;real&quot; sendmail program, named /usr/libexec/sendmail/sendmail
# 
# If dma(8) is installed, an example mailer.conf that uses dma(8) instead can
# can be found in /usr/share/examples/dma.
#
sendmail        /usr/libexec/sendmail/sendmail
mailq           /usr/libexec/sendmail/sendmail
newaliases      /usr/libexec/sendmail/sendmail
hoststat        /usr/libexec/sendmail/sendmail
purgestat       /usr/libexec/sendmail/sendmail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /etc/mail/mailer.conf
# $FreeBSD$
#
# Execute the &quot;real&quot; sendmail program, named /usr/libexec/sendmail/sendmail
#
# If dma(8) is installed, an example mailer.conf that uses dma(8) instead can
# can be found in /usr/share/examples/dma.
#
sendmail        /usr/libexec/sendmail/sendmail
mailq           /usr/libexec/sendmail/sendmail
newaliases      /usr/libexec/sendmail/sendmail
hoststat        /usr/libexec/sendmail/sendmail
purgestat       /usr/libexec/sendmail/sendmail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; &lt;br /&gt;
From the man page for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mailwrapper(8)&lt;/code&gt;:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;The mailwrapper program is designed to replace &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/sbin/sendmail&lt;/code&gt; and
to invoke an appropriate MTA based on configuration information placed in
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${LOCALBASE}/etc/mail/mailer.conf&lt;/code&gt; (LOCALBASE=/usr/local)
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 5 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt; falling back on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/mail/mailer.conf&lt;/code&gt;.
This permits the administrator to configure which MTA is to be invoked
on the system at run time.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;An example &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mailer.conf&lt;/code&gt; that uses &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dma(8)&lt;/code&gt; instead of &lt;em&gt;sendmail&lt;/em&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /usr/share/examples/dma/mailer.conf 
# $FreeBSD$

sendmail  /usr/libexec/dma
mailq     /usr/libexec/dma
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;install-and-configure-cyrus-sasl&quot;&gt;Install and Configure Cyrus SASL&lt;/h3&gt;

&lt;p&gt;Before installing it, check &lt;em&gt;sendmail&lt;/em&gt; dependencies by using
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pkq rquery&lt;/code&gt; command.  [For details: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;man pkg-rquery(8)&lt;/code&gt;
(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pkg rquery&lt;/code&gt; - query information from remote repositories)]:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ pkg rquery &apos;%dn&apos; sendmail
cyrus-sasl-saslauthd
cyrus-sasl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-d0.1&lt;/code&gt; (a.k.a. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-d0&lt;/code&gt;) debugging switch tells &lt;em&gt;sendmail&lt;/em&gt; to print 
information about its version.  The system-built &lt;em&gt;sendmail&lt;/em&gt; version
(on FreeBSD 13) is V8.16.1:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/sendmail/sendmail -d0 &amp;lt; /dev/null
Version 8.16.1
 Compiled with: DNSMAP IPV6_FULL LOG MAP_REGEX MATCHGECOS MILTER
                MIME7TO8 MIME8TO7 NAMED_BIND NETINET NETINET6 NETUNIX NEWDB NIS
                PIPELINING SCANF STARTTLS TCPWRAPPERS TLS_EC TLS_VRFY_PER_CTX
                USERDB XDEBUG
 
============ SYSTEM IDENTITY (after readcf) ============
      (short domain name) $w = fbsd1
  (canonical domain name) $j = fbsd1.home.arpa
         (subdomain name) $m = home.arpa
              (node name) $k = fbsd1.home.arpa
========================================================
      
Recipient names must be specified
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;strong&gt;base&lt;/strong&gt; &lt;em&gt;sendmail&lt;/em&gt; in FreeBSD 13 is &lt;strong&gt;not&lt;/strong&gt; compiled with the
&lt;strong&gt;Cyrus SASL&lt;/strong&gt; library.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/sendmail/sendmail -d0 &amp;lt; /dev/null | grep SASL
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sendmail -d0 &amp;lt; /dev/null
Version 8.16.1
 Compiled with: DNSMAP IPV6_FULL LOG MAP_REGEX MATCHGECOS MILTER
                MIME7TO8 MIME8TO7 NAMED_BIND NETINET NETINET6 NETUNIX NEWDB NIS
                PIPELINING SCANF STARTTLS TCPWRAPPERS TLS_EC TLS_VRFY_PER_CTX
                USERDB XDEBUG
 
============ SYSTEM IDENTITY (after readcf) ============
      (short domain name) $w = fbsd1
  (canonical domain name) $j = fbsd1.home.arpa
         (subdomain name) $m = home.arpa
              (node name) $k = fbsd1.home.arpa
========================================================

Recipient names must be specified
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On the other hand, the &lt;em&gt;sendmail&lt;/em&gt; package (a.k.a. the packaged version
of &lt;em&gt;sendmail&lt;/em&gt;) comes with &lt;strong&gt;SASL&lt;/strong&gt; support (and it’s also a slightly newer
version, V8.17.1 - versus V8.16.1 in FreeBSD 13 base). (As of Nov 12, 2022.)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ pkg search --regex ^sendmail
sendmail-8.17.1_5           Reliable, highly configurable mail transfer agent with utilities
sendmail-devel-8.17.1.20    Reliable, highly configurable mail transfer agent with utilities
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ pkg search --regex --full sendmail-8.17.1_5 | grep SASL
        SASL           : on
        SASLAUTHD      : on
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Query the &lt;em&gt;sendmail&lt;/em&gt; package and its SASL options.
[The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--query-modifier&lt;/code&gt; option of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pkg search&lt;/code&gt; command displays
a list of the port options and their state (&lt;em&gt;on&lt;/em&gt; or &lt;em&gt;off&lt;/em&gt;) when the
package was built.]&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ pkg search --query-modifier options sendmail-8.17.1_5 | grep SASL
        SASL           : on
        SASLAUTHD      : on
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Make sure your hostname is set correctly in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/rc.conf&lt;/code&gt;.
This is what &lt;em&gt;sendmail&lt;/em&gt; uses by default.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ hostname
fbsd1.home.arpa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ grep hostname /etc/rc.conf
hostname=&quot;fbsd1.home.arpa&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ grep -v \# /etc/hosts
::1                     localhost localhost.my.domain
127.0.0.1               localhost localhost.my.domain
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;First, install &lt;em&gt;sendmail&lt;/em&gt;’s dependencies, which are two Cyrus SASL packages:
&lt;em&gt;cyrus-sasl&lt;/em&gt; (SASL itself) and &lt;em&gt;cyrus-sasl-saslauthd&lt;/em&gt; (SASL authentication
server for Cyrus SASL).  (Refer to the beginning of this section, with&lt;br /&gt;
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pkg rquery&lt;/code&gt; command listing &lt;em&gt;sendmail&lt;/em&gt;’s dependencies.)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo pkg install cyrus-sasl cyrus-sasl-saslauthd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;em&gt;cyrus-sasl&lt;/em&gt; port is compiled with a default &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pwcheck_method&lt;/code&gt; of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;auxprop&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;For directions on how to enable SMTP AUTH with the system &lt;em&gt;sendmail&lt;/em&gt;, 
refer to Sendmail.README (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local/share/doc/cyrus-sasl2/Sendmail.README)&lt;/code&gt;
included in &lt;em&gt;cyrus-sasl2&lt;/em&gt; documentation:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /usr/local/share/doc/cyrus-sasl2/Sendmail.README
How to enable SMTP AUTH with FreeBSD default Sendmail

1) Add the following to  /etc/make.conf:

    # Add SMTP AUTH support to Sendmail
    SENDMAIL_CFLAGS+=   -I/usr/local/include -DSASL=2
    SENDMAIL_LDFLAGS+=  -L/usr/local/lib
    SENDMAIL_LDADD+=    -lsasl2

2) Rebuild FreeBSD (make buildworld, ...)

3) Make sure that the pwcheck_method is correct in Sendmail.conf.

   Sendmail.conf (${PREFIX}/lib/sasl2/Sendmail.conf) is created by
   the cyrus-sasl2 ports during installation.  It may have
   pwcheck_method set to saslauthd by default.  Change this to what is
   appropriate for your site.

4) Add the following to your sendmail.mc file:

   dnl The group needs to be mail in order to read the sasldb2 file
   define(`confRUN_AS_USER&apos;,`root:mail&apos;)dnl

   TRUST_AUTH_MECH(`DIGEST-MD5 CRAM-MD5&apos;)dnl
   define(`confAUTH_MECHANISMS&apos;,`DIGEST-MD5 CRAM-MD5&apos;)dnl

   define(`confDONT_BLAME_SENDMAIL&apos;,`GroupReadableSASLDBFile&apos;)dnl

5) Add the following before FEATURE(msp) in your submit.mc file:

   DAEMON_OPTIONS(`Name=NoMTA, Addr=127.0.0.1, M=EA&apos;)dnl

   This disables SMTP AUTH on the loopback interface. Otherwise you may get
   the following error in the log:

        error: safesasl(/usr/local/etc/sasldb2) failed: Group readable file

   when sending mail locally (seen when using pine locally on same server).

 ----

   Additional AUTH Mechanisms are LOGIN, PLAIN, GSSAPI, and KERBEROS_V4.
   These can be added to TRUST_AUTH_MECH and confAUTH_MECHANISMS as a space
   seperated list.  You may want to restrict LOGIN, and PLAIN authentication
   methods for use with STARTTLS, as the password is not encrypted when
   passed to sendmail.

   LOGIN is required for Outlook Express users.  &quot;My server requires
   authentication&quot; needs to be checked in the accounts properties to 
   use SASL Authentication.

   PLAIN is required for Netscape Communicator users.  By default Netscape
   Communicator will use SASL Authentication when sendmail is compiled with
   SASL and will cause your users to enter their passwords each time they
   retreive their mail (NS 4.7).

   The DONT_BLAME_SENDMAIL option GroupReadableSASLDBFile is needed when you
   are using cyrus-imapd and sendmail on the same server that requires access
   to the sasldb2 database.

   SASLv2 support of Sendmail is starting with 8.12.4.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since you’ll install the &lt;em&gt;sendmail&lt;/em&gt; package and will not use the
system &lt;em&gt;sendmail&lt;/em&gt; (a.k.a. FreeBSD default &lt;em&gt;sendmail&lt;/em&gt;), you can skip
step 1: adding SENDMAIL_CFLAGS, SENDMAIL_LDFLAGS, SENDMAIL_LDADD, and
step 2: Rebuild FreeBSD (make buildworld, …); however, I performed the
step 1 and edited &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/make.conf&lt;/code&gt; in case I decide to re-compile the
default &lt;em&gt;sendmail&lt;/em&gt; later.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf %s\\n &apos;SENDMAIL_CFLAGS+=-I/usr/local/include -DSASL=2&apos; | sudo tee -a /etc/make.conf
$ printf %s\\n &apos;SENDMAIL_LDFLAGS+=-L/usr/local/lib&apos; | sudo tee -a /etc/make.conf
$ printf %s\\n &apos;SENDMAIL_LDADD+=-lsasl2&apos; | sudo tee -a /etc/make.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /etc/make.conf
SENDMAIL_CFLAGS+=-I/usr/local/include -DSASL=2
SENDMAIL_LDFLAGS+=-L/usr/local/lib
SENDMAIL_LDADD+=-lsasl2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You need to tell &lt;em&gt;sendmail&lt;/em&gt; what to do about secure authentication.&lt;/p&gt;

&lt;p&gt;Since SASL can be used by different applications, you can create
a customized configuration file in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local/lib/sasl2/&lt;/code&gt; directory 
for every service that uses SASL.  The name of the file must be that of
the service with the &lt;em&gt;conf&lt;/em&gt; extension so in this case it’s a &lt;em&gt;Sendmail.conf&lt;/em&gt;
file.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; &lt;br /&gt;
The &lt;em&gt;Sendmail.conf&lt;/em&gt; (&lt;em&gt;/usr/local/lib/sasl2/Sendmail.conf&lt;/em&gt;) file is created
by the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cyrus-sasl2&lt;/code&gt; ports during installation.&lt;/p&gt;

&lt;p&gt;At a minimum, one line should appear in that file and that line should
indicate your preferred password verification method.  Here, you need to
make sure that the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pwcheck_method&lt;/code&gt; command in that file is set to
&lt;em&gt;saslauthd&lt;/em&gt; daemon process (which is called from the Cyrus-SASL libraries,
and is a SASL authentication server for &lt;em&gt;cyrus-sasl2&lt;/em&gt;).
This means that &lt;em&gt;sendmail&lt;/em&gt; service will use SASL by connecting to the
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;saslauthd(8)&lt;/code&gt; deamon for all authentication (password verification).&lt;/p&gt;

&lt;p&gt;Communication between &lt;em&gt;sendmail&lt;/em&gt; and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;saslauthd&lt;/code&gt; server takes place
over a UNIX-domain socket.  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;saslauthd&lt;/code&gt; usually establishes the UNIX
domain socket in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/run/saslauthd/&lt;/code&gt; and waits for authentication requests.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo ls -lh /var/run/saslauthd/
total 3
srwxrwxrwx  1 root  mail     0B Nov 12 18:10 mux
-rw-------  1 root  mail     0B Nov 12 18:10 mux.accept
-rw-------  1 root  mail     5B Nov 12 18:10 saslauthd.pid
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The default communications socket for &lt;em&gt;saslauthd&lt;/em&gt; on FreeBSD 13 is
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/run/saslauthd/mux&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo file /var/run/saslauthd/mux
/var/run/saslauthd/mux: socket
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo cat /var/run/saslauthd/saslauthd.pid
1358
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here, &lt;em&gt;saslauthd&lt;/em&gt; (from Cyrus SASL) uses the PAM framework to authenticate
credentials:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ps aux | grep -v grep | grep 1358
root    1358   0.0  0.0  18484  6120  -  Is 12Nov22    0:00.03 /usr/local/sbin/saslauthd -a pam
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From the man page for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;saslauthd(8)&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[ . . . ]

     Options
       Options named by lower-case letters configure the server itself.
       Upper-case options control the behavior of specific authentication
       mechanisms; their applicability to a particular authentication mechanism
       is described in the AUTHENTICATION MECHANISMS section.

       -a authmech
               Use authmech as the authentication mechanism. (See the
               AUTHENTICATION MECHANISMS section below.) This parameter is
               mandatory.

[ . . . ]

  AUTHENTICATION MECHANISMS
       saslauthd supports one or more &quot;authentication mechanisms&quot;, dependent
       upon the facilities provided by the underlying operating system.  The
       mechanism is selected by the -a flag from the following list of choices:

[ . . . ]

       pam        (Linux, Solaris)
  
                  Authenticate using Pluggable Authentication Modules (PAM).
[ . . . ]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Refer to 
&lt;strong&gt;&lt;a href=&quot;#authenticating-with-auth&quot;&gt;Authenticating with AUTH&lt;/a&gt;&lt;/strong&gt; section below
for additional information about AUTH protocol and SASL.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf %s\\n &quot;pwcheck_method: saslauthd&quot; | sudo tee /usr/local/lib/sasl2/Sendmail.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /usr/local/lib/sasl2/Sendmail.conf
pwcheck_method: saslauthd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To run &lt;em&gt;saslauthd&lt;/em&gt; from startup, add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;saslauthd_enable=&quot;YES&quot;&lt;/code&gt; in
your &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/rc.conf&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf %s\\n &apos;saslauthd_enable=&quot;YES&quot;&apos; | sudo tee -a /etc/rc.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From the &lt;a href=&quot;https://docs.freebsd.org/en/books/handbook/mail/#SMTP-Auth&quot;&gt;FreeBSD Handbook - 30.9. SMTP Authentication&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;This daemon serves as a broker for &lt;em&gt;sendmail&lt;/em&gt; to authenticate against
the FreeBSD &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;passwd(5)&lt;/code&gt; database.  This saves the trouble of creating
a new set of usernames and passwords for each user that needs to use SMTP
authentication, and keeps the login and mail password the same.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;install-and-configure-sendmail-from-packages-ports&quot;&gt;Install and Configure Sendmail from Packages (Ports)&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo pkg install sendmail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[ . . . ]

===&amp;gt; Creating groups.
Using existing group &apos;smmsp&apos;.
===&amp;gt; Creating users
Using existing user &apos;smmsp&apos;.
===&amp;gt; Creating homedir(s)
[2/2] Extracting sendmail-8.17.1_5: 100%
=====

[ . . . ]

Message from sendmail-8.17.1_5:

--
On install:
you should add in /etc/make.conf:
SENDMAIL_CF_DIR=        /usr/local/share/sendmail/cf
 
To deliver all local mail to your mailhub, edit the last line of submit.mc:
FEATURE(`msp&apos;,&apos;[mailhub.do.main]`)dnl

To update your configuration look at /usr/local/share/sendmail/cf/README.
---------------------------------------------------
To use the binaries supplied by the port you should add the following lines
to your sendmail.mc file before any mailer or feature definition:

define(`confEBINDIR&apos;, `/usr/local/libexec&apos;)dnl
define(`UUCP_MAILER_PATH&apos;, `/usr/local/bin/uux&apos;)dnl

---------------------------------------------------
To activate sendmail as your default mailer, run:
$ cd /usr/local/etc/mail &amp;amp;&amp;amp; cp mailer.conf.sendmail mailer.conf

Your &apos;/usr/local/etc/mail/mailer.conf&apos; should look like this:
#
# Execute the &quot;real&quot; sendmail program, named /usr/libexec/sendmail/sendmail
#
sendmail        /usr/local/sbin/sendmail
send-mail       /usr/local/sbin/sendmail
mailq           /usr/local/sbin/sendmail
newaliases      /usr/local/sbin/sendmail
hoststat        /usr/local/sbin/sendmail
purgestat       /usr/local/sbin/sendmail

You may also need to update /etc/rc.conf.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf %s\\n &apos;SENDMAIL_CF_DIR=/usr/local/share/sendmail/cf&apos; | sudo tee -a /etc/make.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /etc/make.conf
SENDMAIL_CFLAGS+=-I/usr/local/include -DSASL=2
SENDMAIL_LDFLAGS+=-L/usr/local/lib
SENDMAIL_LDADD+=-lsasl2
SENDMAIL_CF_DIR=/usr/local/share/sendmail/cf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The package-installed &lt;em&gt;sendmail&lt;/em&gt; includes SASL support:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/local/sbin/sendmail -bt -d0 &amp;lt; /dev/null | grep SASL
                PICKY_HELO_CHECK PIPELINING SASLv2 SCANF STARTTLS TCPWRAPPERS
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/local/sbin/sendmail -bt -d0 &amp;lt; /dev/null 
Version 8.17.1
 Compiled with: DANE DNSMAP IPV6_FULL LOG MAP_REGEX MATCHGECOS MILTER
                MIME7TO8 MIME8TO7 NAMED_BIND NETINET NETINET6 NETUNIX NEWDB NIS
                PICKY_HELO_CHECK PIPELINING SASLv2 SCANF STARTTLS TCPWRAPPERS
                TLS_EC TLS_VRFY_PER_CTX USERDB XDEBUG

============ SYSTEM IDENTITY (after readcf) ============
      (short domain name) $w = fbsd1
  (canonical domain name) $j = fbsd1.home.arpa
         (subdomain name) $m = home.arpa
              (node name) $k = fbsd1.home.arpa
========================================================

ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)
Enter &amp;lt;ruleset&amp;gt; &amp;lt;address&amp;gt;
&amp;gt; $ 
$ 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To run &lt;em&gt;sendmail&lt;/em&gt; from startup, add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail_enable&lt;/code&gt; to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;YES&lt;/code&gt; in
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/rc.conf&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf %s\\n &apos;sendmail_enable=&quot;YES&quot;&apos; | sudo tee -a /etc/rc.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ find /etc/rc* -iname &apos;*sendmail*&apos;
/etc/rc.d/sendmail
/etc/rc.sendmail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; &lt;br /&gt;
The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/rc.d/sendmail&lt;/code&gt; file is the actual &lt;em&gt;sendmail&lt;/em&gt; startup script.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/rc.sendmail&lt;/code&gt; file is specific to &lt;em&gt;sendmail&lt;/em&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /etc/rc.sendmail
[ . . . ]
# This script is used by /etc/rc at boot time to start sendmail.  It
# is meant to be sendmail specific and not a generic script for all
# MTAs.  It is only called by /etc/rc if the rc.conf mta_start_script is
# set to /etc/rc.sendmail.  This provides the opportunity for other MTAs
# to provide their own startup script.

# The script is also used by /etc/mail/Makefile to enable the
# start/stop/restart targets.

# The source for the script can be found in src/etc/sendmail/rc.sendmail.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To display which &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rc.conf(5)&lt;/code&gt; variables (&lt;strong&gt;rcvar&lt;/strong&gt;) are used to control
the startup of the &lt;em&gt;sendmail&lt;/em&gt; service, use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;grep(1)&lt;/code&gt; utility to search
the &lt;em&gt;sendmail&lt;/em&gt; startup script (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/rc.d/sendmail&lt;/code&gt;) for lines  with &lt;strong&gt;rcvar&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ grep &apos;rcvar=&apos; /etc/rc.d/sendmail
rcvar=&quot;sendmail_enable&quot;
        rcvar=&quot;sendmail_submit_enable&quot;
        rcvar=&quot;sendmail_outbound_enable&quot;
rcvar=&quot;sendmail_msp_queue_enable&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Yo don’t need to add the other three &lt;em&gt;rcvar&lt;/em&gt; variables
(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail_submit_enable&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail_outbound_enable&lt;/code&gt;,
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail_msp_queue_enable&lt;/code&gt;) to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/rc.conf&lt;/code&gt; because they are set 
to &lt;em&gt;YES&lt;/em&gt; by default:  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/defaults/rc.conf&lt;/code&gt; file contains
&lt;strong&gt;default&lt;/strong&gt; &lt;em&gt;rcvar&lt;/em&gt; variables for the default startup behaviour of
your system.  You need to put only your overrides into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/rc.conf&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo grep sendmail_enable /etc/defaults/rc.conf
sendmail_enable=&quot;NO&quot;    # Run the sendmail inbound daemon (YES/NO).
 
$ sudo grep sendmail_submit_enable /etc/defaults/rc.conf
sendmail_submit_enable=&quot;YES&quot;    # Start a localhost-only MTA for mail submission
 
$ sudo grep sendmail_outbound_enable /etc/defaults/rc.conf
sendmail_outbound_enable=&quot;YES&quot;  # Dequeue stuck mail (YES/NO).
 
$ sudo grep sendmail_msp_queue_enable /etc/defaults/rc.conf
sendmail_msp_queue_enable=&quot;YES&quot; # Dequeue stuck clientmqueue mail (YES/NO).
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -lh /usr/local/share/sendmail/
total 13
drwxr-xr-x  11 root  wheel    13B Nov 12 19:30 cf
-r--r--r--   1 root  wheel   5.9K Sep  5 15:35 helpfile
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -lh /usr/local/share/sendmail/cf/
total 186
drwxr-xr-x  2 root  wheel    49B Nov 12 19:30 cf
drwxr-xr-x  2 root  wheel     8B Nov 12 19:30 domain
drwxr-xr-x  2 root  wheel    68B Nov 12 19:30 feature
drwxr-xr-x  2 root  wheel     4B Nov 12 19:30 hack
drwxr-xr-x  2 root  wheel     6B Nov 12 19:30 m4
drwxr-xr-x  2 root  wheel    14B Nov 12 19:30 mailer
drwxr-xr-x  2 root  wheel    58B Nov 12 19:30 ostype
-rw-r--r--  1 root  wheel   188K Jun  9  2021 README
-rw-r--r--  1 root  wheel   7.9K Apr  5  2021 sendmail.schema
drwxr-xr-x  2 root  wheel     3B Nov 12 19:30 sh
drwxr-xr-x  2 root  wheel     6B Nov 12 19:30 siteconfig
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cd /etc/mail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo su
Password:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# pwd
/etc/mail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# head -64 /etc/mail/Makefile
#
# $FreeBSD$
#
# This Makefile provides an easy way to generate the configuration
# file and database maps for the sendmail(8) daemon.
#
# The user-driven targets are:
#
# all     - Build cf, maps and aliases
# cf      - Build the .cf file from .mc file
# maps    - Build the feature maps
# aliases - Build the sendmail aliases
# install - Install the .cf file as /etc/mail/sendmail.cf
#
# For acting on both the MTA daemon and MSP queue running daemon:
# start        - Start both the sendmail MTA daemon and MSP queue running
#                daemon with the flags defined in /etc/defaults/rc.conf or
#                /etc/rc.conf
# stop         - Stop both the sendmail MTA daemon and MSP queue running
#                daemon
# restart      - Restart both the sendmail MTA daemon and MSP queue running
#                daemon
#
# For acting on just the MTA daemon:
# start-mta    - Start the sendmail MTA daemon with the flags defined in
#                /etc/defaults/rc.conf or /etc/rc.conf
# stop-mta     - Stop the sendmail MTA daemon
# restart-mta  - Restart the sendmail MTA daemon
#
# For acting on just the MSP queue running daemon:
# start-mspq   - Start the sendmail MSP queue running daemon with the
#                flags defined in /etc/defaults/rc.conf or /etc/rc.conf
# stop-mspq    - Stop the sendmail MSP queue running daemon
# restart-mspq - Restart the sendmail MSP queue running daemon
#
# Calling `make&apos; will generate the updated versions when either the
# aliases or one of the map files were changed.
#
# A `make install` is only necessary after modifying the .mc file. In
# this case one would normally also call `make restart&apos; to allow the
# running sendmail to pick up the changes as well.
#
# ------------------------------------------------------------------------
# This Makefile uses `&amp;lt;HOSTNAME&amp;gt;.mc&apos; as the default MTA .mc file.  This
# can be changed by defining SENDMAIL_MC in /etc/make.conf, e.g.:
#
#       SENDMAIL_MC=/etc/mail/myconfig.mc
#
# If &apos;&amp;lt;HOSTNAME&amp;gt;.mc&apos; does not exist, it is created using &apos;freebsd.mc&apos;
# as a template.
#
# It also uses &apos;&amp;lt;HOSTNAME&amp;gt;.submit.mc&apos; as the default mail submission .mc
# file.  This can be changed by defining SENDMAIL_SUBMIT_MC in
# /etc/make.conf, e.g.:
#
#       SENDMAIL_SUBMIT_MC=/etc/mail/mysubmit.mc
#
# If &apos;&amp;lt;HOSTNAME&amp;gt;.submit.mc&apos; does not exist, it is created using
# &apos;freebsd.submit.mc&apos; as a template.
# ------------------------------------------------------------------------
#
# The Makefile knows about the following maps:
# access, authinfo, bitdomain, domaintable, genericstable, mailertable,
# userdb, uucpdomain, virtusertable
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ls -lh /usr/local/etc/sasldb2.db 
-rw-r-----  1 cyrus  mail    16K Nov 12 18:56 /usr/local/etc/sasldb2.db
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;NOTE: &lt;br /&gt;
Even though the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local/share/doc/cyrus-sasl2/Sendmail.README&lt;/code&gt; says
that the group needs to be &lt;em&gt;mail&lt;/em&gt; in order to read the sasldb2 file,
my tests worked without adding the following line in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail.mc&lt;/code&gt; file
(on FreeBSD: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/mail/freebsd.mc&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/mail/&amp;lt;hostname&amp;gt;.mc&lt;/code&gt;).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;define(`confRUN_AS_USER&apos;,`root:mail&apos;)dnl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;the-order-of-mc-lines&quot;&gt;The Order Of mc Lines&lt;/h3&gt;

&lt;p&gt;From &lt;strong&gt;sendmail&lt;/strong&gt;, 4th Edition (a.k.a. &lt;strong&gt;“Bat Book”&lt;/strong&gt;) &lt;br /&gt;
By Bryan Costales, Claus Assmann, George Jansen, Gregory Neil Shapiro&lt;br /&gt;
(Published by: O’Reilly Media, Inc., Publication Date: October 2007):&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Some &lt;em&gt;mc&lt;/em&gt; lines must precede others.  This is necessary partly because
&lt;em&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m4(1)&lt;/code&gt;&lt;/em&gt; is a one-pass program, and partly because the order of items in
the final &lt;em&gt;sendmail.cf&lt;/em&gt; file is also critical.  The recommended order is:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;VERSIONID( )
OSTYPE( )
DOMAIN( )
option definitions
FEATURE( )
macro definitions
MAILER( )
ruleset definitions
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The general rules about the order of macro definition declarations
in &lt;em&gt;mc&lt;/em&gt; files:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# sed -n 128,152p /usr/local/share/sendmail/cf/README

        MAILER(`local&apos;)
        MAILER(`smtp&apos;)

These describe the mailers used at the default CS site.  The local
mailer is always included automatically.  Beware: MAILER declarations
should only be followed by LOCAL_* sections.  The general rules are
that the order should be:

        VERSIONID
        OSTYPE
        DOMAIN
        FEATURE
        local macro definitions
        MAILER
        LOCAL_CONFIG
        LOCAL_RULE_*
        LOCAL_RULESETS

There are a few exceptions to this rule.  Local macro definitions which
influence a FEATURE() should be done before that feature.  For example,
a define(`PROCMAIL_MAILER_PATH&apos;, ...) should be done before
FEATURE(`local_procmail&apos;).

*******************************************************************
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also in:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# sed -n 128,152p /usr/share/sendmail/cf/README 
# sed -n 128,152p /usr/src/contrib/sendmail/cf/README
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cp -i /etc/mail/freebsd.mc /etc/mail/freebsd.mc.ORIG
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;edit-sendmailmc-freebsdmc-on-freebsd-file&quot;&gt;Edit &lt;strong&gt;sendmail.mc&lt;/strong&gt; (&lt;strong&gt;freebsd.mc&lt;/strong&gt; on FreeBSD) File&lt;/h3&gt;

&lt;p&gt;Continuing with setup, modify &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail.mc&lt;/code&gt; file
(on FreeBSD this file is: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/mail/freebsd.mc&lt;/code&gt;).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# vi /etc/mail/freebsd.mc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Content of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;freebsd.mc&lt;/code&gt; file after editing it:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ grep -v ^dnl /etc/mail/freebsd.mc | grep -v \^#
divert(-1)


divert(0)
VERSIONID(`$FreeBSD$&apos;)
OSTYPE(freebsd6)
DOMAIN(generic)

define(`confLOG_LEVEL&apos;, `14&apos;)dnl

define(`confEBINDIR&apos;, `/usr/local/libexec&apos;)dnl
define(`UUCP_MAILER_PATH&apos;, `/usr/local/bin/uux&apos;)dnl

FEATURE(`nouucp&apos;,`reject&apos;)dnl

TRUST_AUTH_MECH(`DIGEST-MD5 CRAM-MD5 EXTERNAL GSSAPI LOGIN PLAIN&apos;)dnl
define(`confAUTH_MECHANISMS&apos;,`DIGEST-MD5 CRAM-MD5 EXTERNAL GSSAPI LOGIN PLAIN&apos;)dnl
define(`confDONT_BLAME_SENDMAIL&apos;,`GroupReadableSASLDBFile&apos;)dnl

FEATURE(access_db, `hash -o -T&amp;lt;TMPF&amp;gt; /etc/mail/access&apos;)
FEATURE(blocklist_recipients)
FEATURE(local_lmtp)

FEATURE(mailertable, `hash -o /etc/mail/mailertable&apos;)
FEATURE(virtusertable, `hash -o /etc/mail/virtusertable&apos;)

define(`CERT_DIR&apos;, `/etc/mail/certs&apos;)dnl
define(`confSERVER_CERT&apos;, `CERT_DIR/host.cert&apos;)dnl
define(`confSERVER_KEY&apos;, `CERT_DIR/host.key&apos;)dnl
define(`confCLIENT_CERT&apos;, `CERT_DIR/host.cert&apos;)dnl
define(`confCLIENT_KEY&apos;, `CERT_DIR/host.key&apos;)dnl
define(`confCACERT&apos;, `CERT_DIR/cacert.pem&apos;)dnl
define(`confCACERT_PATH&apos;, `CERT_DIR&apos;)dnl
define(`confDH_PARAMETERS&apos;, `CERT_DIR/dh.param&apos;)dnl

define(`confCW_FILE&apos;, `-o /etc/mail/local-host-names&apos;)

DAEMON_OPTIONS(`Name=IPv4, Family=inet&apos;)

define(`confBIND_OPTS&apos;, `WorkAroundBrokenAAAA&apos;)
define(`confNO_RCPT_ACTION&apos;, `add-to-undisclosed&apos;)
define(`confPRIVACY_FLAGS&apos;, `authwarnings,noexpn,novrfy&apos;)

MAILER(local)dnl
MAILER(smtp)dnl

LOCAL_RULESETS
SLocal_trust_auth
R$*     $: $&amp;amp;{auth_authen}
Rsmmsp  $# OK
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; 
The LHS (lefthand side) in the two lines below &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SLocal_trust_auth&lt;/code&gt;
is separated from the RHS (righthand side) by one or more
&lt;strong&gt;tab&lt;/strong&gt; characters (space characters will not work).  In this case, for
the first line below &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SLocal_trust_auth&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$*&lt;/code&gt; ends the left-hand side;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$:&lt;/code&gt; starts the right-hand side so the TAB character is before &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$:&lt;/code&gt;;
that is: &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;R$*&lt;/code&gt;[TAB]&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$: $&amp;amp;{auth_authen}&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Similarly, in the second line, there is a TAB after &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Rsmmsp&lt;/code&gt;; that is:&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Rsmmsp&lt;/code&gt;[TAB]&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$# OK&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# touch /etc/mail/statistics
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ls -lh /etc/mail/statistics
-rw-r--r--  1 root  wheel     0B Nov 12 18:56 /etc/mail/statistics
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mkdir /etc/mail/host_status
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ls -ld /etc/mail/host_status
drwxr-xr-x  2 root  wheel  2 Nov 12 18:56 /etc/mail/host_status
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cp -i /etc/mail/freebsd.submit.mc /etc/mail/freebsd.submit.mc.ORIG
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;edit-submitmc-on-freebsd-freebsdsubmitmc-file&quot;&gt;Edit &lt;strong&gt;submit.mc&lt;/strong&gt; (on FreeBSD: &lt;strong&gt;freebsd.submit.mc&lt;/strong&gt;) File&lt;/h3&gt;

&lt;p&gt;Modify the &lt;em&gt;submit.mc&lt;/em&gt; file (on FreeBSD: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/mail/freebsd.submit.mc&lt;/code&gt;).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# vi /etc/mail/freebsd.submit.mc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# wc -l /etc/mail/freebsd.submit.mc
      46 /etc/mail/freebsd.submit.mc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Content of the &lt;strong&gt;freebsd.submit.mc&lt;/strong&gt; file after editing it:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /etc/mail/freebsd.submit.mc
divert(-1)

#
#  This is the FreeBSD configuration for a set-group-ID sm-msp sendmail
#  that acts as a initial mail submission program.
#

divert(0)dnl

VERSIONID(`$FreeBSD$&apos;)
define(`confCF_VERSION&apos;, `Submit&apos;)dnl
define(`__OSTYPE__&apos;,`&apos;)dnl dirty hack to keep proto.m4 from complaining
define(`_USE_DECNET_SYNTAX_&apos;, `1&apos;)dnl support DECnet
define(`confTIME_ZONE&apos;, `USE_TZ&apos;)dnl
define(`confDONT_INIT_GROUPS&apos;, `True&apos;)dnl
define(`confBIND_OPTS&apos;, `WorkAroundBrokenAAAA&apos;)dnl

define(`confLOG_LEVEL&apos;, `14&apos;)dnl

define(`SMART_HOST&apos;,`smartrelay:[127.0.0.1]&apos;)dnl
FEATURE(`authinfo&apos;,`hash /etc/mail/authinfo&apos;)dnl

dnl dnl MASQUERADE_AS(`domain.to.masquerade_as&apos;)dnl dnl
dnl dnl MASQUERADE_DOMAIN(&apos;fbsd1.home.arpa&apos;)dnl dnl
dnl # Uncomment the next line (with masquerade_envelope) if 
dnl # you want messages to be delivered to SMART_HOST. 
dnl dnl FEATURE(`masquerade_envelope&apos;)dnl
dnl dnl FEATURE(`masquerade_entire_domain&apos;)dnl dnl

dnl Disable SMTP AUTH on the loopback interface.
DAEMON_OPTIONS(`Name=NoMTA, Addr=127.0.0.1, M=EA&apos;)dnl

FEATURE(`msp&apos;, `[127.0.0.1]&apos;)dnl

MAILER_DEFINITIONS
dnl 
dnl     LR0relayST (Local Rule 0 relay Single Token)
dnl For addresses with only a single token (e.g. a username):  dusko 
MLR0relayST,	P=[IPC], F=mDFMuXa8k, S=EnvFromSMTP/HdrFromSMTP, R=MasqSMTP, E=\r\n, L=2040,
		T=DNS/RFC822/SMTP,
		A=TCP $h

dnl
dnl     LR0relayLH [Local Rule 0 relay Local (AND) Hostname]
dnl For addresses:  dusko@localhost, dusko@&amp;lt;hostname&amp;gt; (that is:  dusko@fbsd1.home.arpa)
MLR0relayLH,	P=[IPC], F=mDFMuXa8k, S=EnvFromSMTP/HdrFromSMTP, R=MasqSMTP, E=\r\n, L=2040,
		T=DNS/RFC822/SMTP,
		A=TCP $h

dnl
dnl     smartrelay 
dnl For nonlocal (external) addresses; for example: dusko@some.external.domain
Msmartrelay,	P=[IPC], F=mDFMuXa8k, S=EnvFromSMTP/HdrFromSMTP, R=MasqSMTP, E=\r\n, L=2040,
		T=DNS/RFC822/SMTP,
		A=TCP $h 1465

LOCAL_RULE_0
R$-	$#LR0relayST $@ $j $: $1 &amp;lt; @ $j. &amp;gt;
R$+ &amp;lt; @ $j. &amp;gt;	$#LR0relayLH $@ $j $: $1 &amp;lt; @ $j. &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  &lt;br /&gt;
The LHS (lefthand side) in two lines below &lt;em&gt;LOCAL_RULE_0&lt;/em&gt; is separated from
the RHS (righthand side) by a &lt;strong&gt;tab&lt;/strong&gt; character (space characters will not
work).  In this case, in the first line under &lt;em&gt;LOCAL_RULE_0&lt;/em&gt;, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-&lt;/code&gt; 
character (the minus sign) ends the LHS; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$#&lt;/code&gt; starts the RHS; that is: &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;R$-&lt;/code&gt; [TAB] &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$#LR0relayST $@ $j $: $1 &amp;lt; @ $j. &amp;gt;&lt;/code&gt;  &lt;br /&gt;
On the last line (second line under &lt;em&gt;LOCAL_RULE_0&lt;/em&gt;), the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;gt;&lt;/code&gt; character
(the greater-than sign) ends the LHS, while &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$#&lt;/code&gt; starts the RHS; that is:  &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;R$+ &amp;lt; @ $j. &amp;gt;&lt;/code&gt; [TAB] &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$#LR0relayLH $@ $j $: $1 &amp;lt; @ $j. &amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  &lt;br /&gt;
In the MAILER_DEFINITIONS &lt;em&gt;mc&lt;/em&gt; configuration macro definitions, you don’t
have to use tabs between mailer names on the lefthand side (LHS) (in this
case, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LR0relayST&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LR0relayLH&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;smartrelay&lt;/code&gt;) and their definitions
(&lt;strong&gt;delivery agent equates&lt;/strong&gt; &lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 10 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;) on the
righthand side (RHS).&lt;/p&gt;

&lt;h3 id=&quot;three-new-customized-delivery-agents-mailers---explanation&quot;&gt;Three New Customized Delivery Agents (Mailers) - Explanation&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;define(`SMART_HOST&apos;,`smartrelay:[127.0.0.1]&apos;)dnl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To enable forwarding of all &lt;strong&gt;nonlocal&lt;/strong&gt; mail to a &lt;strong&gt;smart&lt;/strong&gt; gateway host,
you need to define &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SMART_HOST&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Here, Internet mail (nonlocal mail) will be forwarded to the host
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[127.0.0.1]&lt;/code&gt; using the &lt;strong&gt;smartrelay&lt;/strong&gt; delivery agent [the delivery agent
name is separated from the domain name by a colon (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;:&lt;/code&gt;)].
The square brackets (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;]&lt;/code&gt;) around &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;127.0.0.1&lt;/code&gt; tell &lt;em&gt;sendmail&lt;/em&gt; that
it is dealing with an &lt;strong&gt;IP address&lt;/strong&gt;, rather than a hostname.  In other words, 
the &lt;strong&gt;square brackets&lt;/strong&gt; around &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;127.0.0.1&lt;/code&gt; &lt;strong&gt;suppress&lt;/strong&gt; the lookup
of &lt;strong&gt;MX records&lt;/strong&gt;.  During canonicalization of a hostname, when the
IP address between the square brackets corresponds to a known host,
the address and the square brackets are replaced with that host’s canonical
name.  &lt;br /&gt;
In this case, canonical domain name for my localhost is &lt;em&gt;fbsd1.home.arpa&lt;/em&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sendmail -d0 &amp;lt; /dev/null
[ . . . ]
  (canonical domain name) $j = fbsd1.home.arpa 
[ . . . ]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As a special case, the [default] delivery agent named &lt;em&gt;local&lt;/em&gt; causes
slightly different behaviour in that it allows the name of the target user
to be listed without a host part:  &lt;em&gt;localhost local:dusko&lt;/em&gt;; or
&lt;em&gt;fbsd1.home.arpa local:dusko&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;For configuration in this article, the smart host is configured to use host
&lt;em&gt;127.0.0.1&lt;/em&gt; (&lt;em&gt;localhost&lt;/em&gt;) via the newly defined custom delivery
agent (named &lt;em&gt;smartrelay&lt;/em&gt;).  I defined the &lt;em&gt;smartrelay&lt;/em&gt; delivery agent
in the configuration file for the submission form of &lt;em&gt;sendmail&lt;/em&gt;
(a.k.a. &lt;em&gt;msp sendmail&lt;/em&gt;), &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;submit.mc&lt;/code&gt;
(in FreeBSD, this file is: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/mail/freebsd.submit.mc&lt;/code&gt;)
to use port &lt;em&gt;1465&lt;/em&gt; because I earlier chose that port number
in the &lt;em&gt;stunnel.conf&lt;/em&gt; configuration file to be a conduit for tunneling
SSL to port &lt;em&gt;465&lt;/em&gt; on the external smart host side. &lt;br /&gt;
An excerpt from &lt;em&gt;stunnel.conf&lt;/em&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;accept = 127.0.0.1:1465 
connect = your.isp.net:465
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;MSP&lt;/strong&gt; (mail submission program) is a command-line &lt;em&gt;sendmail&lt;/em&gt; that
functions as a mail submission agent (&lt;strong&gt;MSA&lt;/strong&gt;).&lt;/p&gt;

&lt;p&gt;All mailer (a.k.a. deliver agent) definitions begin with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;M&lt;/code&gt; operator.&lt;/p&gt;

&lt;p&gt;All recipient addresses must resolve to a mailer (delivery agent)
in &lt;strong&gt;rulest 0&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;In &lt;em&gt;sendmail&lt;/em&gt;, a delivery agent is selected by the RHS of a &lt;em&gt;parse&lt;/em&gt; rule
set 0 rule.&lt;/p&gt;

&lt;p&gt;In a setup in which the smart host is configured this way [to be
tunneled through the &lt;em&gt;localhost&lt;/em&gt; with the &lt;em&gt;stunnel&lt;/em&gt; to the actual
(external) smart host] I need to define two new, customized local delivery
agents for delivering local mail.  Otherwise, local mail would be 
forwarded by connecting to &lt;em&gt;[127.0.0.1]&lt;/em&gt; via the default MSP &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;relay&lt;/code&gt; delivery
agent, in which case authentication would fail because the client’s
authentication credentials (configured earlier and stored in the
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/mail/authinfo&lt;/code&gt; file) are for the smart host; that is, they are not
authentication credentials for your localhost.&lt;/p&gt;

&lt;p&gt;Also, I need to define an additional custom delivery agent
for the smart relay.  This delivery agent will use the port number
specified earlier for &lt;em&gt;stunnel&lt;/em&gt; on the localhost side (in this case, port
&lt;em&gt;1465&lt;/em&gt;) for tunneling mail to the smart relay side (which, in this case
requires authentication on port &lt;em&gt;465&lt;/em&gt;).&lt;/p&gt;

&lt;p&gt;The three new delivery agents - summarized:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;MLR0relayST&lt;/em&gt; &lt;br /&gt;
M = mailer definition &lt;br /&gt;
Mailer name: &lt;strong&gt;LR0relayST&lt;/strong&gt; &lt;br /&gt;
Will be used when the address is a single token (such as &lt;em&gt;dusko&lt;/em&gt;)&lt;/p&gt;

&lt;p&gt;&lt;em&gt;MLR0relayLH&lt;/em&gt; &lt;br /&gt;
M = mailer definition &lt;br /&gt;
Mailer name: &lt;strong&gt;LR0relayLH&lt;/strong&gt; &lt;br /&gt;
Will be used when the address is the local hostname &lt;br /&gt;
(&lt;em&gt;dusko@localhost&lt;/em&gt;, or in this case: &lt;em&gt;dusko@fbsd1.home.arpa&lt;/em&gt;)&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Msmartrelay&lt;/em&gt; &lt;br /&gt;
M = mailer definition  &lt;br /&gt;
Mailer name: &lt;strong&gt;smartrelay&lt;/strong&gt; &lt;br /&gt;
Will be used when the address is a nonlocal (external) addresses&lt;br /&gt;
(for example: &lt;em&gt;dusko@some.external.domain&lt;/em&gt;)&lt;/p&gt;

&lt;p&gt;Three new/customized mailers (a.k.a. delivery agents) are defined under
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAILER_DEFINITIONS&lt;/code&gt;. &lt;br /&gt;
The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAILER_DEFINITIONS&lt;/code&gt; &lt;em&gt;m4&lt;/em&gt; command is used for grouping delivery agent
definitions.&lt;/p&gt;

&lt;h3 id=&quot;local_rule_0-mc-macro---explanation&quot;&gt;LOCAL_RULE_0 mc Macro - Explanation&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;LOCAL_RULE_0&lt;/strong&gt; mc macro adds rules to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parse&lt;/code&gt; rule set 0.&lt;/p&gt;

&lt;p&gt;I will use &lt;em&gt;LOCAL_RULE_0&lt;/em&gt; to declare two new rules in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parse&lt;/code&gt; rule set 0.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The first rule detects a &lt;strong&gt;single token&lt;/strong&gt; in the address (such as &lt;em&gt;dusko&lt;/em&gt;)
and calls the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LR0relayST&lt;/code&gt; delivery agent.&lt;/li&gt;
  &lt;li&gt;The second rule detects a match with localhost
(such as &lt;em&gt;localhost&lt;/em&gt; or &lt;em&gt;local-hostname.some.domain&lt;/em&gt;)
and calls the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LR0relayLH&lt;/code&gt; delivery agent. &lt;strong&gt;Note:&lt;/strong&gt; This check is done
against the local hostname after it went through the process of 
canonicalization.
    &lt;ul&gt;
      &lt;li&gt;In the flow of rules through the parse rule set 0, 
canonicalization is done first.  In this case, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;canonify&lt;/code&gt; ruleset
returns &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;&lt;/code&gt; for both inputs 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dusko@localhost&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dusko@fbsd1.home.arpa&lt;/code&gt;. &lt;br /&gt;
My workstation’s hostname is &lt;em&gt;fbsd1.home.arpa&lt;/em&gt;.  Its canonical domain
name (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$j&lt;/code&gt;) is &lt;em&gt;fbsd1.home.arpa&lt;/em&gt;:&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sendmail -d0 &amp;lt; /dev/null
[ . . . ]
  (canonical domain name) $j = fbsd1.home.arpa
[ . . . ]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From &lt;a href=&quot;https://sendmail.org/~ca/email/doc8.12/op-sh-5.html&quot;&gt;The Whole Scoop on the Configuration File - Claus Aßmann at sendmail.org&lt;/a&gt; (Retrieved on Nov 11, 2022):&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;R and S – Rewriting Rules&lt;/p&gt;

  &lt;p&gt;The core of address parsing are the rewriting rules.  These are an ordered
production system.  &lt;em&gt;Sendmail&lt;/em&gt; scans through the set of rewriting rules
looking for a match on the left hand side (LHS) of the rule.  When a rule
matches, the address is replaced by the right hand side (RHS) of the rule.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;The syntax of the R command:&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;R&lt;/strong&gt; &lt;em&gt;lhs&lt;/em&gt; &lt;em&gt;rhs&lt;/em&gt; &lt;em&gt;comments&lt;/em&gt;&lt;/p&gt;

  &lt;p&gt;The fields must be separated by at least one &lt;strong&gt;tab character&lt;/strong&gt;;
there may be embedded spaces in the fields.  The &lt;em&gt;lhs&lt;/em&gt; is a pattern that
is applied to the input.  If it matches, the input is rewritten to the &lt;em&gt;rhs&lt;/em&gt;.
The comments are ignored.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;The left hand side&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;The left hand side of rewriting rules contains a pattern.  Normal words
are simply matched directly.  Metasyntax is introduced using
a &lt;strong&gt;dollar sign&lt;/strong&gt;.  The metasymbols are:&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;$*&lt;/strong&gt;	Match zero or more tokens&lt;br /&gt;
&lt;strong&gt;$+&lt;/strong&gt;	Match one or more tokens&lt;br /&gt;
&lt;strong&gt;$-&lt;/strong&gt;	Match exactly one token&lt;br /&gt;
&lt;strong&gt;$=&lt;/strong&gt;&lt;em&gt;x&lt;/em&gt;	Match any phrase in class &lt;em&gt;x&lt;/em&gt; &lt;br /&gt;
&lt;strong&gt;$~&lt;/strong&gt;&lt;em&gt;x&lt;/em&gt;	Match any word not in class &lt;em&gt;x&lt;/em&gt;&lt;/p&gt;

  &lt;p&gt;If any of these match, they are assigned to the symbol &lt;strong&gt;$&lt;/strong&gt; &lt;em&gt;n&lt;/em&gt; for
replacement on the right hand side, where &lt;em&gt;n&lt;/em&gt; is the index in the LHS.
For example, if the LHS:&lt;/p&gt;

  &lt;p&gt;$-:$+&lt;/p&gt;

  &lt;p&gt;is applied to the input:&lt;/p&gt;

  &lt;p&gt;UCBARPA:eric&lt;/p&gt;

  &lt;p&gt;the rule will match, and the values passed to the RHS will be:&lt;/p&gt;

  &lt;p&gt;$1 UCBARPA &lt;br /&gt;
$2 eric&lt;/p&gt;

  &lt;p&gt;Additionally, the LHS can include &lt;strong&gt;$@&lt;/strong&gt; to match &lt;strong&gt;zero&lt;/strong&gt; tokens.
This is not bound to a &lt;strong&gt;$&lt;/strong&gt; &lt;em&gt;n&lt;/em&gt; on the RHS, and is normally only used
when it stands alone in order to match the &lt;strong&gt;null input&lt;/strong&gt;.&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;The right hand side&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;When the left hand side of a rewriting rule matches, the input is deleted
and replaced by the right hand side.  Tokens are copied directly from the
RHS unless they begin with a dollar sign.  Metasymbols are:&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;$&lt;/strong&gt;&lt;em&gt;n&lt;/em&gt;	Substitute indefinite token n from LHS&lt;br /&gt;
&lt;strong&gt;$[&lt;/strong&gt;&lt;em&gt;name&lt;/em&gt;&lt;strong&gt;$]&lt;/strong&gt;	Canonicalize name &lt;br /&gt;
&lt;strong&gt;$(&lt;/strong&gt;&lt;em&gt;map key &lt;strong&gt;$@&lt;/strong&gt;&lt;/em&gt;arguments &lt;strong&gt;$:&lt;/strong&gt;&lt;em&gt;default&lt;/em&gt; &lt;strong&gt;$)&lt;/strong&gt; &lt;br /&gt;
Generalized keyed mapping function &lt;br /&gt;
&lt;strong&gt;$&amp;gt;&lt;/strong&gt;&lt;em&gt;n&lt;/em&gt;	“Call” ruleset &lt;em&gt;n&lt;/em&gt; &lt;br /&gt;
&lt;strong&gt;$#&lt;/strong&gt;&lt;em&gt;mailer&lt;/em&gt;	Resolve to &lt;em&gt;mailer&lt;/em&gt; &lt;br /&gt;
&lt;strong&gt;$@&lt;/strong&gt;&lt;em&gt;host&lt;/em&gt;	Specify &lt;em&gt;host&lt;/em&gt; &lt;br /&gt;
&lt;strong&gt;$:&lt;/strong&gt;&lt;em&gt;user&lt;/em&gt;	Specify &lt;em&gt;user&lt;/em&gt;&lt;/p&gt;

  &lt;p&gt;The &lt;strong&gt;$&lt;/strong&gt; &lt;em&gt;n&lt;/em&gt; syntax substitutes the corresponding value from a &lt;strong&gt;$+&lt;/strong&gt;,
&lt;strong&gt;$-&lt;/strong&gt;, &lt;strong&gt;$*&lt;/strong&gt;, &lt;strong&gt;$=&lt;/strong&gt;, or &lt;strong&gt;$~&lt;/strong&gt; match on the LHS.  It may be used
anywhere.&lt;/p&gt;

  &lt;p&gt;A host name enclosed between &lt;strong&gt;$[&lt;/strong&gt; and &lt;strong&gt;$]&lt;/strong&gt; is looked up in the host
database(s) and replaced by the canonical name.  For example, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$[ftp$]&lt;/code&gt;
might become &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ftp.CS.Berkeley.EDU&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$[[128.32.130.2]$]&lt;/code&gt; would become
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vangogh.CS.Berkeley.EDU&lt;/code&gt;.  &lt;em&gt;Sendmail&lt;/em&gt; recognizes its numeric IP address
without calling the name server and replaces it with its canonical name.&lt;/p&gt;

  &lt;p&gt;The &lt;strong&gt;$( … $)&lt;/strong&gt; syntax is a more general form of lookup; it uses
a named map instead of an implicit map.  If no lookup is found, the
indicated &lt;em&gt;default&lt;/em&gt; is inserted; if no default is specified and no
lookup matches, the value is left unchanged.  The &lt;em&gt;arguments&lt;/em&gt; are passed
to the map for possible use.&lt;/p&gt;

  &lt;p&gt;The &lt;strong&gt;$&amp;gt;&lt;/strong&gt; &lt;em&gt;n&lt;/em&gt; syntax causes the remainder of the line to be substituted
as usual and then passed as the argument to ruleset &lt;em&gt;n&lt;/em&gt;.  The final value
of ruleset n then becomes the substitution for this rule.  The &lt;strong&gt;$&amp;gt;&lt;/strong&gt;
syntax expands everything after the ruleset name to the end of the
replacement string and then passes that as the initial input to the
ruleset.  Recursive calls are allowed. For example,&lt;/p&gt;

  &lt;p&gt;$&amp;gt;0 $&amp;gt;3 $1&lt;/p&gt;

  &lt;p&gt;expands $1, passes that to ruleset 3, and then passes the result of
ruleset 3 to ruleset 0.&lt;/p&gt;

  &lt;p&gt;The &lt;strong&gt;$#&lt;/strong&gt; syntax should &lt;strong&gt;only&lt;/strong&gt; be used in ruleset zero, a subroutine
of ruleset zero, or rulesets that return decisions (e.g., &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;check_rcpt&lt;/code&gt;).
It causes evaluation of the ruleset to terminate immediately, and signals
to &lt;em&gt;sendmail&lt;/em&gt; that the address has completely resolved.  The complete
syntax for ruleset 0 is:&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;$#&lt;/strong&gt;&lt;em&gt;mailer&lt;/em&gt; &lt;strong&gt;$@&lt;/strong&gt;&lt;em&gt;host&lt;/em&gt; &lt;strong&gt;$:&lt;/strong&gt;&lt;em&gt;user&lt;/em&gt;&lt;/p&gt;

  &lt;p&gt;This specifies the {mailer, host, user} 3-tuple necessary to direct
the mailer.  If the mailer is local the host part may be omitted.
The &lt;em&gt;mailer&lt;/em&gt; must be a single word but the &lt;em&gt;host&lt;/em&gt; and &lt;em&gt;user&lt;/em&gt; may be
multi-part.  If the &lt;em&gt;mailer&lt;/em&gt; is the built-in IPC mailer, the &lt;em&gt;host&lt;/em&gt; may
be a colon-separated list of hosts that are searched in order for the
first working address (exactly like MX records).  The &lt;em&gt;user&lt;/em&gt; is later
rewritten by the mailer-specific envelope rewriting set and assigned to
the &lt;strong&gt;$u&lt;/strong&gt; macro.  As a special case, if the mailer specified has the
&lt;strong&gt;F=@&lt;/strong&gt; flag specified and the first character of the &lt;strong&gt;$:&lt;/strong&gt; value is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@&lt;/code&gt;,
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@&lt;/code&gt; is stripped off, and a flag is set in the address descriptor that
causes sendmail to not do ruleset 5 processing.&lt;/p&gt;

  &lt;p&gt;Normally, a rule that matches is retried, that is, the rule loops until
it fails.  A RHS may also be preceded by a &lt;strong&gt;$@&lt;/strong&gt; or a &lt;strong&gt;$:&lt;/strong&gt; to change
this behaviour.  A &lt;strong&gt;$@&lt;/strong&gt; prefix causes the ruleset to return with the
remainder of the RHS as the value.  A &lt;strong&gt;$:&lt;/strong&gt; prefix causes the rule to
terminate immediately, but the ruleset to continue; this can be used to
avoid continued application of a rule.  The prefix is stripped before continuing.&lt;/p&gt;

  &lt;p&gt;The &lt;strong&gt;$@&lt;/strong&gt; and &lt;strong&gt;$:&lt;/strong&gt; prefixes may precede a &lt;strong&gt;$&amp;gt;&lt;/strong&gt; spec; for example:&lt;/p&gt;

  &lt;p&gt;R$+ $: $&amp;gt;7 $1&lt;/p&gt;

  &lt;p&gt;matches anything, passes that to ruleset seven, and continues; the &lt;strong&gt;$:&lt;/strong&gt;
is necessary to avoid an infinite loop.&lt;/p&gt;

  &lt;p&gt;Substitution occurs in the order described, that is, parameters from the
LHS are substituted, hostnames are canonicalized, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;subroutines&lt;/code&gt; are called,
and finally &lt;strong&gt;$#&lt;/strong&gt;, &lt;strong&gt;$@&lt;/strong&gt;, and &lt;strong&gt;$:&lt;/strong&gt; are processed.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;mailer_definitions-m4-command---explanation&quot;&gt;MAILER_DEFINITIONS m4 Command - Explanation&lt;/h3&gt;

&lt;p&gt;The &lt;strong&gt;MAILER_DEFINITIONS&lt;/strong&gt; section introduces your new delivery agent definitions.&lt;br /&gt;
This m4 command forces new delivery agent definitions to be grouped with
the other delivery agent definitions.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;MAILER_DEFINITIONS&lt;/strong&gt;  &lt;br /&gt;
Define new (custom) delivery agents (aka “mailers”).&lt;/p&gt;

&lt;p&gt;In this case, under &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAILER_DEFINITIONS&lt;/code&gt; macro, three new deliver agents are defined:
&lt;strong&gt;MLR0relayST&lt;/strong&gt;, &lt;strong&gt;MLR0relayLH&lt;/strong&gt; and &lt;strong&gt;smartrelay&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;A close inspection of the fields in these two mailer (delivery agent)
entries shows the following:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;MLR0relayST&lt;/em&gt;, &lt;em&gt;MLR0relayLH&lt;/em&gt; and &lt;em&gt;Msmartrelay&lt;/em&gt; &lt;br /&gt;
Define and name a mailer, here arbitrarily named &lt;em&gt;MLR0relayST&lt;/em&gt;, &lt;em&gt;MLR0relayLH&lt;/em&gt; and &lt;em&gt;Msmartrelay&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;P=[IPC]&lt;/em&gt; &lt;br /&gt;
The path to the program used for this mailer is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[IPC]&lt;/code&gt;, which means delivery
of this mail is handled internally by &lt;em&gt;sendmail&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;F=mDFMuXa8k&lt;/em&gt;&lt;br /&gt;
The &lt;em&gt;sendmail&lt;/em&gt; flags for this mailer say that this mailer can send to
multiple recipients at once (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m&lt;/code&gt;); that Date (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;D&lt;/code&gt;), From (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;F&lt;/code&gt;), and
Message-Id (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;M&lt;/code&gt;) headers are required; that uppercase should be preserved
in hostnames and usernames (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;u&lt;/code&gt;); that lines beginning with a dot have an
extra dot prepended (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;X&lt;/code&gt;); to run extended SMTP protocol (ESMTP) (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a&lt;/code&gt;);
to force sending 8-bit data over SMTP even if the receiving server doesn’t
support 8-bit MIME (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;8&lt;/code&gt;); and to don’t check for loops in EHLO/HELO command (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;k&lt;/code&gt;).&lt;/p&gt;

&lt;p&gt;&lt;em&gt;S=EnvFromSMTP/HdrFromSMTP&lt;/em&gt;  &lt;br /&gt;
The sender address in the mail &lt;em&gt;envelope&lt;/em&gt; is processed through ruleset&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EnvFromSMTP&lt;/code&gt;,
and the sender address in the &lt;em&gt;message&lt;/em&gt; is processed through ruleset &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HdrFromSMTP&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;R=EnvToSMTP&lt;/em&gt; &lt;br /&gt;
All recipient addresses are processed through ruleset EnvToSMTP.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;E=\r\n&lt;/em&gt; &lt;br /&gt;
Lines are terminated with a carriage return and a line feed.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;L=2040&lt;/em&gt; &lt;br /&gt;
This mailer will handle lines up to 2040 bytes long.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;T=DNS/RFC822/SMTP&lt;/em&gt; &lt;br /&gt;
The MIME-type information for this mailer says that DNS is used for hostnames,
RFC 822 email addresses are used, and SMTP error codes are used.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;A=TCP $h&lt;/em&gt; &lt;br /&gt;
An internal &lt;em&gt;sendmail&lt;/em&gt; process designed to deliver SMTP mail over a TCP connection.
The macro &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$h&lt;/code&gt; is expanded to provide the recipient host (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$h&lt;/code&gt;) address.&lt;/p&gt;

&lt;p&gt;All three custom delivery agents (&lt;em&gt;LR0relayST&lt;/em&gt;, &lt;em&gt;LR0relayLH&lt;/em&gt; and &lt;em&gt;smartrelay&lt;/em&gt;)
have been copied from the &lt;strong&gt;relay&lt;/strong&gt; delivery agent as defined and provided by
default in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/mail/submit.cf&lt;/code&gt; file, and then modified. 
For my purposes, I’ve made only two modifications:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;renaming delivery agent (to: &lt;em&gt;LR0relayST&lt;/em&gt;, &lt;em&gt;LR0relayLH&lt;/em&gt; and &lt;em&gt;smartrelay&lt;/em&gt;), and&lt;/li&gt;
  &lt;li&gt;for the &lt;em&gt;Msmartrelay&lt;/em&gt; delivery agent: added a port number &lt;strong&gt;1465&lt;/strong&gt; as
that’s the port configured to be used by &lt;em&gt;stunnel&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;em&gt;relay&lt;/em&gt; delivery agent as defined by default in the &lt;strong&gt;sendmail.cf&lt;/strong&gt;
configuration file uses TCP to connect to other hosts.  It speaks ESMTP
and has the &lt;strong&gt;F=mDFMuXa8&lt;/strong&gt; delivery agent flags set by default:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ grep -A3 Mrelay /etc/mail/sendmail.cf
Mrelay,         P=[IPC], F=mDFMuXa8, S=EnvFromSMTP/HdrFromSMTP, R=MasqSMTP, E=\r\n, L=2040,
                T=DNS/RFC822/SMTP,
                A=TCP $h
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This delivery agent (the &lt;em&gt;relay&lt;/em&gt; delivery agent) is chosen for forwarding
mail to the &lt;strong&gt;SMART_HOST&lt;/strong&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SMART_HOST&lt;/code&gt; mc macro). &lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 8 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;However, note that in the &lt;strong&gt;submit.cf&lt;/strong&gt; configuration file, which is the
configuration file that &lt;em&gt;sendmail&lt;/em&gt; uses for its &lt;strong&gt;MSP&lt;/strong&gt; (mail submission program)
[(a command-line &lt;em&gt;sendmail&lt;/em&gt; that functions as a mail submission agent (&lt;strong&gt;MSA&lt;/strong&gt;)],
the &lt;strong&gt;relay&lt;/strong&gt; delivery agent is defind sligthly differently.  (The only difference
is in &lt;strong&gt;F=mDFMuXa8k&lt;/strong&gt; delivery agent flags.  These are the same delivery
agent flags that &lt;em&gt;relay&lt;/em&gt; in &lt;em&gt;sendmail.cf&lt;/em&gt; uses  but with the &lt;strong&gt;F=k&lt;/strong&gt; delivery
agent flag added, which means “Don’t check for loops in HELO/EHLO command”.)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ grep -A3 Mrelay /etc/mail/submit.cf
Mrelay,         P=[IPC], F=mDFMuXa8k, S=EnvFromSMTP/HdrFromSMTP, R=MasqSMTP, E=\r\n, L=2040,
                T=DNS/RFC822/SMTP,
                A=TCP $h
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;LOCAL_RULE_0&lt;/strong&gt;  &lt;br /&gt;
Add rules to parse rule set 0&lt;/p&gt;

&lt;p&gt;Ruleset 0 is applied to recipient addresses by &lt;em&gt;sendmail&lt;/em&gt; after Ruleset 3
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 9 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;.
Ruleset 0 is expected to perform the delivery of the message to the recipient
so it must resolve to a triple that specifies each of the mailer, host,
and user.  The rules will be placed &lt;strong&gt;before&lt;/strong&gt; any &lt;strong&gt;smart host&lt;/strong&gt;
definition you may include so if you add rules that resolve addresses
appropriately, any address that matches a rule will &lt;strong&gt;not&lt;/strong&gt; be handled by
the smart host.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LOCAL_RULE_0&lt;/code&gt; macro marks the start of &lt;em&gt;sendmail.cf&lt;/em&gt; code that is
added to &lt;strong&gt;ruleset 0&lt;/strong&gt; (more commonly called the &lt;strong&gt;parse&lt;/strong&gt; ruleset).
Specifically, the code that follows the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LOCAL_RULE_0&lt;/code&gt; macro is added to
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ParseLocal&lt;/code&gt; ruleset, which is a hook into the &lt;em&gt;parse&lt;/em&gt; ruleset where
&lt;strong&gt;locally defined rules&lt;/strong&gt; are added.  The &lt;em&gt;parse&lt;/em&gt; ruleset rewrites the delivery
address to a mail delivery triple.&lt;/p&gt;

&lt;p&gt;The code that follows the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LOCAL_RULE_0&lt;/code&gt; macro above is a rewrite rule.
The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;R&lt;/code&gt; command is used to define a rewriting rule: 
Mail addresses are compared to the rule on the left hand side (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$-&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$+&lt;/code&gt;)
(the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$j&lt;/code&gt; macro holds the canonical domain name; which is in this case:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fbsd1.home.arpa&lt;/code&gt;).  If they match it, the rule rewrites those addresses
into a mail delivery triple where the mailer is &lt;em&gt;LR0relayLH&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;After rebuilding the configuration with the new master configuration file,
running a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail -bv&lt;/code&gt; test (with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-Ac&lt;/code&gt; parameters so that the
&lt;strong&gt;submit.cf&lt;/strong&gt; is used instead of &lt;strong&gt;sendmail.cf&lt;/strong&gt;) shows:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo sendmail -Ac -bv dusko
dusko... deliverable: mailer LR0relayST, host fbsd1.home.arpa,
  user dusko@fbsd1.home.arpa

$ sudo sendmail -Ac -bv dusko@localhost
dusko@localhost... deliverable: mailer LR0relayLH, host fbsd1.home.arpa,
  user dusko@fbsd1.home.arpa

$ sudo sendmail -Ac -bv dusko@fbsd1.home.arpa
dusko@fbsd1.home.arpa... deliverable: mailer LR0relayLH, host fbsd1.home.arpa,
  user dusko@fbsd1.home.arpa

$ sudo sendmail -Ac -bv dusko@some.external.domain
dusko@some.external.domain... deliverable: mailer smartrelay, host [127.0.0.1],
  user dusko@some.external.domain
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  Without defining the new, customized delivery agents
&lt;em&gt;LR0relayST&lt;/em&gt; and &lt;em&gt;LR0relayLH&lt;/em&gt;, delivery agent selected for local
delivery would have been the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;relay&lt;/code&gt; mailer supplied by default
by &lt;em&gt;sendmail&lt;/em&gt;.  To check that you can run the following commands with
the default &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;submit.mc&lt;/code&gt; (for FreeBSD: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;freebsd.submit.mc&lt;/code&gt;); that is,
without defining custom mailers (delivery agents):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo sendmail -Ac -bt 
ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)
Enter &amp;lt;ruleset&amp;gt; &amp;lt;address&amp;gt;

&amp;gt; ?
Help for test mode:
?                :this help message.
[ . . . ]
=M               :display the known mailers.
[ . . . ]

&amp;gt; =M 
[ . . .] 
mailer 8 (relay): P=[IPC] S=EnvFromSMTP/HdrFromSMTP R=MasqSMTP/MasqSMTP M=0 U=-1:-1 F=8DFMXakmu
  L=2040 E=\r\n T=DNS/RFC822/SMTP r=100 A=TCP $h
[ . . .] 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo sendmail -Ac -bv dusko
dusko... deliverable: mailer relay, host [127.0.0.1], user dusko@fbsd1.home.arpa

$ sudo sendmail -Ac -bv dusko@localhost
dusko@localhost... deliverable: mailer relay, host [127.0.0.1], user dusko@fbsd1.home.arpa

$ sudo sendmail -Ac -bv dusko@fbsd1.chem.ubc.ca
dusko@fbsd1.home.arpa... deliverable: mailer relay, host [127.0.0.1], user dusko@fbsd1.home.arpa

$ sudo sendmail -Ac -bv dusko@some.external.domain
dusko@some.external.domain... deliverable: mailer smartrelay, host [127.0.0.1],
  user dusko@some.external.domain
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Continuing with the dissection of Ruleset 0 (a.k.a. &lt;em&gt;parse&lt;/em&gt; ruleset):&lt;/p&gt;

&lt;p&gt;Run &lt;em&gt;sendmail&lt;/em&gt; in address test mode by using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-bt&lt;/code&gt; parameters (and also
with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-Ac&lt;/code&gt; parameters so that the &lt;em&gt;submit.cf&lt;/em&gt; is used instead of &lt;em&gt;sendmail.cf&lt;/em&gt;).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sendmail -bt -v -Ac
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;parse-an-address-with-parse&quot;&gt;Parse an Address with /parse&lt;/h3&gt;

&lt;p&gt;(Adapted and modified based on 
“The Bat Book” - sendmail, 4th Edition by Bryan Costales, Claus Assmann,
George Jansen, Gregory Neil Shapiro - Published by O’Reilly Media, Inc.,
October 2007 - Chapter 8. Test Rule Sets with -bt;
Section &lt;em&gt;Parse an Address with /parse&lt;/em&gt;.)&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/parse&lt;/code&gt; rule-testing command instructs &lt;em&gt;sendmail&lt;/em&gt; to pass an address
through a predetermined sequence of rules to select a delivery agent and
to put the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$u&lt;/code&gt; macro into its final form.  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/parse&lt;/code&gt; command is used
like this:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/parse address
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Parse the indicated addresses (dusko, dusko@localhost, dusko@fbsd1.home.arpa,
dusko@some.external.domain) returning the parsed address and mailer
(a.k.a. delivery agent) that &lt;em&gt;sendmail&lt;/em&gt; will use.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; /parse dusko
Cracked address = $g
Parsing envelope recipient address
canonify          input: dusko
Canonify2         input: dusko
Canonify2       returns: dusko
canonify        returns: dusko
parse             input: dusko
Parse0            input: dusko
Parse0          returns: dusko
ParseLocal        input: dusko
ParseLocal      returns: $# LR0relayST $@ fbsd1 . home . arpa $: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
parse           returns: $# LR0relayST $@ fbsd1 . home . arpa $: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
2                 input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
2               returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
MasqSMTP          input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
MasqSMTP        returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
final             input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
final           returns: dusko @ fbsd1 . home . arpa
mailer LR0relayST, host fbsd1.home.arpa, user dusko@fbsd1.home.arpa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; /parse dusko@localhost (FirstN LastN)
Cracked address = $g (FirstN LastN)
Parsing envelope recipient address
canonify          input: dusko @ localhost
Canonify2         input: dusko &amp;lt; @ localhost &amp;gt;
Canonify2       returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
canonify        returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
parse             input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
Parse0            input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
Parse0          returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
ParseLocal        input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
ParseLocal      returns: $# LR0relayLH $@ fbsd1 . home . arpa $: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
parse           returns: $# LR0relayLH $@ fbsd1 . home . arpa $: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
2                 input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
2               returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
MasqSMTP          input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
MasqSMTP        returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
final             input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
final           returns: dusko @ fbsd1 . home . arpa 
mailer LR0relayLH, host fbsd1.home.arpa, user dusko@fbsd1.home.arpa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The address &lt;em&gt;you@localhost&lt;/em&gt; is first fed into &lt;em&gt;crackaddr&lt;/em&gt;
[line &lt;em&gt;Cracked address = $g (FirstN LastN)&lt;/em&gt;] to separate it from any
surrounding RFC822 comments such as “(FirstN LastN)”.  If mail were
actually to be sent, the address would be stored in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$g&lt;/code&gt; macro before
being passed to rules.  That line uses &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$g&lt;/code&gt; as a placeholder to show where
the address was found.&lt;/p&gt;

&lt;p&gt;The next line (&lt;em&gt;Parsing envelope recipient address&lt;/em&gt;) shows that the address
will be treated as that of an &lt;em&gt;envelope recipient&lt;/em&gt;.  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/tryflags&lt;/code&gt; command
sets whether it is treated as a &lt;em&gt;header&lt;/em&gt; or &lt;em&gt;envelope&lt;/em&gt; or as a &lt;em&gt;sender&lt;/em&gt; or
&lt;em&gt;recipient&lt;/em&gt; address.&lt;/p&gt;

&lt;p&gt;The address is passed to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;canonify&lt;/code&gt; rule set 3 because all addresses
are rewritten by the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;canonify&lt;/code&gt; rule set 3 first.  The job of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;canonify&lt;/code&gt;
rule set 3 is to focus on (surround in angle brackets) the host part of the
address, which it does (line &lt;em&gt;Canonify2          input: dusko &amp;lt; @ localhost &amp;gt;&lt;/em&gt;).
The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;canonify&lt;/code&gt; rule set 3, in this example, then passes the address to the
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Canonify2&lt;/code&gt; rule set to see whether &lt;em&gt;localhost&lt;/em&gt; is a synonym for the
local machine’s name.  Since it is, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Canonify2&lt;/code&gt; rule set makes that
translation (&lt;em&gt;Canonify2        returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;&lt;/em&gt;).&lt;/p&gt;

&lt;p&gt;The output of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;canonify&lt;/code&gt; rule set 3 is passed to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parse&lt;/code&gt; rule set 0,
whose job is to select a &lt;strong&gt;delivery agent&lt;/strong&gt;
(line &lt;em&gt;parse             input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;&lt;/em&gt;).
Since &lt;em&gt;fbsd1.home.arpa&lt;/em&gt; is the local machine, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parse&lt;/code&gt; rule set 0
(by way of other rule sets) selects the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LR0relayLH&lt;/code&gt; customized (local)
delivery agent &lt;br /&gt;
(line
&lt;em&gt;parse    returns: $# LR0relayLH $@ fbsd1 . home . arpa $: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;&lt;/em&gt;).&lt;/p&gt;

&lt;p&gt;That line shows that the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$:&lt;/code&gt; part of the delivery agent &lt;strong&gt;triple&lt;/strong&gt; will
eventually be tucked into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$u&lt;/code&gt; for use by the delivery agent’s &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;A=&lt;/code&gt;
delivery agent equate.  Before that happens, that address needs to be
passed through its own set of specific rules.   It is given to rule set 2
because all recipient addresses are given to rule set 2 &lt;br /&gt;
(line  &lt;em&gt;2            input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;&lt;/em&gt;). 
It is then given to rule set &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MasqSMTP&lt;/code&gt; because the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;R=&lt;/code&gt; delivery agent
equate for the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LR0relayLH&lt;/code&gt; customized local delivery agent specifies rule
set &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MasqSMTP&lt;/code&gt; for the envelope recipient
(line &lt;em&gt;MasqSMTP          input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;&lt;/em&gt;).
Finally, it is given to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;final&lt;/code&gt; rule set 4 because all addresses are
lastly rewritten by the final rule set 4 (line 
&lt;em&gt;final           returns: dusko @ fbsd1 . home . arpa&lt;/em&gt;). 
The last line of output shows that the customized local delivery agent
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LR0relayLH&lt;/code&gt; was selected and that the value that would be put into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$u&lt;/code&gt;
(were mail really being sent) would be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dusko@fbsd1.home.arpa&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Similarly, with the actual local host’s hostname (&lt;em&gt;fbsd1.home.arpa&lt;/em&gt;):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; /parse dusko@fbsd1.home.arpa
Cracked address = $g
Parsing envelope recipient address
canonify          input: dusko @ fbsd1 . home . arpa
Canonify2         input: dusko &amp;lt; @ fbsd1 . home . arpa &amp;gt;
Canonify2       returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
canonify        returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
parse             input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
Parse0            input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
Parse0          returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
ParseLocal        input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
ParseLocal      returns: $# LR0relayLH $@ fbsd1 . home . arpa $: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
parse           returns: $# LR0relayLH $@ fbsd1 . home . arpa $: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
2                 input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
2               returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
MasqSMTP          input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
MasqSMTP        returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
final             input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
final           returns: dusko @ fbsd1 . home . arpa
mailer LR0relayLH, host fbsd1.home.arpa, user dusko@fbsd1.home.arpa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In this configuration (with three customized delivery agents &lt;em&gt;LR0relayLH&lt;/em&gt;,
&lt;em&gt;LR0relayST&lt;/em&gt; and &lt;em&gt;smartrelay&lt;/em&gt;), when you &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/parse&lt;/code&gt; an address that is not local:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; /parse dusko@some.external.domain
Cracked address = $g
Parsing envelope recipient address
canonify           input: dusko @ some . external . domain
Canonify2          input: dusko &amp;lt; @ some . external . domain &amp;gt;
Canonify2        returns: dusko &amp;lt; @ some . external . domain . &amp;gt;
canonify         returns: dusko &amp;lt; @ some . external . domain . &amp;gt;
parse              input: dusko &amp;lt; @ some . external . domain . &amp;gt;
Parse0             input: dusko &amp;lt; @ some . external . domain . &amp;gt;
Parse0           returns: dusko &amp;lt; @ some . external . domain . &amp;gt;
ParseLocal         input: dusko &amp;lt; @ some . external . domain . &amp;gt;
ParseLocal       returns: dusko &amp;lt; @ some . external . domain . &amp;gt;
Parse1             input: dusko &amp;lt; @ some . external . domain . &amp;gt;
MailerToTriple     input: &amp;lt; smartrelay : [ 127 . 0 . 0 . 1 ] &amp;gt; dusko &amp;lt; @ some . external . domain . &amp;gt;
MailerToTriple   returns: $# smartrelay $@ [ 127 . 0 . 0 . 1 ] $: dusko &amp;lt; @ some . external . domain . &amp;gt;
Parse1           returns: $# smartrelay $@ [ 127 . 0 . 0 . 1 ] $: dusko &amp;lt; @ some . external . domain . &amp;gt;
parse            returns: $# smartrelay $@ [ 127 . 0 . 0 . 1 ] $: dusko &amp;lt; @ some . external . domain . &amp;gt;
2                  input: dusko &amp;lt; @ some . external . domain . &amp;gt;
2                returns: dusko &amp;lt; @ some . external . domain . &amp;gt;
MasqSMTP           input: dusko &amp;lt; @ some . external . domain . &amp;gt;
MasqSMTP         returns: dusko &amp;lt; @ some . external . domain . &amp;gt;
final              input: dusko &amp;lt; @ some . external . domain . &amp;gt;
final            returns: dusko @ some . external . domain 
mailer smartrelay, host [127.0.0.1], user dusko@some.external.domain
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In this configuration (with three customized delivery agents &lt;em&gt;LR0relayLH&lt;/em&gt;,
&lt;em&gt;LR0relayST&lt;/em&gt; and &lt;em&gt;smartrelay&lt;/em&gt;), when you run the indicated addresses
(dusko, dusko@localhost, dusko@fbsd1.home.arpa, dusko@some.external.address)
through the rule 0:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; 0 dusko
parse             input: dusko
Parse0            input: dusko
Parse0          returns: dusko
ParseLocal        input: dusko
ParseLocal      returns: $# LR0relayST $@ fbsd1 . home . arpa $: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
parse           returns: $# LR0relayST $@ fbsd1 . home . arpa $: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; 0 dusko@localhost
parse              input: dusko @ localhost
Parse0             input: dusko @ localhost
Parse0           returns: dusko @ localhost
ParseLocal         input: dusko @ localhost
ParseLocal       returns: dusko @ localhost
Parse1             input: dusko @ localhost
Parse1           returns: $# local $: dusko @ localhost
parse            returns: $# local $: dusko @ localhost
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; 0 dusko@fbsd1.home.arpa
parse              input: dusko @ fbsd1 . home . arpa
Parse0             input: dusko @ fbsd1 . home . arpa
Parse0           returns: dusko @ fbsd1 . home . arpa
ParseLocal         input: dusko @ fbsd1 . home . arpa
ParseLocal       returns: dusko @ fbsd1 . home . arpa
Parse1             input: dusko @ fbsd1 . home . arpa
Parse1           returns: $# local $: dusko @ fbsd1 . home . arpa
parse            returns: $# local $: dusko @ fbsd1 . home . arpa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; 0 dusko@some.external.address
parse              input: dusko @ some . external . domain
Parse0             input: dusko @ some . external . domain
Parse0           returns: dusko @ some . external . domain
ParseLocal         input: dusko @ some . external . domain
ParseLocal       returns: dusko @ some . external . domain
Parse1             input: dusko @ some . external . domain
Parse1           returns: $# local $: dusko @ some . external . domain
parse            returns: $# local $: dusko @ some . external . domain
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Display the known mailers (by using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;=M&lt;/code&gt; rule-testing command):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; =M
[ . . . ]
mailer 8 (relay): P=[IPC] S=EnvFromSMTP/HdrFromSMTP R=MasqSMTP/MasqSMTP M=0 U=-1:-1 F=8DFMXakmu L=2040 E=\r\n T=DNS/RFC822/SMTP r=100 A=TCP $h
mailer 9 (LR0relay): P=[IPC] S=EnvFromSMTP/HdrFromSMTP R=MasqSMTP/MasqSMTP M=0 U=-1:-1 F=8DFMXakmu L=2040 E=\r\n T=DNS/RFC822/SMTP r=100 A=TCP $h
mailer 10 (smartrelay): P=[IPC] S=EnvFromSMTP/HdrFromSMTP R=MasqSMTP/MasqSMTP M=0 U=-1:-1 F=8DFMXakmu L=2040 E=\r\n T=DNS/RFC822/SMTP r=100 A=TCP $h 1465
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Dump the contents of the Ruleset 0.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; =S0
R$*             $: $&amp;gt; Parse0 $1 
R&amp;lt; @ &amp;gt;          $# local $: &amp;lt; @ &amp;gt; 
R$*             $: $&amp;gt; ParseLocal $1 
R$*             $: $&amp;gt; Parse1 $1 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Dump the contents of the rule Parse0.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; =SParse0
R&amp;lt; @ &amp;gt;          $@ &amp;lt; @ &amp;gt;
[ . . . ]
R$* $=O $* &amp;lt; @ *LOCAL* &amp;gt;                $@ $&amp;gt; Parse0 $&amp;gt; canonify $1 $2 $3 
R$* &amp;lt; @ *LOCAL* &amp;gt;               $: $1 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Dump the contents of the rule ParseLocal.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; =SParseLocal
R$-       $# LR0relayST $@ fbsd1 . home . arpa $: $1 &amp;lt; @ fbsd1 . home . arpa . &amp;gt; 
R$+ &amp;lt; @ fbsd1 . home . arpa . &amp;gt;       $# LR0relayLH $@ fbsd1 . home . arpa $: $1 &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Dump the contents of the rule Parse1.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; =SParse1
R$* &amp;lt; @ [ $+ ] &amp;gt; $*             $: $&amp;gt; ParseLocal $1 &amp;lt; @ [ $2 ] &amp;gt; $3 
R$* &amp;lt; @ [ $+ ] &amp;gt; $*             $: $1 &amp;lt; @ [ $2 ] : smartrelay : [ 127 . 0 . 0 . 1 ] &amp;gt; $3 
R$* &amp;lt; @ [ $+ ] : &amp;gt; $*           $# esmtp $@ [ $2 ] $: $1 &amp;lt; @ [ $2 ] &amp;gt; $3 
R$* &amp;lt; @ [ $+ ] : $- : $* &amp;gt; $*           $# $3 $@ $4 $: $1 &amp;lt; @ [ $2 ] &amp;gt; $5 
R$* &amp;lt; @ [ $+ ] : $+ &amp;gt; $*                $# esmtp $@ $3 $: $1 &amp;lt; @ [ $2 ] &amp;gt; $4 
R$=L &amp;lt; @ $=w . &amp;gt;                $# local $: @ $1 
R$+ &amp;lt; @ $=w . &amp;gt;                 $# local $: $1 
R$* &amp;lt; @ $* &amp;gt; $*                 $: $&amp;gt; MailerToTriple &amp;lt; smartrelay : [ 127 . 0 . 0 . 1 ] &amp;gt; $1 &amp;lt; @ $2 &amp;gt; $3 
R$* &amp;lt; @ $* &amp;gt; $*                 $# esmtp $@ $2 $: $1 &amp;lt; @ $2 &amp;gt; $3 
R$=L            $# local $: @ $1 
R$+             $# local $: $1 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Tests:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf %s\\n &quot;Testing.&quot; | mail -v -s &quot;Test 1&quot; dusko
dusko... Connecting to fbsd1.chem.ubc.ca. via LR0relayST...
[ . . . ]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf %s\\n &quot;Testing.&quot; | mail -v -s &quot;Test 2&quot; dusko@localhost
dusko@localhost... Connecting to fbsd1.chem.ubc.ca. via LR0relayLH...
[ . . . ]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf %s\\n &quot;Testing.&quot; | mail -v -s &quot;Test 3&quot; dusko@fbsd1.home.arpa
dusko@fbsd1.home.arpa... Connecting to fbsd1.home.arpa. via LR0relayLH...
[ . . . ]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf %s\\n &quot;Testing.&quot; | mail -v -s &quot;Test 4&quot; dusko@some.external.domain
dusko@some.external.domain... Connecting to [127.0.0.1] port 1465 via smartrelay...
[ . . . ]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Quit address test mode with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/quit&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; /quit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;When you run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make&lt;/code&gt;, if &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your_machine_hostname.mc&lt;/code&gt; file does not exist, 
it is created (using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;freebsd.mc&lt;/code&gt; file as a template).  Similarly, if 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your_machine_hostname.submit.mc&lt;/code&gt; file does not exist, it is created
using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;freebsd.submit.mc&lt;/code&gt; file as a template.&lt;/p&gt;

&lt;p&gt;More specifically, when you run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make&lt;/code&gt;:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;freebsd.mc&lt;/code&gt; file gets copied to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your_machine_hostname.mc&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m4&lt;/code&gt; macro processor utility processes &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your_machine_hostname.mc&lt;/code&gt; 
into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your_machine_hostname.cf&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;freebsd.submit.mc&lt;/code&gt; file gets copied to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your_machine_hostname.submit.mc&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;m4&lt;/code&gt; macro processor utility processes &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your_machine_hostname.submit.mc&lt;/code&gt;
into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your_machine_hostname.submit.cf&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;NOTE:&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make install&lt;/code&gt; will also install the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*.mc&lt;/code&gt; files as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*.cf&lt;/code&gt; files;
that is, it will install &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your_machine_hostname.mc&lt;/code&gt; as&lt;br /&gt;
  &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail.cf&lt;/code&gt;&lt;/strong&gt;&lt;br /&gt;
and &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your_machine_hostname.submit.mc&lt;/code&gt; as&lt;br /&gt;
  &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;submit.cf&lt;/code&gt;&lt;/strong&gt;. &lt;br /&gt;
[A &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make install&lt;/code&gt; is only necessary after modifying the &lt;em&gt;.mc&lt;/em&gt; file(s).]&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# make 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cp -f freebsd.mc fbsd1.home.arpa.mc
/usr/bin/m4 -D_CF_DIR_=/usr/local/share/sendmail/cf/   /usr/local/share/sendmail/cf/m4/cf.m4 fbsd1.home.arpa.mc &amp;gt; fbsd1.home.arpa.cf 

cp -f freebsd.submit.mc fbsd1.home.arpa.submit.mc
/usr/bin/m4 -D_CF_DIR_=/usr/local/share/sendmail/cf/   /usr/local/share/sendmail/cf/m4/cf.m4 fbsd1.home.arpa.submit.mc &amp;gt; fbsd1.home.arpa.submit.cf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Modify the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mailer.conf&lt;/code&gt; file.  (Note that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mailer.conf&lt;/code&gt;
is in two locations.  The mailwrapper(8) program first looks in
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local/etc/mail/mailer.conf&lt;/code&gt; falling back on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/mail/mailer.conf&lt;/code&gt;.)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo cp -i /usr/local/etc/mail/mailer.conf /usr/local/etc/mail/mailer.conf.ORIG
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /etc/mail/mailer.conf.ORIG 
# $FreeBSD$
#
# Execute the &quot;real&quot; sendmail program, named /usr/libexec/sendmail/sendmail
#
# If dma(8) is installed, an example mailer.conf that uses dma(8) instead can
# can be found in /usr/share/examples/dma.
#
sendmail        /usr/libexec/sendmail/sendmail
mailq           /usr/libexec/sendmail/sendmail
newaliases      /usr/libexec/sendmail/sendmail
hoststat        /usr/libexec/sendmail/sendmail
purgestat       /usr/libexec/sendmail/sendmail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo vi /usr/local/etc/mail/mailer.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /usr/local/etc/mail/mailer.conf
#
# Execute the &quot;real&quot; sendmail program, named /usr/local/sbin/sendmail
#
sendmail        /usr/local/sbin/sendmail
send-mail       /usr/local/sbin/sendmail
mailq           /usr/local/sbin/sendmail
newaliases      /usr/local/sbin/sendmail
hoststat        /usr/local/sbin/sendmail
purgestat       /usr/local/sbin/sendmail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo cp -i /etc/mail/mailer.conf /etc/mail/mailer.conf.ORIG
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo cp -i /usr/local/etc/mail/mailer.conf /etc/mail/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /etc/mail/mailer.conf
#
# Execute the &quot;real&quot; sendmail program, named /usr/local/sbin/sendmail
#
sendmail        /usr/local/sbin/sendmail
send-mail       /usr/local/sbin/sendmail
mailq           /usr/local/sbin/sendmail
newaliases      /usr/local/sbin/sendmail
hoststat        /usr/local/sbin/sendmail
purgestat       /usr/local/sbin/sendmail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;authenticating-with-auth&quot;&gt;Authenticating with AUTH&lt;/h2&gt;

&lt;p&gt;From &lt;strong&gt;sendmail Cookbook&lt;/strong&gt; by Craig Hunt (Published by O’Reilly
Media, Inc., Publication Date: December 2003):&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Strong authentication uses cryptographic techniques to verify the
identity of the &lt;strong&gt;end points&lt;/strong&gt; in a network exchange.  For &lt;em&gt;sendmail&lt;/em&gt;,
strong authentication ensures that the connecting host and the receiving
host are &lt;strong&gt;who they claim to be&lt;/strong&gt;.&lt;/p&gt;

  &lt;p&gt;Authentication is not the same as encryption.  Encryption can be used to
hide the content of a piece of mail or to hide the entire SMTP protocol
exchange, including the mail.  (One technique for encrypting the SMTP
exchange, and the mail it carries, is covered in Chapter 8. Securing the
Mail Transport. &lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 11 &lt;/a&gt;&lt;/sup&gt;])&lt;/strong&gt;  Authentication does not
hide the contents of mail; rather, it ensures that the mail comes from
the correct source. &lt;br /&gt;
[ . . . ]  &lt;br /&gt;
&lt;strong&gt;The AUTH Protocol&lt;/strong&gt;&lt;br /&gt;
&lt;strong&gt;AUTH&lt;/strong&gt; is an SMTP protocol extension. It is defined in RFC 2554,
&lt;em&gt;SMTP Service Extension for Authentication&lt;/em&gt;.  RFC 2554 outlines the
negotiations that are used to select an authentication mechanism.
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 12 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;  &lt;br /&gt;
[ . . . ] &lt;br /&gt;
The AUTH protocol relies on the &lt;strong&gt;Simple Authentication and Security
Layer (SASL)&lt;/strong&gt; for the actual authentication.  RFC 2222,
&lt;em&gt;Simple Authentication and Security Layer (SASL)&lt;/em&gt;, describes the SASL
framework and defines how protocols negotiate an authentication method. &lt;br /&gt;
[ . . . ] &lt;br /&gt;
&lt;em&gt;sendmail&lt;/em&gt; does not contain implementations of the various authentication
techniques.  Instead, &lt;em&gt;sendmail&lt;/em&gt; uses the techniques that are implemented
and configured in SASL.  For this to work, Cyrus SASL must be installed
and properly configured on the &lt;em&gt;sendmail&lt;/em&gt; system.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Refer to
&lt;strong&gt;&lt;a href=&quot;#authmechanisms-option&quot;&gt;AuthMechanisms Option&lt;/a&gt;&lt;/strong&gt; section below for
more information about SASL (including a reference to an additional RFC:
RFC2554).&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Cyrus SASL&lt;/strong&gt;&lt;br /&gt;
Cyrus SASL is implemented as a library.  The SASL library standardizes
the way in which applications interface with the authentication methods.
Many Unix systems come with the SASL libraries preinstalled.&lt;/p&gt;

  &lt;p&gt;If SASL is not installed on your system, check to see if it was delivered
as part of your Unix software.  If it was, install the copy of SASL
provided by your Unix vendor.  If it is not available from your vendor,
go to &lt;a href=&quot;http://www.cyrusimap.org/sasl/&quot;&gt;http://www.cyrusimap.org/sasl/&lt;/a&gt;
to download the latest version of SASL.&lt;/p&gt;

  &lt;p&gt;After Cyrus SASL is installed, the specific authentication techniques
must be configured before they can be used.  To understand SASL
configuration, you must understand SASL terminology.
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 13 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;The SASL Sendmail.conf file&lt;/strong&gt; &lt;br /&gt;
. . . Some authentication techniques (authentication mechanisms)
available through SASL that can be used with &lt;em&gt;sendmail&lt;/em&gt; require
configuration through the &lt;em&gt;Sendmail.conf&lt;/em&gt; SASL application file.
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 14 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Passing Flags to SASL&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;sendmail&lt;/em&gt; can be configured to request optional processing from SASL
for the AUTH protocol.  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;confAUTH_OPTIONS&lt;/code&gt; define can set several
flags that affect the way that &lt;em&gt;sendmail&lt;/em&gt; and SASL interact.
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 15 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Authentication Macros and Rulesets&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;sendmail&lt;/em&gt; uses the information provided by authentication and stores
authentication data in several macros.  The authentication macros are:&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;${auth_author}&lt;/em&gt;&lt;br /&gt;
This macro holds the &lt;em&gt;sendmail&lt;/em&gt; &lt;strong&gt;authorization id&lt;/strong&gt;, which is the address
assigned to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH=&lt;/code&gt; parameter on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL From:&lt;/code&gt; line.&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;${auth_authen}&lt;/em&gt;&lt;br /&gt;
This macro holds the &lt;em&gt;sendmail&lt;/em&gt; &lt;strong&gt;authentication id&lt;/strong&gt;, which is either the
userid or the userid and the realm, written as &lt;em&gt;userid&lt;/em&gt; @ &lt;em&gt;realm&lt;/em&gt;.&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;${auth_type}&lt;/em&gt;&lt;br /&gt;
This macro holds the name of the authentication method used to
authenticate the client.  For example, LOGIN would be a possible
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_type}&lt;/code&gt; value.&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;${auth_ssf}&lt;/em&gt; &lt;br /&gt;
This macro holds the number of bits used for optional SASL encryption.
If no SASL link encryption is used, this macro is unassigned.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;In addition to the authentication macros, the &lt;strong&gt;hostname&lt;/strong&gt; &lt;em&gt;and&lt;/em&gt;
the &lt;strong&gt;IP address&lt;/strong&gt; of the system at the other end of the mail transport
connection are stored in macros, which can be useful information for
authentication checks.  The following values are stored in the macros:&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;${server_addr}&lt;/em&gt;&lt;br /&gt;
The &lt;em&gt;IP address&lt;/em&gt; of the &lt;strong&gt;remote server&lt;/strong&gt;, as determined from the
TCP connection.  This macro is used on the &lt;strong&gt;client&lt;/strong&gt;.&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;${server_name}&lt;/em&gt; &lt;br /&gt;
The &lt;em&gt;hostname&lt;/em&gt; of the &lt;strong&gt;remote server&lt;/strong&gt;, as determined from a hostname
lookup of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${server_addr}&lt;/code&gt; value.  This macro is used on the
&lt;strong&gt;client&lt;/strong&gt;.&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;${client_addr}&lt;/em&gt;&lt;br /&gt;
The &lt;em&gt;IP address&lt;/em&gt; of the &lt;strong&gt;client&lt;/strong&gt;, as determined from the TCP connection.
This macro is used on the &lt;strong&gt;server&lt;/strong&gt;.&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;${client_name}&lt;/em&gt;&lt;br /&gt;
The &lt;em&gt;hostname&lt;/em&gt; of the &lt;strong&gt;client&lt;/strong&gt;, as determined from a hostname lookup of
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${client_addr}&lt;/code&gt; value.  This macro is used on the &lt;strong&gt;server&lt;/strong&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;em&gt;sendmail&lt;/em&gt; also provides &lt;em&gt;ruleset&lt;/em&gt; &lt;strong&gt;hooks&lt;/strong&gt; that simplify the process of
adding authentication checks.  The primary hooks used with AUTH are:&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;Local_check_mail&lt;/em&gt;&lt;br /&gt;
This ruleset adds checks to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;check_mail&lt;/code&gt; ruleset, which is used to
process the &lt;strong&gt;envelope sender address&lt;/strong&gt; from the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL From:&lt;/code&gt; line.
The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;check_mail&lt;/code&gt; ruleset is &lt;strong&gt;not&lt;/strong&gt; specific to AUTH, but the overlap
between the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_author}&lt;/code&gt; value and the envelope sender address means
that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local_check_mail&lt;/code&gt; is occasionally used for custom AUTH processing.&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;Local_check_rcpt&lt;/em&gt;&lt;br /&gt;
This ruleset adds checks to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;check_rcpt&lt;/code&gt; ruleset, which processes
the &lt;strong&gt;envelope recipient address&lt;/strong&gt; from the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCPT To:&lt;/code&gt; line.
The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;check_rcpt&lt;/code&gt; ruleset is &lt;strong&gt;not&lt;/strong&gt; specific to AUTH, but because it is
used to authorize delivery to a recipient, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local_check_rcpt&lt;/code&gt; is
occasionally used to modify it for AUTH processing.&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;Local_trust_auth&lt;/em&gt;&lt;br /&gt;
This ruleset adds checks to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;trust_auth&lt;/code&gt; ruleset, which is used by
the server to determine whether the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH=&lt;/code&gt; parameter on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL From:&lt;/code&gt;
line should be trusted.  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;trust_auth&lt;/code&gt; ruleset is specific to the AUTH
protocol because the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH=&lt;/code&gt; parameter is only used when AUTH is running
on the client.  Use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local_trust_auth&lt;/code&gt; to customize the processing of
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH=&lt;/code&gt; parameter.&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;Local_Relay_Auth&lt;/em&gt;&lt;br /&gt;
This ruleset is called by the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Rcpt_ok&lt;/code&gt; ruleset.  By default, &lt;em&gt;sendmail&lt;/em&gt;
grants relaying privileges to an authenticated client only if the client
authenticated is using a mechanism listed in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$={TrustAuthMech}&lt;/code&gt; class.
Use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local_Relay_Auth&lt;/code&gt; to modify the process of granting relaying
privileges to &lt;strong&gt;authenticated clients&lt;/strong&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;storing-auth-credentials-in-the-authinfo-file&quot;&gt;Storing AUTH Credentials in the authinfo File&lt;/h2&gt;

&lt;p&gt;From the &lt;em&gt;sendmail&lt;/em&gt; &lt;strong&gt;cf/README&lt;/strong&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local/share/sendmail/cf/README&lt;/code&gt;),
under the section for &lt;strong&gt;MSP&lt;/strong&gt; (Message Submission Program), which is a
command-line &lt;em&gt;sendmail&lt;/em&gt; that functions as a mail submission agent (&lt;strong&gt;MSA&lt;/strong&gt;):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[ . . . ]
+----------------------------+
| MESSAGE SUBMISSION PROGRAM |
+----------------------------+
[ . . . ]
If the MSP should actually use AUTH then the necessary data
should be placed in a map as explained in SMTP AUTHENTICATION:

FEATURE(`authinfo&apos;, `DATABASE_MAP_TYPE /etc/mail/msp-authinfo&apos;)

/etc/mail/msp-authinfo should contain an entry like:

        AuthInfo:127.0.0.1      &quot;U:smmsp&quot; &quot;P:secret&quot; &quot;M:DIGEST-MD5&quot;

The file and the map created by makemap should be owned by smmsp,
its group should be smmsp, and it should have mode 640.  

The database used by the MTA for AUTH must have a corresponding entry.

Additionally the MTA must trust this authentication data so the AUTH=
part will be relayed on to the next hop.  This can be achieved by
adding the following to your sendmail.mc file:

        LOCAL_RULESETS
        SLocal_trust_auth
        R$*     $: $&amp;amp;{auth_authen}
        Rsmmsp  $# OK
[ . . . ]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Create the &lt;em&gt;/etc/mail/authinfo&lt;/em&gt; file (for storing AUTH authentication
credentials in a file separate from the &lt;em&gt;access&lt;/em&gt; database).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  In the two lines below &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SLocal_trust_auth&lt;/code&gt;
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 16 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;, there is a &lt;strong&gt;tab&lt;/strong&gt; character
before &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$:&lt;/code&gt; and before &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$#&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;You need to store the client’s authentication credentials in that file
using the same &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AuthInfo:&lt;/code&gt; tag used in the &lt;em&gt;access&lt;/em&gt; database, and you need
to make sure that the &lt;em&gt;authinfo&lt;/em&gt; text file and database are not readable
by anyone except the &lt;em&gt;smmsp&lt;/em&gt; user.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo vi /etc/mail/authinfo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo chown smmsp:smmsp /etc/mail/authinfo
$ sudo chmod 0640 /etc/mail/authinfo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -lh /etc/mail/authinfo
-rw-r-----  1 smmsp  smmsp   142B Nov 12 19:57 /etc/mail/authinfo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ grep &apos;127.0.0.1&apos; /etc/hosts
127.0.0.1               localhost localhost.my.domain
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo cat /etc/mail/authinfo
AuthInfo:[127.0.0.1] &quot;U:smmsp&quot; &quot;I:dusko&quot; &quot;P:YourISPPassword&quot; &quot;M:LOGIN&quot;
AuthInfo:127.0.0.1 &quot;U:smmsp&quot; &quot;I:dusko&quot; &quot;P:YourISPPassword&quot; &quot;M:LOGIN&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In my tests, when the letter &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;M&lt;/code&gt; (the list of mechanisms, separated by
spaces) had both PLAIN and LOGIN mechanisms; that is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;M:PLAIN LOGIN&quot;&lt;/code&gt;
(or: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;M:LOGIN PLAIN&quot;&lt;/code&gt;), &lt;em&gt;sendmail&lt;/em&gt; used only the PLAIN mechanism.
&lt;em&gt;Sendmail&lt;/em&gt; used the LOGIN mechanism when the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;M&lt;/code&gt; letter had only &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LOGIN&lt;/code&gt;
(that is, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;M:LOGIN&quot;&lt;/code&gt;).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; This requires the use of the &lt;em&gt;authinfo&lt;/em&gt; FEATURE to the
&lt;em&gt;sendmail&lt;/em&gt; configuration, which you did above, when you modified
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;freebsd.submit.mc&lt;/code&gt; file.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; If the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make all&lt;/code&gt; command generates an error &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;No such file or
directory&lt;/code&gt; for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail.cf&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cd /etc/mail

$ sudo su
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# make all
[ . . . ]
/usr/sbin/makemap hash authinfo.db &amp;lt; authinfo
makemap: /etc/mail/sendmail.cf: No such file or directory
*** Error code 66

Stop.
make: stopped in /etc/mail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;fix it by creating an empty &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail.cf&lt;/code&gt; file:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# touch /etc/mail/sendmail.cf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and then run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make all&lt;/code&gt; again:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# make all
[ . . . ]
/usr/sbin/makemap hash authinfo.db &amp;lt; authinfo
chmod 0640 authinfo.db
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ls -lh /etc/mail/authinfo*
-rw-r-----  1 smmsp  smmsp   142B Nov 12 19:57 /etc/mail/authinfo
-rw-r-----  1 root   wheel   128K Nov 12 17:57 /etc/mail/authinfo.db
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chown smmsp:smmsp /etc/mail/authinfo.db 
# sudo chmod 0640 /etc/mail/authinfo.db
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ls -lh /etc/mail/authinfo*
-rw-r-----  1 smmsp  smmsp   142B Nov 12 19:57 /etc/mail/authinfo
-rw-r-----  1 smmsp  smmsp   128K Nov 12 19:57 /etc/mail/authinfo.db
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  When you need to re-create &lt;em&gt;sendmail&lt;/em&gt; configuration files with 
these permissions for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;authinfo.db&lt;/code&gt;, you might encounter a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Permission
denied&lt;/code&gt; error:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# make all   (# or &apos;make install&apos;)
[ . . . ]
/usr/sbin/makemap hash authinfo.db &amp;lt; authinfo
makemap: error opening type hash map authinfo.db: Permission denied
*** Error code 73

Stop.
make: stopped in /etc/mail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To fix it, temporary change permissions for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;authinfo.db&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chgrp wheel /etc/mail/authinfo.db
# chmod 0660 /etc/mail/authinfo.db
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ls -lh /etc/mail/authinfo.db
-rw-rw----  1 smmsp  wheel   128K Nov 12 19:14 /etc/mail/authinfo.db
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# make all
/usr/sbin/makemap hash authinfo.db &amp;lt; authinfo
chmod 0640 authinfo.db
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ls -lh /etc/mail/authinfo.db
-rw-r-----  1 smmsp  wheel   128K Nov 12 19:14 /etc/mail/authinfo.db
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After successfull &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make run&lt;/code&gt;, change the permissions back:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chgrp smmsp /etc/mail/authinfo.db
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ls -lh /etc/mail/authinfo.db
-rw-r-----  1 smmsp  smmsp   128K Nov 12 19:14 /etc/mail/authinfo.db
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and continue:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# make install
# make start
Starting: sendmail sendmail-clientmqueue.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# exit
exit
% 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sendmail -d0 &amp;lt; /dev/null
Version 8.17.1
 Compiled with: DANE DNSMAP IPV6_FULL LOG MAP_REGEX MATCHGECOS MILTER
                MIME7TO8 MIME8TO7 NAMED_BIND NETINET NETINET6 NETUNIX NEWDB NIS
                PICKY_HELO_CHECK PIPELINING SASLv2 SCANF STARTTLS TCPWRAPPERS
                TLS_EC TLS_VRFY_PER_CTX USERDB XDEBUG

============ SYSTEM IDENTITY (after readcf) ============
      (short domain name) $w = fbsd1
  (canonical domain name) $j = fbsd1.home.arpa
         (subdomain name) $m = home.arpa
              (node name) $k = fbsd1.home.arpa
========================================================
 
Recipient names must be specified
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sendmail -d0.1 -bv root 
Version 8.17.1
 Compiled with: DANE DNSMAP IPV6_FULL LOG MAP_REGEX MATCHGECOS MILTER
                MIME7TO8 MIME8TO7 NAMED_BIND NETINET NETINET6 NETUNIX NEWDB NIS
                PICKY_HELO_CHECK PIPELINING SASLv2 SCANF STARTTLS TCPWRAPPERS
                TLS_EC TLS_VRFY_PER_CTX USERDB XDEBUG

============ SYSTEM IDENTITY (after readcf) ============
      (short domain name) $w = fbsd1
  (canonical domain name) $j = fbsd1.home.arpa
         (subdomain name) $m = home.arpa
              (node name) $k = fbsd1.home.arpa
========================================================

Notice: -bv may give misleading output for non-privileged user
root... deliverable: mailer local, user root
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo /usr/libexec/sendmail/sendmail -d0.1 -bv root
Version 8.16.1
 Compiled with: DNSMAP IPV6_FULL LOG MAP_REGEX MATCHGECOS MILTER
                MIME7TO8 MIME8TO7 NAMED_BIND NETINET NETINET6 NETUNIX NEWDB NIS
                PIPELINING SCANF STARTTLS TCPWRAPPERS TLS_EC TLS_VRFY_PER_CTX
                USERDB XDEBUG

============ SYSTEM IDENTITY (after readcf) ============
      (short domain name) $w = fbsd1
  (canonical domain name) $j = fbsd1.home.arpa
         (subdomain name) $m = home.arpa
              (node name) $k = fbsd1.home.arpa
========================================================

root... deliverable: mailer local, user root
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo /usr/sbin/sendmail -d0.1 -bv root
Version 8.17.1
 Compiled with: DANE DNSMAP IPV6_FULL LOG MAP_REGEX MATCHGECOS MILTER
                MIME7TO8 MIME8TO7 NAMED_BIND NETINET NETINET6 NETUNIX NEWDB NIS
                PICKY_HELO_CHECK PIPELINING SASLv2 SCANF STARTTLS TCPWRAPPERS
                TLS_EC TLS_VRFY_PER_CTX USERDB XDEBUG

============ SYSTEM IDENTITY (after readcf) ============
      (short domain name) $w = fbsd1
  (canonical domain name) $j = fbsd1.home.arpa
         (subdomain name) $m = home.arpa
              (node name) $k = fbsd1.home.arpa
========================================================

root... deliverable: mailer local, user root
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;install-and-configure-stunnel-1&quot;&gt;Install and Configure stunnel&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo pkg install stunnel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo cp -i /usr/local/etc/stunnel/stunnel.conf-sample /usr/local/etc/stunnel/stunnel.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo vi /usr/local/etc/stunnel/stunnel.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /usr/local/etc/stunnel/stunnel.conf
include = /usr/local/etc/stunnel/conf.d

[smarthost]
client = yes
accept = 127.0.0.1:1465 
connect = your.isp.net:465
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;where &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;your.isp.net&lt;/code&gt; is the FQDN of the SMTP server (your ISP).&lt;/p&gt;

&lt;p&gt;Set &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;stunnel_enable&lt;/code&gt; to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;YES&lt;/code&gt; in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/rc.conf&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf %s\\n &apos;stunnel_enable=&quot;YES&quot;&apos; | sudo tee -a /etc/rc.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Start &lt;em&gt;stunnel&lt;/em&gt; service.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo service stunnel start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo service stunnel status
stunnel is running as pid 51293.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cd /etc/mail

$ sudo su
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# rm -i /etc/mail/fbsd1.home.arpa.*
remove /etc/mail/fbsd1.home.arpa.cf? y
remove /etc/mail/fbsd1.home.arpa.mc? y
remove /etc/mail/fbsd1.home.arpa.submit.cf? y
remove /etc/mail/fbsd1.home.arpa.submit.mc? y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# rm -i /etc/mail/*.cf
remove /etc/mail/sendmail.cf? y
remove /etc/mail/submit.cf? y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make all&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make install&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make restart&lt;/code&gt; (or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make stop&lt;/code&gt; and 
then &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make restart&lt;/code&gt;, depending on whether &lt;em&gt;sendmail&lt;/em&gt; is currently running 
or not).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# make all
# make install
# make restart
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# service sendmail status
sendmail is running as pid 69385.
sendmail_msp_queue is running as pid 69388.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ps aux | grep -v grep | grep sendmail
root    6938   0.0  0.0    18972    7228  -  Ss   19:14       0:00.01 sendmail: accepting connections (sendmail)
smmsp   6941   0.0  0.0    18312    6304  -  Is   19:14       0:00.00 sendmail: Queue runner@00:30:00 for /var/spool/clientmqueue (sendmail)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# tail /var/log/maillog
Nov 12 19:14:21 fbsd1 sm-mta[6938]: starting daemon (8.17.1): SMTP+queueing@00:30:00
[ . . . ]
Nov 12 19:14:21 fbsd1 sm-mta[6938]: STARTTLS=server, Diffie-Hellman init, key=2048 bit (I)
Nov 12 19:14:21 fbsd1 sm-mta[6938]: STARTTLS=server, init=1
Nov 12 19:14:21 fbsd1 sm-mta[6938]: started as: /usr/sbin/sendmail -L sm-mta -bd -q30m
Nov 12 19:14:21 fbsd1 sm-msp-queue[6941]: starting daemon (8.17.1): queueing@00:30:00
Nov 12 19:14:21 fbsd1 sm-msp-queue[6941]: started as: /usr/sbin/sendmail -L sm-msp-queue -Ac -q30m
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you now receive a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;No local mailer defined&lt;/code&gt; error when you run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make all&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# make all
/usr/sbin/makemap hash authinfo.db &amp;lt; authinfo
chmod 0640 authinfo.db
/usr/sbin/sendmail -bi -OAliasFile=/etc/mail/aliases
Warning: .cf file is out of date: sendmail 8.17.1 supports 
  version 10, .cf file is version 0
No local mailer defined
QueueDirectory (Q) option must be set
*** Error code 78

Stop.
make: stopped in /etc/mail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;it’s because &lt;em&gt;sendmail.cf&lt;/em&gt; is still empty.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ls -lh sendmail.cf 
-rw-r--r--  1 root  wheel     0B Nov 12 19:10 sendmail.cf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To fix that, run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make install&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# make install
install -m 444 fbsd1.home.arpa.cf /etc/mail/sendmail.cf
install -m 444 fbsd1.home.arpa.submit.cf /etc/mail/submit.cf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ls -lh sendmail.cf
-r--r--r--  1 root  wheel    59K Nov 12 19:11 sendmail.cf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make all&lt;/code&gt; command runs fine:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# make all
/usr/sbin/sendmail -bi -OAliasFile=/etc/mail/aliases
/etc/mail/aliases: 29 aliases, longest 10 bytes, 297 bytes total
chmod 0640 /etc/mail/aliases.db
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Continue.  In this case, &lt;em&gt;sendmail&lt;/em&gt; was not running so I used
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make start&lt;/code&gt; (you might need to run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make restart&lt;/code&gt; to first stop
&lt;em&gt;sendmail&lt;/em&gt; if it’s running on your system).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# make install
# make start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# service sendmail status
sendmail is running as pid 47902.
sendmail_msp_queue is running as pid 47905.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# exit
$ cd

$ pwd
/usr/home/dusko
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo chown smmsp:smmsp /etc/mail/authinfo.db 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -lh /etc/mail/authinfo*
-rw-r-----  1 smmsp  smmsp    81B Nov 12 19:11 /etc/mail/authinfo
-rw-r-----  1 smmsp  smmsp   128K Nov 12 19:11 /etc/mail/authinfo.db
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# service sendmail status
sendmail is running as pid 49494.
sendmail_msp_queue is running as pid 49497.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;testing-smtp-with-telnet1-or-nc1-aka-netcat1&quot;&gt;Testing SMTP with telnet(1) (or nc(1) aka (netcat(1))&lt;/h3&gt;

&lt;p&gt;The Simple Mail Transfer Protocol (SMTP) governs mail flow.
SMTP conversation can be carried out by connecting to port 25 on
a mail server via &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telnet(1)&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; &lt;br /&gt;
Telnet is not secure as all communication in it happens in plain text
and all network traffic is unencrypted.  I decided it’s fine to use it
for testing my &lt;em&gt;localhost&lt;/em&gt; because it’s in my trusted environment with
trusted network and applications.&lt;/p&gt;

&lt;p&gt;Below is a sample test SMTP session with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telnet(1)&lt;/code&gt; to Port 25 from
my &lt;em&gt;localhost&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; &lt;br /&gt;
In the examples, “&lt;strong&gt;C:&lt;/strong&gt;” indicates what is said by the SMTP
client, “&lt;strong&gt;T:&lt;/strong&gt;” is what you type (that is, in the following example,
you type the following three lines: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telnet localhost 25&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ehlo localhost&lt;/code&gt;, 
and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;quit&lt;/code&gt;), and “&lt;strong&gt;S:&lt;/strong&gt;” indicates what is said by the SMTP server.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;S: &amp;lt;waits for connection on TCP port 25&amp;gt;
C: &amp;lt;opens connection&amp;gt;   # with telnet
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The second line shows the &lt;em&gt;telnet&lt;/em&gt; command format using host &lt;em&gt;localhost&lt;/em&gt;
and TCP port 25.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;S: &amp;lt;waits for connection on TCP port 25&amp;gt;

CT: telnet localhost 25
C: Trying 127.0.0.1...
C: Connected to localhost.
C: Escape character is &apos;^]&apos;.
S: 220 fbsd1.home.arpa ESMTP Sendmail 8.17.1/8.17.1; Sat, 12 Nov 2022 12:00:35 -0700 (PDT)
CT: ehlo localhost
S: 250-fbsd1.home.arpa Hello localhost [127.0.0.1], pleased to meet you
S: 250-ENHANCEDSTATUSCODES
S: 250-PIPELINING
S: 250-8BITMIME
S: 250-SIZE
S: 250-DSN
S: 250-ETRN
S: 250-AUTH DIGEST-MD5 CRAM-MD5
S: 250-STARTTLS
S: 250-DELIVERBY
S: 250 HELP
CT: quit
S: 221 2.0.0 fbsd1.home.arpa closing connection
C: Connection closed by foreign host.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From &lt;strong&gt;Postfix&lt;/strong&gt; by Richard Blum
(Published By: Sams, Publication Date: May 2001):&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;If the server is running an SMTP-based daemon, you should see a response
similar to the one shown.  The first number is a 3-digit response code.
You can use this code for troubleshooting purposes.&lt;/p&gt;

  &lt;p&gt;Next, the hostname of the SMTP server and a description of the SMTP
software package that the server is using are displayed
(in this case, &lt;em&gt;Sendmail 8.17.1/8.17.1&lt;/em&gt;).&lt;/p&gt;

  &lt;p&gt;To close the &lt;em&gt;telnet&lt;/em&gt; connection, type the word &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;quit&lt;/code&gt; and press the
Enter key.  The SMTP server sends you a closing message and ends the
TCP connection.&lt;/p&gt;

  &lt;p&gt;SMTP accepts simple ASCII text commands and returns 3-digit reply codes
with optional ASCII text messages.  SMTP is defined in the Request For
Comment (RFC) document number 821 maintained by the Internet Engineering
Task Force (IETF) published on August 21, 1982.  Several modifications
and enhancements have been made to SMTP over the years, but the basic
protocol commands still remain in use.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;h4 id=&quot;basic-smtp-client-commands&quot;&gt;Basic SMTP Client Commands&lt;/h4&gt;

  &lt;p&gt;When a TCP session has been established and the SMTP server acknowledges
the client by sending a welcome banner, it is the client’s responsibility
to control the connection and transmit data to the server.  The client
accomplishes this by sending special commands to the server.  The server
responds according to each command it receives.&lt;/p&gt;

  &lt;p&gt;RFC 821 defines the basic client commands that an SMTP server should
recognize and respond to.  Since then, there have been several extensions
to SMTP that not all servers have implemented.&lt;/p&gt;

  &lt;p&gt;The basic format of an SMTP command is&lt;/p&gt;

  &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;command [parameters]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;  &lt;/div&gt;

  &lt;p&gt;where &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;command&lt;/code&gt; is a 4-character SMTP command, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parameters&lt;/code&gt; are
optional qualifying data for the command.  For SMTP connections,
the command names are &lt;strong&gt;not&lt;/strong&gt; case sensitive.  Table at the end 
of this page
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 18 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt; lists basic SMTP commands.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; You can use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nc(1)&lt;/code&gt; (&lt;em&gt;netcat&lt;/em&gt;) utility instead of
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telnet(1)&lt;/code&gt; command (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nc localhost 25&lt;/code&gt;).  For &lt;em&gt;localhost&lt;/em&gt; testing,
I decided that &lt;em&gt;telnet&lt;/em&gt; is fine.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc3207&quot;&gt;RFC 3207&lt;/a&gt; defines how SMTP
connections can make use of encryption.  Once a connection is established,
the client issues a STARTTLS command.  If the server accepts this, the client
and the server negotiate an encryption mechanism.  If the negotiation
succeeds, the data that subsequently passes between them is encrypted.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; In this example, the AUTH line (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;250-AUTH DIGEST-MD5 LOGIN PLAIN&lt;/code&gt;)
now has &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LOGIN PLAIN&lt;/code&gt; when inquiring MSA (Mail Submission Agent) port 587
(while it didn’t have LOGIN and PLAIN when testing via port 25). &lt;br /&gt;
“&lt;strong&gt;C:&lt;/strong&gt;” indicates what is said by the SMTP client, “&lt;strong&gt;T:&lt;/strong&gt;” is what you
type (that is, in the following example, you type the following three lines:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;telnet localhost 587&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ehlo localhost&lt;/code&gt;, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;quit&lt;/code&gt;), and “&lt;strong&gt;S:&lt;/strong&gt;” indicates
what is said by the SMTP server.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;S: &amp;lt;waits for connection on TCP port 587&amp;gt;

CT: telnet localhost 587
C: Trying 127.0.0.1...
C: Connected to localhost.
C: Escape character is &apos;^]&apos;.
S: 220 fbsd1.home.arpa ESMTP Sendmail 8.17.1/8.17.1; Sat, 12 Nov 2022 12:00:46 -0700 (PDT)
CT: ehlo localhost
S: 250-fbsd1.home.arpa Hello localhost [127.0.0.1], pleased to meet you
S: 250-ENHANCEDSTATUSCODES
S: 250-PIPELINING
S: 250-8BITMIME
S: 250-SIZE
S: 250-DSN
S: 250-AUTH DIGEST-MD5 LOGIN PLAIN
S: 250-STARTTLS
S: 250-DELIVERBY
S: 250 HELP
CT: quit
S: 221 2.0.0 fbsd1.home.arpa closing connection
C: Connection closed by foreign host.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;testing-and-troubleshooting-with-sendmail-command-line&quot;&gt;Testing and Troubleshooting with sendmail Command-Line&lt;/h2&gt;

&lt;p&gt;Some of &lt;em&gt;sendmail&lt;/em&gt; parameters (from the man page for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail(8)&lt;/code&gt;):&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;-v&lt;/strong&gt;:  Verbose mode.  Alias expansions will be announced, etc. &lt;br /&gt;
&lt;strong&gt;-d&lt;/strong&gt;&lt;em&gt;category.level…&lt;/em&gt;: Set the debugging flag for category to &lt;em&gt;level&lt;/em&gt;.
The &lt;em&gt;category&lt;/em&gt; is either an integer or a name specifying the topic,
and &lt;em&gt;level&lt;/em&gt; is an integer specifying the level of debugging output desired.
Higher levels generally mean more output.  More than one flag can be
specified by separating them with commas.  A list of numeric debugging
categories found in the &lt;em&gt;TRACEFLAGS&lt;/em&gt; file in the &lt;em&gt;sendmail&lt;/em&gt; source
distribution.  The option &lt;strong&gt;-d0.1&lt;/strong&gt; prints the version of &lt;em&gt;sendmail&lt;/em&gt; and
the options used during the compile.  Most other categories are only
useful with, and documented in, &lt;em&gt;sendmail&lt;/em&gt;’s source code.&lt;/p&gt;

&lt;p&gt;Location of the &lt;em&gt;TRACEFLAGS&lt;/em&gt; file in FreeBSD 13:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local/share/doc/sendmail/TRACEFLAGS&lt;/code&gt; and 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/src/contrib/sendmail/src/TRACEFLAGS&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Send a test email message with &lt;em&gt;sendmail&lt;/em&gt; command-line:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ date | sendmail -v -d38.20 dusko@some.external.domain
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Some of &lt;em&gt;sendmail&lt;/em&gt; parameters (from the man page for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail(8)&lt;/code&gt;):&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;-Ac&lt;/strong&gt;:  Use &lt;strong&gt;submit.cf&lt;/strong&gt; even if the operation mode does not indicate
          an initial mail submission; via the &lt;strong&gt;MSP&lt;/strong&gt; (mail submission program)
          [which is a command-line &lt;em&gt;sendmail&lt;/em&gt; that functions as a mail submission agent (&lt;strong&gt;MSA&lt;/strong&gt;)].&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;-d38.20&lt;/strong&gt;:  Debug command-line switch for tracing many different map
              lookups and also for tracing general lookups in various
              kinds of databases.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;-odi&lt;/strong&gt;:  Deliver in foreground.&lt;/p&gt;

&lt;p&gt;Explanation for &lt;strong&gt;-odi&lt;/strong&gt;:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;-o&lt;/strong&gt;x &lt;em&gt;value&lt;/em&gt; (from the man page for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail(8)&lt;/code&gt;):  Set option &lt;em&gt;x&lt;/em&gt; to
the specified &lt;em&gt;value&lt;/em&gt;.  This form uses single character names only.
The short names are not described in this manual page; see the Sendmail
Installation and Operation Guide (on FreeBSD 13:
&lt;em&gt;/usr/local/share/doc/sendmail/op.txt&lt;/em&gt;, or
&lt;em&gt;/usr/local/share/doc/sendmail/op.ps&lt;/em&gt;) for details.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Options&lt;/strong&gt; &lt;br /&gt;
There are also many processing options that can be set.  Normally these
are only used by a system administrator.  Options may be set either on the
command line using the &lt;strong&gt;-o&lt;/strong&gt; flag (for short names), the &lt;strong&gt;-O&lt;/strong&gt; flag (for 
long names), or in the &lt;strong&gt;configuration file&lt;/strong&gt;.  Some of the options are:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;DeliveryMode=&lt;/strong&gt;&lt;em&gt;x&lt;/em&gt;  &lt;br /&gt;
Set the delivery mode to &lt;em&gt;x&lt;/em&gt;.  Delivery modes are
“&lt;strong&gt;i&lt;/strong&gt;” for interactive (synchronous) delivery (a.k.a. delivery in
foreground), “&lt;strong&gt;b&lt;/strong&gt;” for background (asynchronous) delivery, “&lt;strong&gt;q&lt;/strong&gt;” for
queue only; i.e., actual delivery is done the next time the queue is run,
and “&lt;strong&gt;d&lt;/strong&gt;” for deferred - the same as “&lt;strong&gt;q&lt;/strong&gt;”, except that database
lookups for maps which have set the &lt;strong&gt;-D&lt;/strong&gt; option (default for the
host map) are avoided.&lt;/p&gt;

&lt;p&gt;As an example, the &lt;strong&gt;-odi&lt;/strong&gt; in &lt;em&gt;sendmail&lt;/em&gt; source:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sed -n 284p /usr/src/contrib/sendmail/rmail/rmail.c
        args[i++] = &quot;-odi&quot;;             /* Deliver in foreground. */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Similarly, the &lt;strong&gt;-d38.20&lt;/strong&gt; debug command-line switch in &lt;em&gt;sendmail&lt;/em&gt; source:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sed -n 5590p /usr/src/contrib/sendmail/src/map.c
                if (tTd(38,20))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Send a test email message with &lt;em&gt;sendmail&lt;/em&gt; command-line:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ date | sendmail -Ac -v -d38.20 -odi dusko@some.external.domain
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Some of sendmail parameters (from the man page for sendmail(8)):&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;-Am&lt;/strong&gt;:  Use &lt;strong&gt;sendmail.cf&lt;/strong&gt; even if the operation mode indicates an
          initial mail submission.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;-t:&lt;/strong&gt;  Read message for recipients. &lt;strong&gt;To:&lt;/strong&gt;, &lt;strong&gt;Cc:&lt;/strong&gt;, and &lt;strong&gt;Bcc:&lt;/strong&gt; lines
         will be scanned for recipient addresses.  The &lt;strong&gt;Bcc:&lt;/strong&gt; line is 
         deleted before transmission.&lt;/p&gt;

&lt;p&gt;Send a test email message with &lt;em&gt;sendmail&lt;/em&gt; command-line.
In the following example, type in the first seven lines (starting with
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail -Ac -v -t&lt;/code&gt; and ending with a single dot).&lt;/p&gt;

&lt;p&gt;(The lines that begin with numbers and the lines that begin with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/code&gt;
 characters constitute a record of the SMTP conversation.  The other lines
 are &lt;em&gt;sendmail&lt;/em&gt; on your local machine telling you what it is trying to do
 and what it has successfully done.)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sendmail -Ac -v -t
To: Dusko P &amp;lt;dusko@some.external.domain&amp;gt;
From: DP &amp;lt;dusko@fbsd1.home.arpa&amp;gt;
Subject: Test with -Ac

Testing.
.
Dusko P &amp;lt;dusko@some.external.domain&amp;gt;... Connecting to [127.0.0.1] port 1465 via smartrelay...
220 mailx.some.external.domain ESMTP mailer ready at Sat, 12 Nov 2022 16:51:07 -0700
&amp;gt;&amp;gt;&amp;gt; EHLO fbsd1.home.arpa
250-test.domain Hello fqdn.yourisp.domain [123.45.6.7], pleased to meet you
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-SIZE 52428800
250-AUTH LOGIN PLAIN
250-DELIVERBY
250 HELP
&amp;gt;&amp;gt;&amp;gt; AUTH LOGIN
334 VXNlcm5hbWU6
&amp;gt;&amp;gt;&amp;gt; ABCab12=
334 UGFzc3dvcmQ6
&amp;gt;&amp;gt;&amp;gt; ABCdEF12gHIJkLMnoPQRSt==
235 2.0.0 OK Authenticated
&amp;gt;&amp;gt;&amp;gt; MAIL From:&amp;lt;dusko@fbsd1.home.arpa&amp;gt; SIZE=110 AUTH=dusko@fbsd1.home.arpa
250 2.1.0 &amp;lt;dusko@fbsd1.home.arpa&amp;gt;... Sender ok
&amp;gt;&amp;gt;&amp;gt; RCPT To:&amp;lt;dusko@some.external.domain&amp;gt;
250 2.1.5 &amp;lt;dusko@some.external.domain&amp;gt;... Recipient ok
&amp;gt;&amp;gt;&amp;gt; DATA
354 Enter mail, end with &quot;.&quot; on a line by itself
&amp;gt;&amp;gt;&amp;gt; .
250 2.0.0 2A2Np7PB018356 Message accepted for delivery
Dusko P &amp;lt;dusko@some.external.domain&amp;gt;... Sent (2A2Np7PB018356 Message accepted for delivery)
Closing connection to [127.0.0.1]
&amp;gt;&amp;gt;&amp;gt; QUIT
221 2.0.0 mailx.some.external.domain closing connection
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;VXNlcm5hbWU6&lt;/code&gt; is ‘Username:’ encoded in base64, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UGFzc3dvcmQ6&lt;/code&gt; is
‘Password:’ encoded in base64.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ perl -MMIME::Base64 -le &apos;print decode_base64(&quot;VXNlcm5hbWU6&quot;);&apos;
Username:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ perl -MMIME::Base64 -le &apos;print decode_base64(&quot;UGFzc3dvcmQ6&quot;);&apos;
Password:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;testing-and-troubleshooting-with-the-mail1-utility&quot;&gt;Testing and Troubleshooting with the mail(1) Utility&lt;/h2&gt;

&lt;p&gt;Send a test email message with the &lt;em&gt;mail&lt;/em&gt; (aka &lt;em&gt;mail&lt;/em&gt;, &lt;em&gt;Mail&lt;/em&gt;, &lt;em&gt;mailx&lt;/em&gt;)
utility:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf %s\\n &quot;Testing.&quot; | mail -v -s &quot;Test&quot; dusko@some.external.domain
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;testing-smtp-with-openssl1-command-line-tool&quot;&gt;Testing SMTP with openssl(1) Command Line Tool&lt;/h2&gt;

&lt;p&gt;From &lt;a href=&quot;https://www.exim.org/exim-html-current/doc/html/spec_html/ch-encrypted_smtp_connections_using_tlsssl.html&quot;&gt;Chapter 43 - Encrypted SMTP connections using TLS/SSL - Exim Internet Mailer&lt;/a&gt; (Retrieved on Nov 12, 2022):&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;As of &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc8314&quot;&gt;RFC 8314&lt;/a&gt;, the common
practice of using the historically allocated port 465 for “email submission
but with TLS &lt;strong&gt;immediately&lt;/strong&gt; upon connect &lt;strong&gt;instead&lt;/strong&gt; of using STARTTLS” is
officially recommended by the IETF, and recommended by them in preference
to STARTTLS.&lt;/p&gt;

  &lt;p&gt;The name originally assigned to the port was “ssmtp” or “smtps”, but as
clarity emerged over the dual roles of SMTP, for MX delivery and Email
Submission, nomenclature has shifted. The modern name is now “submissions”.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;To test/connect TLS/SSL with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;openssl(1)&lt;/code&gt; to a mail server on port 465
(Implicit TLS submission), use its &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;s_client(1)&lt;/code&gt; command (SSL/TLS client
program).  (Change &lt;em&gt;your.outgoing.mailserver&lt;/em&gt; to the host name of your
mailserver.)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ openssl s_client -connect your.outgoing.mailserver:465
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You’ll get a lot of output concerning the TLS (SSL) session and
certificates used, and the last line of that output will show
a confirmation (a 220 or 250 status code with a message).  For example:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;220 your.outgoing.mailserver ESMTP mailer ready at Sat, 12 Nov 2022 19:31:55 -0800
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Initiate the conversation&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Now you need to identify yourself and initiate the SMTP conversation with
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EHLO&lt;/code&gt; command (Extended EHLO).  This command takes the fully-qualified
domain name of the SMTP client (or an IP address, if the SMTP client system
does not have a meaningful domain name; e.g., when its address is
dynamically allocated and no reverse mapping record is available).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;EHLO fbsd1.home.arpa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The server returns a list of commands (keywords) available in Extended mode; that is,
in ESMTP (Extended SMTP):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;250-your.outgoing.mailserver Hello fbsd1.home.arpa [123.45.67.89], pleased to meet you
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-SIZE 52428800
250-AUTH LOGIN PLAIN
250-DELIVERBY
250 HELP
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Authenticate yourself&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The output to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EHLO&lt;/code&gt; ESMTP command above displayed a space separated
list of the names of supported SASL mechanisms.  In this case, the list of
advertised authentication mechanisms was &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PLAIN&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LOGIN&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Authenticate yourself using PLAIN&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The PLAIN mechanism expects a base64 encoded string containing both
username and password, each prefixed with a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NULL&lt;/code&gt; byte.  You can generate
this string using Perl and its 
&lt;a href=&quot;https://perldoc.perl.org/MIME::Base64&quot;&gt;MIME::Base64&lt;/a&gt; module.
(Change your &lt;em&gt;username&lt;/em&gt; and &lt;em&gt;password&lt;/em&gt; with your username and password.)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ perl -MMIME::Base64 -e &apos;print encode_base64(&quot;\0username\0password&quot;);&apos;
AHVzZXJuYW1lAHBhc3N3b3Jk
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Submit this base64 encoded string to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH&lt;/code&gt; command in your
&lt;em&gt;openssl&lt;/em&gt; session:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;AUTH PLAIN AHVzZXJuYW1lAHBhc3N3b3Jk
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If the authorization is successful, the mail server will reply
with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;235 2.0.0 OK&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;235 2.0.0 OK Authenticated
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Authenticate yourself using LOGIN&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LOGIN&lt;/code&gt; mechanism also expects base64 encoded username and password
but separately.  You can generate this string using Perl and its
&lt;a href=&quot;https://perldoc.perl.org/MIME::Base64&quot;&gt;MIME::Base64&lt;/a&gt; module.  (Change your
&lt;em&gt;yourusername&lt;/em&gt; and &lt;em&gt;yourpasswordhere&lt;/em&gt; with your username and password.)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ perl -MMIME::Base64 -e &apos;print encode_base64(&quot;yourusername&quot;);&apos;
eW91cnVzZXJuYW1l
 
$ perl -MMIME::Base64 -e &apos;print encode_base64(&quot;yourpasswordhere&quot;);&apos;
eW91cnBhc3N3b3JkaGVyZQ==
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Authenticate yourself with the SMTP server:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;AUTH LOGIN
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The server replies with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;334&lt;/code&gt; (authentication challenge) code, followed by
a challenge string.  (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;VXNlcm5hbWU6&lt;/code&gt; is ‘Username:’ encoded in base64.)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;334 VXNlcm5hbWU6
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Enter your username:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;eW91cnVzZXJuYW1l
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Next, the mail server asks for the password.  (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UGFzc3dvcmQ6&lt;/code&gt; is ‘Password:’
encoded in base64.)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;334 UGFzc3dvcmQ6
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Enter your password:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;eW91cnBhc3N3b3JkaGVyZQ==
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If the authorization is successful, the mail server will reply with
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;235 2.0.0 OK Authenticated&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;235 2.0.0 OK Authenticated
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Send an email&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;There are three steps to SMTP mail transactions &lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 20 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;the sender (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL FROM:&lt;/code&gt;)&lt;/li&gt;
  &lt;li&gt;the recipient (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCPT TO:&lt;/code&gt;)&lt;/li&gt;
  &lt;li&gt;the message body (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DATA&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The first step in the procedure is the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL&lt;/code&gt; command.
You use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL FROM:&lt;/code&gt; SMTP command to set the message sender
(the &lt;strong&gt;envelope sender&lt;/strong&gt; address).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  According to
&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc821&quot;&gt;RFC 821 - Simple Mail Transfer Protocol (SMTP)&lt;/a&gt;
  and
&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc2821&quot;&gt;RFC 2821 - Simple Mail Transfer Protocol (SMTP)&lt;/a&gt;, you need to surround the email address with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;&amp;gt;&lt;/code&gt;; that is, 
with &lt;strong&gt;angle brackets&lt;/strong&gt;.  Also, note that there is &lt;strong&gt;no space (blank)
character&lt;/strong&gt; around the colon character (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;:&lt;/code&gt;). &lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 20 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;If the mail server accepts the email address, it will reply with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;250 OK&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;MAIL FROM:&amp;lt;dusko@fbsd1.home.arpa&amp;gt;
250 2.1.0 &amp;lt;dusko@fbsd1.home.arpa&amp;gt;... Sender ok
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now you send the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCPT TO:&lt;/code&gt; (or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rcpt to:&lt;/code&gt;, see the NOTE below) SMTP command
so the server knows who the email message is for.  In this case, I’m sending
the email to &lt;em&gt;dusko@yourdomain.example.net&lt;/em&gt;.
(Change &lt;em&gt;dusko@yourdomain.example.net&lt;/em&gt; with your test email address.)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;:  When you connect with &lt;em&gt;openssl&lt;/em&gt; (as opposed to, for example, 
with &lt;em&gt;nc&lt;/em&gt; or &lt;em&gt;telnet&lt;/em&gt;), make sure to type the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rcpt to&lt;/code&gt; command in
&lt;strong&gt;lowercase&lt;/strong&gt;.  Pressing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;R&lt;/code&gt; in the client session instructs &lt;em&gt;openssl&lt;/em&gt; to
renegotiate the TLS connection. &lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 21 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rcpt to:&amp;lt;dusko@yourdomain.example.net&amp;gt;
250 2.1.5 &amp;lt;dusko@yourdomain.example.net&amp;gt;... Recipient ok
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you were communicating with a destination mail server here, and the
account you specified in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCPT TO:&lt;/code&gt; command was invalid, the mail
server would return an error code.  At this point, the mail server has
accepted the message and will attempt to deliver it.&lt;/p&gt;

&lt;p&gt;After the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCPT&lt;/code&gt; commands, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DATA&lt;/code&gt; command initiates the
actual message transfer.  To enter it, type &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DATA&lt;/code&gt; and press Enter.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DATA
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The mail server responds with instructions to end your email message body
with an empty line containing a single dot (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.&lt;/code&gt;) character.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;354 Enter mail, end with &quot;.&quot; on a line by itself
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can add any additional headers to your email message in the body.&lt;/p&gt;

&lt;p&gt;As per &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc2822&quot;&gt;RFC 2822 - Internet Message Format&lt;/a&gt;, the only required header fields are the origination date field (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Date:&lt;/code&gt;)
and the originator address field(s) (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;From:&lt;/code&gt;).  To end the message,
type a period on a line by itself.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;From: Dusko P &amp;lt;dusko@fbsd1.home.arpa&amp;gt;
To: DP &amp;lt;dusko@yourdomain.example.net&amp;gt;
Date: Sat, 12 Nov 2022 20:12:43 -0800
Subject: Test message 1

Testing.
.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The server will respond with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;250 2.0.0&lt;/code&gt; followed by the queue ID.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;250 2.0.0 2BH22lp2011970 Message accepted for delivery
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Type &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;QUIT&lt;/code&gt; to close the session.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QUIT
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The server responds with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DONE&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DONE
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;testing-with-class-w-w---the-local-host&quot;&gt;Testing with Class w ($=w) - The Local Host&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf &apos;$=w&apos; | sendmail -bt
ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)
Enter &amp;lt;ruleset&amp;gt; &amp;lt;address&amp;gt;
&amp;gt; [IPv6:fe80:0:0:0:0:0:0:1]
[IPv6:0:0:0:0:0:0:0:1]
localhost
fbsd1.home.arpa
[123.45.6.7]
localhost.my.domain
[localhost.my.domain]
&amp;gt; $ 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From &lt;strong&gt;sendmail&lt;/strong&gt;, 4th Edition (a.k.a. &lt;strong&gt;“Bat Book”&lt;/strong&gt;) &lt;br /&gt;
By Bryan Costales, Claus Assmann, George Jansen, Gregory Neil Shapiro&lt;br /&gt;
(Published by: O’Reilly Media, Inc., Publication Date: October 2007):&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Delivering to Local Recipient&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Typically, some early rules in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parse&lt;/code&gt; &lt;em&gt;rule set 0&lt;/em&gt; are intended to
detect addresses that should be delivered locally.  A rule that
accomplishes that end might look like this:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;R $+ &amp;lt;@ $w&amp;gt;          $#local $:$1                 local address
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;Here, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$w&lt;/code&gt; &lt;em&gt;sendmail&lt;/em&gt; macro is the name of the &lt;em&gt;local host&lt;/em&gt;.
Note that the RHS (righthand side) strips the focused host part from
the username.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;At some sites, the local host can be known by any of several names.
A rule to handle such hosts would begin with a class declaration that
adds those names to the class &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;w&lt;/code&gt; (such as in the first line here):&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Cw font-server fax printer3
R $+ &amp;lt;@ $=w&amp;gt;        $#local $:$1                 local address
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;The class &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;w&lt;/code&gt; is special because it is the one to which &lt;em&gt;sendmail&lt;/em&gt;
automatically appends the alternative name of the local host.
This class declaration line adds names that &lt;em&gt;sendmail&lt;/em&gt; might not
automatically detect.  Usually, such a declaration would be near the top
of the configuration file rather than in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parse&lt;/code&gt; rule &lt;em&gt;set 0&lt;/em&gt;, but
technically it can appear anywhere in the file.  This rule looks to see
whether an address contains any of the names in class &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;w&lt;/code&gt;.  If it does,
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$=w&lt;/code&gt; in the lefthand side (LHS) matches, and the RHS selects the
local delivery agent.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;On central mail-server machines, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parse&lt;/code&gt; &lt;em&gt;rule set 0&lt;/em&gt; might also
have to match from a list of hosts for which the central server is an
MX recipient machine (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FEATURE(use_cw_file)&lt;/code&gt;).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;check-whether-your-sendmail-supports-sasl-with--d010-debugging-switch&quot;&gt;Check whether Your sendmail Supports SASL (with -d0.10 Debugging Switch)&lt;/h3&gt;

&lt;p&gt;If you are running a precompiled &lt;em&gt;sendmail&lt;/em&gt; binary, you can use
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-d0.10&lt;/code&gt; debugging command-line switch to determine whether
&lt;em&gt;SASL&lt;/em&gt; support is defined (if it appears in the list, it is defined).&lt;/p&gt;

&lt;p&gt;Also, it shows configuration files; that is, default conf files for
&lt;strong&gt;MTA&lt;/strong&gt; (Mail Transport Agent), &lt;strong&gt;MSP&lt;/strong&gt; (Mail Submission Program)
[which is a command-line &lt;em&gt;sendmail&lt;/em&gt; that functions as a mail submission
agent (&lt;strong&gt;MSA&lt;/strong&gt;)], and the &lt;em&gt;selected configuration file&lt;/em&gt; (if, for example,
you’ve started &lt;em&gt;sendmail&lt;/em&gt; with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-C&amp;lt;file_name&amp;gt;&lt;/code&gt; parameter to use an
alternate configuration file).&lt;/p&gt;

&lt;p&gt;By default: &lt;br /&gt;
configuration file for MSP is:  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/mail/submit.cf&lt;/code&gt;   &lt;br /&gt;
configuration file for MTA is:  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/mail/sendmail.cf&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-d0.10&lt;/code&gt; debug switch causes &lt;em&gt;sendmail&lt;/em&gt; to print all the operating
system-specific &lt;strong&gt;definitions&lt;/strong&gt; that were used to &lt;strong&gt;compile&lt;/strong&gt; your specific
version of &lt;em&gt;sendmail&lt;/em&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sendmail -bt -d0.10 &amp;lt; /dev/null 
Version 8.17.1
 Compiled with: DANE DNSMAP IPV6_FULL LOG MAP_REGEX MATCHGECOS MILTER
                MIME7TO8 MIME8TO7 NAMED_BIND NETINET NETINET6 NETUNIX NEWDB NIS
                PICKY_HELO_CHECK PIPELINING SASLv2 SCANF STARTTLS TCPWRAPPERS
                TLS_EC TLS_VRFY_PER_CTX USERDB XDEBUG
    OS Defines: BSD4_4_SOCKADDR HASFCHOWN HASFCHMOD HASFLOCK
                HASGETDTABLESIZE HASGETUSERSHELL HASINITGROUPS HASLSTAT HASNICE
                HASRANDOM HASRRESVPORT HASSETLOGIN HASSETREUID HASSETRLIMIT
                HASSETSID HASSETUSERCONTEXT HASSETVBUF HAS_ST_GEN HASSRANDOMDEV
                HASURANDOMDEV HASSTRERROR HASUNAME HASUNSETENV HASWAITPID
                HAVE_NANOSLEEP IDENTPROTO IP_SRCROUTE LOCK_ON_OPEN
                SAFENFSPATHCONF SFS_MOUNT USE_DOUBLE_FORK USESETEUID USESYSCTL
Kernel symbols: don&apos;t use _PATH_UNIX
     Conf file: /etc/mail/submit.cf (default for MSP)
     Conf file: /etc/mail/sendmail.cf (default for MTA)
      Pid file: /var/run/sendmail.pid (default)
Canonical name: fbsd1.home.arpa
 UUCP nodename: fbsd1.home.arpa
        a.k.a.: localhost.my.domain
        a.k.a.: fbsd1.home.arpa
        a.k.a.: [127.0.0.1]
        a.k.a.: [IPv6:0:0:0:0:0:0:0:1]
        a.k.a.: [IPv6:fe80:0:0:0:0:0:0:1]
        a.k.a.: [192.168.1.3]
        a.k.a.: [192.168.8.1]
        a.k.a.: [10.1.2.3]
     Conf file: /etc/mail/sendmail.cf (selected)
      Pid file: /var/run/sendmail.pid (selected)

============ SYSTEM IDENTITY (after readcf) ============
      (short domain name) $w = fbsd1
  (canonical domain name) $j = fbsd1.home.arpa
         (subdomain name) $m = home.arpa
              (node name) $k = fbsd1.home.arpa
========================================================

ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)
Enter &amp;lt;ruleset&amp;gt; &amp;lt;address&amp;gt;
&amp;gt; $ 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;from-sendmail-4th-edition-aka-bat-book&quot;&gt;From &lt;strong&gt;sendmail&lt;/strong&gt;, 4th Edition (a.k.a. &lt;strong&gt;“Bat Book”&lt;/strong&gt;)&lt;/h2&gt;
&lt;p&gt;By Bryan Costales, Claus Assmann, George Jansen, Gregory Neil Shapiro&lt;br /&gt;
(Published by: O’Reilly Media, Inc., Publication Date: October 2007):&lt;/p&gt;

&lt;h2 id=&quot;authinfo-and-the-access-database&quot;&gt;Authinfo and the access Database&lt;/h2&gt;

&lt;p&gt;Under V8.12, default client authentication information was moved out of
the &lt;em&gt;default-auth-info&lt;/em&gt; text file and into the &lt;em&gt;access&lt;/em&gt; database.  If you 
prefer a more secure database than the &lt;em&gt;access&lt;/em&gt; database, you can declare
an alternative with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;authinfo&lt;/code&gt; feature (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FEATURE(authinfo)&lt;/code&gt;). For example:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;FEATURE(`authinfo&apos;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here, instead of looking up client authentication information in the 
&lt;em&gt;access&lt;/em&gt; database, &lt;em&gt;sendmail&lt;/em&gt; will look in the &lt;em&gt;/etc/mail/authinfo&lt;/em&gt;
database.&lt;/p&gt;

&lt;p&gt;Whether you store default client authentication information in the
&lt;em&gt;access&lt;/em&gt; database or in the &lt;em&gt;authinfo&lt;/em&gt; database, the syntax of entries
is the same.&lt;/p&gt;

&lt;p&gt;The database entries are created from a text file that has keys down the
left column and matching values down the right.  The two columns are
separated by one or more tab or space characters.  One line in such
a source text file might look like this:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;AuthInfo:address      &quot;U:user&quot;  &quot;P=password&quot; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The left column of the database is composed of two parts. The first part
is mandatory, the literal expression &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AuthInfo:&lt;/code&gt;.  The second, configurable
part is an IPv4 address, an IPv6 address, or a canonical host or domain
name.  For example:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;AuthInfo:123.45.67.89
Authinfo:IPv6:2002:c0a8:51d2::23f4
AuthInfo:host.domain.com
AuthInfo:domain.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When &lt;em&gt;sendmail&lt;/em&gt; connects to another host, and that other host offers to
authenticate, that connected-to host’s IP address, hostname, and domain
are looked up in the database.&lt;/p&gt;

&lt;p&gt;If the IP address, host, or domain is not found, the connection is allowed,
but &lt;em&gt;sendmail&lt;/em&gt; will not attempt to authenticate it.  Otherwise, the
information in the matching right column is returned for &lt;em&gt;sendmail&lt;/em&gt; to use.&lt;/p&gt;

&lt;p&gt;The right column is composed of letter and value pairs, each pair quoted
and separated from the others by space characters:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;AuthInfo:address      &quot;U:user&quot;  &quot;P=password&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Letters are separated from their value with a colon or an equal-sign.
A colon means that the value is literal text.  An equal-sign means that
the value is Base64-encoded.&lt;/p&gt;

&lt;p&gt;These letters and their meanings are shown in the table below.&lt;/p&gt;

&lt;p&gt;Right-column key letters for the default &lt;em&gt;authinfo&lt;/em&gt; file:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+-------------+----------------------------------------------+ 
| Letter      | Description                                  |
+-------------+----------------------------------------------+ 
| U           | The user (authorization) identifier          |
+-------------+----------------------------------------------+ 
| I           | The authentication identifier                |
+-------------+----------------------------------------------+
| P           | The password                                 |
+-------------+----------------------------------------------+ 
| R           | The realm                                    |
+-------------+----------------------------------------------+ 
| M           | The list of mechanisms (separated by spaces) |
+-------------+----------------------------------------------+ 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Either the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U&lt;/code&gt; or the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;I&lt;/code&gt;, or both, must exist or authentication will fail.
The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;P&lt;/code&gt; must always be present.  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;R&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;M&lt;/code&gt; are optional.  All the
letters are case-insensitive-that is, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;u&lt;/code&gt; are the same.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U&lt;/code&gt; lists the name of the user that &lt;em&gt;sendmail&lt;/em&gt; will use to check
allowable permissions.  Generally, this could be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;U:authuser&lt;/code&gt; (but it
should never be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;root&lt;/code&gt;).&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;I&lt;/code&gt; lists the name of the user allowed to set up the connection.
Generally, this could be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;I:authuser&lt;/code&gt; (but it should never be &lt;em&gt;root&lt;/em&gt;).&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;P&lt;/code&gt; value is the password.  If the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;P&lt;/code&gt; is followed by a colon (as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;P:&lt;/code&gt;),
the password is in plain text.  If the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;P&lt;/code&gt; is followed by an equal-sign
(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;P=&lt;/code&gt;), the password is Base64-encoded.  Generally, this should never be
&lt;em&gt;root&lt;/em&gt;’s plain-text password.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;R&lt;/code&gt; lists the administrative realm for authentication.  In general,
this should be your DNS domain.  If no realm is specified (this item is
missing), &lt;em&gt;sendmail&lt;/em&gt; will substitute the value of
the (&lt;a href=&quot;#canonical-name-macro&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$j&lt;/code&gt; macro&lt;/a&gt;) unless the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AuthRealm&lt;/code&gt; option
is used to define a realm to use in place of the value of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$j&lt;/code&gt; macro.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;M&lt;/code&gt; lists the preferred mechanism for connection authentication. 
Multiple mechanisms can be listed, one separated from another with a space:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&quot;M:DIGEST-MD5 CRAM-MD5&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;M&lt;/code&gt; item is missing, &lt;em&gt;sendmail&lt;/em&gt; uses the mechanisms listed in the
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AuthMechanisms&lt;/code&gt; option (&lt;a href=&quot;#authmechanisms-option&quot;&gt;AuthMechanisms&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Missing required letters, unsupported letters, and letters that are missing
values have warnings logged at a LogLevel of 9, or above, like this:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;AUTH=client, relay=server_name [server_addr], authinfo failed
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;server_name&lt;/code&gt; is the value of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${server_name}&lt;/code&gt; &lt;em&gt;sendmail&lt;/em&gt;
macro.  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;server_addr&lt;/code&gt; is the value of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${server_addr}&lt;/code&gt; &lt;em&gt;sendmail&lt;/em&gt;
macro.  Both identify the connected-to host for which the connection failed.&lt;/p&gt;

&lt;p&gt;All of this is implemented when you use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;authinfo&lt;/code&gt; rule set.
As of V8.14, there is no way to add your own rules to this rule set.&lt;/p&gt;

&lt;h3 id=&quot;defaultauthinfo&quot;&gt;DefaultAuthInfo&lt;/h3&gt;

&lt;p&gt;When &lt;em&gt;sendmail&lt;/em&gt; is compiled with SASL defined, authenticated connections 
can be supported.  When negotiating an authenticated connection, certain 
information is required, specifically and in this order:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The &lt;em&gt;user id&lt;/em&gt; is the identifier &lt;em&gt;sendmail&lt;/em&gt; uses to check allowable
permissions.  In general, this should never be &lt;em&gt;root&lt;/em&gt;.&lt;/li&gt;
  &lt;li&gt;The &lt;em&gt;authorization id&lt;/em&gt; is the identifier of the user allowed to set up
the connection.  In general, this should never be &lt;em&gt;root&lt;/em&gt;.&lt;/li&gt;
  &lt;li&gt;The &lt;em&gt;password&lt;/em&gt; is the clear text password used to authorize the mail
connection.  This should be a password dedicated to this use, &lt;em&gt;not&lt;/em&gt; the
plain text copy of the user’s password.&lt;/li&gt;
  &lt;li&gt;The &lt;em&gt;realm&lt;/em&gt; is the administrative zone for authentication.  In general,
this should be your DNS domain.  If no realm is specified (this item is
blank), &lt;em&gt;sendmail&lt;/em&gt; will substitute the value of
the &lt;a href=&quot;#canonical-name-macro&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$j&lt;/code&gt; macro&lt;/a&gt; (a.k.a. canonical name macro).&lt;/li&gt;
  &lt;li&gt;The &lt;em&gt;mechanism&lt;/em&gt; is the preferred mechanism for connection authentication.
This should match one of the mechanisms listed in
the &lt;a href=&quot;#authmechanisms-option&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AuthMechanisms&lt;/code&gt; option&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;canonical-name-macro&quot;&gt;Canonical Name Macro&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;$j&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Your official canonical name&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$j&lt;/code&gt; macro is used to hold the fully qualified domain name of the 
local machine.  V8 &lt;em&gt;sendmail&lt;/em&gt; automatically defines &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$j&lt;/code&gt; to be the fully
qualified canonical name of the local host.  However, you can still
redefine &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$j&lt;/code&gt; if necessary; for example, if &lt;em&gt;sendmail&lt;/em&gt; cannot figure out
your fully qualified canonical name, or if your machine has multiple
network interfaces and &lt;em&gt;sendmail&lt;/em&gt; chooses the name associated with the
wrong interface.&lt;/p&gt;

&lt;p&gt;A fully qualified domain name is one that begins with the local hostname,
which is followed by a dot and all the components of the local domain.&lt;/p&gt;

&lt;p&gt;The hostname part is the name of the local machine.  That name is defined
at boot time in ways that vary with the version of Unix you are using.&lt;/p&gt;

&lt;p&gt;At many sites, the local hostname is already fully qualified.
To tell whether your site uses just the local hostname, run &lt;em&gt;sendmail&lt;/em&gt;
with a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-d0.4&lt;/code&gt; switch:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sendmail -d0 -bt &amp;lt; /dev/null 
[ . . . ]
  (canonical domain name) $j = fbsd1.home.arpa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;One way to tell whether &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$j&lt;/code&gt; contains the correct value is to send mail
to yourself.  Examine the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Received:&lt;/code&gt; headers.  The name of the local host
must be fully qualified where it appears in them:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Received: by some.domain   ...other text here
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$j&lt;/code&gt; is also used in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Message-ID:&lt;/code&gt; header definition.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$j&lt;/code&gt; macro must &lt;em&gt;never&lt;/em&gt; be defined in the command line.&lt;/p&gt;

&lt;p&gt;In the rare event that you need to give &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$j&lt;/code&gt; a value, you can do so in
your &lt;em&gt;mc&lt;/em&gt; configuration file like this:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dnl Here at your.domain we hardwire the domain.
define(`confDOMAIN_NAME&apos;, `your.domain&apos;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;authmechanisms-option&quot;&gt;AuthMechanisms Option&lt;/h2&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AuthMechanisms&lt;/code&gt; option is used to declare the types of authentication
you want to allow to be passed in the AUTH ESMTP extension (see 
&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc2554&quot;&gt;RFC2554&lt;/a&gt;
and 
&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc4954&quot;&gt;RFC4954&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;You use this option by listing the mechanisms you wish to set as its value.&lt;/p&gt;

&lt;p&gt;When there is more than one preferred mechanism, each is separated from
the others by space characters. For example:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;define(`confAUTH_MECHANISMS&apos;, `CRAM-MD5 KERBEROS_V4&apos;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Before the actual AUTH is generated, &lt;em&gt;sendmail&lt;/em&gt; produces an intersection
of the mechanisms you want and those supported by the SASL software you
have installed.  Only those that are specified by this option and those
supported by your software are listed by the issued AUTH command:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;250-AUTH CRAM-MD5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here, you wanted both CRAM-MD5 and KERBEROS_V4 offered as mechanisms.
But if the SASL software installed on your machine, for example, supports
only CRAM-MD5 and DIGEST-MD5, the common or intersecting mechanism will be
CRAM-MD5, so that is all that will be advertised.&lt;/p&gt;

&lt;p&gt;When more than one mechanism is listed, the other side will negotiate them
one at a time, until one succeeds.&lt;/p&gt;

&lt;p&gt;The following mechanisms are the maximum set of those recognized by the
cyrus-sasl-1.5.16 distribution.  Not all will be compiled in, so not all
will be supported.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;ANONYMOUS&lt;/em&gt; &lt;br /&gt;
The ANONYMOUS mechanism allows anyone to use the service. Authentication
parallels that of the anonymous &lt;em&gt;ftp&lt;/em&gt; login.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;CRAM-MD5&lt;/em&gt; &lt;br /&gt;
The CRAM-MD5 mechanism is the style of authentication used by POP servers
known as APOP.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;DIGEST-MD5&lt;/em&gt; &lt;br /&gt;
The DIGEST-MD5 mechanism is a stronger version of the CRAM-MD5 mechanism
that also supports encryption.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;GSSAPI&lt;/em&gt; &lt;br /&gt;
The GSSAPI mechanism implements an API for general security services that
also support encryption.  One example is support for Kerberos V5, which is
achieved using GSSAPI.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;KERBEROS_V4&lt;/em&gt;&lt;br /&gt;
The KERBEROS_V4 mechanism implements authentication based on MIT’s Kerberos 4.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;PLAIN&lt;/em&gt;&lt;br /&gt;
The PLAIN mechanism can perform plain text password authentication (in a
single step) with either PAM, KERBEROS_V4, or &lt;em&gt;/etc/passwd&lt;/em&gt;
(or &lt;em&gt;/etc/shadow&lt;/em&gt;) authentication.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;LOGIN&lt;/em&gt;&lt;br /&gt;
The LOGIN mechanism is a two-step version of PLAIN.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AuthMechanisms&lt;/code&gt; option is available only if &lt;em&gt;sendmail&lt;/em&gt; is compiled
with SASL.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; &lt;br /&gt;
The complete list of SASL mechanisms, and the RFC that describes each,
can be found at&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Simple Authentication and Security Layer (SASL) Mechanisms - IANA
(Internet Assigned Numbers Authority)&lt;/strong&gt; &lt;br /&gt;
&lt;a href=&quot;https://www.iana.org/assignments/sasl-mechanisms/sasl-mechanisms.xhtml&quot;&gt;https://www.iana.org/assignments/sasl-mechanisms/sasl-mechanisms.xhtml&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Similarly, the list of SASL mechanisms, SASL profiles and SASL APIs:  &lt;br /&gt;
&lt;strong&gt;SASL mechanisms, SASL profiles, SASL APIs - Claus Aßmann at sendmail.org&lt;/strong&gt;&lt;br /&gt;
(List composed by Alexey Melnikov.  Last updated: April 29, 2002.)   &lt;br /&gt;
&lt;a href=&quot;https://www.sendmail.org/~ca/email/mel/SASL_info.html&quot;&gt;https://www.sendmail.org/~ca/email/mel/SASL_info.html&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;test-submitcf-hostnamesubmitmc-with-sendmail-from-cli&quot;&gt;Test &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;submit.cf&lt;/code&gt; (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;hostname&amp;gt;.submit.mc&lt;/code&gt;) with &lt;em&gt;sendmail&lt;/em&gt; from CLI&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ hostname
fbsd1.home.arpa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the following example, after you start &lt;em&gt;sendmail&lt;/em&gt; with 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail -Ac -bt&lt;/code&gt;, lines and commands that you type are:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;3,0 dusko@localhost&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;3,0 dusko@fbsd1.home.arpa&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;3,0 dusko@example.com&lt;/code&gt;,
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;3,0 dusko&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;3,0 root&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/quit&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  &lt;br /&gt;
The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-Ac&lt;/code&gt; parameter tells &lt;em&gt;sendmail&lt;/em&gt; to use &lt;em&gt;submit.cf&lt;/em&gt; configuration file;
that is, to oparate in &lt;strong&gt;MSP&lt;/strong&gt; (Mail Submission Program) mode.
MSP is a command-line &lt;em&gt;sendmail&lt;/em&gt; that functions as a Mail Submission Agent
(&lt;strong&gt;MSA&lt;/strong&gt;).&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-bt&lt;/code&gt; parameter invokes &lt;em&gt;sendmail&lt;/em&gt; in address test mode.
This mode reads addresses and shows the steps in parsing.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sendmail -Ac -bt
ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)
Enter &amp;lt;ruleset&amp;gt; &amp;lt;address&amp;gt;
&amp;gt; 3,0 dusko@localhost       
canonify           input: dusko @ localhost
Canonify2          input: dusko &amp;lt; @ localhost &amp;gt;
Canonify2        returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
canonify         returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
parse              input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
Parse0             input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
Parse0           returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
ParseLocal         input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
ParseLocal       returns: $# LR0relay $@ fbsd1 . home . arpa $: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
parse            returns: $# LR0relay $@ fbsd1 . home . arpa $: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
 
&amp;gt; 3,0 dusko@fbsd1.home.arpa
canonify           input: dusko @ fbsd1 . home . arpa
Canonify2          input: dusko &amp;lt; @ fbsd1 . home . arpa &amp;gt;
Canonify2        returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
canonify         returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
parse              input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
Parse0             input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
Parse0           returns: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
ParseLocal         input: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
ParseLocal       returns: $# LR0relay $@ fbsd1 . home . arpa $: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;
parse            returns: $# LR0relay $@ fbsd1 . home . arpa $: dusko &amp;lt; @ fbsd1 . home . arpa . &amp;gt;

&amp;gt; 3,0 dusko@example.com
canonify           input: dusko @ example . com
Canonify2          input: dusko &amp;lt; @ example . com &amp;gt;
Canonify2        returns: dusko &amp;lt; @ example . com . &amp;gt;
canonify         returns: dusko &amp;lt; @ example . com . &amp;gt;
parse              input: dusko &amp;lt; @ example . com . &amp;gt;
Parse0             input: dusko &amp;lt; @ example . com . &amp;gt;
Parse0           returns: dusko &amp;lt; @ example . com . &amp;gt;
ParseLocal         input: dusko &amp;lt; @ example . com . &amp;gt;
ParseLocal       returns: dusko &amp;lt; @ example . com . &amp;gt;
Parse1             input: dusko &amp;lt; @ example . com . &amp;gt;
MailerToTriple     input: &amp;lt; smartrelay : [ 127 . 0 . 0 . 1 ] &amp;gt; dusko &amp;lt; @ example . com . &amp;gt;
MailerToTriple   returns: $# smartrelay $@ [ 127 . 0 . 0 . 1 ] $: dusko &amp;lt; @ example . com . &amp;gt;
Parse1           returns: $# smartrelay $@ [ 127 . 0 . 0 . 1 ] $: dusko &amp;lt; @ example . com . &amp;gt;
parse            returns: $# smartrelay $@ [ 127 . 0 . 0 . 1 ] $: dusko &amp;lt; @ example . com . &amp;gt;
 
&amp;gt; 3,0 dusko
canonify           input: dusko
Canonify2          input: dusko
Canonify2        returns: dusko
canonify         returns: dusko
parse              input: dusko
Parse0             input: dusko
Parse0           returns: dusko
ParseLocal         input: dusko
ParseLocal       returns: dusko
Parse1             input: dusko
Parse1           returns: $# local $: dusko
parse            returns: $# local $: dusko

&amp;gt; 3,0 root
canonify           input: root
Canonify2          input: root
Canonify2        returns: root
canonify         returns: root
parse              input: root
Parse0             input: root
Parse0           returns: root
ParseLocal         input: root
ParseLocal       returns: root
Parse1             input: root
Parse1           returns: $# local $: root
parse            returns: $# local $: root
 
&amp;gt; /quit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;steps-when-recompiling-sendmail-configuration-after-modifying-its-configuration-files&quot;&gt;Steps When Recompiling Sendmail Configuration after Modifying Its Configuration Files&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cd /etc/mail
$ sudo su
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# make stop
Stopping: sendmail sendmail-clientmqueue.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# rm -i fbsd1.home.arpa.*
remove fbsd1.home.arpa.cf? y
remove fbsd1.home.arpa.mc? y
remove fbsd1.home.arpa.submit.cf? y
remove fbsd1.home.arpa.submit.mc? y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# rm -i *.cf
remove sendmail.cf? y
remove submit.cf? y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# make all
# make install 
# make start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;debugging-sendmail---sending-outgoing-test-message-in-verbosedebug-mode&quot;&gt;Debugging Sendmail - Sending Outgoing Test Message in Verbose/Debug Mode&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-d8.20&lt;/code&gt;: Debugging Switch: Tracking DNS Queuries &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-d60.5&lt;/code&gt;: Debugging Switch: Tracking Maps (Databases) queries &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-Ac:&lt;/code&gt; Use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;submit.cf&lt;/code&gt; even if the operation mode does not indicate an
initial mail submission; that is, oparate in MSP (Mail Submission Program)
mode.  MSP is a command-line &lt;em&gt;sendmail&lt;/em&gt; that functions as a Mail Submission
Agent (MSA).&lt;/p&gt;

&lt;p&gt;From: &lt;br /&gt;
&lt;a href=&quot;https://serverfault.com/questions/521032/debugging-sendmail-dsn-5-0-0/521614#521614&quot;&gt;Debugging sendmail - dsn=5.0.0 - - Sendmail: Sending outgoing test message in verbose/debug mode&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You may add additional debug/tracking command line options:  &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-d8.20&lt;/code&gt; - tracking DNS queuries  &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-d60.5&lt;/code&gt; - tracking maps (databases) queries&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# sendmail -v -Ac -d60.5 dusko@your.isp.domain
# sendmail -v -Ac -d60.5 dusko
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Equivalent to:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# sendmail -v -d60.5 -Csubmit.cf dusko@your.isp.domain
# sendmail -v -d60.5 -Csubmit.cf dusko
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the following example, after you start &lt;em&gt;sendmail&lt;/em&gt; with 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail -v -Ac -d60.5 &amp;lt;username&amp;gt;&lt;/code&gt;, the three lines you type are:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Subject: Test 1

.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# sendmail -v -Ac -d60.5 dusko
map_lookup(dequote, dusko, %0=dusko) =&amp;gt; NOT FOUND (0), ad=0
map_lookup(dequote, dusko, %0=dusko) =&amp;gt; NOT FOUND (0), ad=0
map_lookup(dequote, dusko, %0=dusko) =&amp;gt; NOT FOUND (0), ad=0
Subject: Test 1

.
dusko... Connecting to [127.0.0.1] via relay...
220 fbsd1.home.arpa ESMTP mailer ready at Sat, 12 Nov 2022 16:53:07 -0800 (PST)
&amp;gt;&amp;gt;&amp;gt; EHLO fbsd1.home.arpa
250-fbsd1.home.arpa Hello localhost [127.0.0.1], pleased to meet you 
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-SIZE 52428800
250-AUTH LOGIN PLAIN
250-DELIVERBY
250 HELP
&amp;gt;&amp;gt;&amp;gt; STARTTLS
220 2.0.0 Ready to start TLS
&amp;gt;&amp;gt;&amp;gt; EHLO fbsd1.home.arpa
250-fbsd1.home.arpa Hello localhost [127.0.0.1], pleased to meet you
250-ENHANCEDSTATUSCODES
250-PIPELINING
250-8BITMIME
250-SIZE
250-DSN
250-DELIVERBY
250 HELP
&amp;gt;&amp;gt;&amp;gt; MAIL From:&amp;lt;dusko@fbsd1.home.arpa&amp;gt; SIZE=17
250 2.1.0 &amp;lt;dusko@fbsd1.home.arpa&amp;gt;... Sender ok
&amp;gt;&amp;gt;&amp;gt; RCPT To:&amp;lt;dusko@fbsd1.home.arpa&amp;gt;
&amp;gt;&amp;gt;&amp;gt; DATA
250 2.1.5 &amp;lt;dusko@fbsd1.home.arpa&amp;gt;... Recipient ok
354 Enter mail, end with &quot;.&quot; on a line by itself
&amp;gt;&amp;gt;&amp;gt; .
250 2.0.0 2B71HsDo027909 Message accepted for delivery
dusko... Sent (2B71HsDo027909 Message accepted for delivery)
Closing connection to [127.0.0.1]
&amp;gt;&amp;gt;&amp;gt; QUIT
221 2.0.0 fbsd1.home.arpa closing connection
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The lines that begin with numbers and the lines that begin with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/code&gt;
characters constitute a record of the SMTP conversation.&lt;/p&gt;

&lt;p&gt;Similarly, with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-Am&lt;/code&gt; parameter, which tells &lt;em&gt;sendmail&lt;/em&gt; to use
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail.cf&lt;/code&gt; configuration file even if the operation mode indicates an
initial mail submission:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# sendmail -v -Am -d60.5 dusko@your.isp.domain
# sendmail -v -Am -d60.5 dusko
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Equivalent to:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# sendmail -v -Csendmail.cf -d60.5 dusko@your.isp.domain
# sendmail -v -Csendmail.cf -d60.5 dusko
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;references&quot;&gt;References&lt;/h2&gt;

&lt;p&gt;(All references retrieved on Nov 12, 2022.)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cgit.freebsd.org/src/commit/?id=4d184bd438&quot;&gt;RELNOTES: document the switch from sendmail to dma&lt;/a&gt;  (Author: Baptiste Daroussin &lt;bapt at=&quot;&quot; FreeBSD.org=&quot;&quot;&gt;  2022-11-07)&lt;/bapt&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cgit.freebsd.org/src/commit/?id=a67b925ff3e58b072a60b633e442ee1d33e47f7f&quot;&gt;FreeBSD source tree - mail: make The DragonFly Mail Agent (dma) the default mta.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://web.archive.org/web/20150810193500/http://brandonhutchinson.com/Creating_a_new_sendmail_mailer.html&quot;&gt;Creating a new &lt;em&gt;sendmail&lt;/em&gt; mailer&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://william.shallum.net/notes/2010-07-24-sendmailredirectallmailfordevelopment/&quot;&gt;Sendmail: redirect all mail for development&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://forums.freebsd.org/threads/sendmail.56661/&quot;&gt;Sendmail - The FreeBSD Forums&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://forums.freebsd.org/threads/lazy-question-about-sendmail.49321/&quot;&gt;Solved - “Lazy” question about sendmail - The FreeBSD Forums&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.hydrus.org.uk/journal/base-sendmail.html&quot;&gt;Modifying the FreeBSD base system sendmail - Posted on Mar 12, 2005&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www-ecs-shimane--u-ac-jp.translate.goog/~stamura/personal/network/op25b-sendmail.html?_x_tr_sch=http&amp;amp;_x_tr_sl=ja&amp;amp;_x_tr_tl=en&amp;amp;_x_tr_hl=en&amp;amp;_x_tr_pto=sc&quot;&gt;Setting method of submit.mc for non-resident sendmail under OP25B environment - Configuration of submit.mc Under Outbound Port 25 Blocking&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www-ecs-shimane--u-ac-jp.translate.goog/~stamura/personal/network/op25b-sendmail.html?_x_tr_sl=ja&amp;amp;_x_tr_tl=en&amp;amp;_x_tr_hl=en&amp;amp;_x_tr_pto=sc&amp;amp;_x_tr_sch=http#smtp-auth-proxy&quot;&gt;Configuring SMTP-AUTH proxy with resident sendmail&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.exim.org/exim-html-current/doc/html/spec_html/ch-encrypted_smtp_connections_using_tlsssl.html&quot;&gt;Chapter 43 - Encrypted SMTP connections using TLS/SSL - Exim Internet Mailer&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://forums.freebsd.org/threads/dma-makes-sense.52219/&quot;&gt;[Solved] DMA makes sense - The FreeBSD Forums&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://groups.google.com/g/comp.mail.sendmail/c/Gy6QBfMd3l4&quot;&gt;sendmail as relay client over port 465 with SSL - comp.mail.sendmail - &lt;em&gt;sendmail&lt;/em&gt; news group&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://fedoraproject.org/wiki/Configure_sendmail_as_a_client_for_SMTPs&quot;&gt;Configure sendmail as a client for SMTPs - Fedora Project Wiki&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://web.archive.org/web/20140228040212/http://www.dawoodfall.net/index.php/en/relaying-sendmail-a-ssl&quot;&gt;Configuring Sendmail to Relay via an SSL tunnel - Relaying Sendmail and SSL (posted on Feb 28, 2014)&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://jpmens.net/2020/03/05/simple-solution-for-outgoing-mail-from-a-freebsd-system/&quot;&gt;Simple solution for outgoing mail from a FreeBSD system - with dma(8) - DragonFly Mail Agent&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.freebsd.org/en/books/handbook/mail/#sendmail&quot;&gt;30.3. Sendmail Configuration Files - Chapter 30. Electronic Mail - FreeBSD Documentation Portal&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.sendmail.org/~ca/email/auth.html&quot;&gt;SMTP AUTH in sendmail 8.10 (Last Update 2006-04-15) (Claus Aßmann at sendmail.org)&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.freebsd.org/en/books/handbook/mail/#SMTP-Auth&quot;&gt;30.9. SMTP Authentication - FreeBSD Handbook - FreeBSD Documentation Portal&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.brennan.id.au/12-Sendmail_Server.html&quot;&gt;Chapter 12 - Sendmail Server – Linux Home Server HOWTO&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://blog.grem.de/sysadmin/Sendmail-SmartHost-Without-DNS-2012-05-06-22-00.html&quot;&gt;Configure sendmail to forward root’s email without DNS (posted on May 6, 2012)&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://perldoc.perl.org/MIME::Base64&quot;&gt;Perl - MIME::Base64 Module (Encoding and decoding of base64 strings)&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://serverfault.com/questions/343720/sendmail-rewrite-rules-in-separate-file&quot;&gt;sendmail rewrite rules in separate file - Server Fault&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Rules using LOCAL_NET_CONFIG will always be inserted at the same place: &lt;br /&gt;
halfway through ruleset 0.  And they can’t be wildly different from what
was there before such that delivery no longer approximately matches the
assumptions made by the existing “parse” functionality.  New rulesets
(subroutines) from LOCAL_RULESETS will either be called only by your
inserted rules, or be called directly by the &lt;em&gt;sendmail&lt;/em&gt; program itself
depending on specific (and possibly obscure) subroutine names and
sendmail.mc FEATURE specifications.  And extensions to existing rulesets
(subroutines) from LOCAL_RULESET can add new functionality, but probably
cannot change existing functionality, as a match and “return” by an
existing earlier rule will terminate execution of that ruleset before
your additional rules are even reached.  Nevertheless, this may be
adequate for what you want.&lt;/p&gt;

  &lt;p&gt;If you do this, use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sendmail -bt -Ctrial_sendmail.cf_file -d21.15&lt;/code&gt;&lt;br /&gt;
(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-d21.15&lt;/code&gt; debug switch is for tracing &lt;em&gt;sendmail&lt;/em&gt; rules and rule sets)
test mechanism to make sure it’s behaving the way you intend.
Remember, your “style” should be to compose your new rules in such
a way that they fit seamlessly into the existing ruleset framework
(rather than making arbitrary changes with little consideration for the
existing framework); it’s rather like adding a new feature to existing
code that was structured by somebody else.  The distributed rewrite
rules are very good at handling not only mainline behavior but also edge
cases (MX for individual hosts? Masquerade exceptions?  UUCP connectivity?
aliases? etc.?); hopefully your added rules will be similarly comprehensive.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;[ 1 ]&lt;/strong&gt; Other possible AKAs:&lt;/p&gt;

&lt;p&gt;Sendmail as a relay client over port 465 with SSL-or-TLS&lt;br /&gt;
Sendmail with SASL2, SMTP AUTH and TLS &lt;br /&gt;
Sendmail with SASL2, SMTP AUTH and SSL&lt;br /&gt;
Sendmail with SASL2, SMTP AUTH and SSL-or-TLS&lt;br /&gt;
Using Stunnel to secure SMTP transport &lt;br /&gt;
Implicit TLS on port 465 for SMTP Submission &lt;br /&gt;
Sendmail with SSL (port 465) &lt;br /&gt;
Sendmail with SSL-or-TLS (port 465) &lt;br /&gt;
Sendmail’s SMTP Authentication (SMTP AUTH) &lt;br /&gt;
Setting up Sendmail with SSL-or-TLS and AUTH support in FreeBSD &lt;br /&gt;
Setting up Sendmail with TLS and AUTH support in FreeBSD &lt;br /&gt;
Getting Sendmail (as a client) to use AUTH LOGIN &lt;br /&gt;
Sendmail TLS SASL SMTP-AUTH &lt;br /&gt;
Sendmail SSL-or-TLS SASL SMTP-AUTH &lt;br /&gt;
Secure SMTP AUTH over SSL with Sendmail and Cyrus SASL &lt;br /&gt;
Secure SMTP AUTH over SSL-or-TLS with Sendmail and Cyrus SASL &lt;br /&gt;
Authenticated SMTP with sendmail &lt;br /&gt;
SMTP AUTH: Client Authentication &lt;br /&gt;
Sendmail, SASL, and SSL-or-TLS &lt;br /&gt;
Sendmail, SASL, and TLS &lt;br /&gt;
Testing SMTP AUTH connections &lt;br /&gt;
Sendmail TLS SASL SMTP-AUTH &lt;br /&gt;
Sendmail SSL-or-TLS SASL SMTP-AUTH&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[ 2 ]&lt;/strong&gt;  Technically, SMTPS doesn’t exist.  According to
&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc5321#page-61&quot;&gt;RFC 5321&lt;/a&gt;,
the Protocol is either SMTP or ESMTP:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Protocol       = &quot;ESMTP&quot; / &quot;SMTP&quot; / Attdl-Protocol

   Attdl-Protocol = Atom
                  ; Additional standard names for protocols are
                  ; registered with the Internet Assigned Numbers
                  ; Authority (IANA) in the &quot;mail parameters&quot;
                  ; registry [9].  SMTP servers SHOULD NOT
                  ; use unregistered names.

----

   [9]   Newman, C., &quot;ESMTP and LMTP Transmission Types Registration&quot;,
         RFC 3848 [https://datatracker.ietf.org/doc/html/rfc3848], July 2004.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc3848&quot;&gt;RFC 3848&lt;/a&gt; specified
additional values: &lt;br /&gt;
ESMTPA when ESMTP is used with successful user authentication, ESMTPS
when ESMTP is used with STARTTLS, and ESMTPSA when the session has been
secured with both STARTTLS and SMTP AUTH are successfully negotiated
(the combination of ESMTPS and ESMTPA):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Abstract

   This registers seven new mail transmission types (ESMTPA, ESMTPS,
   ESMTPSA, LMTP, LMTPA, LMTPS, LMTPSA) for use in the &quot;with&quot; clause of
   a Received header in an Internet message.

[ . . . ]

1.  IANA Considerations

   As directed by SMTP [2], IANA maintains a registry [7] of &quot;WITH
   protocol types&quot; for use in the &quot;with&quot; clause of the Received header
   in an Internet message.  This registry presently includes SMTP [6],
   and ESMTP [2].  This specification updates the registry as follows:

   o  The new keyword &quot;ESMTPA&quot; indicates the use of ESMTP when the SMTP
      AUTH [3] extension is also used and authentication is successfully
      achieved.

   o  The new keyword &quot;ESMTPS&quot; indicates the use of ESMTP when STARTTLS
      [1] is also successfully negotiated to provide a strong transport
      encryption layer.

   o  The new keyword &quot;ESMTPSA&quot; indicates the use of ESMTP when both
      STARTTLS and SMTP AUTH are successfully negotiated (the
      combination of ESMTPS and ESMTPA).

----

   [1]  Hoffman, P., &quot;SMTP Service Extension for Secure SMTP over
        Transport Layer Security&quot;, 
        RFC 3207 [https://datatracker.ietf.org/doc/html/rfc3207], February 2002.

   [2]  Klensin, J., Ed., &quot;Simple Mail Transfer Protocol&quot;, 
        RFC 2821 [https://datatracker.ietf.org/doc/html/rfc2821], April 2001.

   [3]  Myers, J., &quot;SMTP Service Extension for Authentication&quot;, 
        RFC 2554 [https://datatracker.ietf.org/doc/html/rfc2554], March 1999.

[ . . . ]  

   [6]  Postel, J., &quot;Simple Mail Transfer Protocol&quot;, STD 10, 
        RFC 821 [https://datatracker.ietf.org/doc/html/rfc821], August 1982.

   [7]  &amp;lt;http://www.iana.org/assignments/mail-parameters&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;[ 3 ]&lt;/strong&gt; &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc8314#section-3.3&quot;&gt;3.3. Implicit TLS for SMTP Submission -  The RFC 8314&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;3.3.  Implicit TLS for SMTP Submission&lt;/p&gt;

  &lt;p&gt;When a TCP connection is established for the “submissions” service
(default port 465), a TLS handshake begins immediately.  Clients MUST
implement the certificate validation mechanism described in
[RFC7817].  Once the TLS session is established, Message Submission
protocol data [RFC6409] is exchanged as TLS application data for the
remainder of the TCP connection.  (Note: The “submissions” service
name is defined in Section 7.3 of this document and follows the usual
convention that the name of a service layered on top of Implicit TLS
consists of the name of the service as used without TLS, with an “s”
appended.)&lt;/p&gt;

  &lt;p&gt;[ . . . ]&lt;/p&gt;

  &lt;p&gt;Note that the “submissions” port provides access to a Message
Submission Agent (MSA) as defined in [RFC6409], so requirements and
recommendations for MSAs in that document, including the requirement
to implement SMTP AUTH [RFC4954] and the requirements of Email
Submission Operations [RFC5068], also apply to the submissions port.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://tools.ietf.org/html/rfc8314#section-7.3&quot;&gt;7.3. Submissions Port Registration (Port 465) for message submission over TLS protocol – The RFC 8314 - January 2018&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;7.3.  Submissions Port Registration&lt;/p&gt;

  &lt;p&gt;IANA has assigned an alternate usage of TCP port 465 in addition to
the current assignment using the following template [RFC6335]:&lt;/p&gt;

  &lt;p&gt;Service Name: submissions&lt;br /&gt;
Transport Protocol: TCP&lt;br /&gt;
Assignee: IESG &amp;lt;iesg@ietf.org&amp;gt;&lt;br /&gt;
Contact: IETF Chair &amp;lt;chair@ietf.org&amp;gt;&lt;br /&gt;
Description: Message Submission over TLS protocol&lt;br /&gt;
Reference: RFC 8314&lt;br /&gt;
Port Number: 465&lt;/p&gt;

  &lt;p&gt;[ . . . ]&lt;/p&gt;

  &lt;p&gt;Historically, port 465 was briefly registered as the “smtps” port.
This registration made no sense, as the SMTP transport MX
infrastructure has no way to specify a port, so port 25 is always
used.  As a result, the registration was revoked and was subsequently
reassigned to a different service.  In hindsight, the “smtps”
registration should have been renamed or reserved rather than
revoked.  Unfortunately, some widely deployed mail software
interpreted “smtps” as “submissions” [RFC6409] and used that port for
email submission by default when an end user requested security
during account setup.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;[ 4 ]&lt;/strong&gt; The RFC 8314 was amended in 2018 to recommend the use of
          Implicit TLS over port 465:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc8314#section-3&quot;&gt;The IETF issued a one-time amendment to reinstate port 465 for message submission over TLS protocol - RFC 8314 - Use of TLS for Email Submission/Access - January 2018&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;To encourage more widespread use of TLS and to also encourage greater
consistency regarding how TLS is used, this specification now recommends
the use of Implicit TLS for POP, IMAP, SMTP Submission, and all other
protocols used between an MUA (Mail User Agent) and an MSP (Mail Service
Provider).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Port 465 and 587 are both &lt;strong&gt;valid&lt;/strong&gt; ports for a mail submission agent (MSA).
Port 465 requires negotiation of TLS/SSL at connection setup and port 587
uses STARTTLS if an MUA chooses to negotiate TLS.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[ 5 ]&lt;/strong&gt; On FreeBSD 13, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user.localbase&lt;/code&gt; is set to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local&lt;/code&gt; by default.&lt;/p&gt;

&lt;p&gt;From the man page for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sysctl(8)&lt;/code&gt; utility:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;The string and integer information is summarized below.  For a detailed
description of these variable see sysctl(3).

The changeable column indicates whether a process with appropriate
privilege can change the value.  String and integer values can be set
using sysctl.
  
Name                           Type          Changeable
.
[ . . . ]
.
user.localbase                 string        no
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ man 3 sysctl
[ . . . ]
       USER_LOCALBASE
               Return the value of localbase that has been compiled into system
               utilities that need to have access to resources provided by a
               port or package.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sysctl -d user.localbase
user.localbase: Prefix used to install and locate add-on packages
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sysctl user.localbase
user.localbase: /usr/local
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;[ 6 ]&lt;/strong&gt;  FreeBSD src tree - FreeBSD src commits - RELNOTES: document the
switch from sendmail to dma (Posted on Nov 7, 2022)&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://cgit.freebsd.org/src/commit/?id=4d184bd438&quot;&gt;FreeBSD src tree - FreeBSD src commits - RELNOTES: document the switch from sendmail to dma&lt;/a&gt;  &lt;br /&gt;
(Posted on Nov 7, 2022)&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://twitter.com/FreeBSD_src_git/status/1589587194003472384&quot;&gt;FreeBSD src commits (@FreeBSD_src_git) on Twitter - bapt@ on . (4d184bd438): RELNOTES: document the switch from sendmail to dma&lt;/a&gt;  (Posted on Nov 7, 2022)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://twitter.com/_bapt_/status/938688218215714817&quot;&gt;Time to remove sendmail from #FreeBSD base? - Baptiste Daroussin - Twitter&lt;/a&gt;  (Posted on Dec 7, 2017)&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://lists.freebsd.org/pipermail/freebsd-arch/2017-December/018712.html&quot;&gt;Sendmail deprecation ? - Baptiste Daroussin bapt at FreeBSD.org - Dec 6, 2017 - The freebsd-arch Mailing List Archives&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://twitter.com/ed_maste/status/1487170942249930756&quot;&gt;Did you know? FreeBSD includes the DragonFly Mail Agent (dma), a minimal MTA, in the base system. - Ed Maste (@ed_maste)&lt;/a&gt;  (Posted on Jan 28, 2022)&lt;/p&gt;
    &lt;blockquote&gt;
      &lt;p&gt;Did you know? FreeBSD includes the DragonFly Mail Agent (dma), a minimal MTA,
in the base system.  See the dma(1) and mailer.conf(5) man pages for
configuration details.&lt;/p&gt;

      &lt;p&gt;&lt;a href=&quot;https://www.freebsd.org/cgi/man.cgi?query=dma&quot;&gt;dma(8) - FreeBSD Manual Pages&lt;/a&gt;&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;[ 7 ]&lt;/strong&gt; From &lt;a href=&quot;https://www.sendmail.org/~ca/email/auth.html&quot;&gt;SMTP AUTH in sendmail 8.10 - Claus Aßmann at sendmail.org&lt;/a&gt; (Last Update 2006-04-15) (Retrieved on Nov 12, 2022):&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Terminology&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;SASL defines two terms which are important in this context:
&lt;em&gt;authorization identifier&lt;/em&gt; and &lt;em&gt;authentication identifer&lt;/em&gt;.&lt;/p&gt;

  &lt;p&gt;&lt;em&gt;authorization identifier&lt;/em&gt; (&lt;strong&gt;userid&lt;/strong&gt;) &lt;br /&gt;
The userid is the identifier an application uses to check whether
operations are allowed (authorized).  &lt;br /&gt;
&lt;em&gt;authentication identifer&lt;/em&gt; (&lt;strong&gt;authid&lt;/strong&gt;) &lt;br /&gt;
The authentication identifier is the identifier that is being used to
authenticate the client.  That is, the authentication credentials of
the client contain the authentication identifier.  This can be used
for a proxy server to act as (proxy for) another user.&lt;/p&gt;

  &lt;p&gt;[ . . . ]&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;Operation&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;SMTP AUTH allows relaying for senders who have successfully
&lt;strong&gt;authenticated themselves&lt;/strong&gt;.  Per default, &lt;strong&gt;relaying&lt;/strong&gt; is &lt;strong&gt;allowed&lt;/strong&gt;
for any user who &lt;strong&gt;authenticated&lt;/strong&gt; via a trusted mechanism, i.e., one that
is defined via &lt;br /&gt;
TRUST_AUTH_MECH(`list of mechanisms’) &lt;br /&gt;
This is useful for roaming users and can replace POP-before-SMTP hacks if
the MUA supports SMTP AUTH.&lt;/p&gt;

  &lt;p&gt;[ . . . ]&lt;/p&gt;

  &lt;p&gt;New macros for SMTP AUTH are &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;{auth_authen}&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;{auth_author}&lt;/code&gt;, and
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;{auth_type}&lt;/code&gt;, which hold the client’s authentication credentials
(&lt;a href=&quot;https://www.sendmail.org/~ca/email/auth.html#authid&quot;&gt;authid&lt;/a&gt;),
the authorization identity
(&lt;a href=&quot;https://www.sendmail.org/~ca/email/auth.html#userid&quot;&gt;userid&lt;/a&gt;)
(i.e., the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH=&lt;/code&gt; parameter of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL&lt;/code&gt; command, if supplied),
and the mechanism used for authentication.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;[ 8 ]&lt;/strong&gt; In addition, the &lt;strong&gt;relay&lt;/strong&gt; delivery agent is also chosen for
forwarding mail to LUSER_RELAY (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LUSER_RELAY&lt;/code&gt; mc macro),
BITNET_RELAY (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$B&lt;/code&gt; macro, deprecated), UUCP_RELAY (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;UUCP_RELAY&lt;/code&gt; mc macro),
DECNET_RELAY (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DECNET_RELAY&lt;/code&gt; mc macro), FAX_RELAY (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FAX_RELAY&lt;/code&gt; mc macro)
and MAIL_HUB (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL_HUB&lt;/code&gt; mc macro).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[ 9 ]&lt;/strong&gt;
From &lt;em&gt;Linux Network Administrator’s Guide&lt;/em&gt;, Second Edition&lt;br /&gt;
By Olaf Kirch, Terry Dawson;
Published By: O’Reilly Media, Inc., Publication Date: June 2000&lt;br /&gt;
(Chapter 18. Sendmail &amp;gt; Interpreting and Writing Rewrite Rules &amp;gt; Ruleset Semantics):&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Each of the &lt;em&gt;sendmail&lt;/em&gt; rulesets is called upon to perform
a different task in mail processing.&lt;/p&gt;

  &lt;p&gt;LOCAL_RULE_3&lt;/p&gt;

  &lt;p&gt;Ruleset 3 is responsible for converting an address in an arbitrary format
into a common format that &lt;em&gt;sendmail&lt;/em&gt; will then process.
The expected output format is&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;local-part&lt;/code&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@&lt;/code&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;host-domain-spec&lt;/code&gt;.&lt;/p&gt;

  &lt;p&gt;Ruleset 3 should place the hostname part of the converted address inside
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;gt;&lt;/code&gt; characters to make parsing by later rulesets easier.
Ruleset 3 is applied before &lt;em&gt;sendmail&lt;/em&gt; does any other processing of an
email address so if you want &lt;em&gt;sendmail&lt;/em&gt; to gateway mail from some system that
uses some unusual address format, you should add a rule using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LOCAL_RULE_3&lt;/code&gt;
macro to convert addresses into the common format.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;[ 10 ]&lt;/strong&gt; Delivery Agent Equates&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+--------+----------------+-------------------------------+
| Equate | Field Name     | Meaning                       |
+--------+----------------+-------------------------------+
| /=     | /path          | Set a chroot directory        |
|        |                | (V8.10 and later)             |
+--------+----------------+-------------------------------+
| A=     | Argv           | Delivery agent&apos;s              |
|        |                | command-line arguments        |
+--------+----------------+-------------------------------+
| C=     | CharSet        | Default MIME character        |
|        |                | set (V8.7 and later)          |
+--------+----------------+-------------------------------+
| D=     | Directory      | Delivery agent working        |
|        |                | directory (V8.6 and later)    |
+--------+----------------+-------------------------------+
| E=     | EOL            | End-Of-Line string            |
+--------+----------------+-------------------------------+
| F=     | Flags          | Delivery agent flags          |
+--------+----------------+-------------------------------+
| L=     | LineLimit      | Maximum line length           |
|        |                | (V8.1 and later)              |
+--------+----------------+-------------------------------+
| M=     | MaxMsgSize     | Maximum message size          |
+--------+----------------+-------------------------------+
| m=     | maxMsgsPerConn | Max messages per connection   |
|        |                | (V8.10 and later)             |
+--------+----------------+-------------------------------+
| N=     | Niceness       | How to nice(2) the agent      |
|        |                | (V8.7 and later)              | 
+--------+----------------+-------------------------------+
| P=     | Path           | Path to the delivery agent    |
+--------+----------------+-------------------------------+
| Q=     | QueueGroup     | The name of the queue group   | 
|        |                | to use (V8.12 and later)      | 
+--------+----------------+-------------------------------+
| R=     | Recipient      | Recipient rewriting rule      | 
+--------+----------------+-------------------------------+
| r=     | recipients     | Maximum recipients per        | 
|        |                | envelope (V8.12 and later)    |
+--------+----------------+-------------------------------+
| S=     | Sender         | Sender rewriting rule set     | 
+--------+----------------+-------------------------------+
| T=     | Type           | Types for DSN diagnostics     | 
|        |                | (V8.7 and later)              |
+--------+----------------+-------------------------------+
| U=     | UID            | Run agent as user-id:group-id |
|        |                | (V8.7 and later)              | 
+--------+----------------+-------------------------------+
| W=     | Wait           | Timeout for a process wait    |
|        |                | (V8.10 and later)             |
+--------+----------------+-------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;[ 11 ]&lt;/strong&gt; Sections of Chapter 8. Securing the Mail Transport
(from &lt;em&gt;sendmail Cookbook&lt;/em&gt; by Craig Hunt - Published by O’Reilly
Media, Inc., Publication Date: December 2003):&lt;/p&gt;

&lt;p&gt;8.1. Building a Private Certificate Authority&lt;br /&gt;
8.2. Creating a Certificate Request&lt;br /&gt;
8.3. Signing a Certificate Request&lt;br /&gt;
8.4. Configuring sendmail for STARTTLS&lt;br /&gt;
8.5. Relaying Based on the CA&lt;br /&gt;
8.6. Relaying Based on the Certificate Subject&lt;br /&gt;
8.7. Requiring Outbound Encryption&lt;br /&gt;
8.8. Requiring Inbound Encryption &lt;br /&gt;
8.9. Requiring a Verified Certificate&lt;br /&gt;
8.10. Requiring TLS for a Recipient&lt;br /&gt;
8.11. Refusing STARTTLS Service&lt;br /&gt;
8.12. Selectively Advertising STARTTLS&lt;br /&gt;
8.13. Requesting Client Certificates&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[ 12 ]&lt;/strong&gt; The RFC describes three functions for the AUTH keyword:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;250-AUTH&lt;/code&gt; is the response of the SMTP &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EHLO&lt;/code&gt; command.  The response
advertises the supported authentication mechanisms.  The configuration
that causes &lt;em&gt;sendmail&lt;/em&gt; to list AUTH in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EHLO&lt;/code&gt; response and to accept
incoming AUTH connections is covered in Recipe 7.1.  That configuration
applies when &lt;em&gt;sendmail&lt;/em&gt; runs as an &lt;strong&gt;MTA&lt;/strong&gt;, and it is &lt;strong&gt;only&lt;/strong&gt; applicable
when &lt;em&gt;sendmail&lt;/em&gt; is run with the &lt;strong&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-bd&lt;/code&gt;&lt;/strong&gt; command-line option.&lt;/li&gt;
    &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH&lt;/code&gt; is the SMTP command used to request authentication and to select
the authentication mechanism for the session.  The connecting host must
select one of the mechanisms advertised by the receiving host, or the
authentication attempt is rejected. &lt;em&gt;sendmail&lt;/em&gt; will request AUTH
authentication when it is configured as described in Recipe 7.2.
A laptop or desktop that sends SMTP mail but does not accept inbound SMTP
connections could be configured using only Recipe 7.2.  A system that
accepts incoming AUTH connections and creates outgoing AUTH connections
would combine the configurations from both Recipe 7.1 and Recipe 7.2.&lt;/li&gt;
    &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH=&lt;/code&gt; is a parameter used on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL From:&lt;/code&gt; line to identify the
authenticated source address.  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH=&lt;/code&gt; parameter comes from the
connecting host as part of the initial envelope sender address.
If the receiving host trusts the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH=&lt;/code&gt; parameter, it propagates it on
to the next mail relay.  Recipe 7.6 provides additional information about
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH=&lt;/code&gt; parameter.&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;[ 13 ]&lt;/strong&gt; The Cyrus SASL documentation defines four special terms:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;userid&lt;/strong&gt;  &lt;br /&gt;
The username that determines the permissions granted to the client.
The client is given the permissions normally granted to the specified user.
&lt;em&gt;userid&lt;/em&gt; is also called the &lt;strong&gt;&lt;em&gt;authorization id&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;authid&lt;/strong&gt;  &lt;br /&gt;
The account name used to authenticate the connection.
&lt;em&gt;authid&lt;/em&gt; is also called the &lt;strong&gt;&lt;em&gt;authentication id&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;realm&lt;/strong&gt;&lt;br /&gt;
A group of users, systems, and services that share a common authentication
environment.  All members of a given group use the same &lt;em&gt;realm&lt;/em&gt; value.
It is &lt;strong&gt;common&lt;/strong&gt; to use a &lt;strong&gt;domain name&lt;/strong&gt; or &lt;strong&gt;hostname&lt;/strong&gt; for the &lt;em&gt;realm&lt;/em&gt; value.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;mechanism&lt;/strong&gt; &lt;br /&gt;
Identifies the type of authentication used.  For example, DIGEST-MD5 is a
valid &lt;em&gt;mechanism&lt;/em&gt; value.&lt;/p&gt;

&lt;p&gt;The &lt;em&gt;userid&lt;/em&gt; and &lt;em&gt;authid&lt;/em&gt; values cause the most confusion.  To understand
how SASL uses these two values, think of an &lt;em&gt;/etc/passwd&lt;/em&gt; file with one
entry for &lt;em&gt;craig&lt;/em&gt; and another for &lt;em&gt;kathy&lt;/em&gt;.  In a normal login, when Kathy
logs in to the &lt;em&gt;kathy&lt;/em&gt; account, she is granted the permissions given to
that account.  With SASL, it is possible to set &lt;em&gt;authid&lt;/em&gt; to &lt;em&gt;kathy&lt;/em&gt; and
&lt;em&gt;userid&lt;/em&gt; to &lt;em&gt;craig&lt;/em&gt;, which means that the &lt;em&gt;kathy&lt;/em&gt; account password is
required for authentication, but the permissions granted to the user are
the permissions granted to the &lt;em&gt;craig&lt;/em&gt; account.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[ 14 ]&lt;/strong&gt; Three configuration commands can be used in the &lt;em&gt;Sendmail.conf&lt;/em&gt; file.
They are:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;srvtab&lt;/em&gt; &lt;br /&gt;
The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;srvtab&lt;/code&gt; command points to the file that contains the Kerberos 4
service key.  The argument provided with this command is the full pathname
of the service key file.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;auto_transition&lt;/em&gt;&lt;br /&gt;
The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;auto_transition&lt;/code&gt; command causes SASL to automatically create
a &lt;em&gt;sasldb&lt;/em&gt; entry for every user that authenticates using the &lt;strong&gt;PLAIN&lt;/strong&gt;
authentication method.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;pwcheck_method&lt;/em&gt;&lt;br /&gt;
The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pwcheck_method&lt;/code&gt; command defines the technique that SASL should use to
validate the clear text password received during &lt;strong&gt;PLAIN&lt;/strong&gt; method
authentication.  The possible values for the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pwcheck_method&lt;/code&gt; are:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;em&gt;passwd&lt;/em&gt; &lt;br /&gt;
Tells SASL to look up passwords in the &lt;em&gt;/etc/passwd&lt;/em&gt; file.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;shadow&lt;/em&gt; &lt;br /&gt;
Tells SASL to look up passwords on the &lt;em&gt;/etc/shadow&lt;/em&gt; file.  Because of the
file permissions associated with the &lt;em&gt;/etc/shadow&lt;/em&gt; file, the application
must be running as &lt;em&gt;root&lt;/em&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;pam&lt;/em&gt; &lt;br /&gt;
Tells SASL to use Pluggable Authentication Modules (PAM). PAM must,
of course, be properly configured to authenticate the password.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;sasldb&lt;/em&gt; &lt;br /&gt;
Tells SASL that the passwords for the PLAIN authentication method are
stored in the &lt;em&gt;sasldb&lt;/em&gt; file.  Normally, &lt;em&gt;sasldb&lt;/em&gt; is only used for
DIGEST-MD5 and CRAM-MD5 authentication.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;kerberos_v4&lt;/em&gt; &lt;br /&gt;
Tells SASL to authenticate clear text passwords through the Kerberos 4
server.  Kerberos 4 must be installed, configured, and running, and the
Kerberos 4 server must be configured to accept clear text passwords.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;sia&lt;/em&gt; &lt;br /&gt;
Tells SASL to use Digital’s Security Integration Architecture (SIA) to
validate passwords.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;pwcheck&lt;/em&gt; &lt;br /&gt;
Tells SASL to pass the data to an external program for password checking.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;[ 15 ]&lt;/strong&gt; SASL Flags&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+------+---------------------------------------------------------------+
| Flag | Purpose                                                       |
+------+---------------------------------------------------------------+
| A    | Use the AUTH= parameter only when successfully authenticated. |
+------+---------------------------------------------------------------+
| a    | Request optional protection against active attacks during the |
|      | authentication exchange.                                      |
+------+---------------------------------------------------------------+
| c    | Require client credentials if the authentication mechanism    |
|      | supports them.                                                |
+------+---------------------------------------------------------------+
| d    | Reject authentication techniques that are susceptible to      |
|      | dictionary attacks.                                           |
+------+---------------------------------------------------------------+
| f    | Don&apos;t use the same static shared-secret for each session.     |
+------+---------------------------------------------------------------+
| p    | Reject authentication techniques that are susceptible to      |
|      | simple passive attacks.                                       |
+------+---------------------------------------------------------------+
| y    | Don&apos;t allow the ANONYMOUS authentication mechanism.           |
+------+---------------------------------------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;A&lt;/code&gt; option controls when the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH=&lt;/code&gt; parameter is added to the envelope
sender information on the SMTP &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Mail From:&lt;/code&gt; command line.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[ 16 ]&lt;/strong&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local_trust_auth&lt;/code&gt; rule set and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SLocal_trust_auth&lt;/code&gt; hook&lt;/p&gt;

&lt;p&gt;About the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SLocal_trust_auth&lt;/code&gt; hook - based on directions from
&lt;em&gt;/usr/local/share/sendmail/cf/README&lt;/em&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;If the MSP should actually use AUTH then the necessary data
should be placed in a map as explained in SMTP AUTHENTICATION:

FEATURE(`authinfo&apos;, `DATABASE_MAP_TYPE /etc/mail/msp-authinfo&apos;)

/etc/mail/msp-authinfo should contain an entry like:

        AuthInfo:127.0.0.1      &quot;U:smmsp&quot; &quot;P:secret&quot; &quot;M:DIGEST-MD5&quot;

The file and the map created by makemap should be owned by smmsp,
its group should be smmsp, and it should have mode 640.

The database used by the MTA for AUTH must have a corresponding entry.

Additionally the MTA must trust this authentication data so the AUTH=
part will be relayed on to the next hop.  This can be achieved by
adding the following to your sendmail.mc file:

        LOCAL_RULESETS
        SLocal_trust_auth
        R$*	$: $&amp;amp;{auth_authen}
        Rsmmsp	$# OK
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From &lt;strong&gt;sendmail&lt;/strong&gt;, 4th Edition (a.k.a. &lt;strong&gt;“Bat Book”&lt;/strong&gt;) &lt;br /&gt;
By Bryan Costales, Claus Assmann, George Jansen, Gregory Neil Shapiro&lt;br /&gt;
(Published by: O’Reilly Media, Inc., Publication Date: October 2007)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;SASL and Rule Sets&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The SMTP &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH&lt;/code&gt; extension, enabled by SASL, allows client machines to relay
mail through the authentication-checking server.  This mechanism is especially
useful for roaming users whose laptops seldom have a constant IP number or
hostname assigned.  A special rule set called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;trust_auth&lt;/code&gt;, found inside
the &lt;em&gt;sendmail&lt;/em&gt; configuration file, does the actual checking.  This rule set
decides whether the client’s authentication identifier (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;authid&lt;/code&gt;) is trusted
to act as (proxy for) the requested authorization identity (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;userid&lt;/code&gt;).
It allows &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;authid&lt;/code&gt; to act for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;userid&lt;/code&gt; if both are recognized, and disallows
that action if the authentication fails.&lt;/p&gt;

&lt;p&gt;Another rule set, called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local_trust_auth&lt;/code&gt;, is available if you wish to
supplement the basic test provided by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;trust_auth&lt;/code&gt;.  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local_trust_auth&lt;/code&gt;
rule set can return the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#error&lt;/code&gt; delivery agent to disallow proxying, or it
can return OK to allow proxying.&lt;/p&gt;

&lt;p&gt;Within the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local_trust_auth&lt;/code&gt; rule set you can use three new &lt;em&gt;sendmail&lt;/em&gt;
macros (in addition to the other normal &lt;em&gt;sendmail&lt;/em&gt; macros). They are:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;{auth_authen}&lt;/code&gt;  &lt;br /&gt;
The client’s &lt;strong&gt;authentication credentials&lt;/strong&gt; as determined by the
authentication process.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;{auth_author}&lt;/code&gt; &lt;br /&gt;
The &lt;strong&gt;authorization identity&lt;/strong&gt; as set by issuance of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SMTP AUTH=&lt;/code&gt; parameter.
This could be either a &lt;em&gt;username&lt;/em&gt; or a &lt;em&gt;user@host.domain&lt;/em&gt; address.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;{auth_type}&lt;/code&gt; &lt;br /&gt;
The &lt;strong&gt;mechanism&lt;/strong&gt; used for authentication, such as CRAM-MD5 and PLAIN.&lt;/p&gt;

&lt;p&gt;These three macros can also be used in any of the relay-testing rule sets
to determine whether a particular user may relay.  To illustrate, consider
a rule set designed to allow senders with local accounts on the local
machine to relay only if authenticated:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;LOCAL_RULESETS
SLocal_check_rcpt
R$*			$: $&amp;amp;{auth_type} $| $&amp;amp;{auth_authen}
RDIGEST-MD5 $| $+@$=w	$# OK
RCRAM-MD5 $| $+@$=w	$# OK
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local_check_rcpt&lt;/code&gt; rule set is called to validate the envelope
recipient.  The first rule (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;R&lt;/code&gt; line) replaces the workspace (the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$*&lt;/code&gt; on
the left) with three values: the current value of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_type}&lt;/code&gt; macro;
a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$|&lt;/code&gt; literal; and the current value of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_authen}&lt;/code&gt; macro.&lt;/p&gt;

&lt;p&gt;If the authentication type is either &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DIGEST-MD5&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CRAM-MD5&lt;/code&gt; and if the
domain is in the class &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$=w&lt;/code&gt; (is a local hostname or address), the envelope
sender is allowed to relay.  But if the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_type}&lt;/code&gt; macro’s value is
empty (nothing was authenticated), or if the authentication was by an
untrusted mechanism, such as PLAIN, the envelope sender is not allowed to relay.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Policy Rule Set Reference&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Beginning with V8.8, &lt;em&gt;sendmail&lt;/em&gt; calls special rule sets internally to
determine its behavior.  Called the &lt;em&gt;policy rule sets&lt;/em&gt;, they are used for
such varied tasks as setting spam handling, setting policy, or validating
the conditions when ETRN should be allowed, to list just a few.
Table below shows the complete list of these policy rule sets.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;The policy rule sets table&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+--------------+-------------------+------------------------------------------------------+
| Rule set     | Hook              | Description                                          |
+--------------+-------------------+------------------------------------------------------+
| authinfo     | None              | Handle AuthInfo: lookups in the access database.     |
+--------------+-------------------+------------------------------------------------------+
| check_compat | See below         | Validate just before delivery.                       |
+--------------+-------------------+------------------------------------------------------+
| check_data   | None needed       | Check just after DATA.                               | 
+--------------+-------------------+------------------------------------------------------+
| check_eoh    | None needed       | Validate after headers are read.                     |
+--------------+-------------------+------------------------------------------------------+
| check_eom    | None needed       | Review message&apos;s size (V8.13 and later).             |
+--------------+-------------------+------------------------------------------------------+
| check_etrn   | None needed       | Allow or disallow ETRN.                              |
+--------------+-------------------+------------------------------------------------------+
| check_expn   | None needed       | Validate EXPN.                                       |
+--------------+-------------------+------------------------------------------------------+
| check_mail   | Local_check_mail  | Validate the envelope-sender address.                | 
+--------------+-------------------+------------------------------------------------------+
| check_rcpt   | Local_check_rcpt  | Validate the envelope-recipient address.             | 
+--------------+-------------------+------------------------------------------------------+
| check_relay  | Local_check_relay | Validate incoming network connections.               |
+--------------+-------------------+------------------------------------------------------+
| check_vrfy   | None needed       | Validate VRFY.                                       |
+--------------+-------------------+------------------------------------------------------+
| queuegroup   | See below         | Select a queue group.                                |
+--------------+-------------------+------------------------------------------------------+
| srv_features | None needed       | Tune server setting based on connection information. | 
+--------------+-------------------+------------------------------------------------------+
| tls_client   | LOCAL_TLS_CLIENT  | With the access database, validate inbound STARTTLS  |
|              |                   | or MAIL From: SMTP command.                          |
+--------------+-------------------+------------------------------------------------------+
| tls_rcpt     | LOCAL_TLS_RCPT    | Validate a server&apos;s credentials based on the         |
|              |                   | recipient address.                                   |
+--------------+-------------------+------------------------------------------------------+
| tls_server   | LOCAL_TLS_SERVER  | Possibly with the access database, validate the      |
|              |                   | inbound and outbound connections.                    |
+--------------+-------------------+------------------------------------------------------+
| trust_auth   | Local_trust_auth  | Validate that a client&apos;s authentication              |
|              |                   | identifier (authid) is trusted to act as (proxy for) |
|              |                   | the requested authorization identity (userid).       |
+--------------+-------------------+------------------------------------------------------+
| try_tls      | LOCAL_TRY_TLS     | Disable STARTTLS for selected outbound connected-to  |
|              |                   | hosts.                                               |
+--------------+-------------------+------------------------------------------------------+
| Hname:$      | n/a               | Reject, discard, or accept a message based on a      |
|              |                   | header&apos;s value.                                      |
+--------------+-------------------+------------------------------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that some of these rule sets are omitted from your configuration file
by default.  For those, no hook is needed. You merely declare the rule set
in your &lt;em&gt;mc&lt;/em&gt; file and give it appropriate rules:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;LOCAL_RULESETS
Scheck_vrfy
... &amp;lt;your rules here&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Those with a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local_&lt;/code&gt; hook, as shown in the table, are declared
&lt;strong&gt;by default&lt;/strong&gt; in your configuration file.  To use them yourself, you need
only declare them with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local_&lt;/code&gt; hook indicated:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;LOCAL_RULESETS
SLocal_check_rcpt
... &amp;lt;your rules here&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Those with a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LOCAL_&lt;/code&gt; hook, as shown in the table, are &lt;strong&gt;declared directly
with that hook&lt;/strong&gt;.  There in no need to precede the hook with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LOCAL_RULESETS&lt;/code&gt;.
For example:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;LOCAL_TRY_TLS
... &amp;lt;your rules here&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The two &lt;strong&gt;exceptions&lt;/strong&gt; are the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;check_compat&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;queuegroup&lt;/code&gt; rule sets.
Each is automatically declared when you use the corresponding
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FEATURE(check_compat)&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FEATURE(queuegroup)&lt;/code&gt;, but not declared if you
don’t use that feature.&lt;/p&gt;

&lt;p&gt;All of these rule sets are handled in the same manner.  If the rule set
does not exist, the action is permitted.  If the rule set returns anything
other than a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#error&lt;/code&gt; or a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#discard&lt;/code&gt; delivery agent, the message, identity,
or action is accepted for that rule set (although it can still be rejected
or discarded by another rule set).  Otherwise, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#error&lt;/code&gt; delivery agent
causes the message, identity, or action to be rejected and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#discard&lt;/code&gt;
delivery agent causes the message to be accepted, then discarded.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;${auth_authen} Macro&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;RFC2554 AUTH credentials, &lt;em&gt;sendmail&lt;/em&gt; V8.10 and later.&lt;/p&gt;

&lt;p&gt;A server offers authentication by presenting the AUTH keyword to the
connecting site, following that with the types of mechanisms supported:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;250-host.domain Hello some.domain, pleased to meet you
250-ENHANCEDSTATUSCODES
250-PIPELINING
250-8BITMIME
250-SIZE
250-DSN
250-ETRN
250-AUTH DIGEST-MD5 CRAM-MD5
250-DELIVERBY
250 HELP
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note the line &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;250-AUTH DIGEST-MD5 CRAM-MD5&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;If the connecting site wishes to authenticate itself, it replies with an
AUTH command indicating the type of mechanism preferred:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;AUTH X5                                                           ← client sends
504 Unrecognized authentication type.                             ← server replies
AUTH CRAM-MD5                                                     ← client sends
334  PENCeUxFREJoU0NnbmhNWitOMjNGNndAZWx3b29kLmlubm9zb2Z0LmNvbT4= ← server replies
ZnJlZCA5ZTk1YWVlMDljNDBhZjJiODRhMGMyYjNiYmFlNzg2ZQ=  =            ← client sends
235 Authentication successful.          
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here, the client first asks for X5 authentication, which the server rejects.
The client next asks for CRAM-MD5.  The server says it can support that by
replying with a 334 followed by a challenge string.  The client replies to
the challenge with an appropriate reply string, and the authentication is
successful (as shown in the last line).&lt;/p&gt;

&lt;p&gt;If authentication is successful, this &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_authen}&lt;/code&gt; macro is assigned
the authentication credentials that were approved as its value.  The form
of the credentials depends on the encryption used.  It could be a simple
username (such as &lt;em&gt;bob&lt;/em&gt;) or a username at a realm (such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bob@some.domain&lt;/code&gt;).&lt;/p&gt;

&lt;p&gt;The client can then offer a different user, rather than the envelope sender,
to authenticate on behalf of the envelope sender.  This is done by adding
an AUTH= parameter to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL From:&lt;/code&gt; keyword:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;MAIL From: &amp;lt;user@host.domain&amp;gt; AUTH=address
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;em&gt;address&lt;/em&gt; is assigned to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;{auth_author}&lt;/code&gt; macro, and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;trust_auth&lt;/code&gt;
rule set is called to make further policy decisions, with the AUTH= parameter
in its workspace.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_authen}&lt;/code&gt; macro is useful for adding your own rules to the
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local_trust_auth&lt;/code&gt; rule set.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_authen}&lt;/code&gt; is transient.  If defined in the configuration file or in
the command line, that definition can be ignored by &lt;em&gt;sendmail&lt;/em&gt;.  Note that
a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$&amp;amp;&lt;/code&gt; prefix is necessary when you reference this macro in rules (that is,
use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$&amp;amp;{auth_authen}&lt;/code&gt;, not &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_authen}&lt;/code&gt;).&lt;/p&gt;

&lt;p&gt;Note that, beginning with V8.13, the value to be stored into this macro is
first xtext encoded, then stored (Macro Xtext Translations
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 17 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;${auth_author} Macro&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;RFC2554 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH=&lt;/code&gt; parameter, &lt;em&gt;sendmail&lt;/em&gt; V8.10 and later.&lt;/p&gt;

&lt;p&gt;As part of the RFC2554 authentication scheme, a client can ask whether
a user other than the envelope sender is allowed to authenticate on behalf
of the envelope sender.  This is done by adding an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH=&lt;/code&gt; parameter to the
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL From:&lt;/code&gt; keyword:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;MAIL From: &amp;lt;user@host.domain&amp;gt; AUTH=address
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_author}&lt;/code&gt; macro is assigned the &lt;em&gt;address&lt;/em&gt; that followed the
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL From:&lt;/code&gt; AUTH= extension.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_author}&lt;/code&gt; macro is useful for adding your own rules to the
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local_trust_auth&lt;/code&gt; rule set.&lt;br /&gt;
Note that a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$&amp;amp;&lt;/code&gt; prefix is necessary when you reference this macro in rules
(that is, use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$&amp;amp;{auth_author}&lt;/code&gt;, not &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_author}&lt;/code&gt;).&lt;/p&gt;

&lt;p&gt;Note that beginning with V8.13, the value to be stored into this
macro is first xtext-encoded, then stored (Macro Xtext Translations
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 17 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt;).&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_author}&lt;/code&gt; is transient.  If defined in the configuration file or in
the command line, that definition can be ignored by &lt;em&gt;sendmail&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;${auth_type} Macro&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Authentication mechanism used, &lt;em&gt;sendmail&lt;/em&gt; V8.10 and later.&lt;/p&gt;

&lt;p&gt;A server offers authentication by presenting the AUTH keyword to
the connecting site, following that with the types of authentication
mechanisms supported:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;250-host.domain Hello some.domain, pleased to meet you
250-ENHANCEDSTATUSCODES
250-PIPELINING
250-8BITMIME
250-SIZE
250-DSN
250-ETRN
250-AUTH DIGEST-MD5 CRAM-MD5
250-DELIVERBY
250 HELP
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note the line &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;250-AUTH DIGEST-MD5 CRAM-MD5&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;If the connecting site wishes to authenticate itself, it replies with
an AUTH command indicating the mechanism preferred:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;AUTH CRAM-MD5                                 ← client sends
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Once it is selected, that mechanism is placed into this &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_type}&lt;/code&gt; macro.
If no mechanism is selected (none is offered, or none is accepted) or if the
act of authentication fails, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_type}&lt;/code&gt; becomes undefined (NULL).&lt;/p&gt;

&lt;p&gt;If the authentication is accepted, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Received:&lt;/code&gt; header is updated to reflect that:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;HReceived: $?sfrom $s $.$?_($?s$|from $.$_)
        $.$?{auth_type}(authenticated$?{auth_ssf} bits=${auth_ssf}$.)
        $.by $j ($v/$Z)$?r with $r$. id $i$?{tls_version}
        (version=${tls_version} cipher=${cipher} bits=${cipher_bits}
verify=${verify})$.$?u
        for $u; $|;
        $.$b
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here, if the connection were authenticated, the second line of the
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Received:&lt;/code&gt; header would look like this:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(authenticated bits=bits)
(authenticated)                       ← if no encryption negotiated
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_type}&lt;/code&gt; macro is useful for adding your own rules to
policy rule sets, such as to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Local_trust_auth&lt;/code&gt; rule set.
Note that a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$&amp;amp;&lt;/code&gt; prefix is necessary when you reference this macro
in rules (that is, use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$&amp;amp;{auth_type}&lt;/code&gt;, not &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_type}&lt;/code&gt;).&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;${auth_type}&lt;/code&gt; is transient.  If defined in the configuration file or in
the command line, that definition can be ignored by &lt;em&gt;sendmail&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[ 17 ]&lt;/strong&gt; Macro Xtext Translations&lt;/p&gt;

&lt;p&gt;Some macros are assigned values from text that is supplied by outside
connecting hosts.  Such text cannot necessarily be trusted in rule sets,
or as keys in database-map lookups.&lt;/p&gt;

&lt;p&gt;To protect itself, &lt;em&gt;sendmail&lt;/em&gt; modifies such text by translating whitespace
characters (spaces and tabs), nonprinting characters (such as newlines and
control characters), and the following list of special characters:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt; &amp;gt; ( ) &quot; +
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;em&gt;Translation&lt;/em&gt; is the replacement of each special character with its
corresponding hexadecimal value (based on U.S. ASCII), where each new
hexadecimal value is prefixed with a &lt;strong&gt;plus character&lt;/strong&gt;. (This is also
called &lt;em&gt;xtext&lt;/em&gt; translation and is documented in RFC1891.)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(some text)        becomes  →   +28some+20text+29
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Only six macros are subject to this encoding at this time.  They are listed
in the table below.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Macros subject to xtext encoding&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+-----------------+---------------------------------------------------------------+
| Macro           | Description                                                   |
+-----------------+---------------------------------------------------------------+
| ${auth_authen}  | RFC2554 AUTH credentials (xtext encoded with V8.13 and later) |
+-----------------+---------------------------------------------------------------+
| ${auth_author}  | RFC2554 AUTH= parameter (xtext encoded with V8.13 and later)  |
+-----------------+---------------------------------------------------------------+
| ${cert_issuer}  | Distinguished name of certificate signer                      |
+-----------------+---------------------------------------------------------------+
| ${cert_subject} | Distinguished name of certificate (owner)                     |
+-----------------+---------------------------------------------------------------+
| ${cn_issuer}    | Common name of certificate signer                             |
+-----------------+---------------------------------------------------------------+
| ${cn_subject}   | Common name of certificate                                    |
+-----------------+---------------------------------------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;[ 18 ]&lt;/strong&gt; SMTP Basic Commands
(From &lt;em&gt;Postfix&lt;/em&gt; by Richard Blum, 
Published By: Sams, Publication Date: May 2001):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+---------+----------------------------------------------------------------------+
| Command | Description                                                          |
+---------+----------------------------------------------------------------------+
| HELO    | Opening greeting from client                                         |
+---------+----------------------------------------------------------------------+
| MAIL    | Identifies sender of message                                         |
+---------+----------------------------------------------------------------------+
| RCPT    | Identifies recipient(s)                                              |
+---------+----------------------------------------------------------------------+
| DATA    | Identifies start of message                                          |
+---------+----------------------------------------------------------------------+
| SEND    | Sends message to terminal(s)                                         |
+---------+----------------------------------------------------------------------+
| SOML    | Send-or-Mail; sends message to mailbox or terminal of recipient(s)   |
+---------+----------------------------------------------------------------------+
| SAML    | Send-and-Mail; sends message to mailbox and terminal of recipient(s) |
+---------+----------------------------------------------------------------------+
| RSET    | Reset; aborts SMTP connection and discards information               |
+---------+----------------------------------------------------------------------+
| VRFY    | Verifies that username exists on server                              |
+---------+----------------------------------------------------------------------+
| EXPN    | Verifies that mailing list exists on server                          |
+---------+----------------------------------------------------------------------+
| HELP    | Requests list of commands                                            |
+---------+----------------------------------------------------------------------+
| NOOP    | No operation; only elicits an &quot;OK&quot; from server                       |
+---------+----------------------------------------------------------------------+
| QUIT    | Ends the SMTP session                                                |
+---------+----------------------------------------------------------------------+
| TURN    | Requests that the systems reverse their current SMTP roles           |
+---------+----------------------------------------------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;HELO Command&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This is not a typo.  By definition, SMTP commands are four characters long,
thus the opening greeting by the client to the server is the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HELO&lt;/code&gt; command.
The format for this command is&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HELO hostname&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The purpose of the HELO command is for the client to identify itself to
the SMTP server.  The client can identify itself as whatever it wants to
use in the text string.  Most SMTP servers use this command just as
a formality.  If they really need to know the identity of the client,
they try to use a reverse DNS lookup of the client’s IP address to
determine the client’s DNS name.  For security reasons, many SMTP servers
refuse to talk to hosts whose IP address does not resolve to a proper
DNS hostname.&lt;/p&gt;

&lt;p&gt;By sending the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HELO&lt;/code&gt; command, the client indicates that it wants to
initialize a new SMTP session with the server.  By responding to this
command, the server acknowledges the new connection and should be ready
to receive further commands from the client.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  &lt;em&gt;About people clients versus host clients&lt;/em&gt;  &lt;br /&gt;
In SMTP you must remember to differentiate between people and hosts.
When creating a new mail message, the email user is the client of his
local host.  Once the user sends his message, s/he is no longer the client
in the SMTP process.  His/her local host computer takes over the process of
mailing the message and now becomes the client as far as SMTP is concerned.
When the local host contacts the remote host to transfer the message
using SMTP, it is now acting as the client in the SMTP process.
The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HELO&lt;/code&gt; command identifies the local hostname as the client, not the
actual sender of the message.  This terminology often gets confusing.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;MAIL Command&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL&lt;/code&gt; command initiates a mail session with the server after the
initial &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HELO&lt;/code&gt; command is sent.  It identifies from whom the message is
being sent. The format of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL&lt;/code&gt; command is&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL reverse-path&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;reverse-path&lt;/code&gt; argument not only identifies the sender, but it also
identifies how to reach the sender with a return message.  If the sender
were a user on the client computer that initiated the SMTP session,
the format for the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL&lt;/code&gt; command would look something like this:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL FROM:username@example.domain.net&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Notice how the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FROM&lt;/code&gt; section denotes the proper email address for the
sender of the message, including the fully qualified hostname of the client
computer.  This information should appear in the text of the email message
in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FROM&lt;/code&gt; section.  If the email message has been routed through several
different systems between the original sender and the desired recipient,
each system adds its routing information to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;reverse-path&lt;/code&gt; section.
This documents the path that the email message traversed to get to the server.&lt;/p&gt;

&lt;p&gt;Often, mail from clients on private networks has to traverse several mail
relay points before getting to the Internet.  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;reverse-path&lt;/code&gt; information
is often useful in troubleshooting email problems or in tracking down
senders who are purposely trying to hide their identity by bouncing their
email messages off of several unknowing SMTP servers.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;RCPT Command&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCPT&lt;/code&gt; command identifies the intended recipient of the message.
In order to deliver the same message to multiple recipients, each recipient
must be listed in a separate &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCPT&lt;/code&gt; command line. The format of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCPT&lt;/code&gt;
command is&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCPT forward-path&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;forward-path&lt;/code&gt; argument defines where the email is ultimately destined.
This is usually a fully qualified email address but could be just a username
that is local to the SMTP server.  For example, the following RCPT command&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCPT TO:haley&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;would send the message to user &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;haley&lt;/code&gt; on the local SMTP server that is
processing the message.&lt;/p&gt;

&lt;p&gt;The protocol also allows messages to be relayed; that is, sent to users on
computer systems other than the server currently handling the SMTP connection.&lt;/p&gt;

&lt;p&gt;For example, sending the following &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCPT&lt;/code&gt; command&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCPT TO:riley@example.domain.net&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;to the SMTP server on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shadrach.domain.net&lt;/code&gt; would cause &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shadrach.domain.net&lt;/code&gt;
to make a decision.  Since the recipient is not local to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shadrach&lt;/code&gt;, it must
decide what to do with the message.  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shadrach&lt;/code&gt; could take three possible
actions with the message:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shadrach&lt;/code&gt; could accept the message for later forwarding to the specified
destination and return an OK response to the client.  In this scenario,
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shadrach&lt;/code&gt; would prepend its hostname to the message’s &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;reverse-path&amp;gt;&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shadrach&lt;/code&gt; could refuse to forward the message but could reply to the
client that it would not deliver the message.  The response could also verify
that the address of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;example.domain.net&lt;/code&gt; was a correct address for another
server.  Then the client could try to resend the message directly to
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;example.domain.net&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shadrach&lt;/code&gt; could refuse to forward the message and could reply to the
client that this operation (relaying) is not permitted from this server.
It would be up to the system administrator at the client to figure out
what happened and why.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In the early days of the Internet, it was common to run across computers
that used the first scenario and blindly forwarded email messages across
the world.  Unfortunately, that courteous behavior was exploited by email
&lt;em&gt;spammers&lt;/em&gt;, people who do mass mailings across the Internet for either fun
or profit.  Spammers often use unsuspecting, unsecured SMTP servers that
blindly forward email messages in an attempt to disguise the origin of their
mail messages.  To combat this situation, most mail system administrators
have either completely turned off mail relaying or have at least limited
it to hosts within their domain.  Many ISPs allow their customers to relay
email from their mail server but restrict outside computers from that privilege.&lt;/p&gt;

&lt;p&gt;In the case of multiple recipients, it is up to the client how to handle
situations in which some of the recipients are not allowed by the server.
Some clients abort the entire message and return an error to the sending
user.  Some continue sending the message to the recipients that are
acknowledged and list the recipients that aren’t acknowledged in a return
message.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;DATA Command&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;After the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCPT&lt;/code&gt; commands are worked out, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DATA&lt;/code&gt; command
initiates the actual message transfer.  The format of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DATA&lt;/code&gt; command is&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DATA&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Anything that appears after the command is treated as part of the message
being transferred.  Usually the SMTP server adds a timestamp and
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;return-path&lt;/code&gt; information to the head of the message.  The client indicates
the end of the message by sending a line with just &lt;strong&gt;a single period&lt;/strong&gt;.
The format for that line is&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;CR&amp;gt;&amp;lt;LF&amp;gt;.&amp;lt;CR&amp;gt;&amp;lt;LF&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When the SMTP server receives this sequence, it knows that the message
transmission is done and should return a response code to the client
indicating whether the message has been accepted.&lt;/p&gt;

&lt;p&gt;Technically there is no wrong way to send a message, although work has been
done to standardize a method (see the “Message Format”
&lt;strong&gt;[&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt; 19 &lt;/a&gt;&lt;/sup&gt;]&lt;/strong&gt; in Footnotes).  Any combination of
valid ASCII characters is transferred to the specified recipients.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;RSET Command&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RSET&lt;/code&gt; command is short for reset.  If the client somehow gets confused
by the responses from the server or thinks that the SMTP connection has
gotten out of sync, it can issue the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RSET&lt;/code&gt; command to return the connection to the HELO command state. Of course, all MAIL, RCPT, and DATA information already entered is lost. Often this is used as a last-ditch effort when the client either has lost track of where it was in the command series or did not expect a particular response from the server.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;HELP Command&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HELP&lt;/code&gt; command asks the server to return useful information to
the client.  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HELP&lt;/code&gt; with no arguments returns a list of SMTP commands
that the SMTP server understands.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ telnet localhost 25
Trying 127.0.0.1...
Connected to localhost.
Escape character is &apos;^]&apos;.
220 fbsd1.home.arpa ESMTP Sendmail 8.17.1/8.17.1; Sat, 12 Nov 2022 19:12:14 -0800 (PST)
HELP
214-2.0.0 This is sendmail version 8.17.1
214-2.0.0 Topics:
214-2.0.0       HELO    EHLO    MAIL    RCPT    DATA
214-2.0.0       RSET    NOOP    QUIT    HELP    VRFY
214-2.0.0       EXPN    VERB    ETRN    DSN     AUTH
214-2.0.0       STARTTLS
214-2.0.0 For more info use &quot;HELP &amp;lt;topic&amp;gt;&quot;.
214-2.0.0 To report bugs in the implementation see
214-2.0.0       http://www.sendmail.org/email-addresses.html
214-2.0.0 For local information send email to Postmaster at your site.
214 2.0.0 End of HELP info
QUIT
221 2.0.0 fbsd1.home.arpa closing connection
Connection closed by foreign host.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOOP Command&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NOOP&lt;/code&gt; command is short for &lt;em&gt;no operation&lt;/em&gt;.  This command has no effect
on the SMTP server other than making it return a positive response code.
This is often a useful command to send to test connectivity without actually
starting the message transfer process.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;QUIT Command&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;QUIT&lt;/code&gt; command indicates that the client computer is finished with the
current SMTP session and wants to close the connection.  It is the
responsibility of the SMTP server to respond to this command and to initiate
the closing of the TCP connection.  If the server receives a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;QUIT&lt;/code&gt; command
in the middle of an email transaction, any data previously transferred will
be deleted and not sent to any recipients.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Extended SMTP&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Since SMTP invention in 1982, system administrators began to recognize
its limitations.  Work was done to try and improve the basic SMTP protocol
by keeping the original specifications and adding new features.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc1869&quot;&gt;RFC 1869, SMTP Service Extensions&lt;/a&gt;
was published in 1995 and defined a method of extending the capabilities of SMTP.&lt;/p&gt;

&lt;p&gt;Extended SMTP (ESMTP) replaces the original SMTP greeting (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HELO&lt;/code&gt;) with
a new greeting command: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EHLO&lt;/code&gt;.  When an ESMTP server receives this command,
it should realize that the client is capable of sending extended SMTP commands.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ telnet localhost 25
Trying 127.0.0.1...
Connected to localhost.
Escape character is &apos;^]&apos;.
220 fbsd1.home.arpa ESMTP Sendmail 8.17.1/8.17.1; Sat, 12 Nov 2022 19:28:44 -0800 (PST)
EHLO localhost
250-fbsd1.home.arpa Hello localhost [127.0.0.1], pleased to meet you
250-ENHANCEDSTATUSCODES
250-PIPELINING
250-8BITMIME
250-SIZE
250-DSN
250-ETRN
250-AUTH DIGEST-MD5 CRAM-MD5 LOGIN PLAIN
250-STARTTLS
250-DELIVERBY
250 HELP
HELP DSN
214-2.0.0 MAIL From:&amp;lt;sender&amp;gt; [ RET={ FULL | HDRS} ] [ ENVID=&amp;lt;envid&amp;gt; ]
214-2.0.0 RCPT To:&amp;lt;recipient&amp;gt; [ NOTIFY={NEVER,SUCCESS,FAILURE,DELAY} ]
214-2.0.0                    [ ORCPT=&amp;lt;recipient&amp;gt; ]
214-2.0.0       SMTP Delivery Status Notifications.
214-2.0.0 Descriptions:
214-2.0.0       RET     Return either the full message or only headers.
214-2.0.0       ENVID   Sender&apos;s &quot;envelope identifier&quot; for tracking.
214-2.0.0       NOTIFY  When to send a DSN. Multiple options are OK, comma-
214-2.0.0               delimited. NEVER must appear by itself.
214-2.0.0       ORCPT   Original recipient.
214 2.0.0 End of HELP info
HELP ETRN
214-2.0.0 ETRN [ &amp;lt;hostname&amp;gt; | @&amp;lt;domain&amp;gt; | #&amp;lt;queuename&amp;gt; ]
214-2.0.0       Run the queue for the specified &amp;lt;hostname&amp;gt;, or
214-2.0.0       all hosts within a given &amp;lt;domain&amp;gt;, or a specially-named
214-2.0.0       &amp;lt;queuename&amp;gt; (implementation-specific).
214 2.0.0 End of HELP info
QUIT
221 2.0.0 fbsd1.home.arpa closing connection
Connection closed by foreign host.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Notice that the server indicates that some additional commands are
available now that it is in “extended” mode. One of the new groups
of commands is the Delivery Status Notification (DSN) options.
These options can be used on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCPT&lt;/code&gt; commands to indicate
the delivery status of a particular email message for the client.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;The ETRN Command&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ETRN&lt;/code&gt; command allows an SMTP client to issue a request for the SMTP
server to initiate another SMTP connection with the client to transfer
messages back to it.  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ETRN&lt;/code&gt; command is a request to start another
SMTP session.  This way, the SMTP server can contact the client using the
normal DNS hostname resolution methods.  This does not rely on who the
client says it is.  If a malicious actor establishes an unauthorized SMTP
connection and issues an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ETRN&lt;/code&gt; command, the SMTP server just starts a new
SMTP connection with the real client and sends any mail - no harm done.&lt;/p&gt;

&lt;p&gt;The format for the ETRN command is&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ETRN name&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;where &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;name&lt;/code&gt; can be either an individual hostname or a domain name if you
are requesting mail for an entire domain.  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ETRN&lt;/code&gt; command is a valuable
tool for the mail administrator.  If you elect to have an ISP spool mail
for your email server, you might use this method to notify the ISP when
you are ready to receive your spooled mail.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;The AUTH Command&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Another extended SMTP command gaining popularity is the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH&lt;/code&gt; command,
which allows an SMTP client to identify itself to the SMTP server with
a username and password pair or other agreed-upon authentication technique.
Once the client is positively identified by the server, it may be allowed
to perform special functions, such as using the server as a mail relay,
which non-authenticated clients would not be allowed to do.&lt;/p&gt;

&lt;p&gt;The Cyrus-SASL package is a popular software package that can be used to
provide SMTP &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AUTH&lt;/code&gt; command support for many MTA packages.
The mail administrator must maintain a separate username and password
database that allows authentication of remote SMTP clients.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[ 19 ]&lt;/strong&gt; Message Format - Standard RFC 822 Header Fields&lt;/p&gt;

&lt;p&gt;RFC 822 specifies splitting the message into two separate parts.
The first part is called the &lt;em&gt;header&lt;/em&gt;.  Its job is to store information
about the message.  The second part is the &lt;em&gt;body&lt;/em&gt; of the message.
The header consists of data fields that can be used whenever additional
information is needed in the message.  The header fields should appear
before the text body of the message and should be separated by
&lt;strong&gt;one blank line&lt;/strong&gt;.  Header fields do not need to appear in any particular
order, and the message can have multiple occurrences of any header field
(though this is deprecated).  Below is how a basic RFC 822-compliant
message would look.&lt;/p&gt;

&lt;p&gt;RFC 822-compliant email message&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;RFC 822-compliant email message 
+-----------------------------+
| RFC 822 Header              |
| +-------------------------+ |
| | Received:               | |
| | Return-Path:            | |
| | Reply-To:               | |
| | From:                   | |
| | Date:                   | |
| | To:                     | |
| +-------------------------+ |
|                             |  
| Message Body                |
| +-------------------------+ |
| |                         | |
| |                         | |
| |                         | |
| |                         | |
| |                         | |
| |                         | |
| +-------------------------+ |
+-----------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc822#section-4&quot;&gt;RFC 822 - Standard for the Format of ARPA Internet Text Messages&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;     4.  MESSAGE SPECIFICATION
     
     4.1.  SYNTAX
     
     Note:  Due to an artifact of the notational conventions, the syn-
            tax  indicates that, when present, some fields, must be in
            a particular order.  Header fields  are  NOT  required  to
            occur  in  any  particular  order, except that the message
            body must occur AFTER  the  headers.   It  is  recommended
            that,  if  present,  headers be sent in the order &quot;Return-
            Path&quot;, &quot;Received&quot;, &quot;Date&quot;,  &quot;From&quot;,  &quot;Subject&quot;,  &quot;Sender&quot;,
            &quot;To&quot;, &quot;cc&quot;, etc.
     
            This specification permits multiple  occurrences  of  most
            fields.   Except  as  noted,  their  interpretation is not
            specified here, and their use is discouraged.

[ . . . ]

     4.4.  ORIGINATOR FIELDS
     
          The standard allows only a subset of the combinations possi-
     ble  with the From, Sender, Reply-To, Resent-From, Resent-Sender,
     and Resent-Reply-To fields.  The limitation is intentional.
     
     4.4.1.  FROM / RESENT-FROM
     
        This field contains the identity of the person(s)  who  wished
        this  message to be sent.  The message-creation process should
        default this field  to  be  a  single,  authenticated  machine
        address,  indicating  the  AGENT  (person,  system or process)
        entering the message.  If this is not done, the &quot;Sender&quot; field
        MUST  be  present.  If the &quot;From&quot; field IS defaulted this way,
        the &quot;Sender&quot; field is  optional  and  is  redundant  with  the
        &quot;From&quot;  field.   In  all  cases, addresses in the &quot;From&quot; field
        must be machine-usable (addr-specs) and may not contain  named
        lists (groups).

     4.4.2.  SENDER / RESENT-SENDER
     
        This field contains the authenticated identity  of  the  AGENT
        (person,  system  or  process)  that sends the message.  It is
        intended for use when the sender is not the author of the mes-
        sage,  or  to  indicate  who among a group of authors actually
        sent the message.  If the contents of the &quot;Sender&quot; field would
        be  completely  redundant  with  the  &quot;From&quot;  field,  then the
        &quot;Sender&quot; field need not be present and its use is  discouraged
        (though  still legal).  In particular, the &quot;Sender&quot; field MUST
        be present if it is NOT the same as the &quot;From&quot; Field.

[ . . . ]

     4.5.  RECEIVER FIELDS
     
     4.5.1.  TO / RESENT-TO
     
        This field contains the identity of the primary recipients  of
        the message.

[ . . . ]

     4.6.  REFERENCE FIELDS
     
     4.6.1.  MESSAGE-ID / RESENT-MESSAGE-ID
     
             This field contains a unique identifier  (the  local-part
        address  unit)  which  refers to THIS version of THIS message.
        The uniqueness of the message identifier is guaranteed by  the
        host  which  generates  it.  This identifier is intended to be
        machine readable and not necessarily meaningful to humans.   A
        message  identifier pertains to exactly one instantiation of a
        particular message; subsequent revisions to the message should
        each receive new message identifiers. 

[ . . . ]

     4.6.3.  REFERENCES
     
             The contents of this field identify other  correspondence
        which  this message references.  Note that if message identif-
        iers are used, they must use the msg-id specification format.

[ . . . ]

     4.7.  OTHER FIELDS
     
     4.7.1.  SUBJECT
     
             This is intended to provide a summary,  or  indicate  the
        nature, of the message.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc2822&quot;&gt;RFC 2822 - Internet Message Format&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;2.1.1. Line Length Limits

   There are two limits that this standard places on the number of
   characters in a line.  Each line of characters MUST be no more than
   998 characters, and SHOULD be no more than 78 characters, excluding
   the CRLF.

[ . . . ]

2.3. Body

   The body of a message is simply lines of US-ASCII characters.  The
   only two limitations on the body are as follows:

   - CR and LF MUST only occur together as CRLF; they MUST NOT appear
     independently in the body.

   - Lines of characters in the body MUST be limited to 998 characters,
     and SHOULD be limited to 78 characters, excluding the CRLF.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Required header fields:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;3.6. Field definitions

[ . . . ]

   The only required header fields are the origination date field and
   the originator address field(s).  All other header fields are
   syntactically optional.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;[ 20 ]&lt;/strong&gt; About the proper format of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MAIL FROM:&lt;/code&gt; SMTP command.&lt;/p&gt;

&lt;p&gt;From &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc821#page-3&quot;&gt;RFC 821 - Simple Mail Transfer Protocol (SMTP)&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Commands and replies are composed of characters from the ASCII
character set [1].  When the transport service provides an 8-bit byte
(octet) transmission channel, each 7-bit character is transmitted
right justified in an octet with the high order bit cleared to zero.

When specifying the general form of a command or reply, an argument
(or special symbol) will be denoted by a meta-linguistic variable (or
constant), for example, &quot;&amp;lt;string&amp;gt;&quot; or &quot;&amp;lt;reverse-path&amp;gt;&quot;.  Here the
angle brackets indicate these are meta-linguistic variables.

----

REFERENCES

   [1]  ASCII

      ASCII, &quot;USA Code for Information Interchange&quot;, United States of
      America Standards Institute, X3.4, 1968.  Also in:  Feinler, E.
      and J. Postel, eds., &quot;ARPANET Protocol Handbook&quot;, NIC 7104, for
      the Defense Communications Agency by SRI International, Menlo
      Park, California, Revised January 1978.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;However, some arguments use the angle brackets literally.  For
example, an actual reverse-path is enclosed in angle brackets, i.e.,
&quot;&amp;lt;John.Smith@USC-ISI.ARPA&amp;gt;&quot; is an instance of &amp;lt;reverse-path&amp;gt; (the
angle brackets are actually transmitted in the command or reply).
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc821#section-3&quot;&gt;RFC 821 - Simple Mail Transfer Protocol (SMTP)&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; 3.1.  MAIL

      There are three steps to SMTP mail transactions.  The transaction
      is started with a MAIL command which gives the sender
      identification.  A series of one or more RCPT commands follows
      giving the receiver information.  Then a DATA command gives the
      mail data.  And finally, the end of mail data indicator confirms
      the transaction.

         The first step in the procedure is the MAIL command.  The
         &amp;lt;reverse-path&amp;gt; contains the source mailbox.

            MAIL &amp;lt;SP&amp;gt; FROM:&amp;lt;reverse-path&amp;gt; &amp;lt;CRLF&amp;gt;

         This command tells the SMTP-receiver that a new mail
         transaction is starting and to reset all its state tables and
         buffers, including any recipients or mail data.  It gives the
         reverse-path which can be used to report errors.  If accepted,
         the receiver-SMTP returns a 250 OK reply.

[ . . . ]

The second step in the procedure is the RCPT command.

            RCPT &amp;lt;SP&amp;gt; TO:&amp;lt;forward-path&amp;gt; &amp;lt;CRLF&amp;gt;

         This command gives a forward-path identifying one recipient.
         If accepted, the receiver-SMTP returns a 250 OK reply, and
         stores the forward-path.  If the recipient is unknown the
         receiver-SMTP returns a 550 Failure reply.  This second step of
         the procedure can be repeated any number of times.

[ . . . ]

The third step in the procedure is the DATA command.

            DATA &amp;lt;CRLF&amp;gt;

         If accepted, the receiver-SMTP returns a 354 Intermediate reply
         and considers all succeeding lines to be the message text.
         When the end of text is received and stored the SMTP-receiver
         sends a 250 OK reply.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc2821#section-3.3&quot;&gt;RFC 2821 - Simple Mail Transfer Protocol (SMTP)&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;3.3 Mail Transactions
[ . . . ]

   The first step in the procedure is the MAIL command.

      MAIL FROM:&amp;lt;reverse-path&amp;gt; [SP &amp;lt;mail-parameters&amp;gt; ] &amp;lt;CRLF&amp;gt;

[ . . . ]

   . . .                     The &amp;lt;reverse-path&amp;gt; portion of the first or
   only argument contains the source mailbox (between &quot;&amp;lt;&quot; and &quot;&amp;gt;&quot;
   brackets) . . . 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc821&quot;&gt;RFC 821 - Simple Mail Transfer Protocol (SMTP)&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;4.  THE SMTP SPECIFICATIONS

   4.1.  SMTP COMMANDS

      4.1.1.  COMMAND SEMANTICS

         The SMTP commands define the mail transfer or the mail system
         function requested by the user.  SMTP commands are character
         strings terminated by &amp;lt;CRLF&amp;gt;.  The command codes themselves are
         alphabetic characters terminated by &amp;lt;SP&amp;gt; if parameters follow
         and &amp;lt;CRLF&amp;gt; otherwise.  The syntax of mailboxes must conform to
         receiver site conventions.  The SMTP commands are discussed
         below.  The SMTP replies are discussed in the Section 4.2.

[ . . . ]

         The last command in a session must be the QUIT command.  The
         QUIT command can not be used at any other time in a session.


  4.1.2.  COMMAND SYNTAX

         The commands consist of a command code followed by an argument
         field.  Command codes are four alphabetic characters.  Upper
         and lower case alphabetic characters are to be treated
         identically.  Thus, any of the following may represent the mail
         command:

            MAIL    Mail    mail    MaIl    mAIl

         This also applies to any symbols representing parameter values,
         such as &quot;TO&quot; or &quot;to&quot; for the forward-path.  Command codes and
         the argument fields are separated by one or more spaces.
         However, within the reverse-path and forward-path arguments
         case is important.  In particular, in some hosts the user
         &quot;smith&quot; is different from the user &quot;Smith&quot;.

         The argument field consists of a variable length character
         string ending with the character sequence &amp;lt;CRLF&amp;gt;.  The receiver
         is to take no action until this sequence is received.

[ . . . ]

         The syntax of the above argument fields (using BNF notation
         where applicable) is given below.  The &quot;...&quot; notation indicates
         that a field may be repeated one or more times.

[ . . . ]

            &amp;lt;CR&amp;gt; ::= the carriage return character (ASCII code 13)

            &amp;lt;LF&amp;gt; ::= the line feed character (ASCII code 10)

            &amp;lt;SP&amp;gt; ::= the space character (ASCII code 32)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;[ 21 ]&lt;/strong&gt; From the man page for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;s_client(1)&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  CONNECTED COMMANDS
         If a connection is established with an SSL server then any data
         received from the server is displayed and any key presses will be sent
         to the server. If end of file is reached then the connection will be
         closed down. When used interactively (which means neither -quiet nor
         -ign_eof have been given), then certain commands are also recognized
         which perform special operations. These commands are a letter which
         must appear at the start of a line. They are listed below.

[ . . . ]

         R   Renegotiate the SSL session (TLSv1.2 and below only).
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

</description>
        <pubDate>Sat, 12 Nov 2022 05:50:18 -0800</pubDate>
        <link>http://localhost:4000/sendmail/smtp/mta/mailserver/cli/terminal/shell/freebsd/sysadmin/reference/2022/11/12/sendmail-auth-client.html</link>
        <guid isPermaLink="true">http://localhost:4000/sendmail/smtp/mta/mailserver/cli/terminal/shell/freebsd/sysadmin/reference/2022/11/12/sendmail-auth-client.html</guid>
        
        
        <category>sendmail</category>
        
        <category>smtp</category>
        
        <category>mta</category>
        
        <category>mailserver</category>
        
        <category>cli</category>
        
        <category>terminal</category>
        
        <category>shell</category>
        
        <category>freebsd</category>
        
        <category>sysadmin</category>
        
        <category>reference</category>
        
      </item>
    
      <item>
        <title>Time Management with Graphviz</title>
        <description>&lt;p&gt;OS: FreeBSD 13, Shell: csh&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat timegraph.gv
/*
  Colours:
    green = done
    orange = in progress
    red = not started
 */ 

digraph timegraph
{

  /*
    Graphviz - FaqClusterEdge - How can I create edges between cluster
  boxes? http://www.graphviz.org/content/FaqClusterEdge
  */
  compound = true; 

  graph [newrank = true]; 
  node [fontsize=10, shape = box];
  splines = &quot;line&quot;; // Force edges to be straight, no curves or angles

  subgraph clusterToday 
  {
    label = &quot;Today&quot;;
    style = &quot;filled&quot;;
    color = &quot;#91cf60&quot;;

    &quot;Inspect HP server fans&quot;;
  }

  subgraph clusterTomorrow
  {
    label = &quot;Tomorrow&quot;;

    //{ rank = same; &quot;Email backupmap&quot; ; }
  }

  subgraph clusterWeek1
  {
    label = &quot;1st Week of Oct&quot;;
  }

  subgraph clusterWeek2
  {
    label = &quot;2nd Week of Oct&quot;;
  }

  subgraph clusterWeek3
  {
    label = &quot;3rd Week of Oct&quot;;

    CVM [label = &quot;Clone groups2 VM&quot;]; 
    SVM [label = &quot;Stop KVM VM&quot;, color = &quot;red&quot;];
    EXVM [label = &quot;Export KVM VM&quot;, color = &quot;red&quot;];

    /*
      Group these three nodes - to keep the edges straight.

      From Graphviz documentation:  Attributes - group:
        Name for a group of nodes, for bundling edges avoiding crossings.
        If the end points of an edge belong to the same group, i.e., have the 
        same group attribute, parameters are set to avoid crossings and keep 
        the edges straight.
    */
    CVRT [group = gConvert, label = &quot;Convert QCOW2 to VMDK image&quot;, color = &quot;red&quot;];
    CNO [group = gConvert, label = &quot;Reqeust a new org in VMware Cloud Director&quot;, color = &quot;orange&quot;];
    IMPIMG [group = gConvert, label = &quot;Import VMDK image in VMware Cloud Director&quot;, color = &quot;red&quot;];
  
    CVM -&amp;gt; SVM -&amp;gt; EXVM -&amp;gt; CVRT; 
    CVM -&amp;gt; CNO;
    CNO -&amp;gt; IMPIMG;

    CVRT -&amp;gt; IMPIMG;
  }

  subgraph clusterWeek4
  {
    label = &quot;4th Week of Oct&quot;;
    &quot;Install SSL certs&quot;;
    &quot;Email reviews to Jill&quot;;
  }

  subgraph clusterWeek5
  {
    label = &quot;5th Week of Oct&quot;;
    &quot;Install git&quot;;   
  }

  subgraph clusterFuture
  {
    label = &quot;Future&quot;;

    &quot;Clone NE1032T switch\n
     Install Nagios\n
     Configure an automation system\n
     Backup QCOW2 images for all VMs&quot;;
  }

  label = &quot;Updated on Oct 19, 2022&quot;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Command to generate diagram:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ dot -Tpng timemgraph.gv -o timemgraph.png 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Command to view the graph:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xv timegraph.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Command to generate diagram with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make(1)&lt;/code&gt; tool.&lt;/p&gt;

&lt;p&gt;First create the Makefile file.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;  Each of the lines with target in the Makefile must be
           preceded by a tab (in this case, lines with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dot&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rm&lt;/code&gt;,
           and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xv&lt;/code&gt; commands).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat Makefile
timegraph.png timegraph.pdf: timegraph.gv
	dot -Tpng timegraph.gv -o timegraph.png
	dot -Tpdf timegraph.gv -o timegraph.pdf
	xv timegraph.png
clean:
	rm -i *png *pdf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Use the make(1):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ make
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When you want to delete generated PDF and PNG files:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ make clean
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% xv timegraph.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/timegraph.png&quot; alt=&quot;Displaying a time management diagram png image created by Grapvhiz&quot; title=&quot;Displaying a time management diagram png image created by Grapvhiz&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; To see the image in full size in a web browser, right-click on it and select “Open Image in New Tab”.&lt;/p&gt;

&lt;h2 id=&quot;references&quot;&gt;References&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://zwischenzugs.com/2017/12/18/project-management-as-code-with-graphviz/&quot;&gt;Project Management as Code with Graphviz&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://news.ycombinator.com/item?id=15950325&quot;&gt;HackerNews Discussion&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/ianmiell/pm-as-code&quot;&gt;Graphviz Source Code&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.graphviz.org/documentation/TSE93.pdf&quot;&gt;A Technique for Drawing Directed Graphs&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Manpages for: make(1), style.Makefile(5) (on FreeBSD)&lt;/p&gt;

</description>
        <pubDate>Wed, 19 Oct 2022 08:03:09 -0700</pubDate>
        <link>http://localhost:4000/howto/diagram/graph/graphviz/plaintext/text/tex/latex/visualization/sysadmin/documentation/2022/10/19/timemanagement-graphviz.html</link>
        <guid isPermaLink="true">http://localhost:4000/howto/diagram/graph/graphviz/plaintext/text/tex/latex/visualization/sysadmin/documentation/2022/10/19/timemanagement-graphviz.html</guid>
        
        
        <category>howto</category>
        
        <category>diagram</category>
        
        <category>graph</category>
        
        <category>graphviz</category>
        
        <category>plaintext</category>
        
        <category>text</category>
        
        <category>tex</category>
        
        <category>latex</category>
        
        <category>visualization</category>
        
        <category>sysadmin</category>
        
        <category>documentation</category>
        
      </item>
    
      <item>
        <title>Using Graphviz Clusters</title>
        <description>&lt;p&gt;Host OS: FreeBSD 13, Shell: csh&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat backupmap.dot
/*
   Command to create the graph (when splines = &quot;line&quot;;): 
       dot -Tpng backupmap.dot -o backupmap.png

   Command to create the graph (when splines = &quot;ortho&quot;; in the dot file): 
       dot -Gsplines=none backupmap.dot | neato -n -Gsplines=ortho -Tpng -o backupmap.png
   ---&amp;gt; https://stackoverflow.com/questions/7922960/block-diagram-layout-with-dot-graphviz

   To view the graph:
   Install image viewer and cataloguer; for example:
       xv backupmap.png &amp;amp;
   Or: 
       feh backupmap.png &amp;amp;
*/

/*
  From:
    https://stackoverflow.com/questions/7586376/graphviz-subgraph-doesnt-get-visualized

  From the graphiz documentation, section &quot;Subgraphs and Clusters&quot;:

  The third role for subgraphs directly involves how the graph will be laid 
  out by certain layout engines.  

  From the graphviz documentation:
    https://graphviz.org/docs/attrs/cluster/

  If the name of the subgraph begins with &quot;cluster&quot;, Graphviz notes the 
  subgraph as a special cluster subgraph. 

  Alternatively, you can use
    cluster=true;
  within a cluster.
*/

digraph backupMap {
  /* 
     http://graphs.grevian.org/reference
     Used to influence the &apos;spring&apos; used in the layout. 
     Can be used to push nodes further apart, which is especially useful 
     for twopi and sfdp layouts
  */
  K = 0.6;
  
  /*
     Graphviz - FaqClusterEdge - How can I create edges between cluster boxes?
     http://www.graphviz.org/content/FaqClusterEdge
  */ 
  compound = true; 

  splines = &quot;line&quot;; // Force edges to be straight, no curves or angles
  //splines = &quot;ortho&quot;; 
  rankdir = &quot;LR&quot;;   // NOTE: rankdir can be used only once
  //rankdir = &quot;TB&quot;;
  graph [newrank = true]; 
  // To get the list of fonts:  fc-list
  node[fontname = &quot;Hermit-Bold&quot;, width = 1.5, height = 0.45, fontsize=9];
  nodesep = 0.14;

  /*  Subgraph Clusters
  
      Graphviz cluster alignment
        https://stackoverflow.com/questions/67295008/graphviz-cluster-alignment
  */

  subgraph clusterMain
  {
    style = &quot;dashed&quot;; 
    color = &quot;#625a5a&quot;;
    //peripheries = 0;  // To remove border around the cluster

    //label = &quot;MAIN CLUSTER&quot;;
    //graph[rankdir = &quot;LR&quot;];
    node [shape = box, style = filled, color = black, fillcolor = &quot;#91cf60&quot;];

    node [group = vert];
    a[group = g1, label = &quot;Servers&quot;];
    nfsServer [group = g1, label = &quot;NFS Servers&quot;]; 
    b[group = g1, label = &quot;Backup Destinations&quot;];

    // Added minlen in order to push the three &quot;Backup Destination&quot; clusters further away
    // NOTE:  This is the first  minlen; there&apos;s another one further below
    a -&amp;gt; nfsServer [minlen = 2.7, style = invis]; 
    nfsServer -&amp;gt; b [style = invis];
  }

  subgraph clusterA
  {
    color = &quot;#625a5a&quot;;
    node [shape = box, style = filled, color = black, fillcolor = &quot;#fee08b&quot;];
    peripheries = 0;  // To remove border around the cluster

    a15[label = &quot;redwood&quot;];
    a14[label = &quot;chestnut&quot;];
    a13[label = &quot;neon&quot;];
    a12[label = &quot;www&quot;];
    a11[label = &quot;xenon&quot;];
    a10[label = &quot;mail&quot;];
    a9[label  = &quot;mailx&quot;];
    a8[label  = &quot;groups&quot;];
    a7[label  = &quot;titanium&quot;];
    a6[label  = &quot;chemapps&quot;];
    a5[label  = &quot;wapps&quot;];
    a4[label  = &quot;www5&quot;];
    a3[label  = &quot;abacus&quot;];
    a2[label  = &quot;kvmhost3&quot;];
    a1[label  = &quot;ost&quot;];
  }

  {rank = same a -&amp;gt; {a1 a2 a3 a4 a5 a6 a7 a8 a9 a10 a11 a12 a13 a14 a15} [style = invis] };
  {rank = same b -&amp;gt; {LenovoDS2200 dcds1821 zfs} [ style = invis ] };  


  subgraph clusterBackupToLenovoSANds2200
  {
    //label = &quot;Backup Destination 1&quot;;
    label = &quot;                    &quot;;

    node [fillcolor = &quot;#F5F5F5&quot;, style = filled, shape = &quot;rectangle&quot;]; 

    /*
      Group these two nodes - to keep the edges straight.

      From Graphviz documentation:  Attributes - group:

        Name for a group of nodes, for bundling edges avoiding crossings.

        If the end points of an edge belong to the same group, i.e., have the 
        same group attribute, parameters are set to avoid crossings and keep 
        the edges straight.
    */
    kvmhost2 [group = gLenovoSAN, height = 0.10];
    LenovoDS2200 [group = gLenovoSAN, penwidth=5.0, shape = &quot;cylinder&quot;, label = &quot;Lenovo DS2200\n\nSAN Array&quot;]; 

    kvmhost2 -&amp;gt; LenovoDS2200 [label = &quot;iSCSI&quot;]; 
  }


  {rank = same kvmhost2 -&amp;gt; legend [style = invis] };


  subgraph clusterBackupToDcDs1821NAS
  {
    //label = &quot;Backup Destination 2&quot;;
    label = &quot;                   &quot;;

    node [fillcolor = &quot;#F5F5F5&quot;, style = filled, shape = &quot;rectangle&quot;];
    dummy1821 [style = invis];
    dcds1821 [penwidth = 5.0, shape = &quot;cylinder&quot;, label = &quot;dc-ds1821\n\nSynology NAS&quot;];

    // To force the subgraph to be similar size to the other two Backup Destinations subgraphs
    dummy1821 -&amp;gt; dcds1821 [style = invis]; 
  }

  subgraph clusterBackupToKrypton
  {
    //label = &quot;Backup Destination 3&quot;;
    label = &quot;                    &quot;;

    node [fillcolor=&quot;#F5F5F5&quot;, style=filled, shape=&quot;rectangle&quot;]; 

    krypton [group = gKrypton, height = 0.10];
    zfs [group = gKrypton, penwidth = 5.0, shape = &quot;cylinder&quot;, label = &quot;napp-it Appliance\nZFS\nOpenIndiana&quot;];

    krypton -&amp;gt; zfs [label = &quot;iSCSI&quot;];
  } 

  subgraph clusterLegend
  {
    dLC [ style = invis ];
    peripheries = 0;  // To remove border around the cluster

    legend
    [shape=none, margin=0, label=
      &amp;lt;
        &amp;lt;table border=&quot;0&quot; cellborder=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;4&quot;&amp;gt;
          &amp;lt;tr&amp;gt;&amp;lt;td colspan=&quot;2&quot;&amp;gt;Legend&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
          &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font color=&quot;red&quot;&amp;gt;red&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font color=&quot;red&quot;&amp;gt;Nightly rsync via NFS&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
          &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font color=&quot;green&quot;&amp;gt;green&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font color=&quot;green&quot;&amp;gt;tar via NFS&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
          &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font color=&quot;blue&quot;&amp;gt;blue&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;&amp;lt;font color=&quot;blue&quot;&amp;gt;Nightly rsync&amp;lt;/font&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
          &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;D&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;Databases&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
          &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;W&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;/web or /www or /var/www dir&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
          &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;H&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;/home dir&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
          &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;G&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;/global dir&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
          &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;E&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;/etc, /opt, /root, /usr, /var directories&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
        &amp;lt;/table&amp;gt;
      &amp;gt;];

      dLC -&amp;gt; legend [style = invis];
  }

  edge [fontsize=9.0];

  a1:e  -&amp;gt; kvmhost2 [taillabel=&quot;D, W&quot;, color=&quot;green&quot;];                  // ost
  a2:e  -&amp;gt; kvmhost2 [taillabel=&quot;E&quot;, color=&quot;red&quot;];                       // kvmhost3
  a3:e  -&amp;gt; kvmhost2 [taillabel=&quot;G, H, E&quot;, color=&quot;red&quot;];                 // abacus 
  a4:e  -&amp;gt; kvmhost2 [taillabel=&quot;D, W&quot;, color=&quot;green&quot;];                  // www5
  a5:e  -&amp;gt; kvmhost2 [taillabel=&quot;D, W&quot;, color=&quot;red&quot;];                    // wapps
  a6:e  -&amp;gt; kvmhost2 [taillabel=&quot;D, W&quot;, color=&quot;red&quot;];                    // chemapps
  // Added minlen in order to push the three &quot;Backup Destination&quot; clusters further away
  // NOTE:  This is the second minlen; the first one is around 200 lines above
  a7:e  -&amp;gt; kvmhost2 [taillabel=&quot;E, W, H&quot;, minlen = 2.7, color=&quot;green&quot;]; // titanium 
  a8:e  -&amp;gt; kvmhost2 [taillabel=&quot;H, D&quot;, color=&quot;red&quot;];                    // groups
  a9:n  -&amp;gt; kvmhost2 [taillabel=&quot;H&quot;, color=&quot;red&quot;];                       // mailx
  a9:e  -&amp;gt; zfs      [taillabel=&quot;H&quot;, color=&quot;blue&quot;];                      // mailx
  a9    -&amp;gt; dcds1821 [taillabel=&quot;H, E&quot;, color=&quot;blue&quot;];                   // mailx
  a10:e -&amp;gt; kvmhost2 [taillabel=&quot;H&quot;, color=&quot;red&quot;];                       // mail
  a11:e -&amp;gt; kvmhost2 [taillabel=&quot;H, D, W&quot;, color=&quot;green&quot;];               // xenon 
  a12:e -&amp;gt; kvmhost2 [taillabel=&quot;D, W&quot;, color=&quot;green&quot;];                  // www
  a13:e -&amp;gt; zfs [taillabel=&quot;D, W&quot;, color=&quot;green&quot;];                       // neon
  a14:e -&amp;gt; dcds1821 [taillabel=&quot;E&quot;, color=&quot;blue&quot;];                      // chestnut
  a15:e -&amp;gt; dcds1821 [taillabel=&quot;E&quot;, color=&quot;blue&quot;];                      // redwood

/*
   Graphiz FAQ
     https://graphviz.org/faq/#FaqGraphLabel
   Q: How can I set a graph or cluster label without its propagating to all sub-clusters?
   A: Set the label at the end of the graph (before the closing brace), 
      after all its contents have been defined. (We admit it seems desirable 
      to define some special syntax for non-inherited attribute settings.)
*/
  label = &quot;Backup Map\nUpdated on: Sep 24, 2022&quot;;

}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% dot -Tpng backupmap.dot -o backupmap.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% xv backupmap.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/backupmap.png&quot; alt=&quot;Displaying a backup diagram png image created by Grapvhiz&quot; title=&quot;Displaying a backup diagram png image created by Grapvhiz&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; To see the image in full size in a web browser, right-click on it and select “Open Image in New Tab”.&lt;/p&gt;

</description>
        <pubDate>Sat, 24 Sep 2022 09:13:07 -0700</pubDate>
        <link>http://localhost:4000/howto/diagram/graph/graphviz/plaintext/text/tex/latex/visualization/sysadmin/documentation/2022/09/24/graphviz-clusters.html</link>
        <guid isPermaLink="true">http://localhost:4000/howto/diagram/graph/graphviz/plaintext/text/tex/latex/visualization/sysadmin/documentation/2022/09/24/graphviz-clusters.html</guid>
        
        
        <category>howto</category>
        
        <category>diagram</category>
        
        <category>graph</category>
        
        <category>graphviz</category>
        
        <category>plaintext</category>
        
        <category>text</category>
        
        <category>tex</category>
        
        <category>latex</category>
        
        <category>visualization</category>
        
        <category>sysadmin</category>
        
        <category>documentation</category>
        
      </item>
    
      <item>
        <title>How To Run diagrams.net (aka draw.io or drawio) Locally with Docker on FreeBSD 13 with vm-bhyve and Debian GNU/Linux</title>
        <description>&lt;p&gt;Host OS: FreeBSD 13, Shell: csh  &lt;br /&gt;
Guest OS: Debian GNU/Linux, Shell: bash&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Prerequsites:&lt;/p&gt;

&lt;p&gt;In Debian GNU/Linux VM guest (running inside bhyve):&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Docker installed&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker.service&lt;/code&gt; running&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;containerd.service&lt;/code&gt; running&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You can follow instructions outlined here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/freebsd/docker/vm/virtualization/howto/diagram/2022/02/24/freebsd-docker-linux-kroki-diagrams.html&quot;&gt;How to Run Kroki on FreeBSD 13 with vm-bhyve and Debian GNU/Linux VM&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo vm list
NAME       DATASTORE  LOADER  CPU  MEMORY  VNC  AUTOSTART  STATE
debianvm1  default    grub    1    2048M   -    No         Stopped 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo vm start debianvm1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo vm console debianvm1
---- snip ----

debianvm1 login: dusko
Password:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo \
docker run -d -p 9000:9000 -v \
/var/run/docker.sock:/var/run/docker.sock -v \
portainer_data:/data portainer/portainer
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ss -an | grep 9000
tcp   LISTEN 0      4096    0.0.0.0:9000             0.0.0.0:*
tcp   LISTEN 0      4096    [::]:9000                [::]:*
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo \
docker \
run -it --rm --name=&quot;draw&quot; \
-p 8080:8080 -p 8443:8443 \
jgraph/drawio
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;IP address of the guest VM (GNU/Linux Debian) is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;192.168.8.18&lt;/code&gt;.
The network interface name assigned by the OS is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;enp0s5&lt;/code&gt;, and 
when you run the following inside the guest, you get its IP address:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ip address show dev enp0s5 | grep -w inet 
    inet 192.168.8.18/24 brd 192.168.8.255 scope global dynamic enp0s5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Use a Web browser on the FreeBSD host and open &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://192.168.8.18:8080/&lt;/code&gt; 
or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;https://192.168.8.18:8443/&lt;/code&gt;.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;References:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://jgraph.github.io/drawio/&quot;&gt;drawio&lt;/a&gt;
(Source to app.diagrams.net, &lt;a href=&quot;https://www.diagrams.net/&quot;&gt;www.diagrams.net&lt;/a&gt;) 
(Retrieved on Aug 28, 2022):&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;draw.io, this project, is a configurable diagramming/whiteboarding 
visualization application. draw.io is owned and developed by JGraph Ltd, 
a UK based software company.&lt;/p&gt;

  &lt;p&gt;As well as running this project, we run a production-grade deployment 
of the diagramming interface at https://app.diagrams.net.&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;Scope of the Project&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;draw.io is a diagramming or whiteboarding application, depending on 
which theme is selected.  It is not an SVG editing app, the SVG export 
is designed only for embedding in web pages, not for further editing 
in other tools.&lt;/p&gt;

  &lt;p&gt;The application is designed to be used largely as-is.  It’s possible to 
alter the major parts of the interface, but if you’re looking for an 
editor with very specific editing features, the project is likely not 
a good base to use.&lt;/p&gt;

  &lt;p&gt;That is to say, if you wanted to create/deploy a whiteboard or 
diagramming application where the functionality in the main canvas is 
as this project provides, it more likely to be a good base to use. 
The default libraries, the menus, the toolbar, the default colours, 
the storage location, these can all be changed.&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;Running&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;One way to run diagrams.net is to fork this project, &lt;a href=&quot;https://help.github.com/categories/github-pages-basics/&quot;&gt;publish the master 
branch to GitHub pages&lt;/a&gt; and the &lt;a href=&quot;https://jgraph.github.io/drawio/src/main/webapp/index.html&quot;&gt;pages sites&lt;/a&gt; will have the full editor 
functionality (sans the integrations).&lt;/p&gt;

  &lt;p&gt;Another way is to use &lt;a href=&quot;https://github.com/jgraph/docker-drawio&quot;&gt;the recommended Docker project&lt;/a&gt; or to download &lt;a href=&quot;https://get.diagrams.net/&quot;&gt;draw.io Desktop&lt;/a&gt;.&lt;/p&gt;

  &lt;p&gt;The full packaged .war of the client and servlets is built when the 
project is tagged and available on the &lt;a href=&quot;https://github.com/jgraph/draw.io/releases&quot;&gt;releases page&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
</description>
        <pubDate>Sun, 28 Aug 2022 11:27:04 -0700</pubDate>
        <link>http://localhost:4000/howto/diagram/java/graph/graphviz/plaintext/text/tex/latex/visualization/sysadmin/documentation/2022/08/28/run-diagrams-dot-net-aka-drawio-locally.html</link>
        <guid isPermaLink="true">http://localhost:4000/howto/diagram/java/graph/graphviz/plaintext/text/tex/latex/visualization/sysadmin/documentation/2022/08/28/run-diagrams-dot-net-aka-drawio-locally.html</guid>
        
        
        <category>howto</category>
        
        <category>diagram</category>
        
        <category>java</category>
        
        <category>graph</category>
        
        <category>graphviz</category>
        
        <category>plaintext</category>
        
        <category>text</category>
        
        <category>tex</category>
        
        <category>latex</category>
        
        <category>visualization</category>
        
        <category>sysadmin</category>
        
        <category>documentation</category>
        
      </item>
    
      <item>
        <title>How To Run diagrams.net (aka draw.io or drawio) Locally with a Java war File on FreeBSD 13</title>
        <description>&lt;p&gt;OS: FreeBSD 13 &lt;br /&gt;
Shell: csh&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;From the draw.io project’s 
&lt;a href=&quot;https://github.com/jgraph/drawio#readme&quot;&gt;Readme&lt;/a&gt; file:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The full packaged .war of the client and servlets is built when the 
project is tagged and available on the &lt;a href=&quot;https://github.com/jgraph/draw.io/releases&quot;&gt;releases page&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;As of Aug 27, 2022, the latest draw.io version is 20.2.6.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% mkdir drawio
% cd drawio
% fetch https://github.com/jgraph/drawio/releases/download/v20.2.6/draw.war
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% file draw.war
draw.war: Zip archive data, at least v1.0 to extract, compression method=store
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% unzip draw.war 
---- snip ----
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% pwd
/usr/home/dusko/drawio
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ifconfig
---- snip ----
ue0: flags=8843&amp;lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&amp;gt; metric 0 mtu 1500 
  options=68009b&amp;lt;RXCSUM,TXCSUM,VLAN_MTU,VLAN_HWTAGGING,VLAN_HWCSUM,
  LINKSTATE,RXCSUM_IPV6,TXCSUM_IPV6&amp;gt;
---- snip ----
        inet 192.168.1.9 netmask 0xffffff00 broadcast 192.168.1.255
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For example, to run it with python3 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http.server&lt;/code&gt; module on port &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;8081&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% python3.9 -m http.server 8081
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Use a Web browser and open &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://localhost:8081&lt;/code&gt; or
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://127.0.0.1:8081/&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://192.168.1.9:8081/&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Alternatively, on this system I could also run it with 
python 3.8. &lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% python3.8 -m http.server 8081
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;   If you use python2, to use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SimpleHTTPServer&lt;/code&gt; module, 
you need to run this command:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% python2 -m SimpleHTTPServer 8081
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;

&lt;p&gt;[1] About Python versions on this system:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% pkg info --regex python 
python38-3.8.13_2
python39-3.9.13
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% command -v python; type python; whereis python; which python
python: not found
python:
python: Command not found.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% command -v python3.8; type python3.8; whereis python3.8; which python3.8
/usr/local/bin/python3.8
python3.8 is /usr/local/bin/python3.8
python3.8: /usr/local/bin/python3.8 /usr/local/man/man1/python3.8.1.gz
/usr/local/bin/python3.8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% command -v python3.9; type python3.9; whereis python3.9; which python3.9
/usr/local/bin/python3.9
python3.9 is /usr/local/bin/python3.9
python3.9: /usr/local/bin/python3.9 /usr/local/man/man1/python3.9.1.gz
/usr/local/bin/python3.9
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -lh /usr/local/bin/python*
-r-xr-xr-x  1 root  wheel   5.1K Jul  3 05:11 /usr/local/bin/python3.8
-r-xr-xr-x  1 root  wheel   3.1K Jul  3 05:11 /usr/local/bin/python3.8-config
-r-xr-xr-x  1 root  wheel   5.1K Jul  2 18:17 /usr/local/bin/python3.9
-r-xr-xr-x  1 root  wheel   3.1K Jul  2 18:18 /usr/local/bin/python3.9-config
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

</description>
        <pubDate>Sat, 27 Aug 2022 10:34:06 -0700</pubDate>
        <link>http://localhost:4000/howto/diagram/java/graph/graphviz/plaintext/text/tex/latex/visualization/sysadmin/documentation/2022/08/27/run-diagrams-dot-net-aka-drawio-with-java-war-image.html</link>
        <guid isPermaLink="true">http://localhost:4000/howto/diagram/java/graph/graphviz/plaintext/text/tex/latex/visualization/sysadmin/documentation/2022/08/27/run-diagrams-dot-net-aka-drawio-with-java-war-image.html</guid>
        
        
        <category>howto</category>
        
        <category>diagram</category>
        
        <category>java</category>
        
        <category>graph</category>
        
        <category>graphviz</category>
        
        <category>plaintext</category>
        
        <category>text</category>
        
        <category>tex</category>
        
        <category>latex</category>
        
        <category>visualization</category>
        
        <category>sysadmin</category>
        
        <category>documentation</category>
        
      </item>
    
      <item>
        <title>Fonts in X11 - aka Fonts in X (Xorg)</title>
        <description>&lt;p&gt;OS: FreeBSD 13   &lt;br /&gt;
Shell: csh&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;[TODO]&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;iconv&lt;/li&gt;
  &lt;li&gt;python; e.g.:  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;print(b.decode(&quot;utf8&quot;))&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Perl&lt;/li&gt;
  &lt;li&gt;Also, basically all or most from here:
&lt;a href=&quot;https://charbase.com/02b7-unicode-modifier-letter-small-w&quot;&gt;https://charbase.com/02b7-unicode-modifier-letter-small-w&lt;/a&gt;:  &lt;strong&gt;Decomposition&lt;/strong&gt;, Index, Class, Block, Java escape, Javascript escape, Python escape, HTML escapes, URL encoded, UTF8, UTF16&lt;/li&gt;
  &lt;li&gt;xterm tests - from e.g. Thomas E. Dickey &lt;a href=&quot;http://invisible-island.net/ncurses/&quot;&gt;http://invisible-island.net/ncurses/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;fonts-in-x11-x-window-system-aka-x&quot;&gt;Fonts in X11 (X Window System, aka X)&lt;/h2&gt;

&lt;p&gt;From “Linux in a Windows World” by Roderick W Smith
(O’Reilly Media, Inc. February 2005):&lt;/p&gt;

&lt;p&gt;Two font systems:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;The X core fonts (a.k.a. X fonts)
    &lt;ul&gt;
      &lt;li&gt;Designed with bitmap fonts in mind, meaning that individual characters
were designed for display at a specific size in pixels.
        &lt;ul&gt;
          &lt;li&gt;To support scaleable fonts, which can be resized, multiple bitmap
font files are required, one for each size. X servers ship with
several bitmap fonts in a variety of sizes, designed for both
72 dots per inch (dpi) and 100-dpi displays.&lt;/li&gt;
          &lt;li&gt;Most modern fonts, though, use scaleable font (a.k.a. outline font)
technologies, in which the font is described in terms of mathematical
descriptions of lines and curves.  These descriptions provide an
outline of a character, which the font renderer can scale to any
desired resolution and fill in.
            &lt;ul&gt;
              &lt;li&gt;The two most common scaleable font formats today are
&lt;strong&gt;PostScript Type 1&lt;/strong&gt; (a.k.a. Adobe Type Manager or ATM) fonts and
&lt;strong&gt;TrueType&lt;/strong&gt; fonts (TTF).&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Xft fonts (aka outline fonts or scalable fonts)
    &lt;ul&gt;
      &lt;li&gt;Designed around the FreeType library, which was originally a tool for
rendering TrueType fonts.  Today, though, Xft supports both TrueType
and Type 1 fonts.&lt;/li&gt;
      &lt;li&gt;Improved limitations in the X core fonts:
        &lt;ul&gt;
          &lt;li&gt;X core fonts can’t readily handle more than two colors per font
(Required a font technology known as font smoothing or anti-aliasing.
 Font smoothing uses shades of gray to deliberately blur fonts,
 which has the subjective effect of improving the appearance of
 fonts because it tends to hide the jagged edges along diagonal
 lines and curves.)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Installing the X core fonts can be tricky.&lt;/li&gt;
      &lt;li&gt;X core fonts were not designed with printing in mind, and coordinating
the display and print fonts can be a challenge when using these fonts.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;
Individual X-based programs sometimes employ their own font-handling systems.&lt;/p&gt;

&lt;h2 id=&quot;installing-x-core-fonts-aka-traditional-x-fonts&quot;&gt;Installing X Core Fonts (aka “Traditional” X Fonts)&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;[TODO]&lt;/strong&gt;  ORDER&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Install font; that is, copy its files&lt;/li&gt;
  &lt;li&gt;Run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mkfontdir&lt;/code&gt; to recreate the font database&lt;/li&gt;
  &lt;li&gt;Run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mkfontscale&lt;/code&gt; to recreate an index of scalable font files for X&lt;/li&gt;
  &lt;li&gt;Run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xset fp+ /path/to/the/new/font&lt;/code&gt;  to append it to the font path&lt;/li&gt;
  &lt;li&gt;Run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xset fp rehash&lt;/code&gt; to  reread the font databases in the font path&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;file-fontsdir----todo&quot;&gt;File fonts.dir    &lt;strong&gt;[TODO]&lt;/strong&gt;&lt;/h3&gt;

&lt;h3 id=&quot;file-fontsscale--todo&quot;&gt;File fonts.scale  &lt;strong&gt;[TODO]&lt;/strong&gt;&lt;/h3&gt;

&lt;h3 id=&quot;refresh-rehash-the-font-databases&quot;&gt;Refresh (Rehash) the Font Databases&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% xset fp rehash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From the man page for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xset(1)&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;fp rehash
        The rehash argument resets the font path to its current value,
        causing the server to reread the font databases in the current
        font path.  This is generally only used when adding new fonts
        to a font directory (after running mkfontdir to recreate the
        font database).
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;
To reset the font path to the server’s (that is, X server’s) default:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% xset fp default
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;xlsfonts1---server-font-list-displayer-for-x&quot;&gt;xlsfonts(1) - Server Font List Displayer for X&lt;/h3&gt;

&lt;p&gt;List all X core fonts on the system:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% xlsfonts | wc -l
   25462
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo xlsfonts | wc -l
Password:
   25462
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;converting-a-file-from-an-8-bit-character-set-for-example-iso_8859-1-to-utf-8-without-posting-the-file-to-a-remote-server&quot;&gt;Converting a File from an 8-bit Character Set (For Example ISO_8859-1) to UTF-8 without POSTing the File to a Remote server&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;http://www.acc.umu.se/~saasha/charconv/&quot;&gt;Converting a file from an 8-bit character set (for example ISO_8859-1) to UTF-8 without POSTing the file to a remote server&lt;/a&gt; (Retrieved on Apr 17, 2022):&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt; In many cases, the most obvious way to solve such a problem is to save 
the file, open a terminal, move to the directory where the file resides 
(with cd …) and use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;iconv&lt;/code&gt; similarly to:&lt;/p&gt;

  &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;iconv -f iso88591 -t utf8 fileToConvert.txt &amp;gt; convertedFile.txt&lt;/code&gt;&lt;/p&gt;

  &lt;p&gt;Unfortunately, finding out how to start a terminal is not always easy 
in today’s GUI’s!&lt;/p&gt;

  &lt;p&gt;Here, you are given the opportunity to achieve such a conversion locally. 
Choose a character set (charset, encoding) in the list below and choose 
the file you wish to convert.  The JavaScript program linked to by this 
page will try to make your browser convert the file to UTF-8. 
If the conversion succeeds, you will be given the opportunity to save 
the converted file.&lt;/p&gt;

  &lt;p&gt;You do not need any Internet connection to achieve this conversion. 
You can save this page locally together with (in the same directory than) 
the JavaScript program it is linked to and open it in a browser to 
achieve the conversions even without any Internet connection.&lt;/p&gt;

  &lt;p&gt;Comments and suggestions may be sent to saasha@acc.umu.se.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;installing-xft-fonts-aka-fontconfig&quot;&gt;Installing Xft Fonts (aka Fontconfig)&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -alh /usr/local/share/fonts/ | wc -l
      42

% ls -lh /usr/local/share/fonts/ | wc -l
      40
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -ld /usr/local/etc/fonts/
drwxr-xr-x  4 root  wheel  7 Feb  3  2022 /usr/local/etc/fonts/

% ls -alh /usr/local/etc/fonts/ | wc -l
       8

% ls -lh /usr/local/etc/fonts/ | wc -l
       6
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -lh /usr/local/etc/fonts/
total 79
drwxr-xr-x  2 root  wheel    51B Feb  3  2022 conf.avail
drwxr-xr-x  2 root  wheel    33B Feb  3  2022 conf.d
-rw-r--r--  1 root  wheel   2.6K Jan 21  2022 fonts.conf
-rw-r--r--  1 root  wheel   2.6K Jan 21  2022 fonts.conf.sample
-rw-r--r--  1 root  wheel   8.1K Dec  3  2020 fonts.dtd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -alh /usr/local/etc/fonts/conf.avail/ | wc -l
      52

% ls -lh /usr/local/etc/fonts/conf.avail/ | wc -l
      50
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -alh /usr/local/etc/fonts/conf.d/ | wc -l
      34

% ls -lh /usr/local/etc/fonts/conf.d/ | wc -l
      32
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat /usr/local/etc/fonts/conf.d/README
conf.d/README

Each file in this directory is a fontconfig configuration file.  Fontconfig
scans this directory, loading all files of the form [0-9][0-9]*.conf.
These files are normally installed in /usr/local/etc/fonts/conf.avail
and then symlinked here, allowing them to be easily installed and then
enabled/disabled by adjusting the symlinks.

The files are loaded in numeric order, the structure of the configuration
has led to the following conventions in usage:

 Files beginning with:  Contain:

 00 through 09          Font directories
 10 through 19          system rendering defaults (AA, etc)
 20 through 29          font rendering options
 30 through 39          family substitution
 40 through 49          generic identification, map family-&amp;gt;generic
 50 through 59          alternate config file loading
 60 through 69          generic aliases, map generic-&amp;gt;family
 70 through 79          select font (adjust which fonts are available)
 80 through 89          match target=&quot;scan&quot; (modify scanned patterns)
 90 through 99          font synthesis
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -lh /usr/local/etc/fonts/fonts.conf*
-rw-r--r--  1 root  wheel   2.6K Jan 21  2022 /usr/local/etc/fonts/fonts.conf
-rw-r--r--  1 root  wheel   2.6K Jan 21  2022 /usr/local/etc/fonts/fonts.conf.sample
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% diff /usr/local/etc/fonts/fonts.conf.sample /usr/local/etc/fonts/fonts.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% file /usr/local/etc/fonts/fonts.conf
/usr/local/etc/fonts/fonts.conf: XML 1.0 document, ASCII text
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% wc -l /usr/local/etc/fonts/fonts.conf
     103 /usr/local/etc/fonts/fonts.conf

% sed &apos;/^[[:space:]]*$/d&apos; /usr/local/etc/fonts/fonts.conf | grep -v \# | wc -l
      87
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sed &apos;/^[[:space:]]*$/d&apos; /usr/local/etc/fonts/fonts.conf | grep -v \#
&amp;lt;?xml version=&quot;1.0&quot;?&amp;gt;
&amp;lt;!DOCTYPE fontconfig SYSTEM &quot;urn:fontconfig:fonts.dtd&quot;&amp;gt;
&amp;lt;!-- /etc/fonts/fonts.conf file to configure system font access --&amp;gt;
&amp;lt;fontconfig&amp;gt;
        &amp;lt;description&amp;gt;Default configuration file&amp;lt;/description&amp;gt;
&amp;lt;!--
        DO NOT EDIT THIS FILE.
        IT WILL BE REPLACED WHEN FONTCONFIG IS UPDATED.
        LOCAL CHANGES BELONG IN &apos;local.conf&apos;.
        The intent of this standard configuration file is to be adequate for
        most environments.  If you have a reasonably normal environment and
        have found problems with this configuration, they are probably
        things that others will also want fixed.  Please submit any
        problems to the fontconfig bugzilla system located at fontconfig.org
        Note that the normal &apos;make install&apos; procedure for fontconfig is to
        replace any existing fonts.conf file with the new version.  Place
        any local customizations in local.conf which this file references.
        Keith Packard
--&amp;gt;
&amp;lt;!-- Font directory list --&amp;gt;
        &amp;lt;dir&amp;gt;/usr/local/share/fonts&amp;lt;/dir&amp;gt;
        &amp;lt;dir&amp;gt;/usr/local/lib/X11/fonts&amp;lt;/dir&amp;gt;
        &amp;lt;dir prefix=&quot;xdg&quot;&amp;gt;fonts&amp;lt;/dir&amp;gt;
        &amp;lt;!-- the following element will be removed in the future --&amp;gt;
        &amp;lt;dir&amp;gt;~/.fonts&amp;lt;/dir&amp;gt;
&amp;lt;!--
  Accept deprecated &apos;mono&apos; alias, replacing it with &apos;monospace&apos;
--&amp;gt;
        &amp;lt;match target=&quot;pattern&quot;&amp;gt;
                &amp;lt;test qual=&quot;any&quot; name=&quot;family&quot;&amp;gt;
                        &amp;lt;string&amp;gt;mono&amp;lt;/string&amp;gt;
                &amp;lt;/test&amp;gt;
                &amp;lt;edit name=&quot;family&quot; mode=&quot;assign&quot; binding=&quot;same&quot;&amp;gt;
                        &amp;lt;string&amp;gt;monospace&amp;lt;/string&amp;gt;
                &amp;lt;/edit&amp;gt;
        &amp;lt;/match&amp;gt;
&amp;lt;!--
  Accept alternate &apos;sans serif&apos; spelling, replacing it with &apos;sans-serif&apos;
--&amp;gt;
        &amp;lt;match target=&quot;pattern&quot;&amp;gt;
                &amp;lt;test qual=&quot;any&quot; name=&quot;family&quot;&amp;gt;
                        &amp;lt;string&amp;gt;sans serif&amp;lt;/string&amp;gt;
                &amp;lt;/test&amp;gt;
                &amp;lt;edit name=&quot;family&quot; mode=&quot;assign&quot; binding=&quot;same&quot;&amp;gt;
                        &amp;lt;string&amp;gt;sans-serif&amp;lt;/string&amp;gt;
                &amp;lt;/edit&amp;gt;
        &amp;lt;/match&amp;gt;
&amp;lt;!--
  Accept deprecated &apos;sans&apos; alias, replacing it with &apos;sans-serif&apos;
--&amp;gt;
        &amp;lt;match target=&quot;pattern&quot;&amp;gt;
                &amp;lt;test qual=&quot;any&quot; name=&quot;family&quot;&amp;gt;
                        &amp;lt;string&amp;gt;sans&amp;lt;/string&amp;gt;
                &amp;lt;/test&amp;gt;
                &amp;lt;edit name=&quot;family&quot; mode=&quot;assign&quot; binding=&quot;same&quot;&amp;gt;
                        &amp;lt;string&amp;gt;sans-serif&amp;lt;/string&amp;gt;
                &amp;lt;/edit&amp;gt;
        &amp;lt;/match&amp;gt;
&amp;lt;!--
  Accept alternate &apos;system ui&apos; spelling, replacing it with &apos;system-ui&apos;
--&amp;gt;
        &amp;lt;match target=&quot;pattern&quot;&amp;gt;
                &amp;lt;test qual=&quot;any&quot; name=&quot;family&quot;&amp;gt;
                        &amp;lt;string&amp;gt;system ui&amp;lt;/string&amp;gt;
                &amp;lt;/test&amp;gt;
                &amp;lt;edit name=&quot;family&quot; mode=&quot;assign&quot; binding=&quot;same&quot;&amp;gt;
                        &amp;lt;string&amp;gt;system-ui&amp;lt;/string&amp;gt;
                &amp;lt;/edit&amp;gt;
        &amp;lt;/match&amp;gt;
&amp;lt;!--
  Load local system customization file
--&amp;gt;
        &amp;lt;include ignore_missing=&quot;yes&quot;&amp;gt;conf.d&amp;lt;/include&amp;gt;
&amp;lt;!-- Font cache directory list --&amp;gt;
        &amp;lt;cachedir&amp;gt;/var/db/fontconfig&amp;lt;/cachedir&amp;gt;
        &amp;lt;cachedir prefix=&quot;xdg&quot;&amp;gt;fontconfig&amp;lt;/cachedir&amp;gt;
        &amp;lt;!-- the following element will be removed in the future --&amp;gt;
        &amp;lt;cachedir&amp;gt;~/.fontconfig&amp;lt;/cachedir&amp;gt;
        &amp;lt;config&amp;gt;
&amp;lt;!--
  Rescan configuration every 30 seconds when FcFontSetList is called
 --&amp;gt;
                &amp;lt;rescan&amp;gt;
                        &amp;lt;int&amp;gt;30&amp;lt;/int&amp;gt;
                &amp;lt;/rescan&amp;gt;
        &amp;lt;/config&amp;gt;
&amp;lt;/fontconfig&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -ld /etc/fonts/fonts.conf
ls: /etc/fonts/fonts.conf: No such file or directory
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;font-directory-list&quot;&gt;Font Directory List&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% grep -n &apos;Font directory list&apos; /usr/local/etc/fonts/fonts.conf
25:&amp;lt;!-- Font directory list --&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sed -n 25,35p /usr/local/etc/fonts/fonts.conf
&amp;lt;!-- Font directory list --&amp;gt;

        &amp;lt;dir&amp;gt;/usr/local/share/fonts&amp;lt;/dir&amp;gt;
        &amp;lt;dir&amp;gt;/usr/local/lib/X11/fonts&amp;lt;/dir&amp;gt;


        &amp;lt;dir prefix=&quot;xdg&quot;&amp;gt;fonts&amp;lt;/dir&amp;gt;
        &amp;lt;!-- the following element will be removed in the future --&amp;gt;
        &amp;lt;dir&amp;gt;~/.fonts&amp;lt;/dir&amp;gt;

&amp;lt;!--
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/.fonts&lt;/code&gt; directory will be removed in the future:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% grep -n removed /usr/local/etc/fonts/fonts.conf
32:     &amp;lt;!-- the following element will be removed in the future --&amp;gt;
91:     &amp;lt;!-- the following element will be removed in the future --&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sed -n 32,34p /usr/local/etc/fonts/fonts.conf
        &amp;lt;!-- the following element will be removed in the future --&amp;gt;
        &amp;lt;dir&amp;gt;~/.fonts&amp;lt;/dir&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -alh /usr/local/share/fonts/ | wc -l
      42

% ls -lh /usr/local/share/fonts/ | wc -l
      40
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls /usr/local/share/fonts/
100dpi                  gnu-unifont             SourceHanSansK
75dpi                   ipamjm                  SourceHanSansSC
adobe-cmaps             jmk-x11-fonts           SourceHanSansTC
bitstream-vera          Liberation              SourceSansPro
Caladea                 LinLibertineG           symbola
cantarell               misc                    terminus-font
Carlito                 Monoid                  TerminusTTF
ChromeOS                nanum-coding-ttf        TTF
comic-neue              nanum-ttf               twemoji-color-font-ttf
cyrillic                noto                    Type1
dejavu                  OTF                     uw-ttyp0
encodings               SourceCodePro           vlgothic
GentiumBasic            SourceHanSans           wqy
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -ld /usr/local/lib/X11/fonts
ls: /usr/local/lib/X11/fonts: No such file or directory
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -ld ~/.fonts/
drwxr-xr-x  3 dusko  dusko  214 Nov 22  2021 /home/dusko/.fonts/

% ls -alh ~/.fonts/ | wc -l
     215

% ls -lh ~/.fonts/ | wc -l
     213
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;font-cache-directory-list&quot;&gt;Font Cache Directory List&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% grep -n -i list /usr/local/etc/fonts/fonts.conf
25:&amp;lt;!-- Font directory list --&amp;gt;
87:&amp;lt;!-- Font cache directory list --&amp;gt;
96:  Rescan configuration every 30 seconds when FcFontSetList is called
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sed -n 87,94p /usr/local/etc/fonts/fonts.conf
&amp;lt;!-- Font cache directory list --&amp;gt;

        &amp;lt;cachedir&amp;gt;/var/db/fontconfig&amp;lt;/cachedir&amp;gt;
        &amp;lt;cachedir prefix=&quot;xdg&quot;&amp;gt;fontconfig&amp;lt;/cachedir&amp;gt;
        &amp;lt;!-- the following element will be removed in the future --&amp;gt;
        &amp;lt;cachedir&amp;gt;~/.fontconfig&amp;lt;/cachedir&amp;gt;

        &amp;lt;config&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/.fontconfig&lt;/code&gt; directory will be removed in the future:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% grep -n removed /usr/local/etc/fonts/fonts.conf
32:     &amp;lt;!-- the following element will be removed in the future --&amp;gt;
91:     &amp;lt;!-- the following element will be removed in the future --&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sed -n 91,92p /usr/local/etc/fonts/fonts.conf
        &amp;lt;!-- the following element will be removed in the future --&amp;gt;
        &amp;lt;cachedir&amp;gt;~/.fontconfig&amp;lt;/cachedir&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -ld /var/db/fontconfig/
drwxr-xr-x  2 root  wheel  57 Mar 31 13:49 /var/db/fontconfig/

% ls -alh /var/db/fontconfig/ | wc -l
      58

% ls -lh /var/db/fontconfig/ | wc -l
      56
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat /var/db/fontconfig/CACHEDIR.TAG
Signature: 8a477f597d28d172789f06886806bc55
# This file is a cache directory tag created by fontconfig.
# For information about cache directory tags, see:
#       http://www.brynosaurus.com/cachedir/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -ld ~/.fontconfig
ls: /home/dusko/.fontconfig: No such file or directory
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;file--fontsalias&quot;&gt;File:  fonts.alias&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo locate fonts.alias
/usr/local/share/fonts/100dpi/fonts.alias
/usr/local/share/fonts/75dpi/fonts.alias
/usr/local/share/fonts/cyrillic/fonts.alias
/usr/local/share/fonts/misc/fonts.alias
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;list-information-about-current-fonts-configuration-font-path&quot;&gt;List Information about Current Fonts Configuration, Font Path&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xset -q | grep -n Font
22:Font Path:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xset -q | sed -n 22,23p
Font Path:
  /usr/local/share/fonts/misc/,/usr/local/share/fonts/TTF/,/usr/local/share/fonts/OTF/,/usr/local/share/fonts/Type1/,/usr/local/share/fonts/100dpi/,/usr/local/share/fonts/75dpi/,catalogue:/usr/local/etc/X11/fontpath.d,built-ins,/usr/local/share/fonts/100dpi,/usr/local/share/fonts/75dpi,/usr/local/share/fonts/adobe-cmaps,/usr/local/share/fonts/bitstream-vera,/usr/local/share/fonts/Caladea,/usr/local/share/fonts/cantarell,/usr/local/share/fonts/Carlito,/usr/local/share/fonts/ChromeOS,/usr/local/share/fonts/comic-neue,/usr/local/share/fonts/cyrillic,/usr/local/share/fonts/dejavu,/usr/local/share/fonts/GentiumBasic,/usr/local/share/fonts/gnu-unifont,/usr/local/share/fonts/ipamjm,/usr/local/share/fonts/jmk-x11-fonts,/usr/local/share/fonts/Liberation,/usr/local/share/fonts/LinLibertineG,/usr/local/share/fonts/misc,/usr/local/share/fonts/Monoid,/usr/local/share/fonts/nanum-coding-ttf,/usr/local/share/fonts/nanum-ttf,/usr/local/share/fonts/noto,/usr/local/share/fonts/OTF,/usr/local/share/fonts/SourceCodePro,/usr/local/share/fonts/SourceHanSans,/usr/local/share/fonts/SourceHanSansK,/usr/local/share/fonts/SourceHanSansSC,/usr/local/share/fonts/SourceHanSansTC,/usr/local/share/fonts/SourceSansPro,/usr/local/share/fonts/symbola,/usr/local/share/fonts/terminus-font,/usr/local/share/fonts/TerminusTTF,/usr/local/share/fonts/TTF,/usr/local/share/fonts/twemoji-color-font-ttf,/usr/local/share/fonts/Type1,/usr/local/share/fonts/uw-ttyp0,/usr/local/share/fonts/vlgothic,/usr/local/share/fonts/wqy,/usr/home/dusko/.fonts/knxt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;fc-cache1---build-font-information-cache-files&quot;&gt;fc-cache(1) - Build Font Information Cache Files&lt;/h3&gt;

&lt;p&gt;To refresh only system fonts:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% fc-cache -sv
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From the man page for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-cache(1)&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DESCRIPTION
       fc-cache scans the font directories on the system and builds font
       information cache files for applications using fontconfig for their
       font handling.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-s     Only scan system-wide directories, omitting the places located
       in the user&apos;s home directory.

-v     Display status information while busy.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To force refresh fonts cache:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% fc-cache -fv
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-f     Force re-generation of apparently up-to-date cache files,
       overriding the timestamp checking.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Erase all existing cache files and rescan:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% fc-cache -rv
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;fc-list1---list-available-fonts&quot;&gt;fc-list(1) - List Available Fonts&lt;/h3&gt;

&lt;p&gt;From the man page for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-list(1)&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DESCRIPTION
       fc-list lists fonts and styles available on the system for applications
       using fontconfig.  If any elements are specified, only those are
       printed.  Otherwise family and style are printed, unless verbose output
       is requested.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Number of &lt;strong&gt;fontconfig&lt;/strong&gt; fonts available to the user (lists all font faces):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% fc-list | wc -l
    3182
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Number of &lt;strong&gt;fontconfig&lt;/strong&gt; fonts available to root user (lists all font faces):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo fc-list | wc -l
Password:
    2966
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;fc-conflist1---show-the-ruleset-files-information-on-the-system&quot;&gt;fc-conflist(1) - Show the ruleset files information on the system&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% fc-conflist | wc -l
      51

% sudo fc-conflist | wc -l
      50
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% fc-conflist | grep dusko
+ /home/dusko/.config/fontconfig/fonts.conf: No description
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo fc-conflist | grep dusko
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -lh /home/dusko/.config/fontconfig/fonts.conf
-rw-r--r--  1 dusko  dusko   1.8K Oct 21  2021 /home/dusko/.config/fontconfig/fonts.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;[TODO]&lt;/strong&gt;: Courtesy of &lt;strong&gt;vermaden&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% wc -l /home/dusko/.config/fontconfig/fonts.conf
      52 /home/dusko/.config/fontconfig/fonts.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat /home/dusko/.config/fontconfig/fonts.conf
&amp;lt;?xml version=&quot;1.0&quot;?&amp;gt;
&amp;lt;!DOCTYPE fontconfig SYSTEM &quot;fonts.dtd&quot;&amp;gt;

&amp;lt;fontconfig&amp;gt;

  &amp;lt;!-- ANTIALIAS ALL FONTS --&amp;gt;
  &amp;lt;match target=&quot;font&quot;&amp;gt;
    &amp;lt;edit name=&quot;antialias&quot; mode=&quot;assign&quot;&amp;gt;&amp;lt;bool&amp;gt;true&amp;lt;/bool&amp;gt;&amp;lt;/edit&amp;gt;
    &amp;lt;edit name=&quot;hinting&quot;   mode=&quot;assign&quot;&amp;gt;&amp;lt;bool&amp;gt;false&amp;lt;/bool&amp;gt;&amp;lt;/edit&amp;gt;
    &amp;lt;edit name=&quot;hintstyle&quot; mode=&quot;assign&quot;&amp;gt;&amp;lt;int&amp;gt;0&amp;lt;/int&amp;gt;&amp;lt;/edit&amp;gt;
    &amp;lt;edit name=&quot;dpi&quot;       mode=&quot;assign&quot;&amp;gt;&amp;lt;double&amp;gt;75&amp;lt;/double&amp;gt;&amp;lt;/edit&amp;gt;
    &amp;lt;edit name=&quot;rgba&quot;      mode=&quot;assign&quot;&amp;gt;&amp;lt;const&amp;gt;none&amp;lt;/const&amp;gt;&amp;lt;/edit&amp;gt;
    &amp;lt;/match&amp;gt;

  &amp;lt;!-- REPLACE THESE WITH A BETTER LOOKING FONT (MONO) --&amp;gt;
  &amp;lt;match target=&quot;pattern&quot;&amp;gt;
    &amp;lt;test name=&quot;family&quot;    qual=&quot;any&quot;&amp;gt;&amp;lt;string&amp;gt;Courier [Adobe]&amp;lt;/string&amp;gt;&amp;lt;/test&amp;gt;
    &amp;lt;edit name=&quot;family&quot; mode=&quot;assign&quot;&amp;gt;&amp;lt;string&amp;gt;Courier 10 Pitch&amp;lt;/string&amp;gt;&amp;lt;/edit&amp;gt;
    &amp;lt;/match&amp;gt;

  &amp;lt;match target=&quot;pattern&quot;&amp;gt;
    &amp;lt;test name=&quot;family&quot;    qual=&quot;any&quot;&amp;gt;&amp;lt;string&amp;gt;Fixed&amp;lt;/string&amp;gt;&amp;lt;/test&amp;gt;
    &amp;lt;edit name=&quot;family&quot; mode=&quot;assign&quot;&amp;gt;&amp;lt;string&amp;gt;Courier 10 Pitch&amp;lt;/string&amp;gt;&amp;lt;/edit&amp;gt;
    &amp;lt;/match&amp;gt;

  &amp;lt;match target=&quot;pattern&quot;&amp;gt;
    &amp;lt;test name=&quot;family&quot;    qual=&quot;any&quot;&amp;gt;&amp;lt;string&amp;gt;courier&amp;lt;/string&amp;gt;&amp;lt;/test&amp;gt;
    &amp;lt;edit name=&quot;family&quot; mode=&quot;assign&quot;&amp;gt;&amp;lt;string&amp;gt;Courier 10 Pitch&amp;lt;/string&amp;gt;&amp;lt;/edit&amp;gt;
    &amp;lt;/match&amp;gt;

  &amp;lt;!-- REPLACE THESE WITH A BETTER LOOKING FONT (SANS) --&amp;gt;
  &amp;lt;match target=&quot;pattern&quot;&amp;gt;
    &amp;lt;test name=&quot;family&quot;    qual=&quot;any&quot;&amp;gt;&amp;lt;string&amp;gt;helvetica&amp;lt;/string&amp;gt;&amp;lt;/test&amp;gt;
    &amp;lt;edit name=&quot;family&quot; mode=&quot;assign&quot;&amp;gt;&amp;lt;string&amp;gt;arial&amp;lt;/string&amp;gt;&amp;lt;/edit&amp;gt;
    &amp;lt;/match&amp;gt;

  &amp;lt;match target=&quot;pattern&quot;&amp;gt;
    &amp;lt;test name=&quot;family&quot;    qual=&quot;any&quot;&amp;gt;&amp;lt;string&amp;gt;times&amp;lt;/string&amp;gt;&amp;lt;/test&amp;gt;
    &amp;lt;edit name=&quot;family&quot; mode=&quot;assign&quot;&amp;gt;&amp;lt;string&amp;gt;garamond&amp;lt;/string&amp;gt;&amp;lt;/edit&amp;gt;
    &amp;lt;/match&amp;gt;

  &amp;lt;match target=&quot;pattern&quot;&amp;gt;
    &amp;lt;test name=&quot;family&quot;    qual=&quot;any&quot;&amp;gt;&amp;lt;string&amp;gt;lucida&amp;lt;/string&amp;gt;&amp;lt;/test&amp;gt;
    &amp;lt;edit name=&quot;family&quot; mode=&quot;assign&quot;&amp;gt;&amp;lt;string&amp;gt;trebuchet ms&amp;lt;/string&amp;gt;&amp;lt;/edit&amp;gt;
    &amp;lt;/match&amp;gt;

  &amp;lt;!-- DISABLE EMBEDDED BITMAPS --&amp;gt;
  &amp;lt;match target=&quot;font&quot; &amp;gt;
    &amp;lt;edit name=&quot;embeddedbitmap&quot; mode=&quot;assign&quot;&amp;gt;&amp;lt;bool&amp;gt;false&amp;lt;/bool&amp;gt;&amp;lt;/edit&amp;gt;
    &amp;lt;/match&amp;gt;

&amp;lt;/fontconfig&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;useful-tools-commands-and-code-snippets-for-exploring-fonts-in-x11&quot;&gt;Useful Tools, Commands and Code Snippets for Exploring Fonts in X11&lt;/h2&gt;

&lt;p&gt;Start &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xterm&lt;/code&gt; with red cursor, font Source Code Pro and font size 18:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% xterm -cr red -fa &apos;Source Code Pro&apos; -fs 18
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-fa&lt;/code&gt; option enables &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xterm&lt;/code&gt; to render &lt;strong&gt;Xft&lt;/strong&gt; fonts 
(a.k.a. fontconfig).&lt;/p&gt;

&lt;p&gt;The venerable &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;file(1)&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% file /usr/local/share/fonts/SourceCodePro/SourceCodePro-Regular.ttf
/usr/local/share/fonts/SourceCodePro/SourceCodePro-Regular.ttf: TrueType Font data, digitally signed, 15 tables, 1st &quot;BASE&quot;, 72 names, Microsoft, language 0x408, type 256 string, \261\300\273\314 a\261\300\273\314 gi &amp;amp; l \274\265 \261\272\301\265\274\314\275\265\302\243\254\
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Report information about OpenType fonts with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;otfinfo(1)&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% otfinfo --info /usr/local/share/fonts/SourceCodePro/SourceCodePro-Regular.ttf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% otfinfo --features /usr/local/share/fonts/SourceCodePro/SourceCodePro-Regular.ttf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Print supported scripts and languages:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% otfinfo --scripts /usr/local/share/fonts/SourceCodePro/SourceCodePro-Regular.ttf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DFLT            Default
cyrl            Cyrillic
cyrl.SRB        Cyrillic/Serbian
grek            Greek
latn            Latin
latn.ATH        Latin/Athapaskan
latn.NSM        Latin/Northern Sami
latn.SKS        Latin/Skolt Sami
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Other interesting &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;otfinfo&lt;/code&gt;’s options:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-g, --glyphs
     Print the name of every glyph in each font, one per line.

-u, --unicode
     Print each Unicode code point supported by the font, followed by
     the glyph number representing that code point (and, if present,
     the name of the corresponding glyph).

-t, --tables
     Print the size and name of every OpenType table in the font.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-z, --optical-size
     Print optical size information.

-p, --postscript-name
      Print each font&apos;s PostScript name.

-a, --family
     Print each font&apos;s family name.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xset -q
Keyboard Control:
  auto repeat:  on    key click percent:  0    LED mask:  00000000
  XKB indicators:
    00: Caps Lock:   off    01: Num Lock:    off    02: Scroll Lock: off
    03: Compose:     off    04: Kana:        off    05: Sleep:       off
    06: Suspend:     off    07: Mute:        off    08: Misc:        off
    09: Mail:        off    10: Charging:    off    11: Shift Lock:  off
    12: Group 2:     off    13: Mouse Keys:  off
  auto repeat delay:  660    repeat rate:  25
  auto repeating keys:  00ffffffdffffbbf
                        fadfffefffedffff
                        9fffffffffffffff
                        fff7ffffffffffff
  bell percent:  0    bell pitch:  400    bell duration:  100
Pointer Control:
  acceleration:  2/1    threshold:  4
Screen Saver:
  prefer blanking:  yes    allow exposures:  yes
  timeout:  600    cycle:  600
Colors:
  default colormap:  0x22    BlackPixel:  0x0    WhitePixel:  0xffffff
Font Path:
  /usr/local/share/fonts/misc/,/usr/local/share/fonts/TTF/,/usr/local/share/fonts/OTF/,/usr/local/share/fonts/Type1/,/usr/local/share/fonts/100dpi/,/usr/local/share/fonts/75dpi/,catalogue:/usr/local/etc/X11/fontpath.d,built-ins,/usr/local/share/fonts/100dpi,/usr/local/share/fonts/75dpi,/usr/local/share/fonts/adobe-cmaps,/usr/local/share/fonts/bitstream-vera,/usr/local/share/fonts/Caladea,/usr/local/share/fonts/cantarell,/usr/local/share/fonts/Carlito,/usr/local/share/fonts/ChromeOS,/usr/local/share/fonts/comic-neue,/usr/local/share/fonts/cyrillic,/usr/local/share/fonts/dejavu,/usr/local/share/fonts/GentiumBasic,/usr/local/share/fonts/gnu-unifont,/usr/local/share/fonts/ipamjm,/usr/local/share/fonts/jmk-x11-fonts,/usr/local/share/fonts/Liberation,/usr/local/share/fonts/LinLibertineG,/usr/local/share/fonts/misc,/usr/local/share/fonts/Monoid,/usr/local/share/fonts/nanum-coding-ttf,/usr/local/share/fonts/nanum-ttf,/usr/local/share/fonts/noto,/usr/local/share/fonts/OTF,/usr/local/share/fonts/politika-otf,/usr/local/share/fonts/politika-ttf,/usr/local/share/fonts/SourceCodePro,/usr/local/share/fonts/SourceHanSans,/usr/local/share/fonts/SourceHanSansK,/usr/local/share/fonts/SourceHanSansSC,/usr/local/share/fonts/SourceHanSansTC,/usr/local/share/fonts/SourceSansPro,/usr/local/share/fonts/symbola,/usr/local/share/fonts/terminus-font,/usr/local/share/fonts/TerminusTTF,/usr/local/share/fonts/TTF,/usr/local/share/fonts/twemoji-color-font-ttf,/usr/local/share/fonts/Type1,/usr/local/share/fonts/uw-ttyp0,/usr/local/share/fonts/vlgothic,/usr/local/share/fonts/wqy,/usr/home/dusko/.fonts/knxt
DPMS (Energy Star):
  Standby: 600    Suspend: 600    Off: 600
  DPMS is Enabled
  Monitor is On
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; the content of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Font Path:&lt;/code&gt; line.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xrdb -query
! screen-independent resources
XTerm*saveLines:        1048576
XTerm*loginShell:       true
XTerm*charClass:        33:48,35:48,37:48,43:48,45-47:48,64:48,95:48,126:48
XTerm*eightBitInput:    false
XTerm*borderWidth:      4
Xcursor.theme:  Vanilla-DMZ
XTerm*cursorBlink:      true
XTerm*scrollKey:        true
XTerm*colorUL:  Yellow
XTerm*colorULMode:      true
XTerm*cursorColor:      Cyan
XTerm*background:       Black
XTerm*foreground:       White
XTerm*locale:   UTF-8
XTerm*faceNameDoublesize:       Noto Serif CJK JP
XTerm*scrollTtyOutput:  false
XTerm*selectToClipboard:        true
Xft.autohint:   0
Xft.antialias:  1
Xft.hinting:    1
Xft.rgba:       rgb
Xft.hintstyle:  hintlight
Xft.lcdfilter:  lcddefault
*VT100.Translations:    #override Button1 &amp;lt;Btn3Down&amp;gt;: select-end(PRIMARY,CUT_BUFFER0,CLIPBOARD) \n !Shift &amp;lt;Btn2Up&amp;gt;: insert-selection(CLIPBOARD) \n ~Shift ~Ctrl ~Meta &amp;lt;Btn2Up&amp;gt;: insert-selection(PRIMARY,CUT_BUFFER0) \n &amp;lt;Key&amp;gt;F3: string(&quot;cd ~/scratch/tmpscratch2&quot;) string(0x0d) \n Alt &amp;lt;Key&amp;gt;t: string(&quot;date | dzen2 -xs 2 -p 5 -bg blue&quot;) string(0x0d)
Xmessage*Scrollbar.thumb:       vlines2
Xmessage*Scrollbar.width:       2

! screen 0 resources
#if SCREEN_NUM == 0
#endif

! screen 1 resources
#if SCREEN_NUM == 1
#endif
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; This environment has two monitors so there are references to 
both of them: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#if SCREEN_NUM == 0&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#if SCREEN_NUM == 1&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*VT100.Translations:&lt;/code&gt; is my own customization.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;List all monospaced fonts:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$ fc-list | cut -f2 -d: | sort -u | grep -i Mono&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Print out the fixed width fonts that are available:&lt;/strong&gt; 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$ fc-list :scalable=true:spacing=mono:&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Print out the fixed width fonts that are available with their family name:&lt;/strong&gt; 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$ fc-list :scalable=true:spacing=mono: family&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Sort and page through the available fonts - not only fixed width fonts:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$ fc-list | cut -f2 -d: | sort -u | less&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;To test the status of your colour support in XTerm:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ tput colors
80
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;References: &lt;br /&gt;
(Retrieved on Apr 17, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.futurile.net/2016/06/14/xterm-setup-and-truetype-font-configuration/&quot;&gt;XTerm introduction and TrueType fonts configuration&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.futurile.net/2016/06/15/xterm-256color-themes-molokai-terminal-theme/&quot;&gt;XTerm colour set-up and Molokai theme&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;installing-an-xft-font-aka-fontconfig---a-full-example&quot;&gt;Installing an Xft Font (aka Fontconfig) - A Full Example&lt;/h3&gt;

&lt;p&gt;OS:  FreeBSD 13.0 &lt;br /&gt;
Shell:  csh&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fc-list | wc -l
    3186
 
$ sudo fc-list | wc -l
    2968
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fc-list | grep -i hermit
$ sudo fc-list | grep -i hermit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xlsfonts | wc -l
   25462
 
$ sudo xlsfonts | wc -l
   25462
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xlsfonts | grep -i hermit
$ sudo xlsfonts | grep -i hermit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ pkg search hermit
hermit-font-2.0_1      Monospaced font for programmers by a programmer
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo pkg install hermit-font
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fc-list | wc -l
    3192
 
$ sudo fc-list | wc -l
    2974
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fc-list | grep -i hermit | wc -l
       6

$ sudo fc-list | grep -i hermit | wc -l
       6
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fc-list | grep -i hermit
/usr/local/share/fonts/hermit/Hermit-LightItalic.otf: Hermit,Hermit LightItalic:style=LightItalic,Regular
/usr/local/share/fonts/hermit/Hermit-Bold.otf: Hermit:style=Bold
/usr/local/share/fonts/hermit/Hermit-Regular.otf: Hermit:style=Regular
/usr/local/share/fonts/hermit/Hermit-RegularItalic.otf: Hermit:style=RegularItalic,Italic
/usr/local/share/fonts/hermit/Hermit-Light.otf: Hermit,Hermit Light:style=Light,Regular
/usr/local/share/fonts/hermit/Hermit-BoldItalic.otf: Hermit:style=BoldItalic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xlsfonts | wc -l
   25462

$ sudo xlsfonts | wc -l
   25462
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xlsfonts | grep -i hermit
$ sudo xlsfonts | grep -i hermit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fc-list : fullname | grep -i hermit | wc -l
       6

$ fc-list : fullname | grep -i hermit
:fullname=Hermit Bold
:fullname=Hermit Light
:fullname=Hermit RegularItalic
:fullname=Hermit BoldItalic
:fullname=Hermit LightItalic
:fullname=Hermit Regular
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fc-list : postscriptname | grep -i hermit | wc -l
       6

$ fc-list : postscriptname | grep -i hermit
:postscriptname=Hermit-Regular
:postscriptname=Hermit-RegularItalic
:postscriptname=Hermit-LightItalic
:postscriptname=Hermit-Bold
:postscriptname=Hermit-Light
:postscriptname=Hermit-BoldItalic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fc-match hermit 
Hermit-Regular.otf: &quot;Hermit&quot; &quot;Regular&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fc-match Hermit
Hermit-Regular.otf: &quot;Hermit&quot; &quot;Regular&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fc-query /usr/local/share/fonts/hermit/Hermit-Regular.otf | wc -l
      41
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fc-query /usr/local/share/fonts/hermit/Hermit-Regular.otf 
---- snip ----
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ file /usr/local/share/fonts/hermit/Hermit-Regular.otf
/usr/local/share/fonts/hermit/Hermit-Regular.otf: OpenType font data
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ otfinfo --info /usr/local/share/fonts/hermit/Hermit-Regular.otf
---- snip ----
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ otfinfo --features /usr/local/share/fonts/hermit/Hermit-Regular.otf
---- snip ----
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ otfinfo --scripts /usr/local/share/fonts/hermit/Hermit-Regular.otf
---- snip ----
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ otfinfo --glyphs /usr/local/share/fonts/hermit/Hermit-Regular.otf | wc -l
     393
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ otfinfo --glyphs /usr/local/share/fonts/hermit/Hermit-Regular.otf | wc -l
---- snip ----
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ otfinfo --unicode /usr/local/share/fonts/hermit/Hermit-Regular.otf | wc -l
     391
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ otfinfo --unicode /usr/local/share/fonts/hermit/Hermit-Regular.otf 
---- snip ----
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ otfinfo --font-version /usr/local/share/fonts/hermit/Hermit-Regular.otf
Version 2.000;PS 002.000;hotconv 1.0.88;makeotf.lib2.5.64775
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ otfinfo --optical-size /usr/local/share/fonts/hermit/Hermit-Regular.otf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ otfinfo --postscript-name /usr/local/share/fonts/hermit/Hermit-Regular.otf
Hermit-Regular
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fc-list -v Hermit-Regular charset 
---- snip ----
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fc-list -v Hermit-Regular
---- snip ----
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xfd -fa Hermit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xterm -fa Hermit -fs 14
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xterm -fa &apos;Hermit:light&apos; -fs 14
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; Font face size (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-fs&lt;/code&gt; option for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xterm&lt;/code&gt;) and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pixelsize&lt;/code&gt; are 
not the same so the following two are different:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xterm -fa &apos;Hermit:light:pixelsize=14:antialias=true:autohint=true&apos;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xterm -fa &apos;Hermit:light:antialias=true:autohint=true&apos; -fs 14
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This table gives an approximate conversion between points and pixels:&lt;br /&gt;
&lt;a href=&quot;https://reeddesign.co.uk/test/points-pixels.html&quot;&gt;Approximate conversion from points to pixels - ReedDesign&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Here’s a chart that converts points to pixels (and ems and %). 
It’s an approximation, which will depend on font, browser and OS, but 
it’s a good starting point.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;As per that table, 14pt is approximately 19px:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ xterm -fa &apos;Hermit:light:pixelsize=19:antialias=true:autohint=true&apos;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and that’s the same (similar) to the font face size of 14: &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$ xterm -fa &apos;Hermit:light:antialias=true:autohint=true&apos; -fs 14&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Hermit font setup reference: &lt;br /&gt;
&lt;a href=&quot;http://eradman.com/posts/openbsd-workstation.html&quot;&gt;Eric Radman - Workstation Notes&lt;/a&gt; (Retrieved on Apr 17, 2022)&lt;/p&gt;

&lt;h2 id=&quot;converting-unicode-to-utf-8&quot;&gt;Converting Unicode to UTF-8&lt;/h2&gt;

&lt;h3 id=&quot;a-short-introduction&quot;&gt;A Short Introduction&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; Not going into details about different operating systems, 
different shells, different fonts, locales, different editors, 
different ordering and byte format (7-bit, 8-bit, single byte, 
double byte, multi-byte), double-wide characters, collation, 
endianness, composing &amp;amp; decomposing, UTF-8 vs. UTF-16 vs. UTF-32
&lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;, etc.&lt;/p&gt;

&lt;p&gt;Here’s just a few references to illustrate how complex this area is:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://scripts.sil.org/cms/scripts/page.php?site_id=nrsi&amp;amp;id=UnicodeSupport&quot;&gt;Software requirements for different levels of Unicode Support&lt;/a&gt; (Retrieved on Apr 17, 2022):&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Vim supports editing Unicode in the GUI version and in terminals that 
support UTF-8.  Double-wide characters can be used, and up to two 
composing characters are supported.  When reading a file, Vim can often 
detect how it is encoded and convert the text when necessary. 
UTF-8 files are edited without conversion.  Other Unicode formats 
(16 bit and 32 bit) are converted internally.  Conversion is also used 
to edit files in just about any encoding, using an external converter.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://invisible-island.net/ncurses/ncurses.faq.html&quot;&gt;About Vim’s Unicode support - from What is ncurses? - by Thomas E. Dickey, developer and maintainer of xterm&lt;/a&gt; &lt;br /&gt;
(Updated on Mar 16, 2022) (Retrieved on Apr 17, 2022):&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Vim &lt;br /&gt;
Vim’s developers provide their own termcap definitions, just in case 
there is nothing good enough on the system, and provide features for 
overriding the system’s termcap capabilities even when using the system 
definition as a starting point.  Because of this, vim has had little 
impact on ncurses development; the change-log does not mention vim. 
On the other hand, unlike screen, the source-code for vim still contains 
a comment about a bug in ncurses which was addressed in late 1997, 
before ncurses 4.2 was released.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://vi.stackexchange.com/questions/341/what-is-the-relation-between-vi-nvi-and-vim&quot;&gt;History of - What is the relation between vi, nvi and vim? - Vi and Vim Stack Exchange&lt;/a&gt; (Retrieved on Apr 17, 2022)&lt;/p&gt;

&lt;p&gt;From &lt;a href=&quot;http://ex-vi.sourceforge.net/&quot;&gt;The Traditional Vi&lt;/a&gt; (Retrieved on Apr 17, 2022):&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;This port of vi has generally preserved the original style, terminal 
control, and feature set.  It adds &lt;strong&gt;support for international character 
sets, including multibyte encodings such as UTF-8&lt;/strong&gt; (&lt;em&gt;emphasis mine&lt;/em&gt;), 
and some minor enhancements that were not present in BSD vi 3.7, but had 
been included in later vi versions for System V or in POSIX.2.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;and&lt;/p&gt;

&lt;p&gt;From &lt;a href=&quot;http://ex-vi.sourceforge.net/README&quot;&gt;The Traditional Vi README&lt;/a&gt; (Retrieved on Apr 17, 2022):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Welcome to the ex/vi port!
==========================

This implementation is derived from ex/vi 3.7 of 6/7/85 and the BSD
termcap library, originally from the 2.11BSD distribution. All of them
were changed to compile and run on newer POSIX compatible Unix systems.
Support for international character sets was added, including support
for multibyte locales (based on UTF-8 or East Asian encodings), and some
changes were made to get closer to the POSIX.2 guidelines for ex and
vi. Some issues that were clearly bugs and not features have also been
resolved; see the Changes file for details.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On FreeBSD 13.1 - RELEASE:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% command -v vi; type vi; whereis vi; which vi
/usr/bin/vi
vi is /usr/bin/vi
vi: /usr/bin/vi /usr/share/man/man1/vi.1.gz
/usr/bin/vi
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -lh /usr/bin/vi
-r-xr-xr-x  6 root  wheel   463K Jul 27 11:06 /usr/bin/vi
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% command -v nvi; type nvi; whereis nvi; which nvi
/usr/bin/nvi
nvi is /usr/bin/nvi
nvi: /usr/bin/nvi /usr/share/man/man1/nvi.1.gz
/usr/bin/nvi
 
% ls -lh /usr/bin/nvi
-r-xr-xr-x  6 root  wheel   463K Jul 27 11:06 /usr/bin/nvi
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% diff /usr/bin/vi /usr/bin/nvi
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Reference:  &lt;br /&gt;
From a FreeBSD Forum post started on Dec 24, 2014 &lt;br /&gt;
&lt;a href=&quot;https://forums.freebsd.org/threads/how-do-i-type-in-special-characters-such-as-in-the-terminal-in-vi.49659/&quot;&gt;How do I type in special characters, such as ∞ in the terminal in vi?&lt;/a&gt;, 
post #3 &lt;a href=&quot;https://forums.FreeBSD.org/threads/how-do-i-type-in-special-characters-such-as-in-the-terminal-in-vi.49659/post-277491&quot;&gt;https://forums.FreeBSD.org/threads/how-do-i-type-in-special-characters-such-as-in-the-terminal-in-vi.49659/post-277491&lt;/a&gt; (Retrieved on Apr 17, 2022): &lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;For a complete and detailed list of differences and improvements, 
here’s the official &lt;a href=&quot;https://vimhelp.org/vi_diff.txt.html#vi-differences&quot;&gt;Differences between Vim and Vi&lt;/a&gt; document at the &lt;a href=&quot;https://vimhelp.org/&quot;&gt;Vim help files&lt;/a&gt; site (an HTML version of the Vim help pages).&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;converting-unicode-to-utf-8-when-you-know-unicode-code-point&quot;&gt;Converting Unicode to UTF-8 When You Know Unicode Code Point&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;  Code point is also known as codepoint or code position.&lt;/p&gt;

&lt;h4 id=&quot;converting-with-od1&quot;&gt;Converting with od(1)&lt;/h4&gt;

&lt;p&gt;OS: FreeBSD 13.1 &lt;br /&gt;
Shell: csh&lt;/p&gt;

&lt;p&gt;For example, use the character U+02B7: MODIFIER LETTER SMALL W for testing: &lt;br /&gt;
&lt;a href=&quot;https://charbase.com/02b7-unicode-modifier-letter-small-w&quot;&gt;U+02B7: MODIFIER LETTER SMALL W&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://charbase.com/&quot;&gt;Charbase - A visual Unicode database&lt;/a&gt;
(Retrieved on Apr 17, 2022)&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Charbase is a visual database of characters from the Unicode 6.1 
standard, made available without clutter.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;With &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;uni.pl&lt;/code&gt; Perl script, obtained from Leah Neukirchen’s dotfiles and bin section:  &lt;br /&gt;
&lt;a href=&quot;https://leahneukirchen.org/dotfiles/bin/uni&quot;&gt;uni PATTERN - list unicode symbols matching PATTERN&lt;/a&gt;) (Retrieved on Apr 17, 2022):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ./uni.pl ʷ
ʷ       02B7    MODIFIER LETTER SMALL W
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% printf ʷ &amp;gt; chartest
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat chartest
ʷ% 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% od -ac chartest
0000000   ca  b7
           ʷ  **
0000002
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% printf %s\\n ʷ &amp;gt; chartest
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat chartest
ʷ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% od -ac chartest
0000000   ca  b7  nl
           ʷ  **  \n
0000003
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% od -N 1 -ac chartest
0000000   ca
         312
0000001
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is a 2-byte character:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% od -N 2 -ac chartest
0000000   ca  b7
           ʷ  **
0000002
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In &lt;strong&gt;UTF-8&lt;/strong&gt;, this character is  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CA B7&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% od -N 2 -t x1 chartest
0000000    ca  b7
0000002
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% od -N 2 -c -t x1 chartest
0000000    ʷ  **
           ca  b7
0000002
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% od -N 2 -ab chartest
0000000   ca  b7
          312 267
0000002
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;TIP:&lt;/strong&gt;&lt;br /&gt;
For POSIX compliance, use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;printf&lt;/code&gt; instead of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;echo&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://unix.stackexchange.com/questions/65803/why-is-printf-better-than-echo&quot;&gt;Why is printf better than echo?&lt;/a&gt; (Retrieved on Apr 17, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.in-ulm.de/%7Emascheck/various/echo+printf/&quot;&gt;echo(1) and printf(1)&lt;/a&gt; (Retrieved on Apr 17, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.etalabs.net/sh_tricks.html&quot;&gt;Rich’s sh (POSIX shell) tricks&lt;/a&gt; (Retrieved on Apr 17, 2022)&lt;/p&gt;

&lt;p&gt;For POSIX compliance, for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;printf&lt;/code&gt; you need &lt;strong&gt;octal&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; Not going into details about different operating systems, 
different shells, different fonts, locales, etc.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% printf &apos;\312\267&apos;
ʷ%
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% printf &apos;\312\267\n&apos;
ʷ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  On FreeBSD 13.1-RELEASE in csh:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% command -v printf; type printf; whereis printf; which printf
printf
printf is a shell builtin
printf: /usr/bin/printf /usr/share/man/man1/printf.1.gz
/usr/bin/printf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% freebsd-version
13.1-RELEASE

% ps $$
  PID TT  STAT    TIME COMMAND
22492  9  Ss   0:00.17 -csh (csh)

% printf %s\\n &quot;$SHELL&quot;
/bin/csh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;TIP:&lt;/strong&gt;  You can use the Posix-standard &lt;a href=&quot;https://pubs.opengroup.org/onlinepubs/9699919799/utilities/command.html&quot;&gt;command&lt;/a&gt; command to avoid the use of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;printf&lt;/code&gt; builtin: &lt;br /&gt;
  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;command printf&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;You can also do it directly by specifying the complete path to the 
non-builtin &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;printf&lt;/code&gt;:  &lt;br /&gt;
  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/bin/printf&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Discussion about this (retrieved on Apr 17, 2022): &lt;br /&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/27652458/whats-the-best-way-to-embed-a-unicode-character-in-a-posix-shell-script&quot;&gt;What’s the best way to embed a Unicode character in a POSIX shell script?&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Per this reference (retrieved on Apr 17, 2022):  &lt;br /&gt;
&lt;a href=&quot;https://askubuntu.com/questions/601137/how-to-print-an-octal-values-corresponding-utf-8-character-in-bash&quot;&gt;https://askubuntu.com/questions/601137/how-to-print-an-octal-values-corresponding-utf-8-character-in-bash&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% printf &quot;%b\n&quot; &apos;\312\267&apos;
ʷ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% awk &apos;BEGIN {print &quot;\312\267&quot;}&apos;
ʷ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;converting-unicode-to-utf-8-when-you-dont-know-unicode-code-point&quot;&gt;Converting Unicode to UTF-8 When You Don’t Know Unicode Code Point&lt;/h3&gt;

&lt;p&gt;From 
&lt;a href=&quot;https://unix.stackexchange.com/questions/55770/does-hexdump-respect-the-endianness-of-its-system&quot;&gt;Does hexdump respect the endianness of its system?&lt;/a&gt; 
(Retrieved on Apr 17, 2022):&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The traditional BSD hexdump utility uses the platform’s endianness so 
the output you see means your machine is little-endian.&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;TIP:&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;hexdump -C&lt;/code&gt; (or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;od -t x1&lt;/code&gt;) to get &lt;strong&gt;consistent byte-by-byte output 
irrespective of the platform’s endianness&lt;/strong&gt; (&lt;em&gt;emphasis mine&lt;/em&gt;).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Therefore:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% printf ʷ | hexdump -C
00000000  ca b7                                             |..|
00000002
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% printf ʷ | od -t x1
0000000    ca  b7
0000002
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From here, follow the instructions above for:  &lt;br /&gt;
&lt;a href=&quot;#converting-unicode-to-utf-8-when-you-know-unicode-code-point&quot;&gt;Converting Unicode to UTF-8 When You Know Unicode Code Point&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Also, from the same question - different answer:  &lt;br /&gt;
&lt;a href=&quot;https://unix.stackexchange.com/questions/55770/does-hexdump-respect-the-endianness-of-its-system/55771#55771&quot;&gt;https://unix.stackexchange.com/questions/55770/does-hexdump-respect-the-endianness-of-its-system/55771#55771&lt;/a&gt;
(Retrieved on Apr 17, 2022):&lt;/p&gt;

&lt;p&gt;Your output is little-endian (least significant byte first), which is also the endianness of the x86 and x86_64 architectures, which you are probably using.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;  If no format strings are specified, the default display 
in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;hexdump(1)&lt;/code&gt; is equivalent to specifying the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-x&lt;/code&gt; option – From the 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;hexdump(1)&lt;/code&gt; manpage:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-x      Two-byte hexadecimal display.  Display the input offset in hexa‐
        decimal, followed by eight, space separated, four column, zero-
        filled, two-byte quantities of input data, in hexadecimal, per
        line.

... 

If no format strings are specified, the default display is equivalent 
to specifying the -x option.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% printf ʷ | hexdump
0000000 b7ca
0000002
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;troubleshooting-fonts&quot;&gt;Troubleshooting Fonts&lt;/h2&gt;

&lt;h3 id=&quot;try-a-different-application&quot;&gt;Try a Different Application&lt;/h3&gt;

&lt;p&gt;Even though you can list a font with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-list(1)&lt;/code&gt; and then grep for it,
sometimes it will not be available in some applications, or if it’s
available it will not work.&lt;/p&gt;

&lt;p&gt;Possible fix: try a different app.
For example, I had a problem with a font in TEA &lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;
and LibreOffice &lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt;4&lt;/a&gt;&lt;/sup&gt; – The fix was to use
AbiWord &lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;, which worked fine with that font.&lt;/p&gt;

&lt;h3 id=&quot;useful-tools-commands-and-code-snippets-for-troubleshooting-fonts-in-x11&quot;&gt;Useful Tools, Commands and Code Snippets for Troubleshooting Fonts in X11&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Search for a font by its name:&lt;/strong&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-list : fullname | grep -i FontNameHere&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Search for a font by its PostScript name:&lt;/strong&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-list : postscriptname | grep -i FontNameHere&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Show the list of supported characters in a font:&lt;/strong&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-list -v &apos;FontName: style=Regular&apos; charset&lt;/code&gt;   &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-list -v &apos;FontName&apos; charset&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Query the font:&lt;/strong&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-query /usr/local/share/fonts/FontNameHere/FontFile.ttf&lt;/code&gt;
Number of elts (size) that pattern has, family, style (e.g. Regular),
fullname, slant, weight, width, foundry, is it outline, is it scalable,
charset, lang (supported languages), fontversion, postscriptname,
is it color.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Display the font (display all the characters) in an X core font:&lt;/strong&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xfd -fn FontName&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Display the font (display all the characters) in an Xft font:&lt;/strong&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xfd -fa FontName&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Check if the current terminal and font support a Unicode character
(with Perl) (e.g. “ʷ” U+02B7: Modifier Letter Small W):&lt;/strong&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;perl -C -e &apos;print chr 0x02B7&apos;&lt;/code&gt;
    or
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;perl -C -e &apos;print pack(&quot;U&quot;,0x02b7).&quot;\n&quot;&apos;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Reference:  Create unicode character with pack &lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt;6&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;A simple Perl one-liner:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% perl -e &apos;print chr(0x02b7); print &quot;\n&quot;&apos;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Wide character in print at -e line 1.
ʷ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Alternatively:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% perl -e &apos;print &quot;\x{02b7}\n&quot;&apos;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Wide character in print at -e line 1.
ʷ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;  “Wide character in print at …”
Perl warns you if you print a string that has a character with an ordinal
value greater than 255 (hence it is a “wide” character that requires more
than one byte of storage).
Explicitly &lt;a href=&quot;https://en.wikibooks.org/wiki/Perl_Programming/Unicode_UTF-8#3._Encoding_and_output&quot;&gt;encode your output&lt;/a&gt; to avoid this warning:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% perl -e &apos;binmode STDOUT, &quot;:encoding(utf8)&quot;; print &quot;\x{02b7}\n&quot;&apos;
ʷ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% perl -e &apos;binmode STDOUT, &quot;:encoding(utf8)&quot;; print chr(0x02b7); print &quot;\n&quot;&apos;
ʷ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;From &lt;a href=&quot;https://stackoverflow.com/questions/31198425/perl-pack-a-utf-8-chinese-character-how-to-unpack-to-get-this-character&quot;&gt;perl pack a utf-8 Chinese Character how to unpack to get this Character?&lt;/a&gt; (Retrieved on Apr 17, 2022):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat unpack.pl
#!/usr/local/bin/perl

use utf8;
binmode STDOUT,&quot;:utf8&quot;;

my $packed = pack(&quot;U*&quot;, 0x02b7);
print &quot;$packed\n&quot;;  # ʷ

my $unpacked = unpack(&quot;U*&quot;, &quot;ʷ&quot;);
printf &quot;0x%X\n&quot;, $unpacked;  # 0x02b7
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% chmod 0744 unpack.pl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ./unpack.pl
ʷ
0x2B7
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Another useful Perl Unicode code snippet:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% perl -MDevel::Peek -e &apos;Dump(pack(&quot;U&quot;, 0x02b7));&apos;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SV = PV(0x800e28060) at 0x800e5f7b0
  REFCNT = 1
  FLAGS = (PADTMP,POK,READONLY,PROTECT,pPOK,UTF8)
  PV = 0x800f16480 &quot;\312\267&quot;\0 [UTF8 &quot;\x{2b7}&quot;]
  CUR = 2
  LEN = 32
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Check if the current terminal and font support a Unicode character
(with Python):&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% command -v python; which python
python: Command not found.

% command -v python2; which python2
python2: Command not found.

% command -v python3; which python3
python3: Command not found.

% command -v python3.7; which python3.7
python3.7: Command not found.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% command -v python3.8; which python3.8
/usr/local/bin/python3.8
/usr/local/bin/python3.8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% python3.8 -c &apos;print(u&quot;\u02B7&quot;)&apos;
ʷ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% python3.8 -c &apos;print(u&quot;\u02B7\n&quot;)&apos;
ʷ

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;From “Beyond Linux® From Scratch (System V Edition) - Version r11.1-906 - Chapter 24. Graphical Environments”, &lt;a href=&quot;https://www.linuxfromscratch.org/blfs/view/svn/x/tuning-fontconfig.html&quot;&gt;Tuning Fontconfig&lt;/a&gt;
(retrieved on Apr 17, 2022):&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-list | less&lt;/code&gt;: show a list of all available fonts (/path/to/filename:
Font Name:style).  If you installed a font more than 30 seconds ago but
it does not show, then it or one of its directories is not readable by
your user.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-match &apos;Font Name&apos;&lt;/code&gt;: will tell you which font will be used if the named
font is requested.  Typically you would use this to see what happens if a
font you have not installed is requested, but you can also use it if the
system is giving you a different font from what you expected (perhaps
because fontconfig does not agree that the font supports your language).&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-match -a &apos;Type&apos; | less&lt;/code&gt;: will provide a list of all fonts which can be
used for that type (Monospace, Sans, Serif).  Note that in-extremis
fontconfig will take a glyph from any available font, even if it is not of
the specified type, and unless it knows about the font’s type it will
assume it is Sans.&lt;/p&gt;

&lt;p&gt;If you wish to know which font will be used for a string of text (i.e. one
or more glyphs, preceded by a space), paste the following command and
replace the xyz by the text you care about:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FC_DEBUG=4 pango-view --font=monospace -t xyz | grep family&lt;/code&gt;: this requires
&lt;a href=&quot;https://www.linuxfromscratch.org/blfs/view/svn/x/pango.html&quot;&gt;Pango-1.50.8&lt;/a&gt;
and &lt;a href=&quot;https://www.linuxfromscratch.org/blfs/view/svn/general/imagemagick.html&quot;&gt;ImageMagick-7.1.0-25&lt;/a&gt; - it will invoke display to show the
text in a tiny window, and after closing that the last line of the output
will show which font was chosen.  This is particularly useful for CJK
languages, and you can also pass a language,
e.g. PANGO_LANGUAGE=en;ja (English, then assume Japanese) or
just zh-cn (or other variants - ‘zh’ on its own is not valid). – My Note:
This works in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bash&lt;/code&gt; and compatible shells.
For &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;csh/tcsh&lt;/code&gt;, use:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;env DISPLAY=:0 FC_DEBUG=4 pango-view --font=monospace -t xyz | grep family&lt;/code&gt;
    or
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;env FC_DEBUG=4 pango-view --font=monospace -t xyz | grep family&lt;/code&gt;
    or (for no output, reduce debugging level to zero):
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;env FC_DEBUG=0 pango-view --font=monospace -t xyz | grep family&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;tools-and-test-pages-available-online-unicode-utf-8-encodings&quot;&gt;Tools and Test Pages Available Online: Unicode, UTF-8, Encodings&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://jkorpela.fi/chars/test8.htm&quot;&gt;Test page for 8-bit encodings&lt;/a&gt; &lt;br /&gt;
(Created on May 11, 2005 - Retrieved on Apr 17, 2022)
    &lt;blockquote&gt;
      &lt;p&gt;The table contains alternating rows with octets in the range 
128–255 (decimal) and ISO 8859-1 characters with the same code numbers. 
The first two rows for ISO 8859-1 have been greyed out, since those 
code positions do not contain printable characters but are reserved 
for control character purposes.&lt;/p&gt;

      &lt;p&gt;This document has no character encoding information.  This allows you 
to view it using various 8-bit encodings.  On Internet Explorer, 
&amp;lt; for example, select View, then Encoding, and then for example 
Baltic (Windows) in order to compare Windows Baltic with ISO 8859-1.&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jkorpela.fi/fui.html8&quot;&gt;Full Unicode Input utility (for Unicode version 14)&lt;/a&gt; &lt;br /&gt;
(Created on Oct 2, 2012 - Retrieved on Apr 17, 2022)
    &lt;blockquote&gt;
      &lt;p&gt;This utility can be characterized as an online extended character map 
oriented towards writing characters.  It displays a table that looks 
like a set of keyboard buttons, and clicking on a button you enter the 
character in question.  The characters will be appended to the text 
input area on the right.&lt;/p&gt;

      &lt;p&gt;You can also type the Unicode number of a character in the box prefixed 
by “U+” and press Enter or click on the Add button.&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;And, of course, have in mind:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://eev.ee/blog/2015/05/20/i-stared-into-the-fontconfig-and-the-fontconfig-stared-back-at-me/&quot;&gt;I stared into the fontconfig, and the fontconfig stared back at me&lt;/a&gt; - Posted: May 20, 2015 – Retrieved: Apr 17, 2022&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.reddit.com/r/linux/comments/97z73q/i_stared_into_the_fontconfig_and_the_fontconfig/&quot;&gt;I stared into the fontconfig, and the fontconfig stared back at me / fuzzy notepad - r/linux&lt;/a&gt; – Retrieved: Apr 17, 2022&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.reddit.com/r/programming/comments/36wcu7/i_stared_into_the_fontconfig_and_the_fontconfig/&quot;&gt;I stared into the fontconfig, and the fontconfig stared back at me - r/programming&lt;/a&gt; – Retrieved: Apr 17, 2022&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;From blog post:
&lt;a href=&quot;https://eev.ee/blog/2015/05/20/i-stared-into-the-fontconfig-and-the-fontconfig-stared-back-at-me/&quot;&gt;I stared into the fontconfig, and the fontconfig stared back at me&lt;/a&gt; - Posted: May 20, 2015 – Retrieved: Apr 17, 2022:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Some hot parting tips&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-cache&lt;/code&gt; will force fontconfig to pick up any changes.  There’s a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-f&lt;/code&gt;,
but in all my fighting with fontconfig it never once made a difference.&lt;/p&gt;

&lt;p&gt;As far as I can tell, there is no reason to ever run sudo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-cache -vf&lt;/code&gt;.
This has been floating around the Internet for years, but it seems to be
apocryphal copy/paste.  You don’t need to flush root’s fontconfig cache
unless you’re running GUI stuff as root.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-match &amp;lt;font&amp;gt;&lt;/code&gt; will tell you what font will be used in practice.
You might think that’s what &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-query&lt;/code&gt; does, and you’d be wrong.
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-query&lt;/code&gt;’s primary use is to produce bizarre error messages when you
accidentally use it instead of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-match&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;It is really fxxxing difficult to figure out what font will be used for
a specific glyph.  There are two approaches:&lt;/p&gt;

&lt;p&gt;1. Do it in a [web] browser.  Make a URL like this (that is, enter it in the
browser’s address bar):
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;data:text/html,&amp;lt;meta charset=&quot;utf8&quot;&amp;gt;&amp;lt;p style=&quot;font-family: monospace;&quot;&amp;gt;☺&amp;lt;/p&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Then pop open your dev tools, and look for where it tells you the fonts
that are actually being used.  Firefox’s Inspector has a dedicated “fonts”
tab in the panel on the right; Chromium’s Elements lists fonts at the
bottom of the “computed” tab.&lt;/p&gt;

&lt;p&gt;Fair warning: this is one level removed from fontconfig, because CSS font
rules may interfere.  This bit me above when I tried to confirm my new
cursive font in Firefox!&lt;/p&gt;

&lt;p&gt;Another warning: while Firefox picks up fontconfig changes more or less
instantly (after an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fc-cache&lt;/code&gt;), Chromium does not.  Worse, Chromium seems
to outright ignore fontconfig when it feels like it, such as when it used
a sans serif Japanese font for text styled as serif.&lt;/p&gt;

&lt;p&gt;2. You can also do this nonsense in a terminal:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DISPLAY=:0 FC_DEBUG=4 pango-view --font=monospace -t ☺ | grep family:&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;My note:&lt;/strong&gt; -&amp;gt; for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;csh/tcsh&lt;/code&gt;:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;env DISPLAY=:0 FC_DEBUG=4 pango-view --font=monospace -t ☺ | grep family:&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pango-view&lt;/code&gt; is a tiny program that just pops open a window containing
some text in a particular font.  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FC_DEBUG&lt;/code&gt; is an environment variable to
make fontconfig spit out mountains of fxxxing text on stdout.  The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;grep&lt;/code&gt;
cuts it down to something a little more manageable.  Most likely the last
family you see listed is the font actually being used to render your
favourite glyph.&lt;/p&gt;

&lt;p&gt;If you’re really curious how the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;match&amp;gt;&lt;/code&gt; blocks work, good news:
they are the one thing the &lt;a href=&quot;http://www.freedesktop.org/software/fontconfig/fontconfig-user.html&quot;&gt;fontconfig docs&lt;/a&gt; actually kind of explain.
And of course your &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/fonts/conf.d&lt;/code&gt;
(&lt;strong&gt;my note:&lt;/strong&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local/etc/fonts/conf.d&lt;/code&gt; on FreeBSD) is probably full
of real-world practical examples.&lt;/p&gt;

&lt;p&gt;…&lt;/p&gt;

&lt;p&gt;From the same blog:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;I haven’t put my fontconfig font config (…) in my
&lt;a href=&quot;https://github.com/eevee/rc/&quot;&gt;rc.git&lt;/a&gt;; it seems pretty specific to my
desktop’s particular setup.
But here’s &lt;a href=&quot;https://gist.github.com/eevee/ba231c1b9b64e6ced70d&quot;&gt;the whole thing in a gist&lt;/a&gt;, if you’re interested.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;

&lt;p&gt;[1] A nice overview and discussion about UTF-8, UTF-16 and UTF-32 on StackOverflow:  &lt;a href=&quot;https://stackoverflow.com/questions/496321/utf-8-utf-16-and-utf-32&quot;&gt;UTF-8, UTF-16, and UTF-32&lt;/a&gt; (Posted on Jan 30, 2009; Retrieved on Apr 17, 2022)&lt;/p&gt;

&lt;p&gt;[2] From a FreeBSD Forum post started on Dec 24, 2014 &lt;a href=&quot;https://forums.freebsd.org/threads/how-do-i-type-in-special-characters-such-as-in-the-terminal-in-vi.49659/&quot;&gt;How do I type in special characters, such as ∞ in the terminal in vi?&lt;/a&gt;, 
post #3 &lt;a href=&quot;https://forums.FreeBSD.org/threads/how-do-i-type-in-special-characters-such-as-in-the-terminal-in-vi.49659/post-277491&quot;&gt;https://forums.FreeBSD.org/threads/how-do-i-type-in-special-characters-such-as-in-the-terminal-in-vi.49659/post-277491&lt;/a&gt; (Retrieved on Apr 17, 2022):&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Which vi?  vi on Linux is just a soft link to Vim.  On BSDs vi is 
symbolic link to nvi (new vi) which is a re-implementation of the 
“classic Berkeley vi”.  “Classical Berkeley vi” has multiple versions 
IIRC one of which is personal copy of Bill Joy.  Solaris’ version of vi 
could also be considered classical as well as traditional vi 
&lt;a href=&quot;http://ex-vi.sourceforge.net/&quot;&gt;http://ex-vi.sourceforge.net/&lt;/a&gt;. 
Reading documentation of traditional vi project is a good start.&lt;/p&gt;

  &lt;p&gt;To make matters more confusing BSD projects continue to use nvi 
version 1.79 due to licensing issues between Berkeley Database 1.85 and 
the later versions by Sleepycat Software.  nvi has a support for Unicode 
but I am not sure if the version 1.79 includes or not as I have never 
used Unicode with nvi.
Now &lt;a href=&quot;https://forums.freebsd.org/members/scottro.1587/&quot;&gt;scottro&lt;/a&gt; made 
a major mistake mentioning Unicode as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$\infty$&lt;/code&gt; as written in TeX is 
extended ASCII character and one doesn’t need Unicode to type it. 
I do not know how would you type &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$\infty$&lt;/code&gt; in nvi as a professional 
mathematician I have never seen any mathematical symbols or mathematical 
text typing without serious text typing system such as TeX or Troff. 
TeX is de-facto standard for typing mathematics adopted since 
1979 by AMS.  Troff uses mathematical pre-processor and is definitely 
able to produce all special mathematical characters.  On the web we use 
MathJax, a cross-browser JavaScript library that displays in web, 
using MathML, LaTeX and ASCIIMathML markup to write mathematics.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;[3] Retrieved on Apr 17, 2022: &lt;br /&gt;
    &lt;a href=&quot;https://tea.ourproject.org/&quot;&gt;TEA - text editor&lt;/a&gt;    &lt;br /&gt;
    &lt;a href=&quot;https://en.wikipedia.org/wiki/TEA_%28text_editor%29&quot;&gt;TEA (text editor) - Wikipedia&lt;/a&gt;   &lt;br /&gt;
    &lt;a href=&quot;https://www.linuxinsider.com/story/tea-a-smooth-text-editor-that-hits-the-sweet-spot-74677.html&quot;&gt;TEA: A Smooth Text Editor That Hits the Sweet Spot&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;[4] Retrieved on Apr 17, 2022:  &lt;br /&gt;
    &lt;a href=&quot;https://www.libreoffice.org/&quot;&gt;LibreOffice&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;[5] Retrieved on Apr 17, 2022:  &lt;br /&gt;
    &lt;a href=&quot;http://www.abisource.com/&quot;&gt;AbiWord&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;[6] Retrieved on Apr 17, 2022:  &lt;br /&gt;
    &lt;a href=&quot;https://stackoverflow.com/questions/30851728/create-unicode-character-with-pack&quot;&gt;Create unicode character with pack&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

</description>
        <pubDate>Sun, 17 Apr 2022 09:14:33 -0700</pubDate>
        <link>http://localhost:4000/font/freebsd/unix/x11/xorg/dotfiles/2022/04/17/x-fonts.html</link>
        <guid isPermaLink="true">http://localhost:4000/font/freebsd/unix/x11/xorg/dotfiles/2022/04/17/x-fonts.html</guid>
        
        
        <category>font</category>
        
        <category>freebsd</category>
        
        <category>unix</category>
        
        <category>x11</category>
        
        <category>xorg</category>
        
        <category>dotfiles</category>
        
      </item>
    
      <item>
        <title>FVWM - F Virtual Window Manager</title>
        <description>&lt;hr /&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo pkg install fvwm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;About FVWM - from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pkg info --regex --full fvwm&lt;/code&gt; 3 &lt;sup&gt;&lt;a href=&quot;#footnotes&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;/&lt;sub&gt;4&lt;/sub&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[TODO]&lt;/strong&gt; &lt;br /&gt;
Replace &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mydotfiles...&lt;/code&gt; with
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fetch https://zensites.net/fvwm/guide/fvwm-guide-icons.tar.bz2&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cp -rf \
 /mnt/usbflashdrive/mydotfiles/FVWM.freebsd.lenovo.x280.2022_07_10_2200/THEME-2-ARCTIC/.fvwm/* \
 ~/.fvwm/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ grep -n icons ~/.fvwm/config
36:#   2. Place all icons in this directory:
37:#        /usr/local/share/icons/gnant
38:#   3. It might take a couple of minutes for some icons in the dock
40:#      clock icons.
49:SetEnv  fvwm_icon               /usr/local/share/icons/$[fvm_gnome_icon_theme]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ grep -n fvm_gnome_icon_theme ~/.fvwm/config
48:SetEnv  fvm_gnome_icon_theme    gnant
49:SetEnv  fvwm_icon               /usr/local/share/icons/$[fvm_gnome_icon_theme]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fetch https://strog.org/files/gnant-0.2.tar.bz2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ tar xf gnant-0.2.tar.bz2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo mv gnant /usr/local/share/icons/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ rm -i gnant-0.2.tar.bz2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ fetch https://zensites.net/fvwm/guide/fvwm-guide-icons.tar.bz2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ tar xf fvwm-guide-icons.tar.bz2 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -alh
total 198
drwxr-xr-x   3 dusko  wheel     4B Apr 16 08:25 .
drwxrwxrwt  37 root   wheel   570B Apr 16 08:23 ..
drwxr-xr-x   7 dusko  wheel     8B Aug  5  2004 .fvwm
-rw-r--r--   1 dusko  wheel    73K Jan 14  2008 fvwm-guide-icons.tar.bz2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -alh .fvwm/
total 20
drwxr-xr-x  7 dusko  wheel     8B Aug  5  2004 .
drwxr-xr-x  3 dusko  wheel     4B Jul 11 19:25 ..
-rw-r--r--  1 dusko  wheel    17K Aug  5  2004 fvwm2rc-guide
drwxr-xr-x  5 dusko  wheel     5B Aug  5  2004 icons
drwxr-xr-x  5 dusko  wheel     5B Aug  5  2004 images
drwxr-xr-x  2 dusko  wheel     2B Aug  4  2004 screenshot
drwxr-xr-x  2 dusko  wheel     2B Aug  4  2004 scripts
drwxr-xr-x  2 dusko  wheel     2B Aug  4  2004 tmp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -alh .fvwm/icons/
total 35
drwxr-xr-x  5 dusko  wheel     5B Aug  5  2004 .
drwxr-xr-x  7 dusko  wheel     8B Aug  5  2004 ..
drwxr-xr-x  2 dusko  wheel    10B Aug  5  2004 48x48
drwxr-xr-x  2 dusko  wheel    28B Aug  5  2004 menu
drwxr-xr-x  2 dusko  wheel     7B Aug  5  2004 mini
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo cp -rf .fvwm/icons/menu /usr/local/share/icons/gnant/
$ sudo cp -rf .fvwm/icons/mini /usr/local/share/icons/gnant/
$ sudo cp -rf .fvwm/icons/48x48/* /usr/local/share/icons/gnant/48x48/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ rm -rf .fvwm/
$ rm -i fvwm-guide-icons.tar.bz2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo pkg install rox-filer
% sudo pkg install 3ddesktop
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code class=&quot;language-`&quot;&gt;% pkill Xorg
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Start X:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% exec xinit 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Alternatively:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ exec startx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;

&lt;p&gt;[1] From &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pkg info --regex --full fvwm&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;WWW            : http://www.fvwm.org/
Comment        : Popular virtual window manager for X

Description    :
Fvwm is a very famous window manager for X, which provides a
virtual/multiple disjoint desktop, a 3-D look for windows decorations,
shaped/color icons. It gives a very good emulation of mwm. A nice
button-bar can be used to provide convenient access to frequently used
functions or programs.

WWW: http://www.fvwm.org/

Jason C. Wells
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From &lt;a href=&quot;https://www.fvwm.org/&quot;&gt;https://www.fvwm.org/&lt;/a&gt; (Retrieved on Apr 16, 2022):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Fvwm is a virtual window manager for the X windows system. It was 
originally a feeble fork of TWM by Robert Nation in 1993 (fvwm history), 
and has evolved into the fantastic, fabulous, famous, flexible, and so on, 
window manager we have today.

Fvwm is ICCCM-compliant and highly configurable. Starting from a minimal 
configuration, Fvwm can be configured with both internal tools and third 
party software to customize most aspects of a desktop.

This site is an archive of documentation for Fvwm version 2.6.x, which is 
the current frozen release. For information about the development of Fvwm 
version 3, check out fvwmorg/fvwm3 on GitHub.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

</description>
        <pubDate>Sat, 16 Apr 2022 08:12:34 -0700</pubDate>
        <link>http://localhost:4000/2022/04/16/fvwm.html</link>
        <guid isPermaLink="true">http://localhost:4000/2022/04/16/fvwm.html</guid>
        
        
      </item>
    
      <item>
        <title>Converting Traditional sysV Init Scripts to systemd Unit Files</title>
        <description>&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;References:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;(All references retrieved on Apr 9, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://0pointer.de/blog/projects/systemd-for-admins-3.html&quot;&gt;How Do I Convert A SysV Init Script Into A systemd Service File? (systemd for Administrators, Part III)&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.redhat.com/en/blog/converting-traditional-sysv-init-scripts-red-hat-enterprise-linux-7-systemd-unit-files&quot;&gt;Converting traditional sysV init scripts to Red Hat Enterprise Linux 7 systemd unit files&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.golinuxcloud.com/create-systemd-service-example/&quot;&gt;Create systemd service in Linux [Explained with Example]&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

</description>
        <pubDate>Sat, 09 Apr 2022 09:03:31 -0700</pubDate>
        <link>http://localhost:4000/systemd/linux/howto/cli/terminal/shell/rhel/centos/sysadmin/2022/04/09/convert-sysvinit-to-systemd-service.html</link>
        <guid isPermaLink="true">http://localhost:4000/systemd/linux/howto/cli/terminal/shell/rhel/centos/sysadmin/2022/04/09/convert-sysvinit-to-systemd-service.html</guid>
        
        
        <category>systemd</category>
        
        <category>linux</category>
        
        <category>howto</category>
        
        <category>cli</category>
        
        <category>terminal</category>
        
        <category>shell</category>
        
        <category>rhel</category>
        
        <category>centos</category>
        
        <category>sysadmin</category>
        
      </item>
    
      <item>
        <title>TWM - Tab Window Manager for the X Window System</title>
        <description>&lt;p&gt;OS: FreeBSD 13.0  &lt;br /&gt;
Shell: csh/tcsh&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat ~/.twmrc
RestartPreviousState      # Reiconify iconified windows on startup
UsePPosition        &quot;on&quot;  # Use program-specified size hints accepted
NoTitle                   # No titlebars
BorderWidth         1     # Number of pixels for border around entire window
DontMoveOff               # Disallow moving windows off the visible screen
IconifyByUnmapping        # Iconifying a window sends it to the Icon Manager
AutoRelativeResize        # Don&apos;t wait until the window edge is crossed
NoGrabServer
RandomPlacement

IconManagerFont           &quot;a14&quot;
IconRegion                &quot;90x44-0+0&quot; North East 40 30 
IconManagerGeometry       &quot;90x44-0+0&quot; 1

IconManagerDontShow
{
  &quot;xclock&quot; &quot;xload&quot;
}

Color
{
    BorderColor &quot;red&quot;
    {
      &quot;XTerm&quot; &quot;red&quot;       # Active xterm window border: red
    }

    BorderColor           &quot;yellow&quot;
    BorderTileBackground  &quot;yellow&quot;
    BorderTileForeground  &quot;yellow&quot;

    DefaultBackground     &quot;rgb:2/a/9&quot;
    DefaultForeground     &quot;gray85&quot;
    TitleBackground       &quot;rgb:2/a/9&quot;
    TitleForeground       &quot;gray85&quot;
    MenuBackground        &quot;rgb:2/a/9&quot;
    MenuForeground        &quot;gray85&quot;
    MenuBorderColor       &quot;slategrey&quot;
    MenuTitleBackground   &quot;gray70&quot;
    MenuTitleForeground   &quot;rgb:2/a/9&quot;
    IconBackground        &quot;rgb:2/a/9&quot;
    IconForeground        &quot;gray85&quot;
    IconBorderColor       &quot;gray85&quot;

    IconManagerHighlight  &quot;white&quot;

    IconManagerBackground &quot;rgb:2/a/9&quot;
    {
      &quot;XTerm&quot;             &quot;#ff595e&quot;
      &quot;tea&quot;               &quot;#1982c4&quot;
      &quot;KeePassXC&quot;         &quot;#ffca3a&quot;
      &quot;Thunderbird&quot;       &quot;#6a4c93&quot;
      &quot;Firefox&quot;           &quot;#8ac926&quot; 
      &quot;LibreOffice&quot;       &quot;#deff0a&quot;
      &quot;soffice.bin&quot;       &quot;#deff0a&quot;
      &quot;Zathura&quot;           &quot;#be0aff&quot;
    }

    IconManagerForeground &quot;gray85&quot;
    {
      &quot;XTerm&quot;             &quot;#fae0e4&quot;
      &quot;tea&quot;               &quot;#84DE02&quot;
      &quot;KeePassXC&quot;         &quot;#219ebc&quot; 
      &quot;Thunderbird&quot;       &quot;#ff595e&quot;
      &quot;Firefox&quot;           &quot;#ffff3f&quot;
      &quot;LibreOffice&quot;       &quot;#ff595e&quot;
      &quot;soffice.bin&quot;       &quot;#ff595e&quot;
      &quot;Zathura&quot;           &quot;#0aff99&quot;
    }
}

Cursors
{
  Frame     &quot;left_ptr&quot;
  Title     &quot;left_ptr&quot;
  Icon      &quot;left_ptr&quot;
  IconMgr   &quot;left_ptr&quot;
  Move      &quot;fleur&quot;
  Resize    &quot;fleur&quot;
  Menu      &quot;hand1&quot;
  Button    &quot;hand2&quot;
  Wait      &quot;clock&quot;
  Select    &quot;dot&quot;
  Destroy   &quot;pirate&quot;
}

# ----  Mouse and keyboard bindings  ----
# Mouse:     Button1=left, Button2=middle, Button3=right
# Keyboard:  m=meta (alt), c=ctrl, s=shift, m4=mod4 (Win)

Button1 =   : root    : f.menu &quot;defops&quot;
Button1 =   : iconmgr : f.iconify
Button1 = m : window  : f.move      # Alt + left mouse button
Button3 = m : window  : f.resize    # Alt + right mouse button

&quot;s&quot; =     m : all : f.showiconmgr   # Show the Icon Manager  (Alt + s)
&quot;s&quot; = s | m : all : f.hideiconmgr   # Hide the Icon Manager  (Alt + Shift + s)
&quot;r&quot; =     m : all : f.raiselower    # Raise window if behind (Alt + r)
&quot;v&quot; =     m : all : f.iconify       # &quot;Minimize&quot; window      (Alt + v)

# Cycle through windows with vi(1)-style key bindings 
# NOTE: For best results, make sure that the Icon Manager is *not* hidden
#       when the Icon Manager is hidden, only &quot;l&quot; and &quot;j&quot; work 
&quot;h&quot; =     m : all : f.backiconmgr  # previous column
&quot;l&quot; =     m : all : f.forwiconmgr  # next column
&quot;k&quot; =     m : all : f.upiconmgr    # previous row
&quot;j&quot; =     m : all : f.downiconmgr  # next row

# Use keyboard arrow keys to change the input focus between windows
# NOTE: For best results, make sure that the Icon Manager is *not* hidden
&quot;Left&quot;  = m : all : f.backiconmgr  # previous column
&quot;Right&quot; = m : all : f.forwiconmgr  # next column
&quot;Up&quot;    = m : all : f.upiconmgr    # previous row
&quot;Down&quot;  = m : all : f.downiconmgr  # next row

# Show time and date (local and UTC):  Press Ctrl + Alt + t
&quot;t&quot; =  m | c: all : f.exec &quot;(date; echo &apos;&apos;; date -u) | \
/usr/local/bin/xmessage -bg \&quot;#DE3163\&quot; -fg \&quot;#F6EABE\&quot; -rv -fn \
\&quot;-b&amp;amp;h-lucidatypewriter-bold-r-normal-sans-26-190-100-100-m-159-iso10646-1\&quot; \
-geometry -0+0 -buttons OK:1 -default OK -file - &amp;amp;&quot;

# Display virtual desktop number:      Press Ctrl + Alt + d
&quot;d&quot; =  m | c: all : f.exec &quot;(vdesk) | \
/usr/local/bin/xmessage -bg \&quot;#DE3163\&quot; -fg \&quot;#F6EABE\&quot; -rv -fn \
\&quot;-b&amp;amp;h-lucidatypewriter-bold-r-normal-sans-26-190-100-100-m-159-iso10646-1\&quot; \
-geometry -0+0 -buttons &apos; &apos; -default OK -file - &amp;amp;&quot;

# Launch dmenu with Alt + p
&quot;p&quot; = m      : all : f.exec &quot;/usr/local/bin/dmenu_run&quot;

&quot;i&quot; = m      : all : f.identify   # Alt + i
&quot;d&quot; = m      : all : f.delete     # For closing e.g. &quot;About&quot; windows
&quot;h&quot; = s | m4 : all : f.leftzoom   # [Shift + mod4 (Win)] + h
&quot;l&quot; = s | m4 : all : f.rightzoom  # [Shift + mod4 (Win)] + l
&quot;k&quot; = s | m4 : all : f.topzoom    # [Shift + mod4 (Win)] + k
&quot;j&quot; = s | m4 : all : f.bottomzoom # [Shift + mod4 (Win)] + j
&quot;f&quot; = s | m4 : all : f.fullzoom   # [Shift + mod4 (Win)] + o
&quot;m&quot; = s | m4 : all : f.zoom       # [Shift + mod4 (Win)] + m &amp;lt;- Zoom vertically
&quot;c&quot; = s | m4 : all : f.circledown # [Shift + mod4 (Win)] + c
&quot;u&quot; = s | m4 : all : f.circleup   # [Shift + mod4 (Win)] + u

# QUIT menu
# Defined here, used in the &quot;Main Menu&quot; (below),
#      i.e.  it&apos;s a sub-menu of the Main Menu
menu &quot;quitmenu&quot;
{
 &quot;Really Quit?&quot;   f.title
 &quot;No&quot;             f.nop
 &quot;Yes&quot;            f.quit
}

# Add a menu with the usual things
menu &quot;defops&quot;
{
  &quot;Twm&quot;           f.title
  &quot;Iconify&quot;       f.iconify
  &quot;Resize&quot;        f.resize
  &quot;Move&quot;          f.move
  &quot;Raise&quot;         f.raise
  &quot;Lower&quot;         f.lower
  &quot;&quot;              f.nop
  &quot;Focus&quot;         f.focus
  &quot;Unfocus&quot;       f.unfocus
  &quot;Show Iconmgr&quot;  f.showiconmgr
  &quot;Hide Iconmgr&quot;  f.hideiconmgr
  &quot;&quot;              f.nop
  &quot;Xterm&quot;         f.exec &quot;exec xterm &amp;amp;&quot;
  &quot;&quot;              f.nop
  &quot;Kill&quot;          f.destroy
  &quot;Delete&quot;        f.delete
  &quot;&quot;              f.nop
  &quot;Restart&quot;       f.restart
  &quot;Exit&quot;          f.menu &quot;quitmenu&quot;
}

# Virtual desktops with vdesk  ---- http://offog.org/code/vdesk.html -----

function &quot;set-desktop-1&quot;
{
   f.exec &quot;/usr/local/bin/vdesk 0 `xwininfo -tree -root | grep xclock | awk &apos;{print $1}&apos;`&quot;
   f.exec &quot;vdesk 1&quot;
}
    
function &quot;set-desktop-2&quot;
{
   f.exec &quot;/usr/local/bin/vdesk 0 `xwininfo -tree -root | grep xclock | awk &apos;{print $1}&apos;`&quot;
   f.exec &quot;vdesk 2&quot;
}
  
function &quot;set-desktop-3&quot;
{
   f.exec &quot;/usr/local/bin/vdesk 0 `xwininfo -tree -root | grep xclock | awk &apos;{print $1}&apos;`&quot;
   f.exec &quot;vdesk 3&quot;
}

function &quot;set-desktop-4&quot;
{
   f.exec &quot;/usr/local/bin/vdesk 0 `xwininfo -tree -root | grep xclock | awk &apos;{print $1}&apos;`&quot;
   f.exec &quot;vdesk 4&quot;
}

function &quot;set-desktop-5&quot;
{
   f.exec &quot;/usr/local/bin/vdesk 0 `xwininfo -tree -root | grep xclock | awk &apos;{print $1}&apos;`&quot;
   f.exec &quot;vdesk 5&quot;
}

function &quot;set-desktop-6&quot;
{
   f.exec &quot;/usr/local/bin/vdesk 0 `xwininfo -tree -root | grep xclock | awk &apos;{print $1}&apos;`&quot;
   f.exec &quot;vdesk 6&quot;
}

function &quot;set-desktop-7&quot;
{
   f.exec &quot;/usr/local/bin/vdesk 0 `xwininfo -tree -root | grep xclock | awk &apos;{print $1}&apos;`&quot;
   f.exec &quot;vdesk 7&quot;
}

function &quot;set-desktop-8&quot;
{
   f.exec &quot;/usr/local/bin/vdesk 0 `xwininfo -tree -root | grep xclock | awk &apos;{print $1}&apos;`&quot;
   f.exec &quot;vdesk 8&quot;
}

function &quot;set-desktop-9&quot;
{
   f.exec &quot;/usr/local/bin/vdesk 0 `xwininfo -tree -root | grep xclock | awk &apos;{print $1}&apos;`&quot;
   f.exec &quot;vdesk 9&quot;
}

function &quot;desktop-back&quot;
{
   f.exec &quot;A=$((`vdesk`-1)); if [ $A = 0 ] ; then A=9 ; fi ; vdesk $A&quot;
}

# To switch to one of nine virtual desktop: Alt + [1-9]:
&quot;1&quot;     =     m : all : f.function &quot;set-desktop-1&quot;
&quot;2&quot;     =     m : all : f.function &quot;set-desktop-2&quot;
&quot;3&quot;     =     m : all : f.function &quot;set-desktop-3&quot;
&quot;4&quot;     =     m : all : f.function &quot;set-desktop-4&quot;
&quot;5&quot;     =     m : all : f.function &quot;set-desktop-5&quot;
&quot;6&quot;     =     m : all : f.function &quot;set-desktop-6&quot;
&quot;7&quot;     =     m : all : f.function &quot;set-desktop-7&quot;
&quot;8&quot;     =     m : all : f.function &quot;set-desktop-8&quot;
&quot;9&quot;     =     m : all : f.function &quot;set-desktop-9&quot;

# To cycle forward through virtual desktops:
#     Ctrl + Meta (Win key) + right arrow key
&quot;Right&quot; = c | m : all : f.function &quot;desktop-forward&quot;
# To cycle backwards through virtual desktops:
#     Ctrl + Meta (Win key) + left arrow key
&quot;Left&quot;  = c | m : all : f.function &quot;desktop-back&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat ~/.xinitrc
xrdb -load $HOME/.Xresources 

xsetroot -solid slategrey
xset b off

# Add fonts
for m in `ls /usr/local/share/fonts/`; do
    if [ -d &quot;/usr/local/share/fonts/$m&quot; ]; then
        xset fp+ &quot;/usr/local/share/fonts/$m&quot;
    fi
done

exec twm &amp;gt; /tmp/twmrclog 2&amp;gt;&amp;amp;1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you want to have a clock or clocks, add one or more of the following
four lines to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/.xinitrc&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;exec /usr/local/bin/xclock -digital -strftime &quot;Vancouver: %a %d %b %H:%M:%S&quot; \
  -update 1 -face mono:size=10 -bg &quot;#002020&quot; -fg &quot;red&quot; -geometry -0-2 &amp;amp;
exec env TZ=Europe/Belgrade xclock -digital -strftime \
  &quot;Belgrade: %a %d %b %H:%M&quot; -face mono:size=10 -bg &quot;#002020&quot; -fg &quot;gold&quot; \
  -geometry -256-2 &amp;amp;
exec env TZ=UTC /usr/local/bin/xclock -digital -strftime \
  &apos;UTC: %a %d %b %H:%M&apos; -face mono:size=10 -bg &apos;#002020&apos; -fg &apos;#f6eabe&apos; \
  -geometry -480-2 &amp;amp; 
exec env TZ=GMT /usr/local/bin/xclock -digital -strftime \
  &apos;GMT: %a %d %b %H:%M&apos; -face mono:size=10 -bg &apos;#002020&apos; -fg &apos;#aaaaaa&apos; \
  -geometry -664-2 &amp;amp; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you want to have xload, you first need to install it (with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo pkg install xload&lt;/code&gt;), and after that add this line to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/.xinitrc&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;exec xload -bg steelblue -fg &apos;#001013&apos; -nolabel -geometry 224x33-840-2 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Start &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;X&lt;/code&gt; with:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% exec startx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;or:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% exec xinit 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;References:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Man pages:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;twm(1) - Tab Window Manager for the X Window System&lt;/li&gt;
  &lt;li&gt;xterm(1) - terminal emulator for X&lt;/li&gt;
  &lt;li&gt;xwininfo(1) - window information utility for X&lt;/li&gt;
  &lt;li&gt;Xsecurity(7) - X display access control, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.Xauthority&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Xserver(1) - X Window System display server&lt;/li&gt;
  &lt;li&gt;X(7) - Keyboards, modifiers and keysym - section KEYBOARDS&lt;/li&gt;
  &lt;li&gt;Xorg(1) - X11R7 X server&lt;/li&gt;
  &lt;li&gt;XOrgFoundation(7) -  X.Org Foundation information&lt;/li&gt;
  &lt;li&gt;xinit(1) - X Window System initializer&lt;/li&gt;
  &lt;li&gt;x11perf(1) - X11 server performance test program&lt;/li&gt;
  &lt;li&gt;xauth(1) - X authority file utility&lt;/li&gt;
  &lt;li&gt;showrgb(1) - display an rgb color-name database&lt;/li&gt;
  &lt;li&gt;xkbwatch(1) - XKB extension user utility&lt;/li&gt;
  &lt;li&gt;xkbevd(1) - XKB event daemon&lt;/li&gt;
  &lt;li&gt;xkbvleds(1) - display the state of LEDs on an XKB keyboard&lt;/li&gt;
  &lt;li&gt;xkill(1) - kill a client by its X resource&lt;/li&gt;
  &lt;li&gt;xlsatoms(1) - list interned atoms defined on server&lt;/li&gt;
  &lt;li&gt;xprop(1) - property displayer for X&lt;/li&gt;
  &lt;li&gt;xmodmap(1) - utility for modifying keymaps and pointer button mappings in X&lt;/li&gt;
  &lt;li&gt;xrdb(1) - X server resource database utility&lt;/li&gt;
  &lt;li&gt;xset(1) - user preference utility for X&lt;/li&gt;
  &lt;li&gt;xrefresh(1) - refresh all or part of an X screen&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Retrieved on Apr 3, 2022:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.custompc.plus.com/twm/twmrc.htm&quot;&gt;Graham’s TWM Page!&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.custompc.plus.com/twm2/Grahams_TWM_page2.html&quot;&gt;Graham’s TWM Page! - Updated for 2021&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://offog.org/code/vdesk/&quot;&gt;vdesk -  a virtual desktop manager&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;word-cloud&quot;&gt;Word Cloud&lt;/h3&gt;

&lt;p&gt;X(7), libX11, modifier, keysum, the vmodmap array, locale, 
XkbLatchModifiers(3)&lt;/p&gt;

&lt;hr /&gt;

</description>
        <pubDate>Sun, 03 Apr 2022 09:27:31 -0700</pubDate>
        <link>http://localhost:4000/wm/x11/xorg/freebsd/unix/dotfiles/2022/04/03/twm.html</link>
        <guid isPermaLink="true">http://localhost:4000/wm/x11/xorg/freebsd/unix/dotfiles/2022/04/03/twm.html</guid>
        
        
        <category>wm</category>
        
        <category>x11</category>
        
        <category>xorg</category>
        
        <category>freebsd</category>
        
        <category>unix</category>
        
        <category>dotfiles</category>
        
      </item>
    
  </channel>
</rss>
