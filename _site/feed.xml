<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Dusko Pijetlovic</title>
    <description>Dusko Pijetlovic - My Personal Web Space</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Mon, 23 May 2022 13:08:37 -0700</pubDate>
    <lastBuildDate>Mon, 23 May 2022 13:08:37 -0700</lastBuildDate>
    <generator>Jekyll v3.9.0</generator>
    
      <item>
        <title>QEMU Networking</title>
        <description>&lt;hr /&gt;
&lt;p&gt;Host OS: RHEL 8.5 - Shell: csh  &lt;br /&gt;
Guest OS: CentOS Linux 7.9 - Shell: bash&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;em&gt;Assumptions:&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The host server was already configured for virtualization.  It had the 
following packages installed on it:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipxe-roms-qemu, libvirt-daemon-driver-qemu, qemu-guest-agent, qemu-img, 
qemu-kvm, qemu-kvm-block-curl, qemu-kvm-block-gluster, qemu-kvm-block-iscsi, 
qemu-kvm-block-rbd, qemu-kvm-block-ssh, qemu-kvm-common, qemu-kvm-core,
libvirt, virt-install, virt-manager, libguestfs-tools, libguestfs-gfs2, 
libguestfs-rescue, ibguestfs-rsync libguestfs-xfs,
virt-dib, virt-v2v, virt-p2v-maker, virt-viewer, virt-who, virt-top, virtio-win

minicom 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;about-bridge-switch-bridge-mode-of-qemu-bridged-networking-tun-connection-tap-mode-tap-device-nat-mode&quot;&gt;About Bridge Switch, Bridge Mode of QEMU, Bridged Networking, TUN Connection, TAP Mode (TAP Device), NAT Mode&lt;/h3&gt;

&lt;p&gt;A &lt;strong&gt;bridge&lt;/strong&gt; is a &lt;strong&gt;network switch&lt;/strong&gt; but implemented in software.&lt;/p&gt;

&lt;p&gt;From the &lt;a href=&quot;https://wiki.archlinux.org/index.php/Network_bridge&quot;&gt;Arch Wiki&lt;/a&gt; (Retrieved on Apr 2, 2022):&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;A &lt;strong&gt;bridge&lt;/strong&gt; is a piece of software used to &lt;strong&gt;unite&lt;/strong&gt; two or 
more &lt;strong&gt;network segments&lt;/strong&gt;.&lt;/p&gt;

  &lt;p&gt;A bridge behaves like a virtual network &lt;strong&gt;switch&lt;/strong&gt;, working 
transparently (other machines do not need to know about its 
existence).  Any real devices (e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;eth0&lt;/code&gt;) and virtual devices
(e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tap0&lt;/code&gt;) can be connected to it.&lt;/p&gt;

  &lt;p&gt;[…]   &lt;br /&gt;
When the bridge is fully set up, it can be &lt;strong&gt;assigned an IP address&lt;/strong&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Or as per &lt;a href=&quot;https://wiki.linuxfoundation.org/networking/bridge&quot;&gt;Bridge - The Linux Foundation Wiki&lt;/a&gt; (Retrieved on Apr 2, 2022):&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;[…] a bridge connects two or more physical Ethernets together to 
form one &lt;strong&gt;bigger (logical) Ethernet&lt;/strong&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;When you install &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;libvirt&lt;/code&gt;, a &lt;strong&gt;virtual bridge&lt;/strong&gt; (aka &lt;strong&gt;virtual network 
switch&lt;/strong&gt;), the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0&lt;/code&gt;, is automatically created.  When you later 
create virtual machines, they connect to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0&lt;/code&gt; bridge.&lt;/p&gt;

&lt;p&gt;By default, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0&lt;/code&gt; uses &lt;strong&gt;NAT&lt;/strong&gt; mode and gets assigned an 
IP address 192.168.122.1.  Also, it can provide DHCP service for 
other virtual interfaces that connect to it.&lt;/p&gt;

&lt;p&gt;From the &lt;a href=&quot;https://wiki.archlinux.org/title/Network_bridge&quot;&gt;Arch Wiki&lt;/a&gt;: 
a bridge is a network switch but implemented in software.  Any real 
devices (e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;eth0&lt;/code&gt;) and virtual devices (e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tap0&lt;/code&gt;) can be connected 
to it.&lt;/p&gt;

&lt;p&gt;From &lt;a href=&quot;https://wiki.qemu.org/Documentation/Networking/NAT&quot;&gt;NAT Networking - QEMU Documentation&lt;/a&gt; (Retrieved on Apr 2, 2022):&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;NAT &lt;br /&gt;
Configuring Network Address Translation (NAT) is a useful way to network 
virtual machines in a desktop environment (particularly, when using 
wireless networking).  A NAT network will allow your guests to fully 
access the network, allow networking between your host and guests, but 
&lt;strong&gt;prevent the guests&lt;/strong&gt; from being directly &lt;strong&gt;visible&lt;/strong&gt; on the physical network.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;References:&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://unix.stackexchange.com/questions/523245/whats-the-function-of-virbr0-and-virbr0-nic&quot;&gt;What’s the function of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0-nic&lt;/code&gt;?&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://listman.redhat.com/archives/libvirt-users/2012-September/msg00038.html&quot;&gt;[libvirt-users] virtual networking - virbr0-nic interface&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://unix.stackexchange.com/questions/378264/what-is-virtual-bridge-with-nic-in-the-end-of-name/444863#444863&quot;&gt;What is virtual bridge with -nic in the end of name&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli
eno1: connected to eno1
[...]
eno2: connected to eno2
[...]
virbr0: connected (externally) to virbr0
        &quot;virbr0&quot;
        bridge, 52:54:00:11:22:33, sw, mtu 1500
        inet4 192.168.122.1/24
        route4 192.168.122.0/24
eno3: disconnected
[...]
eno4: disconnected
[...]
lo: unmanaged
        &quot;lo&quot;
        loopback (unknown), 00:00:00:00:00:00, sw, mtu 65536

virbr0-nic: unmanaged
        &quot;virbr0-nic&quot;
        tun, 52:54:00:11:22:33, sw, mtu 1500

DNS configuration:
        servers: 208.67.222.222, 208.67.220.220  &amp;lt;-- Will list your DNS servers
        interface: eno1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli device show virbr0
GENERAL.DEVICE:               virbr0
GENERAL.TYPE:                 bridge
[...]
GENERAL.STATE:                100 (connected (externally))
GENERAL.CONNECTION:           virbr0
[...]
IP4.ADDRESS[1]:               192.168.122.1/24
IP4.GATEWAY:                  --
IP4.ROUTE[1]:                 dst = 192.168.122.0/24, nh = 0.0.0.0, mt = 0
IP6.GATEWAY:                  --
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The network &lt;strong&gt;interface&lt;/strong&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0-nic&lt;/code&gt; (virtual network interface) is not 
a bridge.  It is a regular Ethernet interface (although a virtual one, 
created with ip add type &lt;a href=&quot;https://man7.org/linux/man-pages/man4/veth.4.html&quot;&gt;veth&lt;/a&gt;).  It’s there so that the bridge has at least one interface beneath it to 
use its MAC address from.  It doesn’t pass real traffic since it’s not 
really connected to any physical device.
The bridge would work without it but then it could change its MAC address 
as interfaces enter and exit the bridge, and when the MAC of the bridge 
changes, external switches may be confused, making the host lose network 
for some time.&lt;/p&gt;

&lt;p&gt;According to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nmcli device show&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ip -details link show&lt;/code&gt; commands, 
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0-nic&lt;/code&gt; virtual network interface is a &lt;strong&gt;TUN&lt;/strong&gt; device:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli device show virbr0-nic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;GENERAL.DEVICE:               virbr0-nic
GENERAL.TYPE:                 tun
GENERAL.HWADDR:               52:54:00:11:22:33
GENERAL.MTU:                  1500
GENERAL.STATE:                10 (unmanaged)
GENERAL.CONNECTION:           --
GENERAL.CON-PATH:             --
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ip -details link show virbr0-nic | \
egrep -woi &quot;tun|tap|bridge|bridge_slave|vlan_tunnel&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;tun
tap
bridge_slave
vlan_tunnel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;IP forwarding &lt;a href=&quot;#footnotes&quot;&gt;¹&lt;/a&gt; was already enabled on this server:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo /sbin/sysctl --all | grep 'net.ipv4.ip_forward'
net.ipv4.ip_forward = 1
net.ipv4.ip_forward_update_priority = 1
net.ipv4.ip_forward_use_pmtu = 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Additional package that you need to install is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bridge-utils&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo dnf install bridge-utils
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It provides &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brctl&lt;/code&gt; tool.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo dnf whatprovides /usr/sbin/brctl
[...]
bridge-utils-1.5-9.el7.x86_64 : Utilities for configuring the linux 
                              : ethernet bridge
[...]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ command -V brctl; type brctl; which brctl; whereis brctl
brctl is /usr/sbin/brctl
brctl is /usr/sbin/brctl
/usr/sbin/brctl
brctl: /usr/sbin/brctl /usr/share/man/man8/brctl.8.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brctl(8)&lt;/code&gt; tool is used for the Ethernet bridge administration. 
From its man page:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[...]
DESCRIPTION
    brctl is used to set up, maintain, and inspect the ethernet bridge 
    configuration in the linux kernel.

    An ethernet bridge is a device commonly used to connect different  
    networks of ethernets together, so that these ethernets will appear 
    as one ethernet to the participants.

    Each of the ethernets being connected corresponds to one physical
    interface in the bridge.  These individual ethernets are bundled into
    one bigger ('logical') ethernet, this bigger ethernet corresponds to
    the bridge network interface.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Currently, this server has one bridge device (named virbr0) installed by 
the libvirt library so the output of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brctl show&lt;/code&gt; and  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brctl show virbr0&lt;/code&gt; 
is the same.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ brctl show 
bridge name     bridge id               STP enabled     interfaces
virbr0          8000.525400a7c2ab       yes             virbr0-nic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ brctl show virbr0
bridge name     bridge id               STP enabled     interfaces
virbr0          8000.525400a7c2ab       yes             virbr0-nic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;qemu-networking&quot;&gt;QEMU Networking&lt;/h2&gt;

&lt;p&gt;Two parts:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;The front-end.  The virtual network device; e.g. a PCI network card
(aka NIC - network interface controller) that the guest sees.&lt;/li&gt;
  &lt;li&gt;The network back-end on the host side; that is, the interface that QEMU uses 
to exchange network packets with the outside (like other QEMU instances
or other real hosts in your intranet or the internet).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;QEMU supports networking by emulating some popular network cards
(aka NICs - network interface controllers) and establishing virtual
LANs (VLAN). There are four ways that QEMU guests can be connected:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;User mode (SLiRP)&lt;/li&gt;
  &lt;li&gt;Tap&lt;/li&gt;
  &lt;li&gt;Socket redirection&lt;/li&gt;
  &lt;li&gt;VDE networking&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;References:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.qemu.org/2018/05/31/nic-parameter/&quot;&gt;QEMU’s new -nic command line option&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://wiki.qemu.org/Documentation/Networking&quot;&gt;Networking - QEMU Documentation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikibooks.org/wiki/QEMU/Networking&quot;&gt;Networking - QEMU on wikibooks.org&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The difference between &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-net&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-netdev&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-nic&lt;/code&gt; options of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qemu&lt;/code&gt; command:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-net&lt;/code&gt; option can create either a front-end or a back-end (and also does other things)&lt;/li&gt;
  &lt;li&gt;the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-netdev&lt;/code&gt; can only create a back-end&lt;/li&gt;
  &lt;li&gt;a single occurrence of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-nic&lt;/code&gt; creates both a front-end and a back-end&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;slirp-user-networking&quot;&gt;SLiRP (user networking)&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Provides access to the host’s network via NAT&lt;/li&gt;
  &lt;li&gt;It doesn’t support protocols other than TCP and UDP so e.g. ping and other ICMP utilities won’t work from the guest&lt;/li&gt;
  &lt;li&gt;A virtual DHCP server on 10.0.2.2&lt;/li&gt;
  &lt;li&gt;A virtual DNS server on 10.0.2.3&lt;/li&gt;
  &lt;li&gt;Gateway: 10.0.2.3&lt;/li&gt;
  &lt;li&gt;An IP address starting from 10.0.2.15&lt;/li&gt;
  &lt;li&gt;NO tap0 on the host&lt;/li&gt;
  &lt;li&gt;ssh from the guest to the host&lt;/li&gt;
  &lt;li&gt;By default it acts as a firewall and does not permit any incoming traffic&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;starting-a-qemu-vm-with-slirp-user-networking&quot;&gt;Starting a QEMU VM with SLiRP (User Networking)&lt;/h4&gt;

&lt;p&gt;With the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-netdev&lt;/code&gt; option:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
-drive format=raw,file=xcatmn.img \
-m 4G \
-netdev user,id=network0 \
-device e1000,netdev=network0 \
-nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you don’t specify any network configuration options, then QEMU creates 
a SLiRP user network back-end and an appropriate virtual network device 
for the guest (e.g. an E1000 PCI card for most x86 PC guests):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
-drive format=raw,file=xcatmn.img \
-m 4G \
-nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Alternatively, you can use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-net&lt;/code&gt; (&lt;a href=&quot;https://www.qemu.org/2018/05/31/nic-parameter/&quot;&gt;QEMU’s new -nic command line option&lt;/a&gt;) instead of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-netdev&lt;/code&gt; option:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
-drive format=raw,file=xcatmn.img \
-m 4G \
-net nic \
-net user \
-nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;tap&quot;&gt;Tap&lt;/h3&gt;

&lt;h4 id=&quot;how-to-create-a-bridged-networking-tun-device-in-tap-mode-for-qemu-with-an-ip-address-provided-by-libvirts-bridge-virbr0&quot;&gt;How To Create a Bridged Networking (Tun Device in Tap Mode) for QEMU with an IP Address Provided by libvirt’s Bridge virbr0&lt;/h4&gt;

&lt;p&gt;References: &lt;br /&gt;
&lt;a href=&quot;https://wiki.qemu.org/Features/HelperNetworking&quot;&gt;Helper Networking&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Allows the guest to directly access the host’s network&lt;/li&gt;
  &lt;li&gt;ICMP utilities (e.g. ping) working&lt;/li&gt;
  &lt;li&gt;192.168.122.x (gw: 192.168.122.254)&lt;/li&gt;
  &lt;li&gt;tap0 on the host&lt;/li&gt;
  &lt;li&gt;IP address visible on the host’s network -&amp;gt; ssh from the guest to the host&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;When you install the libvirt &lt;a href=&quot;#footnotes&quot;&gt;²&lt;/a&gt; package, a virtual network 
switch named &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0&lt;/code&gt; is created.&lt;/p&gt;

&lt;p&gt;To allow unprivileged user access to the bridge from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qemu-bridge-helper&lt;/code&gt;
tool, create or modify &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/qemu-kvm/bridge.conf&lt;/code&gt; (in other Linux 
distributions, the location of this configuration file might be different, 
for example, /etc/qemu/bridge.conf).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% printf %s\\n &quot;allow virbr0&quot; | sudo tee -a /etc/qemu-kvm/bridge.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;NOTE: &lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qemu-bridge-helper&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bridge.conf&lt;/code&gt; are in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qemu-kvm-common&lt;/code&gt; package:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ dnf repoquery --file /etc/qemu-kvm/bridge.conf 
[...]
qemu-kvm-common-15:2.12.0-63.module+el8+2833+c7d6d092.x86_64

$ dnf repoquery --file /usr/libexec/qemu-bridge-helper
[...]
qemu-kvm-common-15:2.12.0-63.module+el8+2833+c7d6d092.x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Both examples below use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-netdev&lt;/code&gt; option for the back-end, together 
with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-device&lt;/code&gt; for the front-end.  That combination configures a network 
connection where the emulated NIC is directly connected to a host network
back-end, without a hub in between (as opposed to a network connection 
created with the legacy &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-net&lt;/code&gt; option).&lt;/p&gt;

&lt;h4 id=&quot;tap-with-virbr0-default-virtual-network-switch-created-by-the-libvirt-library---method-1&quot;&gt;Tap with virbr0 (Default Virtual Network Switch Created by the libvirt Library) - Method 1&lt;/h4&gt;

&lt;p&gt;Use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;br=&amp;lt;bridge name&amp;gt;&lt;/code&gt; in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-netdev&lt;/code&gt; option.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
-drive format=raw,file=xcatmn.img \
-m 4G \
-netdev bridge,br=virbr0,id=hn0 \
-device virtio-net-pci,netdev=hn0,id=nic1 \
-nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;tap-with-virbr0-default-virtual-network-switch-created-by-the-libvirt-library---method-2&quot;&gt;Tap with virbr0 (Default Virtual Network Switch Created by the libvirt Library) - Method 2&lt;/h4&gt;

&lt;p&gt;In the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-netdev&lt;/code&gt; option, for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tap&lt;/code&gt; specify &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;helper&lt;/code&gt; and point &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--br&lt;/code&gt; to 
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0&lt;/code&gt; because by default the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qemu-bridge-helper&lt;/code&gt; expects that the 
bridge name is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;br0&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
-drive format=raw,file=xcatmn.img \
-m 4G \
-netdev tap,helper=&quot;/usr/libexec/qemu-bridge-helper --br=virbr0&quot;,id=hn0 \
-device virtio-net-pci,netdev=hn0,id=nic1 \
-nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;how-to-create-a-bridged-networking-tun-device-in-tap-mode-for-qemu-with-an-ip-address-visible-on-the-hosts-network-and-via-a-bridge-interface-you-created&quot;&gt;How To Create a Bridged Networking (Tun Device in Tap Mode) for QEMU with an IP Address Visible on the Host’s Network and via a Bridge Interface You Created&lt;/h4&gt;

&lt;p&gt;When you don’t want to use the [default] bridge &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0&lt;/code&gt; provided by the 
libvirt library, you need to configure the new bridge &lt;em&gt;before&lt;/em&gt; running qemu.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Steps:&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Create a network bridge device and bind your default-route NIC to it.&lt;/li&gt;
  &lt;li&gt;Create a tap device attached to the bridge for QEMU to use.
    &lt;ul&gt;
      &lt;li&gt;Instead of setting it up manually, you can let QEMU to set up
the necessary &lt;strong&gt;tap&lt;/strong&gt; device using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qemu-bridge-helper&lt;/code&gt; tool
(location on this host with the operating system RHEL 8.5:
 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/libexec/qemu-bridge-helper&lt;/code&gt;).  This example shows this, that is,
it leaves the tap device creation and deletion to QEMU.&lt;/li&gt;
      &lt;li&gt;To set up a bridge as a regular user, the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qemu-bridge-helper&lt;/code&gt; tool 
must be run as root so you have to add the setuid bit; that is, 
permission (access) needs to be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(4755/-rwsr-xr-x)&lt;/code&gt;.  On this system
I didn’t have to do it as the helper was already configured with the setuid.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Configure the host’s firewall to allow packets to move across the bridge.
I didn’t have to make changes for this item because IP forwarding
&lt;a href=&quot;#footnotes&quot;&gt;¹&lt;/a&gt; was already enabled on this host.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ lsmod | grep ^bridge
bridge                192512  0

$ lsmod | grep ^tun
tun                    53248  1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ip tuntap list
virbr0-nic: tap persist
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ brctl show
bridge name     bridge id               STP enabled     interfaces
virbr0          8000.525400a7c2ab       yes             virbr0-nic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;NOTE: &lt;br /&gt;
Network bridging doesn’t work with Wi-Fi:  &lt;br /&gt;
&lt;a href=&quot;https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/networking_guide/ch-configure_network_bridging&quot;&gt;Configure Network Bridging - Red Hat Product Documentation (RHEL 7)&lt;/a&gt; (Retrieved on Apr 2, 2022):&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Note that a bridge cannot be established over Wi-Fi networks operating 
in Ad-Hoc or Infrastructure modes.  This is due to the IEEE 802.11 
standard that specifies the use of 3-address frames in Wi-Fi for the 
efficient use of airtime.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;create-a-new-bridge-connection&quot;&gt;Create a New Bridge Connection&lt;/h4&gt;

&lt;p&gt;Create a new bridge connection named br0.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo nmcli connection add type bridge con-name br0 ifname br0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ifconfig | grep -w br0
br0: flags=4099&amp;lt;UP,BROADCAST,MULTICAST&amp;gt;  mtu 1500
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ brctl show
bridge name     bridge id               STP enabled     interfaces
br0             8000.000000000000       yes
virbr0          8000.525400a7c2ab       yes             virbr0-nic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;eno1&lt;/code&gt; network interface to the bridge &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;br0&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo nmcli connection add type bridge-slave ifname eno1 master br0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli -f bridge connection show br0
bridge.mac-address:                     --
bridge.stp:                             yes
bridge.priority:                        32768
bridge.forward-delay:                   15
bridge.hello-time:                      2
bridge.max-age:                         20
bridge.ageing-time:                     300
bridge.group-forward-mask:              0
bridge.multicast-snooping:              yes
bridge.vlan-filtering:                  no
bridge.vlan-default-pvid:               1
bridge.vlans:                           --
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;convert-settings-from-nic-network-interface-controller-to-bridge-interface&quot;&gt;Convert Settings from NIC (Network Interface Controller) to Bridge Interface&lt;/h4&gt;

&lt;p&gt;Allocate a static IP address to the new br0 interface.  (If the DHCP server 
is available, it would provide IP addresses and other settings but since 
this is a server, I chose a set up with a static IP address.)&lt;/p&gt;

&lt;p&gt;In this example, network settings of the existing network interface 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;eno1&lt;/code&gt; are converted to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;br0&lt;/code&gt; bridge settings.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli connection show eno1 | grep 'ipv4.addresses'
ipv4.addresses:   123.12.23.148/24

$ nmcli connection show eno1 | grep gateway
ipv4.gateway:     123.12.23.254

$ nmcli connection show eno1 | grep 'ipv4.dns'
ipv4.dns:         208.67.222.222,208.67.220.220  &amp;lt;-- Will show your DNS servers

$ nmcli connection show eno1 | grep 'ipv4.method'
ipv4.method:                            manual
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo nmcli connection modify br0 ipv4.addresses '123.12.23.148/24'
$ sudo nmcli connection modify br0 ipv4.gateway '123.12.23.254'
$ sudo nmcli connection modify br0 ipv4.dns '208.67.222.222,208.67.220.220'
$ sudo nmcli connection modify br0 ipv4.method manual
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo nmcli connection up br0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Connection successfully activated (master waiting for slaves) 
(D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/28)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ brctl show
bridge name     bridge id               STP enabled     interfaces
br0             8000.0894eff40004       yes             eno1
virbr0          8000.525400a7c2ab       yes             virbr0-nic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli connection show
NAME               UUID                                  TYPE      DEVICE 
eno1               4d928341-...........................  ethernet  eno1   
eno2               e94a2707-...........................  ethernet  eno2   
br0                07d25404-...........................  bridge    br0    
virbr0             3216d7f0-...........................  bridge    virbr0 
bridge-slave-eno1  02132481-...........................  ethernet  --     
[...]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ip address show br0
40: br0: &amp;lt;NO-CARRIER,BROADCAST,MULTICAST,UP&amp;gt; mtu 1500 qdisc noqueue 
      state DOWN group default qlen 1000
      link/ether 5a:18:0d:a2:18:26 brd ff:ff:ff:ff:ff:ff
      inet 123.12.23.148/24 brd 123.12.23.255 scope global noprefixroute br0
      valid_lft forever preferred_lft forever
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Remove the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;eno1&lt;/code&gt; network interface because now the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;br0&lt;/code&gt; bridge 
has a static IP address and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;eno1&lt;/code&gt; will be in forwarding state.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo nmcli connection delete eno1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Allow a regular user access to the new bridge &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;br0&lt;/code&gt; from 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qemu-bridge-helper&lt;/code&gt;.  Add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;allow br0&lt;/code&gt; to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bridge.conf&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf %s\\n &quot;allow br0&quot; | sudo tee -a /etc/qemu-kvm/bridge.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /etc/qemu-kvm/bridge.conf
allow virbr0
allow br0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;NOTE: &lt;br /&gt;
You don’t need to create a tap device (a.k.a. a tap interface) manually 
because the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qemu-bridge-helper&lt;/code&gt; tool (location on the host’s OS, RHEL 8.5: 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/libexec/qemu-bridge-helper&lt;/code&gt;) creates it automatically when you 
start a guest VM.  By default the helper assumes that the bridge name 
is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;br0&lt;/code&gt;.  Also, the name of a tap device that the helper automatically 
creates when the guest VM is started is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tap0&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
-drive format=raw,file=xcatmn.img \
-m 4G \
-netdev bridge,br=br0,id=hn0 \
-device virtio-net-pci,netdev=hn0,id=nic1 \
-nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(NOTE:   You can skip &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;br=br0&lt;/code&gt; because the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qemu-bridge-helper&lt;/code&gt; tool assumes that the name of the bridge is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;br0&lt;/code&gt;.   Also, you can skip &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;id=nic1&lt;/code&gt;.)&lt;/p&gt;

&lt;p&gt;Explanation for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-netdev&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;device&lt;/code&gt; options:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-netdev bridge,br=br0,id=hn0&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Create a bridge network back-end (with id hn0) via bridge &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;br0&lt;/code&gt;. 
This will connect to a tap interface tap0 device (aka tap0 interface), 
which will be automatically setup with the helper &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qemu-bridge-helper&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-device virtio-net-pci,netdev=hn0,id=nic1&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Create a NIC (of a model &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virtio-net-pci&lt;/code&gt; and with id nic1) and connect 
to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;hn0&lt;/code&gt; back-end created by the previous parameter.&lt;/p&gt;

&lt;p&gt;NOTE:  To list all devices, including network devices, 
run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/libexec/qemu-kvm -device help&lt;/code&gt;, which shows help on possible 
drivers and properties (in this case, since you’d be interested in network devices, you’d look under the section titled “Network devices”).&lt;/p&gt;

&lt;p&gt;While the guest VM is running, start another shell on the host.
Run the following set of commands on the host system.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ifconfig | egrep &quot;^br|^virbr|^tap&quot;
br0: flags=4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt;  mtu 1500
tap0: flags=4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt;  mtu 1500
virbr0: flags=4099&amp;lt;UP,BROADCAST,MULTICAST&amp;gt;  mtu 1500
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ifconfig -a | egrep &quot;^br|^virbr|^tap&quot;
br0: flags=4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt;  mtu 1500
tap0: flags=4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt;  mtu 1500
virbr0: flags=4099&amp;lt;UP,BROADCAST,MULTICAST&amp;gt;  mtu 1500
virbr0-nic: flags=4098&amp;lt;BROADCAST,MULTICAST&amp;gt;  mtu 1500
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli connection | egrep -i &quot;bridge|tun|tap|type&quot;
NAME               UUID                                  TYPE      DEVICE 
br0                07d25404-5b85-4006-bdbc-272c63b9aaf0  bridge    br0    
virbr0             3216d7f0-124e-4c66-a6de-5b218d18377c  bridge    virbr0 
bridge-slave-eno1  02132481-584a-413d-97f5-46b161a4de9f  ethernet  eno1   
tap0               37ddcf4a-1105-4ab4-b076-0b62f87df4a8  tun       tap0   
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli connection show br0 | egrep -wi &quot;type|mode|name|master|slave&quot;
connection.type:                    bridge
connection.interface-name:          br0
connection.master:                  --
connection.slave-type:              --
ipv6.addr-gen-mode:                 stable-privacy
GENERAL.NAME:                       br0
GENERAL.MASTER-PATH:                --
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli connection show tap0 | egrep -wi &quot;type|mode|name|master|slave&quot;
connection.type:                    tun
connection.interface-name:          tap0
connection.master:                  br0
connection.slave-type:              bridge
bridge-port.hairpin-mode:           no
tun.mode:                           2 (tap)
GENERAL.NAME:                       tap0
GENERAL.MASTER-PATH:                /org/freedesktop/NetworkManager/Devices/34
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli device | egrep -i &quot;bridge|tun|type&quot;
DEVICE      TYPE      STATE                   CONNECTION        
br0         bridge    connected               br0               
virbr0      bridge    connected (externally)  virbr0            
eno1        ethernet  connected               bridge-slave-eno1 
tap0        tun       connected (externally)  tap0              
virbr0-nic  tun       unmanaged               --                
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli device show br0
GENERAL.DEVICE:         br0
GENERAL.TYPE:           bridge
GENERAL.HWADDR:         08:94:EF:F4:00:04
GENERAL.MTU:            1500
GENERAL.STATE:          100 (connected)
GENERAL.CONNECTION:     br0
GENERAL.CON-PATH:       /org/freedesktop/NetworkManager/ActiveConnection/28
IP4.ADDRESS[1]:         123.12.23.148/24 
IP4.GATEWAY:            123.12.23.254
IP4.ROUTE[1]:           dst = 123.12.23.0/24, nh = 0.0.0.0, mt = 426
IP4.ROUTE[2]:           dst = 0.0.0.0/0, nh = 123.12.23.254, mt = 426
IP4.DNS[1]:             208.67.222.222
IP4.DNS[2]:             208.67.220.220
IP6.ADDRESS[1]:         fe80::c929:3169:74dd:2429/64
IP6.GATEWAY:            fe80::a68c:dbff:fede:1301
IP6.ROUTE[1]:           dst = fe80::/64, nh = ::, mt = 426
IP6.ROUTE[2]:           dst = ::/0, nh = fe80::a68c:dbff:fede:1301, mt = 426
IP6.ROUTE[3]:           dst = ff00::/8, nh = ::, mt = 256, table=255
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli device show tap0
GENERAL.DEVICE:         tap0
GENERAL.TYPE:           tun
GENERAL.HWADDR:         FE:90:76:81:BE:CF
GENERAL.MTU:            1500
GENERAL.STATE:          100 (connected (externally))
GENERAL.CONNECTION:     tap0
GENERAL.CON-PATH:       /org/freedesktop/NetworkManager/ActiveConnection/30
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ brctl show
bridge name     bridge id               STP enabled     interfaces
br0             8000.0894eff40004       yes             eno1
                                                        tap0
virbr0          8000.525400a7c2ab       yes             virbr0-nic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ip link show master br0
4: eno1: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 qdisc mq master br0 
    state UP mode DEFAULT group default qlen 1000
    link/ether 08:94:ef:f4:00:04 brd ff:ff:ff:ff:ff:ff
44: tap0: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 qdisc fq_codel 
    master br0 state UNKNOWN mode DEFAULT group default qlen 1000
    link/ether fe:90:76:81:be:cf brd ff:ff:ff:ff:ff:ff
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ bridge link show
[...]
4: eno1: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 master br0 
     state forwarding priority 32 cost 100 
4: eno1: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 master br0 hwmode VEPA 
[...]
44: tap0: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 master br0 
      state forwarding priority 32 cost 100 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli device show br0 | grep -i type
GENERAL.TYPE:                           bridge

$ nmcli device show tap0 | grep -i type
GENERAL.TYPE:                           tun

$ nmcli device show eno1 | grep -i type
GENERAL.TYPE:                           ethernet
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Return to the first shell, and in the guest VM, power off the system.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# poweroff
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Back on the host system, after the VM is powered off:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ifconfig | egrep &quot;^br|^virbr|^tap&quot;
br0: flags=4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt;  mtu 1500
virbr0: flags=4099&amp;lt;UP,BROADCAST,MULTICAST&amp;gt;  mtu 1500
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ifconfig -a | egrep &quot;^br|^virbr|^tap&quot;
br0: flags=4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt;  mtu 1500
virbr0: flags=4099&amp;lt;UP,BROADCAST,MULTICAST&amp;gt;  mtu 1500
virbr0-nic: flags=4098&amp;lt;BROADCAST,MULTICAST&amp;gt;  mtu 1500
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli connection | egrep -i &quot;bridge|tun|tap|type&quot;
NAME               UUID                                  TYPE      DEVICE 
br0                07d25404-5b85-4006-bdbc-272c63b9aaf0  bridge    br0    
virbr0             3216d7f0-124e-4c66-a6de-5b218d18377c  bridge    virbr0 
bridge-slave-eno1  02132481-584a-413d-97f5-46b161a4de9f  ethernet  eno1   
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli device | egrep -i &quot;bridge|tun|tap|type&quot;
DEVICE      TYPE      STATE                   CONNECTION        
br0         bridge    connected               br0               
virbr0      bridge    connected (externally)  virbr0            
eno1        ethernet  connected               bridge-slave-eno1 
virbr0-nic  tun       unmanaged               --                
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ brctl show
bridge name     bridge id               STP enabled     interfaces
br0             8000.0894eff40004       yes             eno1
virbr0          8000.525400a7c2ab       yes             virbr0-nic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ip link show master br0
4: eno1: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 qdisc mq master br0 
    state UP mode DEFAULT group default qlen 1000
    link/ether 08:94:ef:f4:00:04 brd ff:ff:ff:ff:ff:ff
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ bridge link show
[...]
4: eno1: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 master br0 
     state forwarding priority 32 cost 100 
4: eno1: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 master br0 hwmode VEPA 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;how-to-launch-a-qemu-instance-in-bridge-network-with-two-nics-in-two-separate-networks-via-tap-network-connections---aka-configure-host-tap-network-backendshost-tap-interfaces&quot;&gt;How To Launch a QEMU Instance in Bridge Network with Two NICs in Two Separate Networks via TAP Network Connections - aka Configure Host TAP Network Backends/Host TAP Interfaces&lt;/h3&gt;

&lt;h4 id=&quot;two-bridges---method-1&quot;&gt;Two Bridges - Method 1&lt;/h4&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;p&gt;Launch a QEMU instance with two NICs, each connected to a TAP device.
Use the default network script but instead of using the script’s &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0&lt;/code&gt; 
bridge, connect the both TAP devices to bridgess &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;br0&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;br1&lt;/code&gt;,
respectively:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
-drive format=raw,file=xcatmn.img \
-m 4G \
-netdev tap,helper=&quot;/usr/libexec/qemu-bridge-helper --br=br0&quot;,id=hn0 \
-netdev tap,helper=&quot;/usr/libexec/qemu-bridge-helper --br=br1&quot;,id=hn1 \
-device virtio-net-pci,netdev=hn0 \
-device virtio-net-pci,netdev=hn1 \
-nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When it starts the guest VM, QEMU automatically creates two &lt;strong&gt;TUN&lt;/strong&gt;
connections (aka tun devices) of type &lt;strong&gt;TAP&lt;/strong&gt;.  In this case QEMU names
these two devices tap0 and tap1.  You can obtain the details by starting
a separate shell (while the guest VM is running) and by using the 
following commands: 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ip --details address show&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ip --details link show&lt;/code&gt;, 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ip --details tuntap&lt;/code&gt;, 
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nmcli connection&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nmcli device&lt;/code&gt;,
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nmcli device show&lt;/code&gt;, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brctl show&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&quot;two-bridges---method-2&quot;&gt;Two Bridges - Method 2&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
-drive format=raw,file=xcatmn.img \
-m 4G \
-netdev bridge,br=br0,id=hn0 \
-netdev bridge,br=br1,id=hn1 \
-device virtio-net-pci,netdev=hn0 \
-device virtio-net-pci,netdev=hn1 \
-nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;vde-networking&quot;&gt;VDE Networking&lt;/h3&gt;

&lt;p&gt;From &lt;a href=&quot;https://wiki.qemu.org/Documentation/Networking&quot;&gt;Networking - QEMU Wiki - Documentation&lt;/a&gt; (Retrieved on Apr 2, 2022):&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;VDE&lt;/p&gt;

  &lt;p&gt;The VDE networking backend uses the &lt;a href=&quot;https://github.com/virtualsquare/vde-2&quot;&gt;Virtual Distributed Ethernet&lt;/a&gt; infrastructure to network guests. 
Unless you specifically know that you want to use VDE, it is probably 
not the right backend to use.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;redirecting-ports&quot;&gt;Redirecting Ports&lt;/h3&gt;

&lt;h4 id=&quot;how-to-get-ssh-access-to-a-guest-with-port-forwarding&quot;&gt;How to Get SSH Access to a Guest with Port Forwarding&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;No tap0 on the guest.&lt;/li&gt;
  &lt;li&gt;IP address in the guest:  10.0.2.x  (gw: 10.0.2.254)&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
-drive format=raw,file=xcatmn.img \
-m 4G \
-device e1000,netdev=net0 \
-netdev user,id=net0,hostfwd=tcp::5555-:22 \
-nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The first line creates a virtual e1000 network device, while the second 
line created one user typed backend, forwarding local port 5555 to guest 
port 22.  Then from the host:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ssh -p 5555 username@localhost
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;to have SSH access to guest after its network setup (if there are any 
firewalls in the guest or host, disable them or allow the needed ports).&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;how-to-start-a-qemu-vm-with-bridged-networking-with-the-legacy--net-option-aka-via-hub&quot;&gt;How To Start a QEMU VM with Bridged Networking (with the Legacy -net Option, aka via Hub)&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Task:&lt;/em&gt;  Start a guest VM with the virtual network bridge &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0&lt;/code&gt; 
(installed by the libvirt).&lt;/p&gt;

&lt;p&gt;When QEMU starts (e.g. when you invoke it by starting a VM via QEMU), 
it runs the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qemu-bridge-helper&lt;/code&gt; tool, which automatically creates 
a new tap device, which is effectively a virtual NIC (network interface
controller) with its own MAC address, and connects that device to the bridge.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;NOTE:&lt;/em&gt; &lt;br /&gt;
This example shows the use of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-net&lt;/code&gt; &lt;a href=&quot;#footnotes&quot;&gt;³&lt;/a&gt; legacy option.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Possible to ping from the guest VM&lt;/li&gt;
  &lt;li&gt;The NIC is an e1000 by default on the PC target so if you want to emulate 
an e1000 NIC in the guest you can skip &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-model=e1000&lt;/code&gt; in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-net nic&lt;/code&gt; option.
As such, in the example below, you can use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-net nic&lt;/code&gt; instead of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-net nic,model=e1000&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;The emulated NIC and the host back-end are not &lt;em&gt;directly&lt;/em&gt; connected.
They are rather both connected to an emulated &lt;strong&gt;hub&lt;/strong&gt; (called “vlan” in older versions of QEMU).&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
-drive format=raw,file=xcatmn.img \
-global ide-hd.physical_block_size=4096 \
-m 4G \
-net nic,model=e1000 \
-net bridge,br=virbr0 \
-nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  CentOS Linux (3.10.0-1160.el7.x86_64) 7 (Core)
  CentOS Linux (0-rescue-d01c41227ec248b983c9ea19758c73b0) 7 (Core)


  Use the ↑ and ↓ keys to change the selection.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Log in to the guest VM.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;CentOS Linux 7 (Core)
Kernel 3.10.0-1160.el7.x86_64 on an x86_64

xcatmn login: root
Password:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Networking information in the guest VM:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ifconfig | grep -w inet
    inet 192.168.122.76  netmask 255.255.255.0  broadcast 192.168.122.255
    inet 127.0.0.1  netmask 255.0.0.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# nmcli connection 
NAME  UUID                                  TYPE      DEVICE 
ens3  e5ec08b7-...........................  ethernet  ens3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ip address show ens3 | grep -w inet
    inet 192.168.122.76/24 brd 192.168.122.255 scope global noprefixroute dynam3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cat /etc/sysconfig/network-scripts/ifcfg-ens3
TYPE=&quot;Ethernet&quot;
PROXY_METHOD=&quot;none&quot;
BROWSER_ONLY=&quot;no&quot;
BOOTPROTO=&quot;dhcp&quot;
DEFROUTE=&quot;yes&quot;
IPV4_FAILURE_FATAL=&quot;no&quot;
IPV6INIT=&quot;no&quot;
IPV6_AUTOCONF=&quot;yes&quot;
IPV6_DEFROUTE=&quot;yes&quot;
IPV6_FAILURE_FATAL=&quot;no&quot;
IPV6_ADDR_GEN_MODE=&quot;stable-privacy&quot;
NAME=&quot;ens3&quot;
UUID=&quot;e5ec08b7-...........................&quot;
DEVICE=&quot;ens3&quot;
ONBOOT=&quot;yes&quot;
DNS1=&quot;208.67.222.222&quot;  &amp;lt;-- Will list your DNS1 server
DNS2=&quot;208.67.220.220&quot;  &amp;lt;-- Will list your DNS2 server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# nmcli device show ens3 | grep DNS
IP4.DNS[1]:         192.168.122.1  
IP4.DNS[2]:         208.67.222.222    &amp;lt;-- Will show your DNS2 server
IP4.DNS[3]:         208.67.220.220    &amp;lt;-- Will show your DNS3 server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The kernel routing tables:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# netstat -rn
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
0.0.0.0         192.168.122.1   0.0.0.0         UG        0 0          0 ens3
192.168.122.0   0.0.0.0         255.255.255.0   U         0 0          0 ens3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Or:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# route -e
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
default         gateway         0.0.0.0         UG        0 0          0 ens3
192.168.122.0   0.0.0.0         255.255.255.0   U         0 0          0 ens3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Or with the new tool &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ip(8)&lt;/code&gt;, from the iproute2 package (a collection of 
userspace utilities for controlling and monitoring various aspects of 
networking in the Linux kernel):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ip route
default via 192.168.122.1 dev ens3 proto dhcp metric 100 
192.168.122.0/24 dev ens3 proto kernel scope link src 192.168.122.76 metric 100 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cat /etc/resolv.conf 
# Generated by NetworkManager
search yourdomain.org
nameserver 192.168.122.1
nameserver 208.67.222.222   &amp;lt;-- Will list your nameserver1
nameserver 208.67.220.220   &amp;lt;-- Will list your nameserver2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;virbr0-nic-ethernet-interface-and-tap0-device-are-created-automatically-when-guest-vm-is-running&quot;&gt;virbr0-nic Ethernet Interface and tap0 Device are Created Automatically when Guest VM is Running&lt;/h4&gt;

&lt;p&gt;While the guest VM is running, start another shell on the host.&lt;/p&gt;

&lt;p&gt;On the host system, run the following commands, which show that 
the &lt;strong&gt;tun&lt;/strong&gt; device named &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tap0&lt;/code&gt; (a.k.a. network interface of type 
&lt;strong&gt;tun&lt;/strong&gt; - tun mode &lt;strong&gt;tap&lt;/strong&gt; ) is created automatically (as a slave 
of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0&lt;/code&gt; bridge) when the guest VM is powered on.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ifconfig | egrep -i &quot;virbr|tap&quot;
tap0: flags=4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt;  mtu 1500
virbr0: flags=4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt;  mtu 1500
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ifconfig -a | egrep -i &quot;virbr|tap&quot;
tap0: flags=4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt;  mtu 1500
virbr0: flags=4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt;  mtu 1500
virbr0-nic: flags=4098&amp;lt;BROADCAST,MULTICAST&amp;gt;  mtu 1500
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli connection | egrep -i &quot;bridge|tun|tap|type&quot;
NAME    UUID                                  TYPE      DEVICE
virbr0  3216d7f0-124e-4c66-a6de-5b218d18377c  bridge    virbr0
tap0    72e1da4b-5a73-40ec-9cce-c480078f3c68  tun       tap0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli connection show virbr0 | egrep -wi &quot;type|mode|name|master|slave&quot;
connection.type:                    bridge
connection.interface-name:          virbr0
connection.master:                  --
connection.slave-type:              --
ipv6.addr-gen-mode:                 stable-privacy
GENERAL.NAME:                       virbr0
GENERAL.MASTER-PATH:                --
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli connection show tap0 | egrep -wi &quot;type|mode|name|master|slave&quot;
connection.type:                    tun
connection.interface-name:          tap0
connection.master:                  virbr0
connection.slave-type:              bridge
bridge-port.hairpin-mode:           no
tun.mode:                           2 (tap)
GENERAL.NAME:                       tap0
GENERAL.MASTER-PATH:                /org/freedesktop/NetworkManager/Devices/6
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli device | egrep -i &quot;bridge|tun|type&quot;
DEVICE      TYPE      STATE                   CONNECTION
virbr0      bridge    connected (externally)  virbr0
tap0        tun       connected (externally)  tap0
virbr0-nic  tun       unmanaged               --
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli device show virbr0
GENERAL.DEVICE:           virbr0
GENERAL.TYPE:             bridge
[...]
GENERAL.STATE:            100 (connected (externally))
GENERAL.CONNECTION:       virbr0
[...]
IP4.ADDRESS[1]:           192.168.122.1/24
IP4.GATEWAY:              --
IP4.ROUTE[1]:             dst = 192.168.122.0/24, nh = 0.0.0.0, mt = 0
[...]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli device show virbr0-nic
GENERAL.DEVICE:           virbr0-nic
GENERAL.TYPE:             tun
[...]
GENERAL.STATE:            10 (unmanaged)
GENERAL.CONNECTION:       --
[...]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli device show tap0
GENERAL.DEVICE:           tap0
GENERAL.TYPE:             tun
[...]
GENERAL.STATE:            100 (connected (externally))
GENERAL.CONNECTION:       tap0
[...]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ brctl show
bridge name     bridge id               STP enabled     interfaces
virbr0          8000.525400a7c2ab       yes             tap0
                                                        virbr0-nic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;verification-of-bridge-creation-and-network-connection&quot;&gt;Verification of Bridge Creation and Network Connection&lt;/h4&gt;

&lt;p&gt;Use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ip&lt;/code&gt; utility to display the link status of Ethernet devices that 
are ports of the bridge &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ip link show master virbr0
7: virbr0-nic: &amp;lt;BROADCAST,MULTICAST&amp;gt; mtu 1500 qdisc fq_codel master 
      virbr0 state DOWN mode DEFAULT group default qlen 1000
      link/ether 52:54:00:a7:c2:ab brd ff:ff:ff:ff:ff:ff
33: tap0: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 qdisc fq_codel master 
      virbr0 state UNKNOWN mode DEFAULT group default qlen 1000
      link/ether fe:0e:7b:05:f6:b1 brd ff:ff:ff:ff:ff:ff
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can also use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bridge&lt;/code&gt; utility to display the status of Ethernet 
devices that are ports of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0&lt;/code&gt; bridge device.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ bridge link show 
[...]
4: eno1: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 hwmode VEPA 
5: eno2: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 hwmode VEPA 
7: virbr0-nic: &amp;lt;BROADCAST,MULTICAST&amp;gt; mtu 1500 master virbr0 state disabled 
     priority 32 cost 100 
33: tap0: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 master virbr0 state 
     forwarding priority 32 cost 100
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli device show virbr0 | grep -i type
GENERAL.TYPE:                           bridge

$ nmcli device show virbr0-nic | grep -i type
GENERAL.TYPE:                           tun

$ nmcli device show tap0 | grep -i type
GENERAL.TYPE:                           tun
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Back in the first shell, in the guest VM, power off the system.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# poweroff
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;virbr0-nic-network-interface-and-tap0-device-are-automatically-removed-when-guest-vm-is-powered-down&quot;&gt;virbr0-nic Network Interface and tap0 Device are Automatically Removed when Guest VM is Powered Down&lt;/h4&gt;

&lt;p&gt;Back on the host system, after the VM is powered off, run the following 
set of commands.  They show that the the &lt;strong&gt;tun&lt;/strong&gt; device named &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tap0&lt;/code&gt; 
(network interface of type &lt;strong&gt;tun&lt;/strong&gt; - tun mode &lt;strong&gt;tap&lt;/strong&gt; ) is automatically 
removed after the guest VM is powered off.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ifconfig | egrep -i &quot;virbr|tap&quot;
virbr0: flags=4099&amp;lt;UP,BROADCAST,MULTICAST&amp;gt;  mtu 1500
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ifconfig -a | egrep -i &quot;virbr|tap&quot;
virbr0: flags=4099&amp;lt;UP,BROADCAST,MULTICAST&amp;gt;  mtu 1500
virbr0-nic: flags=4098&amp;lt;BROADCAST,MULTICAST&amp;gt;  mtu 1500
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli connection | egrep -i &quot;bridge|tun|tap|type&quot;
NAME    UUID                                  TYPE      DEVICE
virbr0  3216d7f0-124e-4c66-a6de-5b218d18377c  bridge    virbr0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli device | egrep -i &quot;bridge|tun|tap|type&quot;
DEVICE      TYPE      STATE                   CONNECTION
virbr0      bridge    connected (externally)  virbr0
virbr0-nic  tun       unmanaged               --
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ brctl show
bridge name     bridge id               STP enabled     interfaces
virbr0          8000.525400a7c2ab       yes             virbr0-nic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ip link show master virbr0
7: virbr0-nic: &amp;lt;BROADCAST,MULTICAST&amp;gt; mtu 1500 qdisc fq_codel master virbr0 
      state DOWN mode DEFAULT group default qlen 1000
      link/ether 52:54:00:a7:c2:ab brd ff:ff:ff:ff:ff:ff
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ bridge link show
[...]
4: eno1: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 hwmode VEPA 
5: eno2: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&amp;gt; mtu 1500 hwmode VEPA 
7: virbr0-nic: &amp;lt;BROADCAST,MULTICAST&amp;gt; mtu 1500 master virbr0 state disabled 
      priority 32 cost 100 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;appendix&quot;&gt;Appendix&lt;/h2&gt;

&lt;p&gt;This section shows how the guest VM used in the examples was created.&lt;/p&gt;

&lt;h3 id=&quot;create-a-customized-centosrhel-dvd-iso-for-installation-in-text-mode-via-serial-console&quot;&gt;Create a Customized CentOS/RHEL DVD ISO for Installation in Text Mode via Serial Console&lt;/h3&gt;

&lt;p&gt;Download CentOS 7.9 DVD ISO image and verify the SHA256 checksum 
of the ISO image file to ensure its integrity – Verify that the SHA256 
checksum of the downloaded file matches that of the SHA256 checksum listed 
at the CentOS.org official download site.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cd /tmp/

$ wget https://mirror.esecuredata.com/centos/7.9.2009/isos/x86_64/CentOS-7-x86_64-Everything-2009.iso

$ wget https://mirror.esecuredata.com/centos/7.9.2009/isos/x86_64/sha256sum.txt

$ ls -lh sha256sum.txt
-rw-rw-r-- 1 dusko dusko 398 Nov  4  2020 sha256sum.txt

$ wc -l sha256sum.txt
4 sha256sum.txt

$ grep -n 'CentOS-7-x86_64-Everything-2009.iso' sha256sum.txt
1:689531cce9cf484378481ae762fae362791a9be078fda10e4f6977bf8fa71350  CentOS-7-x86_64-Everything-2009.iso

$ grep CentOS-7-x86_64-Everything-2009.iso sha256sum.txt &amp;gt; /tmp/sha256sum.txt.tmp

$ mv /tmp/sha256sum.txt.tmp /tmp/sha256sum.txt

$ cat /tmp/sha256sum.txt
689531cce9cf484378481ae762fae362791a9be078fda10e4f6977bf8fa71350  CentOS-7-x86_64-Everything-2009.iso

$ sha256sum --check sha256sum.txt
CentOS-7-x86_64-Everything-2009.iso: OK
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Customize the DVD ISO image so that the installer redirects its text output 
to the serial console, specifically to the first serial device (ttyS0), 
with baud rate of 19200. (This is to meet the requirement of the system 
that this VM is going to replicate.)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo mkdir -p /mnt/{dvd,customdvd}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo \
mount \
-t iso9660 \
/tmp/CentOS-7-x86_64-Everything-2009.iso \
/mnt/dvd/
mount: /mnt/dvd: WARNING: device write-protected, mounted read-only.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo rsync -a /mnt/dvd/ /mnt/customdvd/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -alh /mnt/customdvd/isolinux/
total 60M
drwxr-xr-x 2 root root  198 Oct 26  2020 .
drwxr-xr-x 8 root root  254 Oct 29  2020 ..
-r--r--r-- 1 root root 2.0K Nov  2  2020 boot.cat
-rw-r--r-- 1 root root   84 Oct 26  2020 boot.msg
-rw-r--r-- 1 root root  281 Oct 26  2020 grub.conf
-rw-r--r-- 1 root root  53M Oct 26  2020 initrd.img
-rw-r--r-- 1 root root  24K Oct 26  2020 isolinux.bin
-rw-r--r-- 1 root root 3.0K Oct 26  2020 isolinux.cfg
-rw-r--r-- 1 root root 187K Nov  5  2016 memtest
-rw-r--r-- 1 root root  186 Sep 30  2015 splash.png
-r--r--r-- 1 root root 2.2K Nov  2  2020 TRANS.TBL
-rw-r--r-- 1 root root 150K Oct 30  2018 vesamenu.c32
-rwxr-xr-x 1 root root 6.5M Oct 19  2020 vmlinuz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /mnt/customdvd/isolinux/boot.msg


splash.lss

 -  Press the 01&amp;lt;ENTER&amp;gt;07 key to begin the installation process.

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Delete the line with ‘splash.lss’ from the ‘boot.msg’.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo sed -i.bkp '/splash.lss/d' /mnt/customdvd/isolinux/boot.msg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ diff \
--unified=0 \
/mnt/customdvd/isolinux/boot.msg.bkp \
/mnt/customdvd/isolinux/boot.msg
--- /mnt/customdvd/isolinux/boot.msg.bkp      2020-10-26 09:25:28.000000000 -0700
+++ /mnt/customdvd/isolinux/boot.msg    2022-04-02 08:09:31.109458847 -0700
@@ -2 +1,0 @@
-splash.lss
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /mnt/customdvd/isolinux/boot.msg



 -  Press the 01&amp;lt;ENTER&amp;gt;07 key to begin the installation process.

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo rm -i /mnt/customdvd/isolinux/boot.msg.bkp
rm: remove regular file '/mnt/customdvd/isolinux/boot.msg.bkp'? y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Remove ‘boot.cat’. It will be regenerated in a later step.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo rm -i /mnt/customdvd/isolinux/boot.cat
rm: remove regular file '/mnt/customdvd/isolinux/boot.cat'? y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Tell ISOLINUX to use a serial port as the console. “port” is a number
(0 = /dev/ttyS0 = COM1, etc.) or an I/O port address (e.g. 0x3F8)
(&lt;a href=&quot;https://www.syslinux.org/old/faq.php&quot;&gt;https://www.syslinux.org/old/faq.php&lt;/a&gt;,
&lt;a href=&quot;https://wiki.syslinux.org/wiki/index.php?title=SYSLINUX&quot;&gt;https://wiki.syslinux.org/wiki/index.php?title=SYSLINUX&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Here I want to use the port 0 so the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;console&lt;/code&gt; statement uses tty0 and ttyS0.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo vi /mnt/customdvd/isolinux/isolinux.cfg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ diff \
--unified=0 \
/mnt/dvd/isolinux/isolinux.cfg \
/mnt/customdvd/isolinux/isolinux.cfg
--- /mnt/dvd/isolinux/isolinux.cfg      2020-10-26 09:25:28.000000000 -0700
+++ /mnt/customdvd/isolinux/isolinux.cfg        2022-04-02 08:12:12.604830661 -0700
@@ -64 +64 @@
-  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 quiet
+  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 quiet console=tty0 console=ttyS0,19200
@@ -70 +70 @@
-  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rd.live.check quiet
+  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rd.live.check quiet console=tty0 console=ttyS0,19200
@@ -86 +86 @@
-  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 xdriver=vesa nomodeset quiet
+  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 xdriver=vesa nomodeset quiet console=tty0 console=ttyS0,19200
@@ -96 +96 @@
-  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rescue quiet
+  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rescue quiet console=tty0 console=ttyS0,19200
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -lh /mnt/customdvd/EFI/BOOT/
total 6.0M
-rwxr--r-- 1 root root 978K Jul 31  2020 BOOTIA32.EFI
-rwxr--r-- 1 root root 1.2M Jul 31  2020 BOOTX64.EFI
drwxr-xr-x 2 root root   42 Oct 26  2020 fonts
-rw-r--r-- 1 root root 1.3K Oct 26  2020 grub.cfg
-rwxr--r-- 1 root root 745K Jul 28  2020 grubia32.efi
-rwxr--r-- 1 root root 1.1M Jul 28  2020 grubx64.efi
-rwxr--r-- 1 root root 898K Jul 31  2020 mmia32.efi
-rwxr--r-- 1 root root 1.2M Jul 31  2020 mmx64.efi
-r--r--r-- 1 root root 1.8K Nov  2  2020 TRANS.TBL
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo vi /mnt/customdvd/EFI/BOOT/grub.cfg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ diff --unified=0 /mnt/dvd/EFI/BOOT/grub.cfg /mnt/customdvd/EFI/BOOT/grub.cfg
--- /mnt/dvd/EFI/BOOT/grub.cfg  2020-10-26 09:25:28.000000000 -0700
+++ /mnt/customdvd/EFI/BOOT/grub.cfg    2022-04-02 08:23:17.334493194 -0700
@@ -16,0 +17,4 @@
+serial --unit=0 --speed=19200 --word=8 --parity=no --stop=1
+terminal_input serial console=tty0 console=ttyS0,19200
+terminal_output serial console=tty0 console=ttyS0,19200
+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /mnt/customdvd/EFI/BOOT/grub.cfg
set default=&quot;1&quot;

function load_video {
  insmod efi_gop
  insmod efi_uga
  insmod video_bochs
  insmod video_cirrus
  insmod all_video
}

load_video
set gfxpayload=keep
insmod gzio
insmod part_gpt
insmod ext2

serial --unit=0 --speed=19200 --word=8 --parity=no --stop=1
terminal_input serial console=tty0 console=ttyS0,19200
terminal_output serial console=tty0 console=ttyS0,19200

set timeout=60
### END /etc/grub.d/00_header ###

search --no-floppy --set=root -l 'CentOS 7 x86_64'

### BEGIN /etc/grub.d/10_linux ###
menuentry 'Install CentOS 7' --class fedora --class gnu-linux --class gnu --class os {
        linuxefi /images/pxeboot/vmlinuz inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 quiet
        initrdefi /images/pxeboot/initrd.img
}
menuentry 'Test this media &amp;amp; install CentOS 7' --class fedora --class gnu-linux --class gnu --class os {
        linuxefi /images/pxeboot/vmlinuz inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rd.live.check quiet
        initrdefi /images/pxeboot/initrd.img
}
submenu 'Troubleshooting --&amp;gt;' {
        menuentry 'Install CentOS 7 in basic graphics mode' --class fedora --class gnu-linux --class gnu --class os {
                linuxefi /images/pxeboot/vmlinuz inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 xdriver=vesa nomodeset quiet
                initrdefi /images/pxeboot/initrd.img
        }
        menuentry 'Rescue a CentOS system' --class fedora --class gnu-linux --class gnu --class os {
                linuxefi /images/pxeboot/vmlinuz inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rescue quiet
                initrdefi /images/pxeboot/initrd.img
        }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ isoinfo -d -i /tmp/CentOS-7-x86_64-Everything-2009.iso | grep &quot;Volume id&quot;
Volume id: CentOS 7 x86_64

$ isoinfo -d -i /tmp/CentOS-7-x86_64-Everything-2009.iso | grep Joliet
Joliet with UCS level 3 found

$ isoinfo -d -i /tmp/CentOS-7-x86_64-Everything-2009.iso | grep prepare
Data preparer id:

$ isoinfo -d -i /tmp/CentOS-7-x86_64-Everything-2009.iso | grep Torito
El Torito VD version 1 found, boot catalog is in sector 1430
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ blkid /tmp/CentOS-7-x86_64-Everything-2009.iso
/tmp/CentOS-7-x86_64-Everything-2009.iso: BLOCK_SIZE=&quot;2048&quot; 
  UUID=&quot;2020-11-02-15-15-23-00&quot; LABEL=&quot;CentOS 7 x86_64&quot; TYPE=&quot;iso9660&quot; 
  PTUUID=&quot;6b8b4567&quot; PTTYPE=&quot;dos&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo \
mkisofs \
-o /tmp/CentOS-7-x86_64-Everything-CUSTOM-2009.iso \
-b isolinux/isolinux.bin \
-J \
-R \
-l \
-c isolinux/boot.cat \
-no-emul-boot \
-boot-load-size 4 \
-boot-info-table \
-eltorito-alt-boot \
-e images/efiboot.img \
-no-emul-boot \
-graft-points \
-input-charset utf-8 \
-output-charset utf-8 \
-V &quot;CentOS 7 x86_64&quot; \
/mnt/customdvd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo chown dusko:dusko /tmp/CentOS-7-x86_64-Everything-CUSTOM-2009.iso
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ blkid /tmp/CentOS-7-x86_64-Everything-CUSTOM-2009.iso
/tmp/CentOS-7-x86_64-Everything-CUSTOM-2009.iso: BLOCK_SIZE=&quot;2048&quot; 
  UUID=&quot;2022-04-02-08-31-52-00&quot; LABEL=&quot;CentOS 7 x86_64&quot; TYPE=&quot;iso9660&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Implant an MD5 checksum in the ISO image.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ implantisomd5 /tmp/CentOS-7-x86_64-Everything-CUSTOM-2009.iso
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Check an MD5 checksum implanted by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;implantisomd5&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ checkisomd5 --verbose /tmp/CentOS-7-x86_64-Everything-CUSTOM-2009.iso
[...]
The media check is complete, the result is: PASS.

It is OK to use this media.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Create a raw image of 60 GB in size. Using seek option creates 
a sparse file, which saves space.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ dd if=/dev/null of=xcatmn.img bs=1M seek=61440
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -lh xcatmn.img
-rw-rw-r-- 1 dusko dusko 60G Mar 2 08:36 xcatmn.img
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ command -V qemu-kvm; type qemu-kvm; which qemu-kvm; whereis qemu-kvm
/usr/bin/command: line 2: command: qemu-kvm: not found
/usr/bin/type: line 2: type: qemu-kvm: not found
qemu-kvm: Command not found.
qemu-kvm: /usr/lib64/qemu-kvm /etc/qemu-kvm /usr/libexec/qemu-kvm 
          /usr/share/qemu-kvm /usr/share/man/man1/qemu-kvm.1.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;install-centos-linux-79-on-qemu-guest-vm-image&quot;&gt;Install CentOS Linux 7.9 on QEMU Guest VM Image&lt;/h3&gt;

&lt;p&gt;Create a QEMU virtual machine with the following properties:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;for the VM’s disk use the 60GB image created in the previous step&lt;/li&gt;
  &lt;li&gt;configure the disk with the physical sector size of 4096 bytes (4 K)
(this is to meet the requirement of the system that this VM is going 
 to replicate)&lt;/li&gt;
  &lt;li&gt;4 GB RAM&lt;/li&gt;
  &lt;li&gt;virtual machine booting on the first serial device (ttyS0)&lt;/li&gt;
  &lt;li&gt;VM booting from the first CD-ROM/DVD drive&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
-cdrom /tmp/CentOS-7-x86_64-Everything-CUSTOM-2009.iso \
-drive format=raw,file=xcatmn.img \
-global ide-hd.physical_block_size=4096 \
-m 4G \
-boot d \
-serial pty \
-nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This opens QEMU monitor (aka QEMU console):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QEMU 4.2.0 monitor - type 'help' for more information
(qemu) char device redirected to /dev/pts/1 (label serial0)
(qemu)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Open a new shell and start &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;minicom&lt;/code&gt; to connect to the installer, whose 
output is redirected to the first serial device (ttyS0) to /dev/pts/1. 
(Baud rate of 19200 was configured earlier in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;grub.cfg&lt;/code&gt;, when you 
customized the installation DVD ISO image.)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ minicom --baudrate=19200 --ptty=/dev/pts/1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Install CentOS 7.9 Linux.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[  OK  ] Started Media check on /dev/sr0.
[  OK  ] Started Show Plymouth Boot Screen.
[  OK  ] Reached target Paths.
[...]
Starting installer, one moment...
anaconda 21.48.22.159-1 for CentOS 7 started.
 * installation log files are stored in /tmp during the installation
 * shell is available on TTY2
 * when reporting a bug add logs from /tmp as separate text/plain attachments
15:43:19 Not asking for VNC because we don't have a network
=============================================================================
=============================================================================
Installation

 1) [x] Language settings                 2) [!] Time settings
        (English (United States))                (Timezone is not set.)
 3) [!] Installation source               4) [!] Software selection
        (Processing...)                          (Processing...)
 5) [!] Installation Destination          6) [x] Kdump
        (No disks selected)                      (Kdump is enabled)
 7) [ ] Network configuration             8) [!] Root password
        (Not connected)                          (Password is not set.)
 9) [!] User creation
        (No user will be created)
  Please make your choice from above ['q' to quit | 'b' to begin installation |
  'r' to refresh]:

[anaconda] 1:main* 2:shell  3:log  4:storage-lo&amp;gt; Switch tab: Alt+Tab | Help: F1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;2: Time settings &amp;gt; America/Vancouver timezone
NTP servers:
ntp1.serverinyourregion.org
ntp2.serverinyourregion.org

4: Software selection &amp;gt; Compute Node

5: Installation Destination
QEMU HARDDISK 60 GiB (sda) &amp;gt; Use All Space &amp;gt; LVM

7: Network configuration
Host name:  xcatmn.yourdomain.org

Wired (ens3)
Device configuration
DHCP
IPv6:  ignore
Nameservers:  208.67.222.222, 208.67.220.220  &amp;lt;&amp;lt;-- Use your nameservers 
[x] Connect automatically after reboot
[x] Apply configuration in installer

8: Root password

9: User creation
Create user
Fullname: dusko
Username: dusko
Use password
[X] Administrator
Groups: wheel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;=============================================================================
=============================================================================
Installation
  
 1) [x] Language settings                 2) [x] Time settings
        (English (United States))                (America/Vancouver timezone)
 3) [x] Installation source               4) [x] Software selection
        (Local media)                            (Compute Node)
 5) [x] Installation Destination          6) [x] Kdump
        (Automatic partitioning                  (Kdump is enabled)
        selected)                         8) [x] Root password
 7) [x] Network configuration                    (Password is set.)
        (Wired (ens3) connected)
 9) [x] User creation
        (Administrator dusko will be
        created)

Please make your choice from above ['q' to quit | 'b' to begin installation |
'r' to refresh]:  b

=============================================================================
=============================================================================
Progress
Setting up the installation environment
.
Creating disklabel on /dev/sda
Creating xfs on /dev/sda1
Creating lvmpv on /dev/sda2
Creating swap on /dev/mapper/centos-swap
Creating xfs on /dev/mapper/centos-home
Creating xfs on /dev/mapper/centos-root
.
Running pre-installation scripts
.
Starting package installation process
Preparing transaction from installation source
Installing libgcc (1/483)
[...]
Installing iwl6000g2a-firmware (482/483)
Installing words (483/483)
Performing post-installation setup tasks
Installing boot loader
.
Performing post-installation setup tasks

Configuring installed system
Writing network configuration
Creating users
Configuring addons
Generating initramfs
Running post-installation scripts
.
    Use of this product is subject to the license agreement found at
      /usr/share/centos-release/EULA

     Installation complete.  Press return to quit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Press Ctr+b 2&lt;/p&gt;

&lt;p&gt;Power off the virtual machine.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[anaconda root@localhost ~]# poweroff

[  OK  ] Started Show Plymouth Power Off Screen.
[  OK  ] Stopped Anaconda.
[  OK  ] Stopped target Anaconda System Services.
[...]
[  OK  ] Reached target Shutdown.
dracut Warning: Killing all remaining processes
Powering off.
[ 1909.085711] Power down.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Not shown here:  QEMU console (in the first shell) automatically exits.&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h4&gt;

&lt;p&gt;[¹] IP Forwarding and libvirt Networking&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;libvirt’s default network configures an isolated bridge device to be
used by guest domains.  This default bridge creates a private network
for the virtual machines but does not connect that private network to
your physical network.  The simplest way to complete that connection is
to enable IP Forwarding in the kernel.  You can quickly enable IP
Forwarding using sysctl:&lt;/p&gt;

  &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# sysctl -w net.ipv4.ip_forward=1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;  &lt;/div&gt;
&lt;/blockquote&gt;

&lt;p&gt;[²] A library providing a simple virtualization API - a C toolkit to 
interact with the virtualization capabilities of Linux. It includes the 
libvrtd server exporting the virtualization support.&lt;/p&gt;

&lt;p&gt;[³]  From &lt;a href=&quot;https://www.qemu.org/2018/05/31/nic-parameter/&quot;&gt;QEMU’s new -nic command line option&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;The legacy -net option&lt;/p&gt;

  &lt;p&gt;QEMU’s initial way of configuring the network for the guest was the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-net&lt;/code&gt;
option.  The emulated NIC hardware can be chosen with the
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-net nic,model=xyz,...&lt;/code&gt; parameter, and the host back-end with the
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-net &amp;lt;backend&amp;gt;,...&lt;/code&gt; parameter (e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-net user&lt;/code&gt; for the SLIRP back-end).
However, the emulated NIC and the host back-end are &lt;em&gt;not directly connected&lt;/em&gt;.
They are rather both connected to an emulated &lt;strong&gt;hub&lt;/strong&gt; (called “vlan” in older
versions of QEMU).  Therefore, if you start QEMU with
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-net nic,model=e1000 -net user -net nic,model=virtio -net tap&lt;/code&gt; for example,
you get a setup where all the front-ends and back-ends are connected
together via a hub.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;References:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://unix.stackexchange.com/questions/523245/whats-the-function-of-virbr0-and-virbr0-nic&quot;&gt;What’s the function of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;virbr0-nic&lt;/code&gt;?&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://listman.redhat.com/archives/libvirt-users/2012-September/msg00038.html&quot;&gt;[libvirt-users] virtual networking - virbr0-nic interface&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://unix.stackexchange.com/questions/378264/what-is-virtual-bridge-with-nic-in-the-end-of-name/444863#444863&quot;&gt;What is virtual bridge with -nic in the end of name&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://code.lardcave.net/2019/07/20/1/&quot;&gt;Bridged networking with qemu on Linux&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://wiki.archlinux.org/title/Network_bridge&quot;&gt;Network bridge - Arch Wiki&lt;/a&gt;&lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://wiki.linuxfoundation.org/networking/bridge&quot;&gt;Bridge - The Linux Foundation Wiki&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://bsdwiki.reedmedia.net/wiki/networking_qemu_virtual_bsd_systems.html&quot;&gt;Networking QEMU Virtual BSD Systems&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://blog.christophersmart.com/2016/08/31/configuring-qemu-bridge-helper-after-access-denied-by-acl-file-error/&quot;&gt;Configuring QEMU bridge helper after “access denied by acl file” error&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.linux-kvm.org/page/Networking&quot;&gt;Configuring Guest Networking - KVM&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Guest (VM) networking in kvm is the same as in qemu, so it is possible 
to refer to other documentation about networking in qemu.  This page will 
try to explain how to configure the most frequent types of networking needed.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://www.qemu.org/2018/05/31/nic-parameter/&quot;&gt;QEMU’s new -nic command line option&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.cyberciti.biz/faq/centos-8-add-network-bridge-br0-with-nmcli-command/&quot;&gt;CentOS 8 add network bridge (br0) with nmcli command&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.cyberciti.biz/faq/how-to-add-network-bridge-with-nmcli-networkmanager-on-linux/&quot;&gt;How to add network bridge with nmcli (NetworkManager) on Linux&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://access.redhat.com/discussions/5996181&quot;&gt;Qemu bridge/tap adaper - Red Hat Customer Portal&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_virtualization/configuring-virtual-machine-network-connections_configuring-and-managing-virtualization#virtual-networking-bridged-mode_types-of-virtual-machine-network-connections&quot;&gt;Virtual networking in bridged mode&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_networking/configuring-a-network-bridge_configuring-and-managing-networking#configuring-a-network-bridge-using-nmcli-commands_configuring-a-network-bridge&quot;&gt;Configuring a network bridge using nmcli commands&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://gist.github.com/extremecoders-re/e8fd8a67a515fee0c873dcafc81d811c&quot;&gt;Setting up Qemu with a tap interface&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://bbs.archlinux.org/viewtopic.php?id=261207&quot;&gt;[SOLVED] KVM/QEMU - Ethernet will not bridge&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://ahelpme.com/linux/howto-do-qemu-full-virtualization-with-bridged-networking/&quot;&gt;Howto do QEMU full virtualization with bridged networking&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://qemu.readthedocs.io/en/latest/system/devices/net.html&quot;&gt;Network emulation - QEMU Documentation&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://stty.io/2019/05/13/qemu-vm-wireguard-vpn-tun-tap-networking/&quot;&gt;Setting up TUN/TAP networking for QEMU VM’s (and bonus wireguard)&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.linux-kvm.org/page/Networking&quot;&gt;Configuring Guest Networking - KVM Documentation&lt;/a&gt; &lt;br /&gt;
(Retrieved on Apr 2, 2022)&lt;/p&gt;

&lt;hr /&gt;

</description>
        <pubDate>Sat, 02 Apr 2022 08:11:22 -0700</pubDate>
        <link>http://localhost:4000/howto/virtualization/rs232serial/cli/terminal/shell/console/sysadmin/server/hardware/networking/2022/04/02/qemu-networking.html</link>
        <guid isPermaLink="true">http://localhost:4000/howto/virtualization/rs232serial/cli/terminal/shell/console/sysadmin/server/hardware/networking/2022/04/02/qemu-networking.html</guid>
        
        
        <category>howto</category>
        
        <category>virtualization</category>
        
        <category>rs232serial</category>
        
        <category>cli</category>
        
        <category>terminal</category>
        
        <category>shell</category>
        
        <category>console</category>
        
        <category>sysadmin</category>
        
        <category>server</category>
        
        <category>hardware</category>
        
        <category>networking</category>
        
      </item>
    
      <item>
        <title>Configure IP Addressing with NetworkManager (nmcli) in RHEL 8/CentOS 8</title>
        <description>&lt;p&gt;OS: RHEL 8 &lt;br /&gt;
Shell:  bash&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;static-addressing&quot;&gt;Static Addressing&lt;/h3&gt;

&lt;p&gt;For example, create a new connection named ‘eno1’. &lt;br /&gt;
Specify a name for the connection profile (con-name), the interface the 
profile should be applied to (ifname), the IP address (ip4) and optionally, 
the gateway (gw4). The IP address must be specified with the network prefix. 
The connection profile name can match the interface name. 
The connection will be activated as soon as it is created.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo nmcli connection add \
con-name eno1 ifname eno1 type ethernet \
ip4 123.12.23.34/24 gw4 123.12.23.254
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Set up DNS servers. For example, use recursive nameservers by OpenDNS, 
208.67.222.222, 208.67.220.220.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo nmcli connection modify eno1 \ 
ipv4.dns &quot;208.67.222.222,208.67.220.220&quot; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;NOTE:  Some other options that you can use for your DNS resolver:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Cloudflare’s public DNS server 1.1.1.1&lt;/li&gt;
  &lt;li&gt;Google’s DNS servers 4.4.8.8, 4.4.4.4, 8.8.8.8&lt;/li&gt;
  &lt;li&gt;In Canada, &lt;a href=&quot;https://www.cira.ca/cybersecurity-services/canadian-shield&quot;&gt;CIRA Canada Shield&lt;/a&gt;:
    &lt;ul&gt;
      &lt;li&gt;Private - DNS resolution only: 149.112.121.10, 149.112.122.10&lt;/li&gt;
      &lt;li&gt;Protected - Malware and phishing protection: 149.112.121.20, 149.112.122.20&lt;/li&gt;
      &lt;li&gt;Family - Protected + blocking offensive content: 149.112.121.30, 149.112.122.30&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo nmcli connection modify eno1 ipv4.method manual
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo nmcli connection reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nmcli connection show
NAME  UUID               TYPE      DEVICE 
eno1  4d928341-........  ethernet  eno1   
[...]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Confirm the system is using NetworkManager.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo systemctl restart NetworkManager.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo systemctl status NetworkManager.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo nmcli networking connectivity check
full
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

</description>
        <pubDate>Sun, 27 Mar 2022 09:48:33 -0700</pubDate>
        <link>http://localhost:4000/rhel/centos/linux/networking/howto/2022/03/27/rhel8-centos8-linux-setup-static-ip-address.html</link>
        <guid isPermaLink="true">http://localhost:4000/rhel/centos/linux/networking/howto/2022/03/27/rhel8-centos8-linux-setup-static-ip-address.html</guid>
        
        
        <category>rhel</category>
        
        <category>centos</category>
        
        <category>linux</category>
        
        <category>networking</category>
        
        <category>howto</category>
        
      </item>
    
      <item>
        <title>Occasionally Revisited Code and Shell Script Snippets</title>
        <description>&lt;h3 id=&quot;which-shell-im-in&quot;&gt;Which shell I’m in?&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ps $$
    PID TTY      STAT   TIME COMMAND
2612401 pts/0    Ss     0:00 -csh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ printf %s\\n &quot;$SHELL&quot;
/bin/csh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;h3 id=&quot;how-to-set-an-environment-variable-for-just-one-command-in-cshtcsh&quot;&gt;How to Set an Environment Variable for Just One Command In csh/tcsh?&lt;/h3&gt;

&lt;p&gt;Use a subshell:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# (setenv XCATBYPASS &quot;Y&quot;; tabdump site)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Reference:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/5946736/how-to-set-an-environment-variable-for-just-one-command-in-csh-tcsh&quot;&gt;How to set an environment variable for just one command in csh/tcsh&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 13, 2022)&lt;/p&gt;

&lt;h3 id=&quot;how-to-set-an-environment-variable-for-just-one-command-in-cshtcsh-and-pass-it-to-sudo&quot;&gt;How to set an Environment Variable for Just One Command in csh/tcsh and Pass It To sudo&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo &quot;XCATBYPASS=Y&quot; csh -c 'printf %s\\n &quot;$XCATBYPASS&quot;'
Y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  This also works if you replace &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;csh&lt;/code&gt; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tcsh&lt;/code&gt;, 
or with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sh&lt;/code&gt;, or with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bash&lt;/code&gt;. (Tested on FreeBSD 13.0 and RHEL 8.4.)&lt;/p&gt;

&lt;p&gt;Reference:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/40624957/pass-environment-variable-to-sudo&quot;&gt;Pass environment variable to sudo&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 13, 2022)&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;sed1&quot;&gt;sed(1)&lt;/h3&gt;

&lt;p&gt;OS: CentOS Linux 7, Shell: bash&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ grep -n ttyS0 /etc/securetty
24:ttyS0

$ sed -n '/ttyS0/p' /etc/securetty
ttyS0

$ sed -n '/ttyS0/=' /etc/securetty
24
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;perl&quot;&gt;Perl&lt;/h3&gt;

&lt;p&gt;OS: CentOS Linux 5, Shell: bash&lt;/p&gt;

&lt;p&gt;You need to prepend the currency symbol (a.k.a. dollar sign) with
a backslash (\) in a &lt;a href=&quot;https://en.wikipedia.org/wiki/Here_document&quot;&gt;heredoc&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat &amp;lt;&amp;lt; EOF &amp;gt;&amp;gt; perl1.pl
#!/usr/bin/env perl
use strict;
use Getopt::Long;
use File::Basename;

my \$arguments=join(',',@ARGV);

print &quot;\$arguments\n&quot;;
EOF
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chmod 0744 perl1.pl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ./perl1.pl testArg1 testArg2
testArg1,testArg2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;how-to-get-physical-block-size-in-linux&quot;&gt;How to Get Physical Block Size in Linux?&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# blockdev --getbsz /dev/sda
4096
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If filesystem is XFS (property: &lt;strong&gt;bsize&lt;/strong&gt;):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# df -hT
Filesystem              Type      Size  Used Avail Use% Mounted on
devtmpfs                devtmpfs  908M     0  908M   0% /dev
tmpfs                   tmpfs     919M     0  919M   0% /dev/shm
tmpfs                   tmpfs     919M  8.5M  911M   1% /run
tmpfs                   tmpfs     919M     0  919M   0% /sys/fs/cgroup
/dev/mapper/centos-root xfs       3.5G  1.3G  2.3G  36% /
/dev/sda1               xfs      1014M  150M  865M  15% /boot
tmpfs                   tmpfs     184M     0  184M   0% /run/user/0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# xfs_info /dev/mapper/centos-root
meta-data=/dev/mapper/centos-root isize=512    agcount=4, agsize=229120 blks
         =                       sectsz=4096  attr=2, projid32bit=1
         =                       crc=1        finobt=0 spinodes=0
data     =                       bsize=4096   blocks=916480, imaxpct=25
         =                       sunit=0      swidth=0 blks
naming   =version 2              bsize=4096   ascii-ci=0 ftype=1
log      =internal               bsize=4096   blocks=2560, version=2
         =                       sectsz=4096  sunit=1 blks, lazy-count=1
realtime =none                   extsz=4096   blocks=0, rtextents=0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# xfs_info /dev/mapper/centos-root | grep bsize
data     =                       bsize=4096   blocks=916480, imaxpct=25
naming   =version 2              bsize=4096   ascii-ci=0 ftype=1
log      =internal               bsize=4096   blocks=2560, version=2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# xfs_info /boot | grep bsize
data     =                       bsize=4096   blocks=262144, imaxpct=25
naming   =version 2              bsize=4096   ascii-ci=0 ftype=1
log      =internal               bsize=4096   blocks=2560, version=2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;running-commands-on-a-remote-machine-with-ssh1&quot;&gt;Running Commands on a Remote Machine with ssh(1)&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ssh user@example.org &quot;df -hT&quot;
user@example.org's password: 
Filesystem    Type    Size  Used Avail Use% Mounted on
/dev/sda1     ext3    263G   26G  224G  11% /
tmpfs        tmpfs    7.9G     0  7.9G   0% /dev/shm
mgmt:/home     nfs    5.0T  1.7T  3.3T  34% /home
mgmt:/global   nfs    3.9T  636G  3.3T  16% /global
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;delete-all-hidden-files-with-rm1&quot;&gt;Delete All Hidden Files with rm(1)&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -alh /mnt/customdvd/
total 8.0K
drwxr-xr-x  2 root root  40 Apr 23 15:54 .
drwxr-xr-x. 5 root root  50 Apr 22 16:17 ..
-rw-r--r--  1 root root  29 Oct 26  2020 .discinfo
-rw-r--r--  1 root root 354 Oct 26  2020 .treeinfo
 
$ ls -lh /mnt/customdvd/.[a-z0-9]*
-rw-r--r-- 1 root root  29 Oct 26  2020 /mnt/customdvd/.discinfo
-rw-r--r-- 1 root root 354 Oct 26  2020 /mnt/customdvd/.treeinfo

$ sudo rm -i /mnt/customdvd/.[a-z0-9]*
rm: remove regular file '/mnt/customdvd/.discinfo'? y
rm: remove regular file '/mnt/customdvd/.treeinfo'? y

$ ls -alh /mnt/customdvd/
total 0
drwxr-xr-x  2 root root  6 Apr 23 15:58 .
drwxr-xr-x. 5 root root 50 Apr 22 16:17 ..
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;jekyll-markdown-internal-links---aka-temporarily-disable-tag-processing&quot;&gt;Jekyll Markdown Internal Links - aka Temporarily Disable Tag Processing&lt;/h3&gt;

&lt;p&gt;How can you link to internal content in Jekyll? &lt;br /&gt;
A: You can post internal links by using the following:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[Some Link]{% post_url 2010-07-21-name-of-post %}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;em&gt;Other options:&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[Customize CentOS/RHEL DVD ISO for Installation in Text Mode via Serial Console and Test the Image with QEMU](http://localhost:4000/howto/virtualization/rs232serial/cli/terminal/shell/console/sysadmin/server/hardware/2022/03/12/centos-rhel-dvd-iso-customization-testing-with-qemu.html)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[Customize CentOS/RHEL DVD ISO for Installation in Text Mode via Serial Console and Test the Image with QEMU](/howto/virtualization/rs232serial/cli/terminal/shell/console/sysadmin/server/hardware/2022/03/12/centos-rhel-dvd-iso-customization-testing-with-qemu.html)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  How to actually display these code examples (with curly braces}? &lt;br /&gt;
A:  Use raw and endraw tags (see below).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://jekyllrb.com/docs/liquid/tags/&quot;&gt;Jekyll Docs - Tags Filters&lt;/a&gt;: &lt;br /&gt;
(Retrieved on Mar 13, 2022)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Jekyll processes all Liquid filters in code blocks&lt;/p&gt;

  &lt;p&gt;If you are using a language that contains curly braces, you will likely
need to place  {% raw %} 
and  {% endraw   %} 
tags around your code.&lt;/p&gt;

  &lt;p&gt;Since Jekyll 4.0, you can add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;render_with_liquid: false&lt;/code&gt; in your front 
matter to disable Liquid entirely for a particular document.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://shopify.github.io/liquid/tags/template/&quot;&gt;Liquid Documentation: Tags - Template&lt;/a&gt;: &lt;br /&gt;
(Retrieved on Mar 13, 2022)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;raw&lt;/p&gt;

  &lt;p&gt;Temporarily disables tag processing. This is useful for generating 
certain content that uses conflicting syntax, such as 
&lt;a href=&quot;https://mustache.github.io/&quot;&gt;Mustache&lt;/a&gt; or 
&lt;a href=&quot;https://handlebarsjs.com/&quot;&gt;Handlebars&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;– References:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://jekyllrb.com/docs/liquid/tags/#linking-to-posts&quot;&gt;Jekyll Documentation - Linking to posts&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 13, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/4629675/jekyll-markdown-internal-links&quot;&gt;jekyll markdown internal links&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Mar 13, 2022)&lt;/p&gt;

&lt;hr /&gt;
</description>
        <pubDate>Sun, 13 Mar 2022 10:12:32 -0700</pubDate>
        <link>http://localhost:4000/unix/shell/script/cli/terminal/perl/sysadmin/2022/03/13/occasionally-revisited-code-shell-script-snippets.html</link>
        <guid isPermaLink="true">http://localhost:4000/unix/shell/script/cli/terminal/perl/sysadmin/2022/03/13/occasionally-revisited-code-shell-script-snippets.html</guid>
        
        
        <category>unix</category>
        
        <category>shell</category>
        
        <category>script</category>
        
        <category>cli</category>
        
        <category>terminal</category>
        
        <category>perl</category>
        
        <category>sysadmin</category>
        
      </item>
    
      <item>
        <title>Customize CentOS/RHEL DVD ISO for Installation in Text Mode via Serial Console and Test the Image with QEMU</title>
        <description>&lt;p&gt;OSs: RHEL 7, CentOS 7  &lt;br /&gt;
Shells:  csh, bash&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Specifically:  Customize CentOS/RHEL DVD ISO Image for Installation in Text 
Mode via Serial Console &lt;strong&gt;on IBM BladeCenter HS21 Servers&lt;/strong&gt; and Test It with QEMU&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;em&gt;Task:&lt;/em&gt;    &lt;br /&gt;
Install CentOS Linux 7 in Text Mode on IBM BladeCenter HS21 blade servers 
(a.k.a blades) via serial console.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Motivation:&lt;/em&gt; &lt;br /&gt;
Could not use IBM MM (Management Module) web interface’s console 
for performing CentOS Linux installation because MM required a very old 
Java version, which proved complicated to setup.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;prepare-the-server-to-use-serial-console&quot;&gt;Prepare the Server to Use Serial Console&lt;/h3&gt;

&lt;p&gt;Server:  IBM BladeCenter HS21 (This blade is &lt;strong&gt;BIOS-based&lt;/strong&gt; and does &lt;strong&gt;not&lt;/strong&gt; 
support &lt;em&gt;EFI/UEFI&lt;/em&gt;)&lt;/p&gt;

&lt;p&gt;For SOL (Serial Over LAN) to work on this server, the following settings
of its BIOS need to be changed (the lines in bold had to be changed):&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Devices and I/O Ports:
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;Serial Port A:&lt;/strong&gt; Auto-configure&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Serial Port B:&lt;/strong&gt; Auto-configure&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Remote Console Redirection:
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;Remote Console Active:&lt;/strong&gt; Enabled&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Remote Console COM Port:&lt;/strong&gt; COM 2&lt;/li&gt;
      &lt;li&gt;Remote Console Baud Rate: 19200&lt;/li&gt;
      &lt;li&gt;Remote Console Data Bits: 8&lt;/li&gt;
      &lt;li&gt;Remote Console Parity: None&lt;/li&gt;
      &lt;li&gt;Remote Console Stop Bits: 1&lt;/li&gt;
      &lt;li&gt;Remote Console Text Emulation: ANSI&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Remote Console After Boot:&lt;/strong&gt; Enabled&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Remote Console Flow Control:&lt;/strong&gt; Hardware&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;em&gt;(Optional)&lt;/em&gt; &lt;br /&gt;
Before the upgrade, the OS on the blades was CentOS Linux 5.2. 
If you wanted to enable CentOS 5.2 for redirecting output to the second 
serial device ttyS1 (COM2), you would need to change the following 
configuration files on that OS:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;/etc/inittab&lt;/li&gt;
  &lt;li&gt;/etc/securetty&lt;/li&gt;
  &lt;li&gt;/boot/grub/grub.conf&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Add the following line to the end of the
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;# Run gettys in standard runlevels&lt;/code&gt; section of the &lt;strong&gt;/etc/inittab&lt;/strong&gt; file. 
This enables hardware flow control and enables users to log in through 
the SOL console.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;7:2345:respawn:/sbin/agetty -h ttyS1 19200 vt102
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Add the following line at the bottom of the &lt;strong&gt;/etc/securetty&lt;/strong&gt; file to 
enable a user to log in as the root user through the SOL console:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ttyS1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Complete the following steps to modify the &lt;strong&gt;/boot/grub/grub.conf&lt;/strong&gt; file:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Comment out the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;splashimage=...&lt;/code&gt; line by adding a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#&lt;/code&gt; at the 
beginning of this line.&lt;/li&gt;
  &lt;li&gt;Add the following line before the first &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;title=...&lt;/code&gt; line:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;# This will allow you to only Monitor the OS boot via SOL&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Append the following text to the first &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;title=...&lt;/code&gt; line:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SOL Monitor&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Append the following text to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kernel/...&lt;/code&gt; line of the 
first &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;title=...&lt;/code&gt; section:&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;console=ttyS1,19200 console=tty1&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Add the following lines between the two &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;title=...&lt;/code&gt; sections:&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# This will allow you to Interact with the OS boot via SOL 
title Red Hat Linux (2.4.9-e.12smp) SOL Interactive
    root (hd0,0)
    kernel /vmlinuz-2.4.9-e.12smp ro root=/dev/hda6 console=tty1 
console=ttyS1,19200
    initrd /initrd-2.4.9-e.12smp.img
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; The entry beginning with kernel &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/vmlinuz...&lt;/code&gt; is shown 
with a line break after &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;console=tty1&lt;/code&gt;. In your file, the entire 
entry must all be on one line.&lt;/p&gt;

&lt;p&gt;Details:
&lt;a href=&quot;https://bladecenter.lenovofiles.com/help/topic/com.lenovo.bladecenter.advmgtmod.doc/kp1bd_pdf.pdf&quot;&gt;IBM BladeCenter - Serial Over LAN (SOL) Setup Guide&lt;/a&gt;  &lt;br /&gt;
Chapter 3. Operating system configuration &amp;gt; Linux configuration &amp;gt; 
Red Hat Enterprise Linux ES 2.1 configuration (including GRUB configuration)  &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Steps:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Download and test ISO&lt;/li&gt;
  &lt;li&gt;Mount ISO and prep for edit&lt;/li&gt;
  &lt;li&gt;Edit isolinux.cfg&lt;/li&gt;
  &lt;li&gt;Create the new ISO&lt;/li&gt;
  &lt;li&gt;Create a test QEMU image with console redirection to serial device on COM2 (ttyS1)&lt;/li&gt;
  &lt;li&gt;Test the QEMU image&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  &lt;br /&gt;
You need to construct a command line for calling QEMU because the 
raw QEMU doesn’t have any VM management so your VM configuration is not
permanent. For the task explained on this page that’s nice since you’ll 
experiment with different VM configurations; for example, one serial 
device in the guest VM, two serial devices in the VM, no serial devices…&lt;/p&gt;

&lt;p&gt;While your VM configuration is not remembered, changes you 
make in the guest VM do get saved in the VM image. In other words, after
you boot the guest in an image, log into the OS installed on it, and 
make changes in the guest OS’ configuration files, they are saved. 
After restarting the guest on the same VM image, next time you log into 
the guest OS on it, your changes will be there.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;IBM BladeCenter HS21 does not support &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ipmitool&lt;/code&gt;. &lt;br /&gt;
&lt;strong&gt;[TODO]:&lt;/strong&gt;  Check to see if it’s possible to add IPMI support in/via BIOS.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  &lt;br /&gt;
When there are long lines in scripts, code and CLI output examples, 
they are folded and then indented to make sure they fit the page.
If there are exceptions, they are noted.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;optional-create-a-test-qemu-image-with-a-text-console-on-the-first-serial-device-ttys0-com1&quot;&gt;(Optional) Create a Test QEMU Image with a Text Console on the First Serial Device ttyS0 (COM1)&lt;/h3&gt;

&lt;p&gt;Note that this step is optional. It’s here to show the setup of packages 
needed on the host OS, the use of QEMU as a test tool for performing the 
required task, and to demonstrate how to create a test virtual machine 
that redirects text output to serial console device.&lt;/p&gt;

&lt;p&gt;The host server used as a jump box already had the following 
packages installed.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipxe-roms-qemu, libvirt-daemon-driver-qemu, qemu-guest-agent, qemu-img, 
qemu-kvm, qemu-kvm-block-curl, qemu-kvm-block-gluster, qemu-kvm-block-iscsi, 
qemu-kvm-block-rbd, qemu-kvm-block-ssh, qemu-kvm-common, qemu-kvm-core
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Install additional packages.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo dnf install libvirt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo dnf install virt-install virt-manager
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo dnf install libguestfs-tools libguestfs-gfs2 libguestfs-rescue \
 libguestfs-rsync libguestfs-xfs
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo dnf install virt-dib virt-v2v virt-p2v-maker virt-viewer virt-who \
 virt-top virtio-win
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo dnf install minicom 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo dnf install isomd5sum
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;CentOS Mirror (&lt;a href=&quot;http://mirror.centos.org/&quot;&gt;http://mirror.centos.org/&lt;/a&gt;)
contains a directory tree with current CentOS Linux and Stream releases 
(as of Mar 12, 2022: CentOS 7 and CentOS 8-stream).  The last CentOS 
release before switching to CentOS Stream was CentOS 7.9: 
&lt;a href=&quot;http://mirror.centos.org/centos-7/7.9.2009/&quot;&gt;http://mirror.centos.org/centos-7/7.9.2009/&lt;/a&gt;.  In order to conserve the limited bandwidth 
available, ISO images on CentOS.org are not downloadable from 
mirror.centos.org.  The following page lists mirrors in your region that 
have the ISO images available: &lt;a href=&quot;http://isoredirect.centos.org/centos/7.9.2009/isos/x86_64/&quot;&gt;http://isoredirect.centos.org/centos/7.9.2009/isos/x86_64/&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Download and verify the CentOS DVD ISO installation image. I decided to use minimal install, CentOS-7-x86_64-Minimal-2009.iso.  (Other options were: CentOS-7-x86_64-DVD-2009.iso, CentOS-7-x86_64-Everything-2009.iso, CentOS-7-x86_64-NetInstall-2009.iso.)  For my region, download location was on mirror.esecuredata.com.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ wget https://mirror.esecuredata.com/centos/7.9.2009/isos/x86_64/CentOS-7-x86_64-Minimal-2009.iso
$ wget https://mirror.esecuredata.com/centos/7.9.2009/isos/x86_64/sha256sum.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sha256sum CentOS-7-x86_64-Minimal-2009.iso
07b94e6b1a0b0260b94c83d6bb76b26bf7a310dc78d7a9c7432809fb9bc6194a  CentOS-7-x86_6
4-Minimal-2009.iso

$ grep 'CentOS-7-x86_64-Minimal-2009.iso' sha256sum.txt
07b94e6b1a0b0260b94c83d6bb76b26bf7a310dc78d7a9c7432809fb9bc6194a  CentOS-7-x86_6
4-Minimal-2009.iso
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo mkdir -p /mnt/{dvd,customdvd}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -lh /mnt/
total 0
drwxr-xr-x 2 root root 6 Apr 16 19:57 customdvd
drwxr-xr-x 2 root root 6 Apr 16 19:57 dvd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Mount the DVD ISO image.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo \
 mount \ 
 -t iso9660 \
 /home/dusko/CentOS-7-x86_64-Minimal-2009.iso \ 
 /mnt/dvd/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Copy the content of the DVD to a separate directory.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo rsync -a /mnt/dvd/ /mnt/customdvd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -alh /mnt/customdvd/
total 84K
drwxr-xr-x  8 root root  254 Nov  3  2020 .
drwxr-xr-x. 4 root root   34 Apr 17 18:39 ..
-rw-r--r--  1 root root   14 Oct 29  2020 CentOS_BuildTag
-rw-r--r--  1 root root   29 Oct 26  2020 .discinfo
drwxr-xr-x  3 root root   35 Oct 26  2020 EFI
-rw-rw-r--  1 root root  227 Aug 30  2017 EULA
-rw-rw-r--  1 root root  18K Dec  9  2015 GPL
drwxr-xr-x  3 root root   57 Oct 26  2020 images
drwxr-xr-x  2 root root  182 Apr 17 18:47 isolinux
drwxr-xr-x  2 root root   43 Oct 26  2020 LiveOS
drwxr-xr-x  2 root root  28K Nov  3  2020 Packages
drwxr-xr-x  2 root root 4.0K Nov  3  2020 repodata
-rw-rw-r--  1 root root 1.7K Dec  9  2015 RPM-GPG-KEY-CentOS-7
-rw-rw-r--  1 root root 1.7K Dec  9  2015 RPM-GPG-KEY-CentOS-Testing-7
-r--r--r--  1 root root 2.9K Nov  3  2020 TRANS.TBL
-rw-r--r--  1 root root  354 Oct 26  2020 .treeinfo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /mnt/customdvd/.discinfo 
1603728831.612616
7.9
x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /mnt/customdvd/.treeinfo 
[general]
name = CentOS-7
family = CentOS
timestamp = 1603729576.26
variant = 
version = 7
packagedir = 
arch = x86_64

[stage2]
mainimage = LiveOS/squashfs.img

[images-x86_64]
kernel = images/pxeboot/vmlinuz
initrd = images/pxeboot/initrd.img
boot.iso = images/boot.iso

[images-xen]
kernel = images/pxeboot/vmlinuz
initrd = images/pxeboot/initrd.img
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -lh /mnt/customdvd/isolinux/
total 60M
-r--r--r-- 1 root root 2.0K Nov  3  2020 boot.cat
-rw-r--r-- 2 root root   84 Oct 26  2020 boot.msg
-rw-r--r-- 2 root root  281 Oct 26  2020 grub.conf
-rw-r--r-- 4 root root  53M Oct 26  2020 initrd.img
-rw-r--r-- 2 root root  24K Nov  3  2020 isolinux.bin
-rw-r--r-- 2 root root 3.0K Oct 26  2020 isolinux.cfg
-rw-r--r-- 3 root root 187K Nov  5  2016 memtest
-rw-r--r-- 5 root root  186 Sep 30  2015 splash.png
-r--r--r-- 1 root root 2.2K Nov  3  2020 TRANS.TBL
-rw-r--r-- 3 root root 150K Oct 30  2018 vesamenu.c32
-rwxr-xr-x 4 root root 6.5M Oct 19  2020 vmlinuz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Customize the DVD ISO so that the installer redirects its text 
output to the serial console.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cd /mnt/customdvd/isolinux/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Remove ‘boot.cat’. It will be regenerated in a later step.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo rm -i boot.cat
rm: remove regular file 'boot.cat'? y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ wc -l boot.msg
5 boot.msg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Delete the line with ‘splash.lss’ from the ‘boot.msg’.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat boot.msg

 
splash.lss

 -  Press the 01&amp;lt;ENTER&amp;gt;07 key to begin the installation process.

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ grep -n 'splash\.lss' boot.msg
2:splash.lss
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo sed -i.bkp '/splash\.lss/d' boot.msg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ diff boot.msg.bkp boot.msg
2d1
&amp;lt; splash.lss
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ diff \
 --unified=0 \
 /mnt/dvd/isolinux/boot.msg \
 /mnt/customdvd/isolinux/boot.msg
--- /mnt/dvd/isolinux/boot.msg  2020-10-26 09:25:28.000000000 -0700
+++ /mnt/customdvd/isolinux/boot.msg    2022-03-12 21:11:33.140839189 -0700
@@ -2 +1,0 @@
-splash.lss
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo rm -i boot.msg.bkp
rm: remove regular file 'boot.msg.bkp'? y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo vi isolinux.cfg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Tell ISOLINUX to use a serial port as the console. 
“port” is a number (0 = /dev/ttyS0 = COM1, etc.) or an I/O port address (e.g. 0x3F8) (&lt;a href=&quot;https://www.syslinux.org/old/faq.php&quot;&gt;https://www.syslinux.org/old/faq.php&lt;/a&gt;, &lt;a href=&quot;https://wiki.syslinux.org/wiki/index.php?title=SYSLINUX&quot;&gt;https://wiki.syslinux.org/wiki/index.php?title=SYSLINUX&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Here I want to use the port 0 so the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;console&lt;/code&gt; statement uses 
tty0 and ttyS0.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ diff \
 --unified=0 \
 /mnt/dvd/isolinux/isolinux.cfg \
 /mnt/customdvd/isolinux/isolinux.cfg
--- /mnt/dvd/isolinux/isolinux.cfg      2020-10-26 09:25:28.000000000 -0700
+++ /mnt/customdvd/isolinux/isolinux.cfg        2022-03-12 22:39:15.690733667 -0700
@@ -64 +64 @@
-  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 quiet
+  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 quiet console=tty0 console=ttyS0
@@ -70 +70 @@
-  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rd.live.check quiet
+  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rd.live.check quiet console=tty0 console=ttyS0
@@ -86 +86 @@
-  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 xdriver=vesa nomodeset quiet
+  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 xdriver=vesa nomodeset quiet console=tty0 console=ttyS0
@@ -96 +96 @@
-  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rescue quiet
+  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rescue quiet console=tty0 console=ttyS0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;No need to make EFI changes because in this case the guest system you are 
planning to simulate is is BIOS-based, not EFI/UEFI.&lt;/p&gt;

&lt;p&gt;Just as a reference, here’s the content of the EFI directory:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -lh /mnt/customdvd/EFI/BOOT/
total 6.0M
-rwxr--r-- 1 root root 978K Jul 31  2020 BOOTIA32.EFI
-rwxr--r-- 1 root root 1.2M Jul 31  2020 BOOTX64.EFI
drwxr-xr-x 2 root root   42 Oct 26  2020 fonts
-rw-r--r-- 1 root root 1.3K Oct 26  2020 grub.cfg
-rwxr--r-- 1 root root 745K Jul 28  2020 grubia32.efi
-rwxr--r-- 1 root root 1.1M Jul 28  2020 grubx64.efi
-rwxr--r-- 1 root root 898K Jul 31  2020 mmia32.efi
-rwxr--r-- 1 root root 1.2M Jul 31  2020 mmx64.efi
-r--r--r-- 1 root root 1.8K Nov  3  2020 TRANS.TBL
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;create-a-new-bootable-installation-dvd-iso-image&quot;&gt;Create a New Bootable Installation DVD ISO Image&lt;/h4&gt;

&lt;p&gt;For the CentOS 7 Installation DVD, the label must stay the same.&lt;/p&gt;

&lt;p&gt;Use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;isoinfo&lt;/code&gt; command to find out the label of the CentOS DVD 
(an extension named “Volume id”). You can use the same command to find 
out other extensions too; for example, information about Rock Ridge, 
Joliet extensions and Eltorito boot information if present.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ isoinfo -d -i \
 ~/CentOS-7-x86_64-Minimal-2009.iso | wc -l
29
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ isoinfo -d -i \
 ~/CentOS-7-x86_64-Minimal-2009.iso | grep &quot;Volume id&quot; 
Volume id: CentOS 7 x86_64

$ isoinfo -d -i \
 ~/CentOS-7-x86_64-Minimal-2009.iso | grep Joliet
Joliet with UCS level 3 found

$ isoinfo -d -i \
 ~/CentOS-7-x86_64-Minimal-2009.iso | grep prepare
Data preparer id:

$ isoinfo -d -i \
~/CentOS-7-x86_64-Minimal-2009.iso | grep Torito
El Torito VD version 1 found, boot catalog is in sector 606
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Alternatively, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;blkid(8)&lt;/code&gt; also shows the label:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ blkid ~/CentOS-7-x86_64-Minimal-2009.iso
/home/dusko/CentOS-7-x86_64-Minimal-2009.iso: BLOCK_SIZE=&quot;2048&quot; 
  UUID=&quot;2020-11-03-14-55-29-00&quot; LABEL=&quot;CentOS 7 x86_64&quot; TYPE=&quot;iso9660&quot; 
  PTUUID=&quot;6acc9bba&quot; PTTYPE=&quot;dos&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Recreate the DVD ISO image with the customized settings.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo \
 mkisofs \
 -o /tmp/CentOS-7-x86_64-Minimal-2009-CUSTOM.iso \
 -b isolinux/isolinux.bin \
 -J \
 -R \
 -l \
 -c isolinux/boot.cat \
 -no-emul-boot \
 -boot-load-size 4 \
 -boot-info-table \
 -eltorito-alt-boot \
 -e images/efiboot.img \
 -no-emul-boot \
 -graft-points \
 -input-charset utf-8 \
 -output-charset utf-8 \
 -V &quot;CentOS 7 x86_64&quot; \
 /mnt/customdvd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo chown dusko:dusko /tmp/CentOS-7-x86_64-Minimal-2009-CUSTOM.iso
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Implant an MD5 checksum in the ISO image.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ implantisomd5 /tmp/CentOS-7-x86_64-Minimal-2009-CUSTOM.iso
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For systems that suport EFI/UEFI, the next step would be to run 
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;isohybrid&lt;/code&gt; command to make the installation ISO image 
EFI/UEFI-bootable. (In this case, do &lt;strong&gt;not&lt;/strong&gt; run the isohybrid command 
below because this server supports only BIOS.)&lt;/p&gt;

&lt;p&gt;Similarly, if you wanted to create a bootable USB drive (USB flash drive), 
you would also need to run the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;isohybrid&lt;/code&gt; command.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ isohybrid --uefi \
 /tmp/CentOS-7-x86_64-Minimal-2009-CUSTOM.iso
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Check an MD5 checksum implanted by &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;implantisomd5&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ checkisomd5 \
 --verbose \
 /tmp/CentOS-7-x86_64-Minimal-2009-CUSTOM.iso
---- snip ----
Checking: 100.0%

The media check is complete, the result is: PASS.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cd

$ pwd
/home/dusko
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Create an image file for the guest virtual machine.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ truncate --size=291999055872 abnodevm.img
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The created image’s format is raw.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ qemu-img info abnodevm.img
image: abnodevm.img
file format: raw
virtual size: 272 GiB (291999055872 bytes)
disk size: 512 B
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Optionally, you can convert the raw image to qcow2 format. 
(Shown here as a reference. &lt;strong&gt;Don’t&lt;/strong&gt; do it now.)&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ qemu-img \ 
 convert \ 
 -f raw \
 -O qcow2 \
 abnodevm.img \
 abnodevm.qcow2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ qemu-img info abnodevm.qcow2
image: abnodevm.qcow2
file format: qcow2
virtual size: 272 GiB (291999055872 bytes)
disk size: 16.5 KiB
cluster_size: 65536
Format specific information:
    compat: 1.1
    lazy refcounts: false
    refcount bits: 16
    corrupt: false
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Some useful options for QEMU’s virtual console:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm -h

---- snip ----

During emulation, the following keys are useful:
ctrl-alt-f      toggle full screen
ctrl-alt-n      switch to virtual console 'n'
ctrl-alt        toggle mouse and keyboard grab

When using -nographic, press 'ctrl-a h' to get some help.

See &amp;lt;https://qemu.org/contribute/report-a-bug&amp;gt; for how to report bugs.
More information on the QEMU project at &amp;lt;https://qemu.org&amp;gt;.

WARNING: 
Direct use of qemu-kvm from the command line is not supported by Red Hat.

WARNING: Use libvirt as the stable management interface.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Install CentOS 7.9 on the virtual machine image by using the customized 
CentOS installation DVD image (in text mode, with output via serial 
console - in this example it’s the first serial device, ttyS0).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
 -cdrom /tmp/CentOS-7-x86_64-Minimal-2009-CUSTOM.iso \
 -hda abnodevm.qcow2 \
 -m 2G \
 -boot d \
 -enable-kvm \
 -nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Start the OS install and finish installing CentOS Linux 7.9.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;After installation:&lt;/p&gt;

&lt;p&gt;When you want to just boot from the image file without the installation 
ISO file (after you have finished installing and now you always want to 
boot the installed system), you can just remove the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-cdrom&lt;/code&gt; option:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
 -hda abnodevm.qcow2 \
 -m 2G \
 -enable-kvm \
 -nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Alternatively, you can enable ssh port forwarding (with ‘-net user’, 
‘-net nic’) when starting the guest VM so this works too:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
 -cdrom /tmp/CentOS-7-x86_64-Minimal-2009-CUSTOM.iso \
 -hda abnodevm.qcow2 \
 -m 2G \
 -boot d \
 -enable-kvm \
 -net user,hostfwd=tcp::10022-:22 \
 -net nic \
 -nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;create-a-qemu-image-with-serial-text-console-on-ttys1-com2&quot;&gt;Create a QEMU Image with Serial Text Console on ttyS1 (COM2)&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Why redirection to ttyS1 (COM2)?:&lt;/strong&gt;  The serial console on 
&lt;strong&gt;COM2&lt;/strong&gt; (&lt;strong&gt;ttyS1&lt;/strong&gt; in Unix) is required by IBM &lt;strong&gt;MM&lt;/strong&gt; (Management Module) 
&lt;strong&gt;CLI&lt;/strong&gt; on IBM BladeCenter HS21 Blade Servers.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Details:&lt;/em&gt;  &lt;br /&gt;
Out-of-band (OOB) management interface (1) (2) on IBM BladeCenter server 
architecture is called &lt;strong&gt;MM&lt;/strong&gt; (Management Module). 
On this particular generation of BladeCenter servers, in order 
for the MM to be able to support SOL (Serial Over LAN) you have to 
redirect the serial console to &lt;strong&gt;COM2&lt;/strong&gt; (&lt;strong&gt;ttyS1&lt;/strong&gt; in Unix).&lt;/p&gt;

&lt;p&gt;(1): Sometimes called lights-out management (LOM). &lt;br /&gt;
(2): IBM MM (Management Module) interacts with a hardware module 
(a remote management card) often called BMC (Baseboard Management 
Controller) installed inside the IBM BladeCenter server chassis
(that houses multiple blades). The BMC is configured with the 
network interface controller (NIC) to use the Remote Management 
Control Protocol (RMCP), a.k.a. IPMI (Intelligent Platform Management 
Interface).&lt;/p&gt;

&lt;p&gt;Download the CentOS 7 DVD ISO image.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ wget https://mirror.esecuredata.com/centos/7.9.2009/isos/x86_64/CentOS-7-x86_64-DVD-2009.iso
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ file CentOS-7-x86_64-DVD-2009.iso
CentOS-7-x86_64-DVD-2009.iso: ISO 9660 CD-ROM filesystem data 
  (DOS/MBR boot sector) 'CentOS 7 x86_64' (bootable)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ wget https://mirror.esecuredata.com/centos/7.9.2009/isos/x86_64/sha256sum.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Usually I fold and then indent long lines when showing them in scripts, 
code and CLI outputs.  In this case (for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sha256sum --check&lt;/code&gt;), 
I’m making an exception.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ wc -l sha256sum.txt
4 sha256sum.txt

$ grep 'CentOS-7-x86_64-DVD-2009.iso' sha256sum.txt
e33d7b1ea7a9e2f38c8f693215dd85254c3a4fe446f93f563279715b68d07987  CentOS-7-x86_64-DVD-2009.iso

$ grep 'CentOS-7-x86_64-DVD-2009.iso' sha256sum.txt &amp;gt; /tmp/sha256sum.txt

$ mv /tmp/sha256sum.txt ~/sha256sum.txt

$ cat sha256sum.txt
e33d7b1ea7a9e2f38c8f693215dd85254c3a4fe446f93f563279715b68d07987  CentOS-7-x86_64-DVD-2009.iso

$ sha256sum --check sha256sum.txt
CentOS-7-x86_64-DVD-2009.iso: OK
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo mkdir -p /mnt/{dvd,customdvd}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo \
 mount \
 -t iso9660 \
 ~/CentOS-7-x86_64-DVD-2009.iso \
 /mnt/dvd/
mount: /mnt/dvd: WARNING: device write-protected, mounted read-only.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo rsync -a /mnt/dvd/ /mnt/customdvd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ du -chs /mnt/dvd/ /mnt/customdvd/
4.5G    /mnt/dvd/
4.5G    /mnt/customdvd
8.9G    total
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -alh /mnt/customdvd/isolinux/
total 60M
drwxr-xr-x 2 root root  198 Nov  2  2020 .
drwxr-xr-x 8 root root  254 Nov  3  2020 ..
-r--r--r-- 1 root root 2.0K Nov  3  2020 boot.cat
-rw-r--r-- 1 root root   84 Oct 26  2020 boot.msg
-rw-r--r-- 1 root root  281 Oct 26  2020 grub.conf
-rw-r--r-- 1 root root  53M Oct 26  2020 initrd.img
-rw-r--r-- 1 root root  24K Nov  3  2020 isolinux.bin
-rw-r--r-- 1 root root 3.0K Oct 26  2020 isolinux.cfg
-rw-r--r-- 1 root root 187K Nov  5  2016 memtest
-rw-r--r-- 1 root root  186 Sep 30  2015 splash.png
-r--r--r-- 1 root root 2.2K Nov  3  2020 TRANS.TBL
-rw-r--r-- 1 root root 150K Oct 30  2018 vesamenu.c32
-rwxr-xr-x 1 root root 6.5M Oct 19  2020 vmlinuz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Delete the line with ‘splash.lss’ from the ‘boot.msg’.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ wc -l /mnt/customdvd/isolinux/boot.msg 
5 /mnt/customdvd/isolinux/boot.msg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /mnt/customdvd/isolinux/boot.msg

 
splash.lss

 -  Press the 01&amp;lt;ENTER&amp;gt;07 key to begin the installation process.

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo sed -i.bkp '/splash.lss/d' /mnt/customdvd/isolinux/boot.msg 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ diff \
 --unified=0 \
 /mnt/dvd/isolinux/boot.msg \
 /mnt/customdvd/isolinux/boot.msg
--- /mnt/dvd/isolinux/boot.msg  2020-10-26 09:25:28.000000000 -0700
+++ /mnt/customdvd/isolinux/boot.msg    2022-03-12 22:45:03.473419287 -0700
@@ -2 +1,0 @@
-splash.lss
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ wc -l /mnt/customdvd/isolinux/boot.msg
4 /mnt/customdvd/isolinux/boot.msg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cat /mnt/customdvd/isolinux/boot.msg

 

 -  Press the 01&amp;lt;ENTER&amp;gt;07 key to begin the installation process.

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo rm -i /mnt/customdvd/isolinux/boot.msg.bkp
rm: remove regular file '/mnt/customdvd/isolinux/boot.msg.bkp'? y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Remove &lt;em&gt;boot.cat&lt;/em&gt;. You’ll regenerate it in later steps.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo rm -i /mnt/customdvd/isolinux/boot.cat
rm: remove regular file '/mnt/customdvd/isolinux/boot.cat'? y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo vi /mnt/customdvd/isolinux/isolinux.cfg 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Usually I fold and then indent long lines when showing them in scripts, 
code and CLI outputs. In this case, I’m making an exception.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ diff \
 --unified=0 \
 /mnt/dvd/isolinux/isolinux.cfg \
 /mnt/customdvd/isolinux/isolinux.cfg
--- /mnt/dvd/isolinux/isolinux.cfg      2020-10-26 09:25:28.000000000 -0700
+++ /mnt/customdvd/isolinux/isolinux.cfg     2022-03-12 22:46:18.607074016 -0700
@@ -64 +64 @@
-  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 quiet
+  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 quiet console=tty1 console=ttyS1,19200
@@ -70 +70 @@
-  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rd.live.check quiet
+  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rd.live.check quiet console=tty1 console=ttyS1,19200
@@ -86 +86 @@
-  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 xdriver=vesa nomodeset quiet
+  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 xdriver=vesa nomodeset quiet console=tty1 console=ttyS1,19200
@@ -96 +96 @@
-  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rescue quiet
+  append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 rescue quiet console=tty1 console=ttyS1,19200
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As noted in the &lt;a href=&quot;#create-a-new-bootable-installation-dvd-iso-image&quot;&gt;previous step&lt;/a&gt;, for the CentOS 7 Installation DVD the label must stay the same.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ isoinfo -d -i ~/CentOS-7-x86_64-DVD-2009.iso | wc -l
29

$ isoinfo -d -i ~/CentOS-7-x86_64-DVD-2009.iso | grep &quot;Volume id&quot;
Volume id: CentOS 7 x86_64

$ isoinfo -d -i ~/CentOS-7-x86_64-DVD-2009.iso | grep Joliet
Joliet with UCS level 3 found

$ isoinfo -d -i ~/CentOS-7-x86_64-DVD-2009.iso | grep Rock
Rock Ridge signatures version 1 found

$ isoinfo -d -i ~/CentOS-7-x86_64-DVD-2009.iso | grep preparer
Data preparer id:

$ isoinfo -d -i ~/CentOS-7-x86_64-DVD-2009.iso | grep Torito
El Torito VD version 1 found, boot catalog is in sector 606
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Alternatively, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;blkid(8)&lt;/code&gt; also shows the label:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ blkid ~/CentOS-7-x86_64-DVD-2009.iso
/home/dusko/CentOS-7-x86_64-DVD-2009.iso: BLOCK_SIZE=&quot;2048&quot; 
  UUID=&quot;2020-11-04-11-36-43-00&quot; LABEL=&quot;CentOS 7 x86_64&quot; TYPE=&quot;iso9660&quot; 
  PTUUID=&quot;6b8b4567&quot; PTTYPE=&quot;dos&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Generate an ISO image of the customized DVD.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo \
 mkisofs \
 -o /tmp/CentOS-7-x86_64-DVD-2009-CUSTOM.iso \
 -b isolinux/isolinux.bin \
 -J \
 -R \
 -l \
 -c isolinux/boot.cat \
 -no-emul-boot \
 -boot-load-size 4 \
 -boot-info-table \
 -eltorito-alt-boot \
 -e images/efiboot.img \
 -no-emul-boot \
 -graft-points \
 -input-charset utf-8 \
 -output-charset utf-8 \
 -V &quot;CentOS 7 x86_64&quot; \
 /mnt/customdvd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo chown dusko:dusko /tmp/CentOS-7-x86_64-DVD-2009-CUSTOM.iso
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ implantisomd5 /tmp/CentOS-7-x86_64-DVD-2009-CUSTOM.iso
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ checkisomd5 --verbose /tmp/CentOS-7-x86_64-DVD-2009-CUSTOM.iso
---- snip ----
The media check is complete, the result is: PASS.
It is OK to use this media.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Create a raw image of 20 GB in size. Using &lt;strong&gt;seek&lt;/strong&gt; option creates 
a sparse file, which saves space.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ dd if=/dev/null of=ttyS1disk4k.img bs=1M seek=20480
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls -lh ttyS1disk4k.img
-rw-rw-r-- 1 dusko dusko 20G Mar 12 22:47 ttyS1disk4k.img
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The image doesn’t have a filesystem yet:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ blkid ttyS1disk4k.img
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;NOTE  &lt;br /&gt;
For serial on QEMU:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;You should use pseudo-terminals (-serial pty) instead of connecting to 
“real” char-devices (-chardev tty,…).&lt;/p&gt;

  &lt;p&gt;qemu displays the pty /dev/pts/xx which it actually uses.  You can now 
use this pty as a normal serial port from your host.&lt;/p&gt;

  &lt;p&gt;You can repeat this option to get more ptys connected to /dev/ttyS[0-*] 
on the guest (if you use ‘-serial stdio’, it is /dev/ttyS0 on the guest, 
the first pty is then /dev/ttyS1). &amp;lt;— Using ‘-serial stdio’ and then
another ‘-serial pty’ did &lt;strong&gt;not&lt;/strong&gt; work in my tests. 
When I used &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-serial stdio -serial pty&lt;/code&gt;, 
qemu complained with this error:&lt;/p&gt;

  &lt;p&gt;qemu-kvm: -serial stdio: cannot use stdio by multiple character devices&lt;br /&gt;
qemu-kvm: -serial stdio: could not connect serial device to character 
                         backend ‘stdio’&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Reference: &lt;br /&gt;
&lt;a href=&quot;https://alpha.frasesdemoda.com/categories-topics-unix.stackexchange.com/questions/78511/ttyo-ports-do-not-have-the-good-port-address-on-qemu-1-4-0-running-image-for-bea&quot;&gt;ttyO ports do not have the good port address on QEMU 1.4.0 running image for beagleboard-xm&lt;/a&gt;     &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;Next step:  install the OS.&lt;/p&gt;

&lt;p&gt;Explanation for options in the next command:&lt;/p&gt;

&lt;p&gt;The ‘-drive format=raw,file=&amp;lt;image_filename&amp;gt;’ is for a raw image.&lt;br /&gt;
(With -hda &amp;lt;image_filename&amp;gt;, qemu reports the warning below.)&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Image format was not specified for ‘image_filename’ and probing
guessed raw.  Automatically detecting the format is dangerous for
raw images, write operations on block 0 will be restricted.
Specify the ‘raw’ format explicitly to remove the restrictions.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The ‘-global ide-hd.physical_block_size=4096’ is to set disk 
block size to 4K, which is the block size on compute nodes (on the 
machine for which you are preparing and doing this test).&lt;/p&gt;

&lt;p&gt;Specifying the ‘-serial pty ‘option &lt;strong&gt;twice&lt;/strong&gt; is needed because the 
first one is for ttyS0 (COM1) and the second one is for ttyS1 (COM2). 
Similar to the block size, the second serial device (ttyS1) is required 
by the server for which this test is performed.&lt;/p&gt;

&lt;p&gt;From the man page for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qemu-kvm&lt;/code&gt;:&lt;/p&gt;
&lt;blockquote&gt;

  &lt;p&gt;-nographic &lt;br /&gt;
Normally, if QEMU is compiled with graphical window support, it
displays output such as guest graphics, guest console, and the
QEMU monitor in a window. With this option, you can totally
disable graphical output so that QEMU is a simple command line
application. The emulated serial port is redirected on the console
and muxed with the monitor (unless redirected elsewhere
explicitly). Therefore, you can still use QEMU to debug a Linux
kernel with a serial console.&lt;/p&gt;

  &lt;p&gt;Use C-a h for help on switching between the console and monitor.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;‘-cdrom’: Use file as CD-ROM image. &lt;br /&gt;
‘-m 2G’:  Set guest startup RAM size to 2 gigabytes.&lt;br /&gt;
‘-b d’:   Boot from CD-ROM.&lt;/p&gt;

&lt;p&gt;Note that default block size that the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mkfs.xfs&lt;/code&gt; uses is 4096 bytes (4k).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[TODO]&lt;/strong&gt; &lt;br /&gt;
Would there be any (major) differences if instead of leaving it to the OS 
installer to create it, you created the filesystem first, with, 
for example: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mkfs.xfs /&amp;lt;image_name/&amp;gt;&lt;/code&gt;, in this case:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mkfs.xfs ttyS1disk4k.img&lt;/code&gt;?&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
 -cdrom /tmp/CentOS-7-x86_64-DVD-2009-CUSTOM.iso \ 
 -drive format=raw,file=ttyS1disk4k.img \
 -global ide-hd.physical_block_size=4096 \
 -m 2G \
 -boot d \
 -enable-kvm \ 
 -serial pty \
 -serial pty \
 -nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QEMU 4.2.0 monitor - type 'help' for more information
(qemu) char device redirected to /dev/pts/2 (label serial0)
char device redirected to /dev/pts/3 (label serial1)

(qemu)  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From the QEMU Monitor’s output above, note where qemu
redirected two char devices. In this case:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/pts/2&lt;/code&gt; and  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/pts/3&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;NOTE: &lt;br /&gt;
To get help in the QEMU prompt (QEMU monitor), press  Ctrl-a h:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C-a h    print this help
C-a x    exit emulator
C-a s    save disk data back to file (if -snapshot)
C-a t    toggle console timestamps
C-a b    send break (magic sysrq)
C-a c    switch between console and monitor
C-a C-a  sends C-a
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Open two new shell instances, and start minicom in both of them.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Why two shell and minicom instances?&lt;/strong&gt; &lt;br /&gt;
A:  To be sure you will not miss them:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Virtual Terminal (VT) login prompts, i.e. those on your VGA screen 
as exposed in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/tty1&lt;/code&gt; (and similar devices).&lt;/li&gt;
  &lt;li&gt;Serial port terminal (including &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/ttyS0&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/ttyS1&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;tty1&lt;/strong&gt; gets special treatment: if you boot into graphical mode, the 
display manager takes possession of this VT.  If you boot into multi-user 
(text) mode, a getty is started on it.&lt;/p&gt;

  &lt;p&gt;By default systemd will instantiate one serial-getty@.service on the 
main kernel console, if it is not a virtual terminal.  The kernel console 
is where the kernel outputs its own log messages and is usually configured 
on the kernel command line in the boot loader via an argument such as
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;console=ttyS0&lt;/code&gt;.  This logic ensures that when the user asks the kernel 
to redirect its output onto a certain serial terminal, he will automatically 
also get a login prompt on it as the boot completes.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Reference: &lt;br /&gt;
&lt;a href=&quot;http://0pointer.de/blog/projects/serial-console.html&quot;&gt;systemd for Administrators, Part XVI&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;In the first new shell, start the first minicom.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ minicom --baudrate=19200 --ptty=/dev/pts/2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The first serial connection (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/pts/2&lt;/code&gt;) is the kernel console.
As per quote above:&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;By default systemd will instantiate one serial-getty@.service on the 
main kernel console, if it is not a virtual terminal.  The kernel console 
is where the kernel outputs its own log messages and is usually configured 
on the kernel command line in the boot loader via an argument such as
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;console=ttyS0&lt;/code&gt;.  This logic ensures that when the user asks the kernel 
to redirect its output onto a certain serial terminal, he will automatically 
also get a login prompt on it as the boot completes.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;For now (before making changes in the grub configuration), if you are
fast enough, you might briefly see CentOS Installer boot menu in the first 
serial console (/dev/pts/2):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;   CentOS Linux (3.10.0-1160.el7.x86_64) 7 (Core)
   CentOS Linux (0-rescue-5003bb903e814f84ad84b479956f01d0) 7 (Core)




   Use the ^ and v keys to change the selection.
Press 'e' to edit the selected item, or 'c' for a command prompt.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, in this example you are more interested in the second serial 
console connections (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/pts/3&lt;/code&gt;) because the CentOS 7 Linux 
Installer output will be displayed in there – In the second new shell, 
start the second minicom.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ minicom --baudrate=19200 --ptty=/dev/pts/3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Welcome to minicom 2.7.1

OPTIONS: I18n
Compiled on Aug 13 2018, 16:41:28.
Port /dev/ttyS1

Press CTRL-A Z for help on special keys
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;At the bottom of minicom’s screen:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;CTRL-A Z for help | 19200 8N1 | NOR | Minicom 2.7.1 | VT102 | Offline | ttyS1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; &lt;br /&gt;
You might need to press  Enter  to  refresh the screen in minicom.&lt;/p&gt;

&lt;p&gt;Start the OS install and finish installing CentOS.&lt;/p&gt;

&lt;p&gt;At the end of installation, the CentOS installer, Anaconda, 
displays the following:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[...]
      Installation complete.  Press return to quit

[anaconda] 1:main* 2:shell  3:log  4:storage-lo&amp;gt; Switch tab: Alt+Tab | Help: F1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Anaconda uses the &lt;strong&gt;tmux&lt;/strong&gt; terminal multiplexer to display and control 
several windows you can use in addition to the main interface.&lt;/p&gt;

&lt;p&gt;When you choose text mode installation, you start in virtual console 1 (tmux). 
The console running tmux has 5 available windows.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; The keyboard shortcuts are two-part: first press Ctrl+b, then 
release both keys, and press the number key for the window you want to use.&lt;/p&gt;

&lt;p&gt;Press Ctrl+b 2 to switch to interactive shell prompt with root 
privileges:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[anaconda root@localhost ~]# 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Power off the system.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[anaconda root@localhost ~]# poweroff
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Start the virtual machine.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
 -drive format=raw,file=ttyS1disk4k.img \
 -global ide-hd.physical_block_size=4096 \
 -m 2G \
 -enable-kvm \
 -serial pty \
 -serial pty \
 -nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Log in to the guest virtual machine.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;CentOS Linux 7 (Core)
Kernel 3.10.0-1160.el7.x86_64 on an x86_64

guestvm login: root
Password:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You now have the anaconda kickstart configuration file, which you can use 
as a sample or a reference.&lt;/p&gt;

&lt;p&gt;Usually I fold and then indent long lines when showing them in scripts, 
code and CLI outputs. In this case, I’m making an exception (for lines 
starting with ‘network  –bootproto’ and with ‘user –groups=wheel’).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cat /root/anaconda-ks.cfg                                   
#version=DEVEL
# System authorization information
auth --enableshadow --passalgo=sha512
# Use CDROM installation media
cdrom
# Use text mode install
text
# Run the Setup Agent on first boot
firstboot --enable
ignoredisk --only-use=sda
# Keyboard layouts
keyboard --vckeymap=us --xlayouts=''
# System language
lang en_US.UTF-8

# Network information
network  --bootproto=static --device=ens3 --gateway=192.168.80.56 --ip=192.168.80.3 --nameserver=192.168.80.200,192.168.80.210 --netmask=255.255.255.0 --noipv6 --activate
network  --hostname=guestvm

# Root password
rootpw --iscrypted $6$SYPpA&amp;lt;string_of_random_characters&amp;gt;
# System services
services --enabled=&quot;chronyd&quot;
# Do not configure the X Window System
skipx
# System timezone
timezone America/Vancouver --isUtc
user --groups=wheel --name=dusko --password=$6$FgrE&amp;lt;string_of_random_characters&amp;gt; --iscrypted --gecos=&quot;dusko&quot;
# System bootloader configuration
bootloader --append=&quot; crashkernel=auto&quot; --location=mbr --boot-drive=sda
autopart --type=lvm
# Partition clearing information
clearpart --all --initlabel --drives=sda

%packages
@base
@core
@scientific
chrony
kexec-tools

%end

%addon com_redhat_kdump --enable --reserve-mb='auto'

%end

%anaconda
pwpolicy root --minlen=6 --minquality=1 --notstrict --nochanges --notempty
pwpolicy user --minlen=6 --minquality=1 --notstrict --nochanges --emptyok
pwpolicy luks --minlen=6 --minquality=1 --notstrict --nochanges --notempty
%end
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Some other configurations in the guest virtual machine:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cat /etc/fstab 

#
# /etc/fstab
# Created by anaconda on Sun Mar 12 05:48:28 2022
#
# Accessible filesystems, by reference, are maintained under '/dev/disk'
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info
#
/dev/mapper/centos-root /                       xfs   defaults    0 0
UUID=d6acae6c-9e23-4721-9180-722091f019d7 /boot xfs   defaults    0 0
/dev/mapper/centos-swap swap                    swap  defaults    0 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# df -hT
Filesystem              Type      Size  Used Avail Use% Mounted on
devtmpfs                devtmpfs  908M     0  908M   0% /dev
tmpfs                   tmpfs     919M     0  919M   0% /dev/shm
tmpfs                   tmpfs     919M  8.5M  911M   1% /run
tmpfs                   tmpfs     919M     0  919M   0% /sys/fs/cgroup
/dev/mapper/centos-root xfs        17G  1.5G   16G   9% /
/dev/sda1               xfs      1014M  153M  862M  16% /boot
tmpfs                   tmpfs     184M     0  184M   0% /run/user/0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Confirm that both serial devices, COM1 (in *nix: ttyS0) 
and COM2 (in *nix: ttyS1), are created in the guest VM:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# dmesg | grep tty 
[  0.000000] Command line: BOOT_IMAGE=/vmlinuz-3.10.0-1160.el7.x86_64 root=/d8
[  0.000000] Kernel command line: BOOT_IMAGE=/vmlinuz-3.10.0-1160.el7.x86_64 8
[  0.000000] console [ttyS1] enabled
[  0.808863] 00:04: ttyS0 at I/O 0x3f8 (irq = 4) is a 16550A
[  0.832473] 00:05: ttyS1 at I/O 0x2f8 (irq = 3) is a 16550A
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Next step is to set up serial terminal in the guest OS.&lt;/p&gt;

&lt;h4 id=&quot;set-up-a-serial-terminal-and-console-in-centos-7rhel-7&quot;&gt;Set Up a Serial Terminal and Console (in CentOS 7/RHEL 7)&lt;/h4&gt;

&lt;p&gt;As per Red Hat (https://access.redhat.com/articles/7212):&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;It is sometimes helpful to have a serial console for debugging purposes 
and a serial terminal for headless operation.  A serial console will 
send all console output to the serial port.  A serial terminal, if 
properly configured, also lets you log on to the system via the serial 
port as a remote terminal.  You can set up both or just one.&lt;/p&gt;

  &lt;h5 id=&quot;about-serial-console-kernel-option-configuration&quot;&gt;About Serial Console Kernel Option Configuration&lt;/h5&gt;

  &lt;p&gt;First, to get the kernel to output all console messages to the serial 
port you need to pass the &lt;strong&gt;console=ttyS0&lt;/strong&gt; parameter to the kernel at 
boot time.  This is usually done via the bootloader; we’ll be using 
GRUB in our examples.&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;  The &lt;strong&gt;primary&lt;/strong&gt; console for system output will be the 
&lt;strong&gt;last&lt;/strong&gt; console listed in the kernel parameters. For example:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;console=tty0 console=ttyS0,115200&lt;/code&gt; 
In this example, the serial console is the primary and the VGA console 
tty0 is the secondary display.  This means messages from init scripts, 
boot messages and critical warnings will go to the serial console since 
it is the primary console,  If init script messages don’t need to be 
seen on the serial console, it should be made the secondary by swapping 
the order of the console parameters:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;console=ttyS0,115200 console=tty0&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Continuing with the setup of the guest virtual machine: you need to 
configure the system to send the console output to the serial port 
&lt;strong&gt;ttyS1&lt;/strong&gt; at a baud rate of 19200, as well as to send the output to the 
regular console or “screen” &lt;strong&gt;tty1&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cp -i /etc/default/grub /tmp/grub.original.bkp 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# vi /etc/default/grub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# diff \
 --unified=0 \
 /tmp/grub.original.bkp \
 /etc/default/grub
--- /tmp/grub.original.bkp      2022-03-12 22:46:58.157447335 -0700
+++ /etc/default/grub   2022-03-12 22:48:01.959447335 -0700
@@ -5,3 +5,4 @@ 
-GRUB_TERMINAL=&quot;serial console&quot;
-GRUB_SERIAL_COMMAND=&quot;serial --unit=1 --speed=19200&quot;
-GRUB_CMDLINE_LINUX=&quot;crashkernel=auto rd.lvm.lv=centos/root rd.lvm.lv=centos/swap console=ttyS1,19200&quot;
+GRUB_CMDLINE_LINUX_DEFAULT=&quot;console=tty1 console=ttyS1,19200&quot;                  
+GRUB_TERMINAL=&quot;console serial&quot;    
+GRUB_SERIAL_COMMAND=&quot;serial --speed=19200 --unit=1 --word=8 --parity=no --stop=1&quot;
+GRUB_CMDLINE_LINUX=&quot;crashkernel=auto rd.lvm.lv=centos/root rd.lvm.lv=centos/swap console=tty1 console=ttyS1,19200&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The system that this test guest VM image is for is a BIOS-based server 
so the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;grub2-mkconfig&lt;/code&gt; command to update GRUB2 is BIOS-specific:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# grub2-mkconfig -o /boot/grub2/grub.cfg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(On UEFI-based machines it would be:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;grub2-mkconfig -o /boot/efi/EFI/redhat/grub.cfg&lt;/code&gt;)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; &lt;br /&gt;
The &lt;strong&gt;main kernel console&lt;/strong&gt; is the one listed &lt;strong&gt;first&lt;/strong&gt; in
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/sys/class/tty/console/active&lt;/code&gt;, which is the &lt;em&gt;last&lt;/em&gt; one 
listed on the &lt;em&gt;kernel command line&lt;/em&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cat /sys/class/tty/console/active
ttyS1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(After reboot, the GRUB2 changes will take effect and&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/sys/class/tty/console/active&lt;/code&gt; will show: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tty1 ttyS1&lt;/code&gt;)&lt;/p&gt;

&lt;p&gt;Configure a serial getty with the needed parameters so that it starts on boot.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cp -i \
 /usr/lib/systemd/system/serial-getty@.service \
 /etc/systemd/system/serial-getty@ttyS1.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# vi /etc/systemd/system/serial-getty@ttyS1.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# diff \
 --unified=0 \
 /usr/lib/systemd/system/serial-getty@.service \
 /etc/systemd/system/serial-getty@ttyS1.service
--- /usr/lib/systemd/system/serial-getty@.service    2020-10-01 10:08:50.0000
+++ /etc/systemd/system/serial-getty@ttyS1.service   2022-03-12 22:36:36.5400
@@ -23 +23 @@
-ExecStart=-/sbin/agetty --keep-baud 115200,38400,9600 %I $TERM
+ExecStart=-/sbin/agetty --keep-baud 115200,38400,19200,9600 %I $TERM
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Create a symlink.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ln -s \
 /etc/systemd/system/serial-getty@ttyS1.service \
 /etc/systemd/system/getty.target.wants/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Reload the daemon and start the service.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl daemon-reload
# systemctl enable serial-getty@ttyS1.service
# systemctl start serial-getty@ttyS1.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This creates a unit file that is specific to serial port ttyS1 so that 
you can make specific changes to this port and this port only.&lt;/p&gt;

&lt;p&gt;Restart the guest virtual machine.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# reboot
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you keep shells with &lt;strong&gt;minicom&lt;/strong&gt; connections running, the CentOS 
boot menu now appears in both shells: the one with minicom connected
to output of QEMU char device redirected to the first serial 
device /dev/pts/2 (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;minicom --baudrate=19200 --ptty=/dev/pts/2&lt;/code&gt;):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;   CentOS Linux (3.10.0-1160.el7.x86_64) 7 (Core)
   CentOS Linux (0-rescue-b8fcd7b7f02249dc9e6a3d2a443a3b92) 7 (Core)


   Use the ^ and v keys to change the selection.
   Press 'e' to edit the selected item, or 'c' for a command prompt.
The selected entry will be started automatically in 4s.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and the other shell with 
minicom connected to output of QEMU char device redirected to the second 
serial device /dev/pts/3 (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;minicom --baudrate=19200 --ptty=/dev/pts/3&lt;/code&gt;):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;   CentOS Linux (3.10.0-1160.el7.x86_64) 7 (Core)
   CentOS Linux (0-rescue-b8fcd7b7f02249dc9e6a3d2a443a3b92) 7 (Core)


   Use the ^ and v keys to change the selection.
   Press 'e' to edit the selected item, or 'c' for a command prompt.
The selected entry will be started automatically in 4s.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After the selected boot menu entry starts, output is displayed only 
in the second separate shell (in this example: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;minicom --baudrate=19200 --ptty=/dev/pts/3&lt;/code&gt;):&lt;/p&gt;

&lt;p&gt;Log in to the guest virtual machine.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;CentOS Linux 7 (Core)
Kernel 3.10.0-1160.el7.x86_64 on an x86_64

guestvm login: root 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Confirm that the serial getty service has been started 
and that it’s running.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl is-enabled serial-getty@ttyS1.service
enabled
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl is-active serial-getty@ttyS1.service
active
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cat /sys/class/tty/console/active                          
tty1 ttyS1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When you are done with exploring the guest VM, power it off.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# poweroff
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After you have finished installing and setting up the OS in the guest, 
use the following to start the guest VM again:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
 -drive format=raw,file=ttyS1disk4k.img \
 -global ide-hd.physical_block_size=4096 \
 -m 2G \
 -enable-kvm \
 -serial pty \
 -serial pty \
 -nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output (which shows the QEMU monitor):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;QEMU 4.2.0 monitor - type 'help' for more information
(qemu) char device redirected to /dev/pts/2 (label serial0)
char device redirected to /dev/pts/3 (label serial1)

(qemu)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then, from a separate shell instance, start &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;minicom&lt;/code&gt; and connect 
to the serial console that was configured for console redirection.
In this case it’s the second serial device, ttyS1, redirected by qemu 
and reported by the QEMU monitor as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/pts/3&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ minicom --baudrate=19200 --ptty=/dev/pts/3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above command for starting the guest VM can be simplified a bit 
(no need for ‘-global ide-hd.physical_block_size=4096’), 
as the filesystem has already been configured with block size of 4K). 
Also, the ‘-serial null’ disables COM1 (ttyS0), redirects console to 
serial on COM2 (ttyS1):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \ 
 -drive format=raw,file=ttyS1disk4k.img \
 -m 2G \
 -serial null \
 -serial pty \
 -nographic

QEMU 4.2.0 monitor - type 'help' for more information
(qemu) char device redirected to /dev/pts/0 (label serial1)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then, connect to the serial console reported by qemu as serial1, 
in this case reported by the QEMU monitor as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/pts/0&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ minicom --baudrate=19200 --ptty=/dev/pts/0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;Yet another version of a qemu command for starting a QEMU VM image 
containing an OS configured to redirect output to second serial text 
console on &lt;strong&gt;ttyS1 (COM2)&lt;/strong&gt; -&amp;gt; Use &lt;em&gt;‘-serial null’&lt;/em&gt; to disable 
COM1 (ttyS0) and the QEMU monitor, and combine that with &lt;em&gt;‘mon:stdio’&lt;/em&gt; to 
redirect output on COM2 (ttyS1) to the QEMU monitor (a.k.a. QEMU console):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
 -drive format=raw,file=ttyS1disk4k.img \
 -m 2G \
 -serial null \
 -serial mon:stdio \
 -nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  CentOS Linux (3.10.0-1160.el7.x86_64) 7 (Core)
  CentOS Linux (0-rescue-5003bb903e814f84ad84b479956f01d0) 7 (Core)



  Use the ^ and v keys to change the selection.
Press 'e' to edit the selected item, or 'c' for a command prompt.   

---- snip ----

CentOS Linux 7 (Core)
Kernel 3.10.0-1160.el7.x86_64 on an x86_64

guestvm login: 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;appendix&quot;&gt;APPENDIX&lt;/h3&gt;

&lt;h4 id=&quot;connect-serial-output-to-a-tcp-port-in-qemu-backend&quot;&gt;Connect Serial Output To a TCP Port in QEMU Backend&lt;/h4&gt;

&lt;p&gt;From:   &lt;a href=&quot;https://stackoverflow.com/questions/66214257/qemu-connecting-to-specific-guest-uart-device&quot;&gt;https://stackoverflow.com/questions/66214257/qemu-connecting-to-specific-guest-uart-device&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;If you pass multiple -serial options to QEMU they will be interpreted 
as defining what you want to do for UARTs 0, 1, 2, etc. 
So for example “-serial stdio -serial tcp::4444,server” will send 
UART 0 to your terminal and connect UART 1 to a TCP server on port 
4444, which you can then connect to with netcat or similar utility.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Here’s an example of starting QEMU with an image of an OS whose serial 
console is redirected to TCP port 4321:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
 -drive format=raw,file=ttyS1disk4k.img \
 -m 2G \
 -serial pty \
 -serial tcp::4321,server \
 -nographic

QEMU 4.2.0 monitor - type 'help' for more information
(qemu) char device redirected to /dev/pts/0 (label serial0)
qemu-kvm: -serial tcp::4321,server: info: QEMU waiting for connection on: 
  disconnected:tcp:0.0.0.0:4321,server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then, to connect with telnet:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ telnet 127.0.0.1 4321
Trying 127.0.0.1...
Connected to 127.0.0.1.
Escape character is '^]'.

guestvm login: root
Password: WillBeInClearText
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Or, to connect with nc (netcat):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ nc 127.0.0.1 4321

CentOS Linux 7 (Core)
Kernel 3.10.0-1160.el7.x86_64 on an x86_64


guestvm login: root
root
Password: WillBeInClearText
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;how-to-get-ssh-access-to-a-qemu-guest&quot;&gt;How to Get SSH Access to a QEMU Guest&lt;/h4&gt;

&lt;p&gt;Install CentOS 7 Linux VM in QEMU:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
 -cdrom /tmp/CentOS-7-x86_64-Minimal-2009-CUSTOM.iso \
 -hda abnodevm.qcow2 \
 -m 2G \
 -boot d \
 -enable-kvm \
 -device e1000,netdev=net0 -netdev user,id=net0,hostfwd=tcp::5555-:22 \
 -nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; &lt;br /&gt;
This worked when I configured DHCP in the guest VM.&lt;/p&gt;

&lt;p&gt;Start the VM.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ /usr/libexec/qemu-kvm \
 -hda abnodevm.qcow2 \
 -m 2G \
 -enable-kvm \
 -device e1000,netdev=net0 -netdev user,id=net0,hostfwd=tcp::5555-:22 \
 -nographic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From another shell instance in the host, connect to the guest VM.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ssh localhost -p 5555
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h4 id=&quot;word-soup&quot;&gt;Word Soup&lt;/h4&gt;

&lt;blockquote&gt;
  &lt;p&gt;CentOS 7/RHEL 7 installation through serial console, CentOS Installation 
without VGA Console, How to remote install CentOS/RHEL 7 using a rescue 
image like GRML, Remote Installation of the FreeBSD Operating System 
Without a Remote Console, SOL (Serial Over LAN), 
ipmitool - (IP Management Interface) tool, BMC - a.k.a an IPMI controller&lt;/p&gt;

  &lt;p&gt;IBM MM (Management Module), remote management, 
KVM (Keyboard - Video - Mouse), Virtualization, QEMU emulator, 
KVM (Kernel-based Virtual Machine)&lt;/p&gt;

  &lt;p&gt;qemu&amp;gt; prompt&lt;/p&gt;

  &lt;p&gt;SYSLINUX / ISOLINUX / PXELINUX, boot, GRUB (Legacy GRUB), GRUB 2 
iPXE
Kickstart
dd
guestfish&lt;/p&gt;

  &lt;p&gt;xCAT&lt;/p&gt;

  &lt;p&gt;bootloader chainloading
headless VNC
Ultimate Deployment Applicance&lt;/p&gt;

  &lt;p&gt;dmesg
tty tty0 ttyS0 tty1 ttyS1&lt;/p&gt;

&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;REFERENCES:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.privex.io/articles/using-serial-sol-config/&quot;&gt;Using a Serial Console with Linux, GRUB, SysLinux + Understanding Serial Configuration&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://unix.stackexchange.com/questions/164289/how-to-remote-install-centos-rhel-7-using-a-rescue-image-like-grml&quot;&gt;How to remote install CentOS/RHEL 7 using a rescue image like GRML?&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Out-of-band_management&quot;&gt;Out-of-band management&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/IBM_BladeCenter&quot;&gt;IBM BladeCenter&lt;/a&gt;   &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/IBM_Remote_Supervisor_Adapter&quot;&gt;IBM Remote Supervisor Adapter or Integrated Management Module (IMM; IBM’s out-of-band management implementation)&lt;/a&gt;   &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Baseboard_Management_Controller&quot;&gt;Baseboard Management Controller, a microcontroller on computer motherboards&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Intelligent_Platform_Management_Interface&quot;&gt;Intelligent Platform Management Interface (IPMI)&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;My comment:&lt;/strong&gt; HP iLO would be easier but I’m restricted by my environment 
with (a legacy) IBM MM (Management Module). For example, the website in 
the link below shows that with the version of iLO from that website it’s 
possible to mount CD-ROM to http; iLO shows which serial port is active 
(COM1, COM2,…), etc. &lt;br /&gt;
&lt;a href=&quot;http://stivesso.blogspot.com/2015/09/hp-ilo-vsp-centos-7rhel-7installation.html&quot;&gt;HP ILO VSP: CentOS 7/RHEL 7 Installation through Serial Console&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://mirror.centos.org/centos/7.9.2009/os/x86_64/images/pxeboot/&quot;&gt;CentOS Mirror - PXE Installer BOOT Images - initrd.img and vmlinuz&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://serverfault.com/questions/872238/qemu-and-serial-ports-on-the-guest-os&quot;&gt;QEMU and serial ports on the guest OS&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/52801787/qemu-doesnt-create-a-second-serial-port-ubuntu-x86-64-guest-and-host&quot;&gt;QEMU doesn’t create a second serial port (Ubuntu x86-64 guest and host)&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://unix.stackexchange.com/questions/78511/ttyo-ports-do-not-have-the-good-port-address-on-qemu-1-4-0-running-image-for-bea&quot;&gt;ttyO ports do not have the good port address on QEMU 1.4.0 running image for beagleboard-xm&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;The problem is on the host side:&lt;/p&gt;

  &lt;p&gt;You should use Pseudo-terminals (-serial pty) instead of 
connecting to “real” char-devices (-chardev tty,…).&lt;/p&gt;

  &lt;p&gt;qemu displays the pty /dev/pts/xx which it actually uses. You can now use 
this pty as a normal serial port from your host.&lt;/p&gt;

  &lt;p&gt;You can repeat this option to get more ptys connected to /dev/ttyS[0-*] on 
the guest (if you use -serial stdio, it is /dev/ttyS0 on the guest, the 
first pty is then /dev/ttyS1).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;http://wandin.net/dotclear/index.php?post/2010/03/16/CentOS-Installation-without-VGA-Console&quot;&gt;CentOS Installation without VGA Console&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://bladecenter.lenovofiles.com/help/topic/com.lenovo.bladecenter.advmgtmod.doc/kp1bd_pdf.pdf&quot;&gt;IBM BladeCenter - Serial Over LAN (SOL) Setup Guide&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://bauermann.wordpress.com/2013/09/04/connecting-qemukvm-virtual-machines-via-serial-port/&quot;&gt;Connecting QEMU/KVM virtual machines via serial port&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://wiki.centos.org/TipsAndTricks/VncHeadlessInstall&quot;&gt;Headless VNC Install Disk&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://gist.github.com/vkanevska/fd624f708cde7d7c172a576b10bc6966&quot;&gt;centos_bstick.sh&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/QEMU&quot;&gt;QEMU - Wikipedia&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/49716931/how-to-run-qemu-with-nographic-and-monitor-but-still-be-able-to-send-ctrlc-to&quot;&gt;How to run qemu with -nographic and -monitor but still be able to send Ctrl+C to the guest and quit with Ctrl+A X?&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://unix.stackexchange.com/questions/167165/how-to-pass-ctrl-c-to-the-guest-when-running-qemu-with-nographic/436321#436321&quot;&gt;How to pass Ctrl-C to the guest when running qemu with -nographic?&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.centos.org/en-US/centos/install-guide/Consoles_Logs_During_Install_x86/&quot;&gt;Installation Guide - Installing Using Anaconda - Consoles and Logging During the Installation – CentOS Documentation&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/installation_guide/sect-consoles-logs-during-installation-x86&quot;&gt;Red Hat Product Documentation - Red Hat Enterprise Linux - 7 - Installation Guide - Consoles and Logging During the Installation&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://web.archive.org/web/20171014140837/http://nairobi-embedded.org/making_a_qemu_disk_image_bootable_with_grub.html&quot;&gt;Making a QEMU disk image bootable with GRUB&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://centosfaq.org/centos/centos7-serial-console-and-flow-control/&quot;&gt;CentOS7 – Serial Console And Flow Control&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.uni-koeln.de/~pbogusze/posts/QEMU_serial_console.html&quot;&gt;QEMU serial console&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://hintshop.ludvig.co.nz/show/centos-text-cd/&quot;&gt;Creating a CentOS text-only CD / DVD&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.facebook.com/notes/linux-only/make-a-custom-centos-7-or-rhel-7-cd-with-kicktart-file/1142994982390559&quot;&gt;Make a custom CentOS-7 or RHEL-7 CD With kicktart File&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://access.redhat.com/solutions/655603&quot;&gt;During install of custom RHEL 6 ISO, mediacheck errors with “Unable to find the checksum in the image. This probably means the disc was created without adding the checksum.”&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/anaconda_customization_guide/sect-iso-images&quot;&gt;Working with ISO Images Red Hat Enterprise Linux 7 | Red Hat Customer Portal&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://wiki.qemu.org/Documentation/Networking#How_to_get_SSH_access_to_a_guest&quot;&gt;How to get SSH access to a guest - Network HOWTOs - QEMU Documentation - Networking&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://developer.ibm.com/tutorials/l-qemu-development/&quot;&gt;Archived | Using QEMU for cross-platform development&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://libera.irclog.whitequark.org/osdev/2021-07-14&quot;&gt;#osdev - Operating System Development - IRC&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://access.redhat.com/articles/7212&quot;&gt;How does one set up a serial terminal and/or console in Red Hat Enterprise Linux?&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://0pointer.de/blog/projects/serial-console.html&quot;&gt;systemd for Administrators, Part XVI&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://peterpap.net/index.php/Sample_Kickstart_Configuration_file&quot;&gt;Sample Kickstart Configuration file&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 12, 2022)&lt;/p&gt;

&lt;hr /&gt;

</description>
        <pubDate>Sat, 12 Mar 2022 08:01:47 -0800</pubDate>
        <link>http://localhost:4000/howto/virtualization/rs232serial/cli/terminal/shell/console/sysadmin/server/hardware/2022/03/12/centos-rhel-dvd-iso-customization-testing-with-qemu.html</link>
        <guid isPermaLink="true">http://localhost:4000/howto/virtualization/rs232serial/cli/terminal/shell/console/sysadmin/server/hardware/2022/03/12/centos-rhel-dvd-iso-customization-testing-with-qemu.html</guid>
        
        
        <category>howto</category>
        
        <category>virtualization</category>
        
        <category>rs232serial</category>
        
        <category>cli</category>
        
        <category>terminal</category>
        
        <category>shell</category>
        
        <category>console</category>
        
        <category>sysadmin</category>
        
        <category>server</category>
        
        <category>hardware</category>
        
      </item>
    
      <item>
        <title>How to Connect to Xorg in Linux Guest from Bhyve</title>
        <description>&lt;p&gt;OS: FreeBSD 13 &lt;br /&gt;
Shell:  csh&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo vm list
NAME       DATASTORE  LOADER  CPU  MEMORY  VNC  AUTOSTART  STATE
debianvm1  default    grub    1    512M    -    No         Stopped
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo vm start debianvm1
Starting debianvm1
  * found guest in /vm/debianvm1
  * booting...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo vm console debianvm1


  Booting `Debian GNU/Linux'

Loading Linux 5.10.0-13-amd64 ...
Loading initial ramdisk ...

---- snip ----
Debian GNU/Linux 11 debianvm1 ttyS0

debianvm1 login: dusko
Password:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In Linux guest:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo apt install tigervnc-standalone-server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ vncserver -depth 32 -geometry 1680x1200
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;You will require a password to access your desktops.

Password:
Verify:
Would you like to enter a view-only password (y/n)? n

New Xtigervnc server 'debianvm1.chem.ubc.ca:1 (dusko)' on port 5901 
  for display :1.
Use xtigervncviewer -SecurityTypes VncAuth -passwd /home/dusko/.vnc/passwd :1 
  to connect to the VNC server.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ss -tulpn | grep vnc
tcp   LISTEN 0  5  127.0.0.1:5901   0.0.0.0:*  users:((&quot;Xtigervnc&quot;,pid=1441,fd=9))
tcp   LISTEN 0  5      [::1]:5901      [::]:*  users:((&quot;Xtigervnc&quot;,pid=1441,fd=10))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ip -4 address | grep inet
  inet 127.0.0.1/8 scope host lo
  inet 123.12.23.43/24 brd 123.12.23.255 scope global dynamic noprefixroute enp0s5 
  inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ exit
logout
Connection to 123.12.23.43 closed.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the FreeBSD host:&lt;/p&gt;

&lt;p&gt;Make sure that you have a VNC client. 
If not, install one. 
For example, you can install tigervnc-viewer.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo pkg install tigervnc-viewer
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Forward a local port to the port used by VNC server in bhyve guest VM. 
In this example:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Local port: as the first 1024 ports are restricted to the root user only, and this example is for a non-root user, you can use any port above 1024, e.g. 9876&lt;/li&gt;
  &lt;li&gt;VNC server port in bhyve guest VM: 5901&lt;/li&gt;
  &lt;li&gt;Bhyve guest VM’s IP address: 123.12.23.43&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ssh dusko@123.12.23.43 -L 9876:127.0.0.1:5901
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Launch a separate shell instance and from there start &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vncviewer&lt;/code&gt;, 
specifying the port you forwarded.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ vncviewer 127.0.0.1:9876
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;Reference: &lt;br /&gt;
&lt;a href=&quot;https://forums.freebsd.org/threads/bhyve-how-to-configure-xorg-in-linux-guest.82231/&quot;&gt;Bhyve - how to configure Xorg in Linux guest - FreeBSD Forums&lt;/a&gt; &lt;br /&gt;
(Thread started on Sep 28, 2021)  &lt;br /&gt;
(Retrieved on Mar 9, 2022)&lt;/p&gt;

&lt;hr /&gt;

</description>
        <pubDate>Wed, 09 Mar 2022 18:13:27 -0800</pubDate>
        <link>http://localhost:4000/howto/bhyve/virtualization/xorg/x11/freebsd/2022/03/09/bhyve-connect-to-xorg-linux-guest.html</link>
        <guid isPermaLink="true">http://localhost:4000/howto/bhyve/virtualization/xorg/x11/freebsd/2022/03/09/bhyve-connect-to-xorg-linux-guest.html</guid>
        
        
        <category>howto</category>
        
        <category>bhyve</category>
        
        <category>virtualization</category>
        
        <category>xorg</category>
        
        <category>x11</category>
        
        <category>freebsd</category>
        
      </item>
    
      <item>
        <title>Setting Up GitHub Pages Website with Jekyll</title>
        <description>&lt;p&gt;OS: FreeBSD 13 &lt;br /&gt;
Shell:  csh&lt;/p&gt;

&lt;p&gt;Steps:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Install Ruby and Jekyll (including rubygem-bundler)&lt;/li&gt;
  &lt;li&gt;Create or Clone your GitHub Jekyll repository&lt;/li&gt;
  &lt;li&gt;cd into the cloned repository
    &lt;ul&gt;
      &lt;li&gt;Run your local Jekyll server:&lt;br /&gt;
 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bundle exec jekyll serve&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Open your local site in a Web browser:
  http://localhost:4000&lt;/li&gt;
  &lt;li&gt;To stop the local Jekyll server:&lt;br /&gt;
  press &lt;strong&gt;ctrl-c&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo pkg install ruby rubygem-jekyll rubygem-bundler
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git clone https://github.com/duskopijetlovic/duskopijetlovic.github.io
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cd ~/duskopijetlovic.github.io/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ bundle exec jekyll serve
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Open your local site in a Web browser:
     &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://localhost:4000&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;To stop the local Jekyll server:
     press &lt;strong&gt;ctrl-c&lt;/strong&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;add-custom-domain-in-github-pages&quot;&gt;Add Custom Domain in GitHub Pages&lt;/h3&gt;

&lt;p&gt;Add www.duskopijetlovic.com in the repo’s Settings:  &lt;br /&gt;
Go to the project ‘duskopijetlovic/duskopijetlovic.github.io’: &lt;br /&gt;
Pages &amp;gt; Custom domain:  www.duskopijetlovic.com  &lt;br /&gt;
Click ‘Save’&lt;/p&gt;

&lt;p&gt;Wait a couple of minutes for DNS check to complete.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;pushing-updates-to-github-pages&quot;&gt;Pushing Updates to GitHub Pages&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cd ~/duskopijetlovic.github.io/
% git status
% git config --list
% git add .
% git commit -a
% git push
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;References:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;All references below retrieved on Mar 7, 2022.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://dev.to/azukacchi/setting-up-github-pages-site-with-jekyll-tutorial-1l60&quot;&gt;Setting Up Github Pages site with Jekyll Tutorial&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/azukacchi/azukacchi.github.io&quot;&gt;Setting Up Github Pages site with Jekyll Tutorial for Absolute Beginner&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/kbroman/simple_site&quot;&gt;Minimal tutorial on making a simple website with GitHub Pages&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://kbroman.org/simple_site/&quot;&gt;Simple site - Easy websites with GitHub Pages&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/6317980/you-have-already-activated-x-but-your-gemfile-requires-y&quot;&gt;You have already activated X, but your Gemfile requires Y&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/plusjade/jekyll-bootstrap&quot;&gt;Jekyll-Bootstrap – The quickest way to start and publish your Jekyll powered blog. 100% compatible with GitHub pages&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://jekyllrb.com/tutorials/using-jekyll-with-bundler/&quot;&gt;Using Jekyll with Bundler&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://jekyllrb.com/docs/themes/&quot;&gt;Jekyll Themes&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://rubygems.org/search?utf8=%E2%9C%93&amp;amp;query=jekyll-theme&quot;&gt;Search for Jekyll Themes&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://jekyllrb.com/docs/step-by-step/10-deployment/&quot;&gt;Step by Step Tutorial&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/barryclark/jekyll-now&quot;&gt;Jekyll-Now – Build a Jekyll blog in minutes, without touching the command line&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.jekyllnow.com/Markdown-Style-Guide/&quot;&gt;Markdown Style Guide - Jekyll Now&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://pages.github.com/versions/&quot;&gt;GitHub Pages - Dependency versions&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

</description>
        <pubDate>Mon, 07 Mar 2022 21:01:12 -0800</pubDate>
        <link>http://localhost:4000/howto/tutorial/ruby/git/github/2022/03/07/setting-up-github-pages-with-jekyll.html</link>
        <guid isPermaLink="true">http://localhost:4000/howto/tutorial/ruby/git/github/2022/03/07/setting-up-github-pages-with-jekyll.html</guid>
        
        
        <category>howto</category>
        
        <category>tutorial</category>
        
        <category>ruby</category>
        
        <category>git</category>
        
        <category>github</category>
        
      </item>
    
      <item>
        <title>Writing Documentation and Creating Diagrams with LuaLaTeX and Inkscape</title>
        <description>&lt;p&gt;OS: FreeBSD 13 &lt;br /&gt;
Shell:  csh&lt;br /&gt;
Ghostscript version:  GPL Ghostscript 9.52 (2020-03-19)  &lt;br /&gt;
Inkscape version: 1.1 &lt;br /&gt;
xv version: 3.10a&lt;br /&gt;
zathura version: 0.4.5 (girara 0.3.6, runtime: 0.3.6)&lt;br /&gt;
zathura plugin versions: cb (0.1.8), ps (0.2.6), djvu (0.2.9), pdf-poppler (0.3.0), pdf-mupdf (0.3.5)&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Assumption&lt;/strong&gt;: previously installed Ghostscript, Inkscape, ImageMagick, xv, zathura.&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% sudo pkg install inkscape
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% inkscape --version
Inkscape 1.1 (c68e22c387, 2021-05-23)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -lh datacentrelayout.svg
-rw-r--r--  1 dusko  dusko   356K Apr  1  2021 datacentrelayout.svg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% file datacentrelayout.svg
datacentrelayout.svg: SVG Scalable Vector Graphics image
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% wc -l datacentrelayout.svg
    7970 datacentrelayout.svg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% head datacentrelayout.svg
&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&amp;gt;
&amp;lt;svg
   xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot;
   xmlns:cc=&quot;http://creativecommons.org/ns#&quot;
   xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;
   xmlns:svg=&quot;http://www.w3.org/2000/svg&quot;
   xmlns=&quot;http://www.w3.org/2000/svg&quot;
   xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;
   xmlns:sodipodi=&quot;http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd&quot;
   xmlns:inkscape=&quot;http://www.inkscape.org/namespaces/inkscape&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% inkscape datacentrelayout.svg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In &lt;strong&gt;Inkscape&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Edit 

Save As &amp;gt; Inkscape SVG (*.svg)  
Save As &amp;gt; Plain SVG (*.svg)  
Save As &amp;gt; Encapsulated PostScript (*.eps)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;generate-an-svg-or-a-png-with-graphviz-from-kroki-cli&quot;&gt;Generate an SVG or a PNG with Graphviz from Kroki-CLI&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat hello.dot
digraph G {
  Hello-&amp;gt;World
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ./kroki convert hello.dot --type dot 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% file hello.svg
hello.svg: SVG Scalable Vector Graphics image
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% inkscape hello.svg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ./kroki convert hello.dot --type dot --format png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% xv hello.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;convert-an-svg-image-svg-file-to-ps-or-eps&quot;&gt;Convert an SVG Image (SVG File) to PS or EPS&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% rsvg-convert --format ps hello.svg &amp;gt; hello.ps
% zathura --fork hello.ps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% rsvg-convert --format eps hello.svg &amp;gt; hello.eps
% zathura --fork hello.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;convert-png-to-svg&quot;&gt;Convert PNG to SVG&lt;/h3&gt;

&lt;h4 id=&quot;convert-png-to-pnm-first&quot;&gt;Convert PNG to PNM First&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% anytopnm server_blades.png &amp;gt; server_blades.pnm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;convert-pnm-to-svg&quot;&gt;Convert PNM to SVG&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% pamtosvg server_blades.pnm &amp;gt; server_blades.svg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;getting-information-about-images&quot;&gt;Getting Information About Images&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;&lt;br /&gt;
PDF (and PostScript) &lt;strong&gt;units&lt;/strong&gt; are 1/72 inch so 72 = 1 inch, 144 = 2 inches. 
You need to shift the origin of the page down and left, which is why the 
values for PageOffset are negative.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DOWN  = -
LEFT  = -
UP    = +
RIGHT = +
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;References:&lt;/strong&gt; &lt;br /&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/59101374/ghostscript-crop-certain-area&quot;&gt;Ghostscript : Crop Certain Area?&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;using--dsafer--dbatch--dnopause-trio-in-ghostscript&quot;&gt;Using -dSAFER -dBATCH -dNOPAUSE Trio in Ghostscript&lt;/h4&gt;

&lt;p&gt;It is conventional to call Ghostscript with the ‘-dSAFER -dBATCH -dNOPAUSE’ 
trio of options when rasterizing to a file.  These suppress interactive 
prompts and enable some security checks on the file to be run. 
Please see the &lt;a href=&quot;https://ghostscript.com/doc/current/Use.htm&quot;&gt;Use documentation&lt;/a&gt; 
for a complete description.&lt;/p&gt;

&lt;p&gt;Explanation:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;The -c parameter allows you to add PostScript code snippets which 
will be executed when Ghostscript processes the input file.  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -dSAFER -dNOPAUSE -dBATCH -sDEVICE=bbox firewall.eps
%%BoundingBox: 368 291 383 325
%%HiResBoundingBox: 368.564333 291.923991 382.598426 324.089990
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can use the &lt;a href=&quot;https://ghostscript.com/doc/current/Use.htm#Quiet&quot;&gt;&lt;strong&gt;-q&lt;/strong&gt;&lt;/a&gt;
switch to prevent Ghostscript from writing messages 
to standard output which become mixed with the intended output stream.&lt;/p&gt;

&lt;p&gt;Also, the &lt;strong&gt;-o&lt;/strong&gt; option determines output path+filename (and saves usage 
of -dBATCH -dNOPAUSE).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -o -dSAFER -sDEVICE=bbox firewall.eps
%%BoundingBox: 368 291 383 325
%%HiResBoundingBox: 368.564333 291.923991 382.598426 324.089990
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;getting-image-information-with-imagemagicks-identify&quot;&gt;Getting Image Information with ImageMagick’s identify&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% identify firewall.eps
firewall.eps[0] EPT 15x33 15x33+0+0 16-bit ColorSeparation CMYK 2079B 0.000u 0:00.001
firewall.eps[1] TIFF 15x34 15x34+0+0 8-bit sRGB 256c 2200B 0.000u 0:00.001
identify: Invalid TIFF directory; tags are not sorted in ascending order. 
  `TIFFReadDirectoryCheckOrder' @ warning/tiff.c/TIFFWarnings/959.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;NOTE that identify(1) reports the relative dimensions - as opposed to 
Ghostscript, which reports the image size with dimensions within the page.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Width  = 383 - 368 = 15  
Height = 325 - 291 = 34
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;NOTE BoundingBox:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% head firewall.eps
����,&amp;gt;J&amp;gt;��%!PS-Adobe-3.0 EPSF-3.0
%%Creator: Adobe Illustrator(R) 8.0
%%AI8_CreatorVersion: 8.0.1
%%For: (Gary V Stewart) (Cisco Systems Inc)
%%Title: (Firewall.eps)
%%CreationDate: (7/11/2000) (10:17 AM)
%%BoundingBox: 367 291 384 325
%%HiResBoundingBox: 367.998 291.4106 383.1011 324.5298
%%DocumentProcessColors: Black
%%DocumentSuppliedResources: procset Adobe_level2_AI5 1.2 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% grep Box firewall.eps
Binary file firewall.eps matches
 
% wc -l firewall.eps
    3788 firewall.eps
 
% strings firewall.eps | wc -l
    3229
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% strings firewall.eps | grep Box
%%BoundingBox: 367 291 384 325
%%HiResBoundingBox: 367.998 291.4106 383.1011 324.5298
%AI3_TemplateBox: 306 396 306 396
%AI3_TileBox: 0 0 592 744
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can extract (crop) the image from the page:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -q \
 -o cropped.eps \
 -dEPSCrop \
 -sDEVICE=eps2write \
 -f firewall.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and then Ghostscript reports the relative image size:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -o -dSAFER -sDEVICE=bbox cropped.eps
%%BoundingBox: 0 0 15 33
%%HiResBoundingBox: 0.558000 0.522000 14.600390 32.669999
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you want an EPS (PDF) viewer to display the cropped image in actual size:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -q \
 -o scaled.eps \
 -dEPSCrop \
 -sDEVICE=eps2write \
 -c &quot;&amp;lt;&amp;lt;/Install {1 1 scale}&amp;gt;&amp;gt; setpagedevice&quot; \
 -f firewall.eps 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;getting-boundingbox-information-with-ghostscript&quot;&gt;Getting BoundingBox Information with Ghostscript&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -o -dSAFER -sDEVICE=bbox scaled.eps 
%%BoundingBox: 0 0 15 33
%%HiResBoundingBox: 0.558000 0.522000 14.600390 32.669999
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;NOTE that you often can get the BoundingBox information with ImageMagick’s identify:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% identify scaled.eps
scaled.eps EPS 15x33 15x33+0+0 16-bit sRGB 3288B 0.000u 0:00.000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% grep Box scaled.eps 
%%BoundingBox: 0 0 15 33
%%HiResBoundingBox: 0.00 0.00 15.00 33.00
/MediaBox get aload pop
/FontBBox 1 index/FontBBox get def
dup/BBox get aload pop exch 3 index sub exch 2 index sub rectclip
&amp;lt;&amp;lt;/Type/Page/MediaBox [0 0 15.1 33.12]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;References:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/39652178/how-to-resize-an-eps-file-using-ghostscript&quot;&gt;How to resize an .eps file using ghostscript&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;resizing-images-with-ghostscript-gs&quot;&gt;Resizing Images with Ghostscript (gs)&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; &lt;br /&gt;
From Rescaling postscript figures&lt;br /&gt;
&lt;a href=&quot;http://www.verycomputer.com/18_696ed9f0514c5233_1.htm#p7&quot;&gt;http://www.verycomputer.com/18_696ed9f0514c5233_1.htm#p7&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 5, 2022)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Sorry to be so negative but I waste a lot of time having
to deal with seriously broken PS figures. Most of these
are the direct result of people thinking it is a good
idea to rotate or rescale their figures using ImageMagick,
xv, gimp, or some other program that works internally with
raster images. Please don’t do it!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -lh ~/Downloads/images/Cisco-Icons/forunzip/firewall.eps 
-rw-r--r--  1 dusko  dusko    82K Jul 11  2000 /home/dusko/Downloads/images/Cisco-Icons/forunzip/firewall.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cp -i ~/Downloads/images/Cisco-Icons/forunzip/firewall.eps /tmp/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cd /tmp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With &lt;strong&gt;Ghostscript&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -dSAFER -dNOPAUSE -dBATCH -sDEVICE=bbox firewall.eps
%%BoundingBox: 368 291 383 325
%%HiResBoundingBox: 368.564333 291.923991 382.598426 324.089990
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With &lt;strong&gt;ImageMagick&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% identify firewall.eps
firewall.eps[0] EPT 15x33 15x33+0+0 16-bit ColorSeparation CMYK 2079B 0.000u 0:00.001
firewall.eps[1] TIFF 15x34 15x34+0+0 8-bit sRGB 256c 2200B 0.000u 0:00.001
identify: Invalid TIFF directory; tags are not sorted in ascending order. 
  `TIFFReadDirectoryCheckOrder' @ warning/tiff.c/TIFFWarnings/959.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;crop--clip--aka-resize-page-to-size-of-the-image&quot;&gt;Crop / Clip / a.k.a. Resize Page to Size of the Image&lt;/h2&gt;

&lt;p&gt;Very often this will work.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -q \
 -o scaled.eps \
 -dEPSCrop \ 
 -sDEVICE=eps2write \
 -c &quot;&amp;lt;&amp;lt;/Install {1 1 scale}&amp;gt;&amp;gt; setpagedevice&quot; \
 -f firewall.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Confirm:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -dSAFER -dNOPAUSE -dBATCH -sDEVICE=bbox scaled.eps 
%%BoundingBox: 0 0 15 33
%%HiResBoundingBox: 0.558000 0.522000 14.600390 32.669999
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% identify scaled.eps
scaled.eps EPS 15x33 15x33+0+0 16-bit sRGB 3288B 0.000u 0:00.000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To resize (e.g.: 70%) as opposed to the actual size ({1 1 scale}):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -o scaled.eps -dEPSCrop -sDEVICE=eps2write -c &quot;&amp;lt;&amp;lt;/Install {0.70 0.70 scale}&amp;gt;&amp;gt; setpagedevice&quot; -f firewall.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -dSAFER -dNOPAUSE -dBATCH -sDEVICE=bbox scaled.eps 
%%BoundingBox: 0 0 11 23
%%HiResBoundingBox: 0.393820 0.360000 10.224000 22.877999
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;padding-images-with-ghostscript-and-inkscape&quot;&gt;Padding Images with Ghostscript and Inkscape&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -q \
 -o padded.eps \
 -sDEVICE=eps2write \
 -c &quot;&amp;lt;&amp;lt;/PageOffset [0 -1]&amp;gt;&amp;gt; setpagedevice&quot; \
 -f gigabit_switch_router.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Reference:&lt;/strong&gt;&lt;br /&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/35050233/ghostscript-and-page-margin&quot;&gt;Ghostscript and page margin&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 5, 2022)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;OR - if needed:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;For example, to add a label at the bottom of an image:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -o -dSAFER -sDEVICE=bbox firewall.eps
%%BoundingBox: 368 291 383 325
%%HiResBoundingBox: 368.564333 291.923991 382.598426 324.089990

% identify firewall.eps
firewall.eps[0] EPT 15x33 15x33+0+0 16-bit ColorSeparation CMYK 2079B 0.000u 0:00.001
firewall.eps[1] TIFF 15x34 15x34+0+0 8-bit sRGB 256c 2200B 0.000u 0:00.001
identify: Invalid TIFF directory; tags are not sorted in ascending order. 
  `TIFFReadDirectoryCheckOrder' @ warning/tiff.c/TIFFWarnings/959.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% grep -n Box firewall.eps
Binary file firewall.eps matches

% strings firewall.eps | wc -l
    3229

% strings firewall.eps | grep -n Box
7:%%BoundingBox: 367 291 384 325
8:%%HiResBoundingBox: 367.998 291.4106 383.1011 324.5298
24:%AI3_TemplateBox: 306 396 306 396
25:%AI3_TileBox: 0 0 592 744
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -q \
 -o scaled.eps \
 -dEPSCrop \
 -sDEVICE=eps2write \
 -c &quot;&amp;lt;&amp;lt;/Install {1 1 scale}&amp;gt;&amp;gt; setpagedevice&quot; \
 -f firewall.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% grep -n Box scaled.eps
3:%%BoundingBox: 0 0 15 33
4:%%HiResBoundingBox: 0.00 0.00 15.00 33.00
717:/MediaBox get aload pop
1456:/FontBBox 1 index/FontBBox get def
3883:dup/BBox get aload pop exch 3 index sub exch 2 index sub rectclip
8320:&amp;lt;&amp;lt;/Type/Page/MediaBox [0 0 15.1 33.12]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cp -i padded.eps padded.eps.bak
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Add 10 points in height:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% vi padded.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% diff --unified=0 padded.eps.bak padded.eps
--- padded.eps.bak      2022-03-27 15:50:42.472025000 -0700
+++ padded.eps  2022-03-27 15:56:13.098029000 -0700
@@ -3,2 +3 @@
-%%BoundingBox: 20 0 35 33
-%%HiResBoundingBox: 20.00 0.00 35.00 33.00
+%%BoundingBox: 20 0 35 43
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Clean with &lt;strong&gt;Inkscape&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% inkscape padded.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;In the 'Page settings' dialog:  accept defaults and click  OK

Select the object and move it to the top

Edit  &amp;gt;  Create Guides Around the Page
File  &amp;gt;  Document Properties
File  &amp;gt;  Clean Up Document

File  &amp;gt;  Save As  &amp;gt;  Encapsulated PostScript (*.eps)
In the 'Save As' dialog:  accept defaults and click  OK
 
File  &amp;gt;  Quit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% mv padded.eps padded.eps.old
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -q \
 -o padded.eps \
 -sDEVICE=eps2write \
 -c &quot;&amp;lt;&amp;lt;/PageOffset [0.2 0]&amp;gt;&amp;gt; setpagedevice&quot; \
 -f padded.eps.old
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% grep -n Box padded.eps
3:%%BoundingBox: 0 0 16 43
4:%%HiResBoundingBox: 0.20 0.00 15.20 42.10
717:/MediaBox get aload pop
1456:/FontBBox 1 index/FontBBox get def
3883:dup/BBox get aload pop exch 3 index sub exch 2 index sub rectclip
8309:&amp;lt;&amp;lt;/Type/Page/MediaBox [0 0 612 792]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Check with &lt;strong&gt;zathura&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% zathura --fork padded.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;reducing-file-size-aka-compressing&quot;&gt;Reducing File Size (a.k.a. Compressing)&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -q \
 -o padded.eps \
 -dDownsampleColorImages=true \
 -dColorImageResolution=300 \
 -sDEVICE=eps2write \
 -c &quot;&amp;lt;&amp;lt;/PageOffset [14 -2]&amp;gt;&amp;gt; setpagedevice&quot; \
 -f scaled.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Reference:&lt;/strong&gt; &lt;br /&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/43079007/improving-my-ghostscript-eps-compressive-script&quot;&gt;Improving my ghostscript eps compressive script&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 5, 2022)&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;generating-pdf-from-ps-and-eps-files-with-ghostscript&quot;&gt;Generating PDF from PS and EPS Files with Ghostscript&lt;/h2&gt;
&lt;h2 id=&quot;aka-converting-a-ps-or-an-eps-file-to-pdf&quot;&gt;(a.k.a. Converting a PS or an EPS File to PDF)&lt;/h2&gt;

&lt;p&gt;Here is a sample command line to invoke Ghostscript for 
generating a PDF/A document:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -dPDFA=1 \
 -dBATCH \
 -dNOPAUSE \
 -sColorConversionStrategy=RGB \
 -sDEVICE=pdfwrite \
 -sOutputFile=output.pdf \
 input.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Even simpler:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -sDEVICE=pdfwrite -o converted.pdf -f input.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Reference:&lt;/strong&gt;    &lt;br /&gt;
&lt;a href=&quot;https://ghostscript.com/doc/current/VectorDevices.htm&quot;&gt;High Level Output Devices (Vector Devices)&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Mar 5, 2022)&lt;/p&gt;

&lt;h2 id=&quot;generating-monochrome-pdf-from-ps-and-eps-files-with-ghostscript&quot;&gt;Generating Monochrome PDF from PS and EPS Files with Ghostscript&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -q \
 -o output.pdf \
 -sColorConversionStrategy=Gray \
 -sDEVICE=pdfwrite \
 -f input.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;cropping-pdf-and-removing-extraneous-whitespace&quot;&gt;Cropping PDF (and Removing Extraneous Whitespace)&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat network_diagram.dot 
graph network_diagram {

  imagepath=&quot;/mnt/usbflashdrive/myknowledgebase/images&quot;

  label=&quot;\nNetwork Diagram&quot;;

  node [
    shape=box,
    //fontname=&quot;arial&quot;,
    fontsize=8,
    style=filled,
    color=&quot;#d3edea&quot;
  ];
  splines=&quot;compound&quot;

  fw [ label=&quot;Edge firewall&quot; shape=none image=&quot;firewall.eps&quot; labelloc=b color=&quot;#ffffff&quot;];
  panel [ label=&quot;Patch panel&quot; shape=none image=&quot;24-port-patch-panel.eps&quot; labelloc=b color=&quot;#ffffff&quot; ];
  sw1 [ label=&quot;Cisco switch&quot; shape=none image=&quot;gigabit_switch_router.eps&quot; labelloc=b color=&quot;#ffffff&quot;];
  sw2 [ label=&quot;Inside switch&quot; shape=none image=&quot;gigabit_switch_router.eps&quot; labelloc=b color=&quot;#ffffff&quot;];
  srv1 [ label=&quot;Cluster server&quot; shape=none image=&quot;rackmount-1U-server.eps&quot; labelloc=b color=&quot;#ffffff&quot;];
  srv2 [ label=&quot;Cluster nodes 101-114&quot; shape=none image=&quot;server_blades.eps&quot; labelloc=b color=&quot;#ffffff&quot;];
  srv3 [ label=&quot;Cluster nodes 201-214&quot; shape=none image=&quot;server_blades.eps&quot; labelloc=b color=&quot;#ffffff&quot;];
  srv4 [ label=&quot;Management node&quot; shape=none image=&quot;rackmount-1U-server.eps&quot; labelloc=b color=&quot;#ffffff&quot;];

  cloud [ label=&quot;Internet&quot; shape=none, image=&quot;cloud.eps&quot; labelloc=b color=&quot;#ffffff&quot;];

  cloud -- fw;
  fw -- panel;
  panel -- sw1;
  sw1 -- srv1 [color=&quot;#ffbb00&quot;];
  srv1 -- sw2 [color=&quot;#ffbb00&quot;];
  srv1 -- sw2 [color=&quot;#ffbb00&quot;];
  srv2 -- sw2 [color=&quot;#ffbb00&quot;];
  srv2 -- sw2 [color=&quot;#ffbb00&quot;];
  srv3 -- sw2 [color=&quot;#ffbb00&quot;];
  srv3 -- sw2 [color=&quot;#ffbb00&quot;];
  panel -- srv4 [color=&quot;#ffbb00&quot;];
  srv4 -- sw2 [color=&quot;#ffbb00&quot;];
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% dot -Teps network_diagram.dot -o network_diagram.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Convert the EPS file to PDF (option ‘-q’ -&amp;gt; quiet Ghostscript processing).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -q \
 -sDEVICE=pdfwrite \
 -o network_diagram.pdf \
 -f network_diagram.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The resulting PDF has a lot of whitespace around the image as shown below.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/network_diagram.png&quot; alt=&quot;Displaying a png image of a network diagram&quot; title=&quot;Displaying a png image of a network diagram&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Find out the dimensions (and &lt;strong&gt;BoundingBox&lt;/strong&gt;) of PDF:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -dSAFER -dNOPAUSE -dBATCH -sDEVICE=bbox -f network_diagram.pdf
%%BoundingBox: 48 43 485 505
%%HiResBoundingBox: 48.221999 43.847999 484.613985 504.971985
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Use those dimensions to &lt;strong&gt;crop&lt;/strong&gt; the PDF with Ghostscript:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -q \
 -sDEVICE=pdfwrite \
 -o trimmed.pdf \
 -c &quot;[/CropBox [48 44 485 505] /PAGES pdfmark&quot; \
 -f network_diagram.pdf 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above command produces the cropped image:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/trimmed.png&quot; alt=&quot;Displaying an image of an appropriately cropped png image of a network diagram&quot; title=&quot;Displaying an image of an appropriately cropped png image of a network diagram&quot; /&gt;&lt;/p&gt;

&lt;p&gt;REFERENCE:&lt;br /&gt;
&lt;a href=&quot;https://sachinashanbhag.blogspot.com/2012/09/how-to-crop-pdf-images.html&quot;&gt;How to: Crop PDF Images&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;convert-pdf-to-png-image---with-ghostscript-gs&quot;&gt;Convert PDF to PNG Image - with Ghostscript (gs)&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -sDEVICE=png16m -r150 -o output.png -f input.pdf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;convert-pdf-to-png-image-and-remove-extranous-whitespace---with-ghostscript-gs&quot;&gt;Convert PDF to PNG Image and Remove Extranous Whitespace - with Ghostscript (gs)&lt;/h3&gt;

&lt;p&gt;Use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-dUseCropBox&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -sDEVICE=png16m -r150 -o trimmed.png -dUseCropBox -f input.pdf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;References:&lt;/strong&gt;&lt;br /&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/38171343/ghostscript-converting-pdf-to-png-with-wrong-output-size&quot;&gt;Ghostscript Converting PDF to PNG With Wrong Output Size&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/2657458/obey-the-mediabox-cropbox-in-pdf-when-using-ghostscript-to-render-a-pdf-to-a-png&quot;&gt;Obey the MediaBox/CropBox in PDF when using Ghostscript to render a PDF to a PNG&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;convert-eps-to-png-image&quot;&gt;Convert EPS to PNG Image&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% ls -lh firewall.eps
-rw-r--r--  1 dusko  wheel   163K Mar  5 13:40 firewall.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% file firewall.eps
firewall.eps: PostScript document text conforming DSC level 3.0, type EPS, Level 2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;List PNG supported devices by Ghostscript.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -h | grep -i png
   faxg3 faxg32d faxg4 fmlbp fmpr fpng fs600 gdi hl1240 hl1250 hl7x0
   planc plang plank planm plib plibc plibg plibk plibm png16 png16m png256
   png48 pngalpha pnggray pngmono pngmonod pnm pnmraw ppm ppmraw pr1000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -o -dSAFER -sDEVICE=bbox firewall.eps
%%BoundingBox: 0 9 15 42
%%HiResBoundingBox: 0.756000 9.522000 14.798812 41.669999

% identify firewall.eps
firewall.eps EPS 15x42 15x42+0+0 16-bit sRGB 3305B 0.000u 0:00.000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% wc -l firewall.eps
    8467 firewall.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% grep Box firewall.eps
%%BoundingBox: 0 0 16 43
%%HiResBoundingBox: 0.20 0.00 15.20 42.10
/MediaBox get aload pop
/FontBBox 1 index/FontBBox get def
dup/BBox get aload pop exch 3 index sub exch 2 index sub rectclip
&amp;lt;&amp;lt;/Type/Page/MediaBox [0 0 612 792]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -q \
 -o firewall.png \
 -sDEVICE=png16m \
 -r150 \
 -dEPSCrop \
 -dUseCropBox \
 -f firewall.eps 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% xv firewall.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;adding-a-border-around-an-image-with-imagemagick&quot;&gt;Adding a Border Around an Image with ImageMagick&lt;/h3&gt;

&lt;p&gt;Add a red border of size 4 pixels to an image.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% convert -bordercolor red -border 4 network_diagram.png network_diagramBORDER.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Reference:&lt;/strong&gt;&lt;br /&gt;
&lt;a href=&quot;https://askubuntu.com/questions/819482/how-to-add-a-border-using-imagemagick&quot;&gt;How to add a border using Imagemagick&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;hr /&gt;
&lt;hr /&gt;

&lt;h2 id=&quot;querying-ghostscript-for-the-default-optionssettings-of-an-output-device-such-as-pdfwrite-or-tiffg4&quot;&gt;Querying Ghostscript for the default options/settings of an output device (such as ‘pdfwrite’ or ‘tiffg4’)&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -c &quot;currentpagedevice {exch ==only ( ) print == } forall&quot;
GPL Ghostscript 9.52 (2020-03-19)
Copyright (C) 2020 Artifex Software, Inc.  All rights reserved.
This software is supplied under the GNU AGPLv3 and comes with NO WARRANTY:
see the file COPYING for details.
/MaxSeparations 3
/BandWidth 0
/DeviceGrayToK true
/DeviceLinkProfile ()
/KPreserve 8
/BandHeight 0
/PageOffset [0 0]
/GrayValues 256
/HWResolution [91.2449 91.2449]
/Separations false
/BeginPage {--.callbeginpage--}
/BlendColorProfile ()
/TextBlackPt 8
/BandBufferSpace 0
/Margins [0.0 0.0]
/BlueValues 256
/PostRenderProfile ()
/ImageBlackPt 8
/MaxBitmap 50000000
/MaxTempImage 5000
/OutputAttributes -dict-
/GreenValues 256
/LeadingEdge null
/ProofProfile ()
/GraphicBlackPt 8
/MaxPatternBitmap 0
/MaxTempPixmap 20000
/ProcessColorModel /DeviceRGB
/PageDeviceName null
/InputAttributes -dict-
/PageList /
/RedValues 256
/TextICCProfile ()
/InterpolateControl 1
/BlackPtComp 8
/.HWMargins [0.0 0.0 0.0 0.0]
/AntidropoutDownscaler false
/.IsPageDevice true
/LastPage 0
/ImagingBBox null
/ImageICCProfile ()
/TextIntent 8
/%MediaSource 0
/GraphicsAlphaBits 4
/WindowID 0
/OutputICCProfile (default_rgb.icc)
/FirstPage 0
/OutputDevice /x11alpha
/GraphicICCProfile ()
/ImageIntent 8
/%MediaDestination 0
/TextAlphaBits 4
/FILTERVECTOR false
/Name (x11alpha)
/HWSize [775 1003]
/PreBandThreshold false
/GraphicIntent 8
/UseCIEColor false
/.IgnoreNumCopies false
/PageUsesTransparency false
/FILTERTEXT false
/BitsPerPixel 24
/Install {--.callinstall--}
/SimulateOverprint true
/.LockSafetyParams false
/ColorAccuracy 2
/NumCopies null
/TextKPreserve 8
/FILTERIMAGE false
/ColorValues 16777216
/DisablePageHandler false
/.MediaSize [611.540955 791.452393]
/UseFastColor false
/PageSize [611.540955 791.452393]
/RenderIntent 8
/ImageKPreserve 8
/SeparationColorNames []
/BufferSpace 4000000
/PageCount 0
/Policies -dict-
/Colors 3
/GrayDetection false
/EndPage {--.callendpage--}
/ICCOutputColors ()
/GraphicKPreserve 8

GS&amp;gt;quit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The result is a list of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/SomeName somevalue&lt;/code&gt; pairs which describe 
the settings used for rendering pages to the current screen.&lt;/p&gt;

&lt;p&gt;This is so because usually the display is the default device for Ghostscript 
to send its output to.  Now you may notice that you’ll see an empty 
Ghostscript window pop up, which you’ll have to close.&lt;/p&gt;

&lt;p&gt;You can add some options to avoid the popup window:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -o /dev/null \
 -dNODISPLAY \
 -c &quot;currentpagedevice {exch ==only ( ) print ==} forall&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But this will change the query return values, because you (unintentionally) 
changed the output device settings:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -c &quot;currentpagedevice {exch ==only ( ) print ==} forall&quot; | grep Resolution
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Result:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/HWResolution [91.2449 91.2449]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Compare this to:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -o /dev/null \
 -dNODISPLAY \
 -c &quot;currentpagedevice {exch ==only ( ) print == } forall&quot; \
 | grep Resolution
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Result:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/HWResolution [72.0 72.0]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Avoid this trap.  Now assuming you want to query for the default settings 
of the PDF writing device, run this one:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -o /dev/null \
 -sDEVICE=pdfwrite \
 -c &quot;currentpagedevice {exch ==only ( ) print ==} forall&quot; \
 | tee ghostscript-pdfwrite-default-pagedevice-settings.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You now have all settings for the pdfwrite device in a *.txt file, 
and you may repeat that with some other interesting Ghostscript devices 
and then compare them for all their detailled differences:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cd /tmp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Switch to Bash.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% bash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ for _dev in \
  pswrite ps2write pdfwrite \
  tiffg3 tiffg4 tiff12nc tiff24nc tiff32nc tiff48nc tiffsep \
  jpeg jpeggray jpegcmyk \
  png16 png16m png256 png48 pngalpha pnggray pngmono; \
do \
  gs \
    -o /dev/null \
    -sDEVICE=${_dev} \
    -c &quot;currentpagedevice {exch ==only ( ) print ==} forall&quot; \
   | sort \
   | tee ghostscript-${_dev}-default-pagedevice-settings.txt; \
done
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It’s interesting to compare the settings for, say, the &lt;em&gt;pswrite&lt;/em&gt; and 
&lt;em&gt;ps2write&lt;/em&gt; devices like this (and also discover parameters which are 
available for the one, but not the other device):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sdiff -sbB ghostscript-ps*write-default-pagedevice-settings.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;or:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ diff -sbB ghostscript-ps*write-default-pagedevice-settings.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To avoid the return of just &lt;em&gt;-dict-&lt;/em&gt; for certain key values, 
use the &lt;em&gt;===&lt;/em&gt; instead of &lt;em&gt;==&lt;/em&gt; macro. &lt;br /&gt;
&lt;em&gt;===&lt;/em&gt; acts like &lt;em&gt;==&lt;/em&gt; but also prints the &lt;strong&gt;content&lt;/strong&gt; of dictionaries.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ for _dev in \
 pswrite ps2write pdfwrite \
 tiffg3 tiffg4 tiff12nc tiff24nc tiff32nc tiff48nc tiffsep \
 jpeg jpeggray jpegcmyk \
 png16 png16m png256 png48 pngalpha pnggray pngmono; \
 do \
   gs -o /dev/null \
   -sDEVICE=${_dev} -c &quot;currentpagedevice {exch ===only ( ) print ===} forall&quot; \
   | sort | \
   tee ghostscript-${_dev}-default-pagedevice-settings.txt; \
 done
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Exit from Bash.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ exit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;References:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;https://stackoverflow.com/questions/11001107/querying-ghostscript-for-the-default-options-settings-of-an-output-device-such&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;printing-aka-scaling-pdf-for-printing&quot;&gt;Printing (a.k.a. Scaling PDF for Printing)&lt;/h2&gt;

&lt;h3 id=&quot;print-to-a-legal-sized-paper-in-portrait-mode&quot;&gt;Print to a Legal Sized Paper in Portrait Mode&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ gs \
 -q \
 -sPAPERSIZE=legal \
 -dFIXEDMEDIA \
 -dBATCH \
 -dNOPAUSE \
 -sDEVICE=pdfwrite \
 -o printable.pdf 
 -f input.pdf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Open with zathura.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% zathura printable.pdf 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Print from zathura with its &lt;strong&gt;print&lt;/strong&gt; command:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;:print
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;print-a-pdf-with-a-big-image-to-a-legal-sized-paper-in-landscape-mode&quot;&gt;Print a PDF with a Big Image to a Legal Sized Paper in Landscape Mode&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat wiring_diagram.dot
graph wiring_diagram {
 
  splines=ortho;
  ranksep=&quot;0.8 equally&quot;;

  label=&quot;\n\n\nWiring Diagram\n&quot;;

  legend [shape=none, margin=0, label=
  &amp;lt;
    &amp;lt;table border=&quot;0&quot; cellborder=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;4&quot;&amp;gt;
        &amp;lt;tr&amp;gt;&amp;lt;td colspan=&quot;2&quot;&amp;gt;Legend&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
        &amp;lt;tr&amp;gt;&amp;lt;td bgcolor=&quot;red&quot;&amp;gt;red&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=&quot;red&quot;&amp;gt;public&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
        &amp;lt;tr&amp;gt;&amp;lt;td bgcolor=&quot;blue&quot;&amp;gt;blue&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=&quot;blue&quot;&amp;gt;inside&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
        &amp;lt;tr&amp;gt;&amp;lt;td bgcolor=&quot;green&quot;&amp;gt;green&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=&quot;green&quot;&amp;gt;MGMT&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
    &amp;lt;/table&amp;gt;
  &amp;gt;];

  subgraph cluster_pp {
    label=&quot;Patch panel&quot;;
    graph [fillcolor=&quot;burlywood&quot;, style=&quot;filled, rounded&quot;];
    node [shape=&quot;record&quot;, fillcolor=&quot;white&quot;, style=&quot;filled&quot;, width=0.4, height=0.4];
    edge [weight=1000, style=&quot;invis&quot;];
    
    node [label=&quot;1&quot;] p1; 
    node [label=&quot;2&quot;] p2;
    node [label=&quot;3&quot;] p3;
    node [label=&quot;4&quot;] p4;
    node [label=&quot;5&quot;] p5;
    node [label=&quot;6&quot;] p6;
    node [label=&quot;7&quot;] p7;
    node [label=&quot;8&quot;] p8;
    node [label=&quot;9&quot;] p9;
    node [label=&quot;10&quot;] p10;
    node [label=&quot;11&quot;] p11;
    node [label=&quot;12&quot;] p12;
    node [label=&quot;13&quot;] p13;
    node [label=&quot;14&quot;] p14;
    node [label=&quot;15&quot;] p15;
    node [label=&quot;16&quot;] p16;
    node [label=&quot;17&quot;] p17;
    node [label=&quot;18&quot;] p18;
    node [label=&quot;19&quot;] p19;
    node [label=&quot;20&quot;] p20;
    node [label=&quot;21&quot;] p21;
    node [label=&quot;22&quot;] p22;
    node [label=&quot;23&quot;] p23;
    node [label=&quot;24&quot;] p24;

    rank=same {p1 -- p2 -- p3 -- p4 -- p5 -- p6 -- p7 -- p8 -- p9 -- p10 -- p11 -- p12}
    rank=same {p13 -- p14 -- p15 -- p16 -- p17 -- p18 -- p19 -- p20 -- p21 -- p22 -- p23 -- p24}

    p1 -- p13
    p2 -- p14
    p3 -- p15
    p4 -- p16
    p5 -- p17
    p6 -- p18
    p7 -- p19
    p8 -- p20
    p9 -- p21
    p10 -- p22
    p11 -- p23
    p12 -- p24
  }

  subgraph cluster_webmo {
    label=&quot;WebMO and cluster storage [R2]&quot;;
    edge [style=&quot;invis&quot;];
    node [shape=&quot;record&quot;];

    node [label=&quot;ETH1&quot;] webmo1;
    node [label=&quot;ETH2&quot;] webmo2;
    node [label=&quot;ETHM&quot;] webmom;
    
    {rank=&quot;same&quot;; webmo1; webmo2; webmom;} 
    webmo1 -- webmo2 -- webmom;
  }

  subgraph cluster_achassis1 {
    label=&quot;Chassis 1 - Compute nodes 101-114 [R2]&quot;;
    edge [style=&quot;invis&quot;];
    node [shape=&quot;record&quot;];

    node [label=&quot;MM1&quot;] ac1mm ;
    node [label=&quot;4&quot;] ac1p4;
    node [label=&quot;3&quot;] ac1p3;
    node [label=&quot;2&quot;] ac1p2;
    node [label=&quot;1&quot;] ac1p1;
    
    {rank=&quot;same&quot;; ac1p1; ac1p2; ac1p3; ac1p4; ac1mm;}
    ac1p1 -- ac1p2 -- ac1p3 -- ac1p4 -- ac1mm;
  }

  subgraph cluster_achassis2 {
    label=&quot;Chassis 2 - Compute nodes 201-214 [R4]&quot;;
    edge[style=&quot;invis&quot;];
    node [shape=&quot;record&quot;];

    node [label=&quot;MM1&quot;] ac2mm;
    node [label=&quot;1&quot;] ac2p1;
    node [label=&quot;2&quot;] ac2p2;
    node [label=&quot;3&quot;] ac2p3;
    node [label=&quot;4&quot;] ac2p4;
    
    {rank=&quot;same&quot;; ac2p1; ac2p2; ac2p3; ac2p4; ac2mm}
    ac2p1 -- ac2p2 -- ac2p3 -- ac2p4 -- ac2mm;
  }

  subgraph cluster_compute_mgmt_node {
    label=&quot;Compute management node [R1]&quot;;
    edge [style=&quot;invis&quot;];
    node [shape=&quot;record&quot;];

    node [label=&quot;2&quot;] x2 ;
    node [label=&quot;1&quot;] x1 ;
    
    {rank=&quot;same&quot;; x1; x2;}
    x1 -- x2;
  }

  subgraph cluster_as {
    label=&quot;Compute cluster switch&quot;;
    graph [fillcolor=&quot;burlywood1&quot;, style=&quot;filled&quot;];
    node [shape=&quot;record&quot;, fillcolor=&quot;white&quot;, style=&quot;filled&quot;];
    edge [style=&quot;invis&quot;];

    node [label=&quot;1&quot;] asw1;
    node [label=&quot;2&quot;] asw2;
    node [label=&quot;3&quot;] asw3;
    node [label=&quot;4&quot;] asw4;
    node [label=&quot;5&quot;] asw5;
    node [label=&quot;6&quot;] asw6;
    node [label=&quot;7&quot;] asw7;
    node [label=&quot;8&quot;] asw8;

    {rank=&quot;same&quot;; asw1; asw2; asw3; asw4; asw5; asw6; asw7; asw8;} 
    asw1 -- asw2 -- asw3 -- asw4 -- asw5 -- asw6 -- asw7 -- asw8;
  }

  subgraph cluster_cs {
    label=&quot;Cisco switch [R1]&quot;;
    graph [fillcolor=&quot;burlywood1&quot;, style=&quot;filled&quot;];
    node [shape=&quot;record&quot;, fillcolor=&quot;white&quot;, style=&quot;filled&quot;];
    edge [style=&quot;invis&quot;];

    node [label=&quot;1&quot;] cs1;
    node [label=&quot;2&quot;] cs2;
    node [label=&quot;3&quot;] cs3;
    node [label=&quot;4&quot;] cs4;
    node [label=&quot;19&quot;] cs19;

    {rank=&quot;same&quot;; cs1; cs2; cs3; cs4; cs19;}
    cs1 -- cs2 -- cs3 -- cs4 -- cs19;
  }

  align_chassis [style=&quot;invis&quot;];
  align_chassis -- ac1mm [style=&quot;invis&quot;];
  align_chassis -- ac2mm [style=&quot;invis&quot;];

  x1 -- asw1 [color=&quot;blue&quot;];
  p2 -- x2 [color=&quot;red&quot;, constraint=&quot;false&quot;]; 
  p1 -- cs1 [color=&quot;red&quot;, constraint=&quot;false&quot;];
  asw3 -- ac1mm [color=&quot;green&quot;, penwidth=2, constraint=&quot;false&quot;];
  asw5 -- webmom [color=&quot;green&quot;, penwidth=2];
  asw7 -- ac2mm [color=&quot;green&quot;, penwidth=2, constraint=&quot;false&quot;];
  webmo1:sw -- cs19:ne [color=&quot;white:red:white&quot;];
  webmo2-- asw6 [color=&quot;blue&quot;];
  ac1p1 -- asw2 [color=&quot;blue&quot;];
  asw4 -- ac2p4 [color=&quot;blue&quot;, constraint=&quot;false&quot;];
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% dot -Teps wiring_diagram.dot -o wiring_diagram.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -sDEVICE=eps2write \
 -dEPSCrop \
 -o wiring_diagram.pdf \
 -f wiring_diagram.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -sDEVICE=eps2write \
 -o scaled.eps \
 -dEPSCrop \
 -c &quot;&amp;lt;&amp;lt;/PageSizePolicy 3&amp;gt;&amp;gt; setpagedevice&quot; \
 -dFIXMEDIA \
 -f wiring_diagram.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -sDEVICE=pdfwrite \
 -o printable.pdf \
 -dEPSFitPage \
 -c &quot;&amp;lt;&amp;lt;/PageSizePolicy 3&amp;gt;&amp;gt; setpagedevice&quot; \
 -dFIXMEDIA \
 -dNORANGEPAGESIZE \
 -f scaled.eps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs -q -o -dSAFER -sDEVICE=bbox printable.pdf
%%BoundingBox: 0 1 792 150
%%HiResBoundingBox: 0.000211 1.710000 791.999976 149.412581
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -sDEVICE=pdfwrite \
 -o trimmed.pdf \
 -c &quot;[/CropBox [0 1 792 150] /PAGES pdfmark&quot; \
 -f printable.pdf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% zathura trimmed.pdf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you want to get the prompt (use  -sOutputFile):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -q \
 -sDEVICE=pdfwrite \
 -sOutputFile=new.pdf \
 -dDEVICEHEIGHTPOINTS=612 \
 -dDEVICEWIDTHPOINTS=1008 \
 -dFitPage \
 -dFIXMEDIA \
 -dAutoRotatePages=/None \
 -f printable.pdf 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you want to get the prompt (use  -sOutputFile) and to exit it without typing ‘quit’:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs \
 -q \
 -sDEVICE=pdfwrite \
 -sOutputFile=new.pdf \
 -dDEVICEHEIGHTPOINTS=612 \
 -dDEVICEWIDTHPOINTS=1008 \
 -dFitPage \
 -dFIXMEDIA \
 -dAutoRotatePages=/None \
 -f printable.pdf \
 -c quit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you do not want to see output details (use -o):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% gs 
 -q \ 
 -sDEVICE=pdfwrite \
 -o new.pdf \
 -dDEVICEHEIGHTPOINTS=612 \
 -dDEVICEWIDTHPOINTS=1008 \
 -dFitPage \
 -dFIXMEDIA \
 -dAutoRotatePages=/None \
 -f printable.pdf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Load Legal sized paper in the Tray 1 (upper tray) of the HP LaserJet 2420dn printer.&lt;/p&gt;

&lt;p&gt;After running the the above command and loading the paper, open the 
resulting PDF with zathura.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% zathura new.pdf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From zathura:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;:print
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the Print dialog box:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Select the printer (in this example: HP_LaserJet_2420dn) 

In the Page Setup tab change the following two values - under Paper heading:
  Paper size:   Change it from 'US Letter' to 'US Legal'
  Orientation:  Change it from 'Portrait' to 'Landscape'

Click 'Print'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;NOTE:&lt;br /&gt;
The &lt;strong&gt;-dDEVICEHEIGHTPOINTS=612&lt;/strong&gt; and &lt;strong&gt;-dDEVICEWIDTHPOINTS=1008&lt;/strong&gt; are paper 
dimensions for &lt;strong&gt;Legal paper size&lt;/strong&gt; and you can obtain them from here:&lt;br /&gt;
&lt;a href=&quot;https://ghostscript.com/doc/current/Use.htm#Known_paper_sizes&quot;&gt;The paper sizes known to Ghostscript - Ghostsript Documentation&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 5, 2022)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;References:&lt;/strong&gt; &lt;br /&gt;
&lt;a href=&quot;https://comp.lang.postscript.narkive.com/xSbH7XrD/ghostscript-any-way-to-fit-to-printable-area&quot;&gt;Ghostscript - any way to fit to printable area?&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 5, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/42371152/ghostscript-changed-orientation-from-landscape-to-portrait&quot;&gt;Ghostscript changed Orientation from landscape to portrait&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 5, 2022)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://web.mit.edu/ghostscript/www/Use.htm&quot;&gt;How to use Ghostscript&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 5, 2022)&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;tips---useful-to-know&quot;&gt;TIPS - USEFUL TO KNOW:&lt;/h2&gt;

&lt;p&gt;From:
&lt;a href=&quot;https://stackoverflow.com/questions/70583490/dimensions-change-when-ghostscript-converts-ps-to-png&quot;&gt;Dimensions change when Ghostscript converts PS to PNG&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 5, 2022)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The BoundingBox in your PostScript program is a comment and therefore 
has no effect.  If you want to set the media size then you need to take 
action to do so.  You can do this in PostScript by using the 
setpagedevice operator.  Or you can do so from the command line using 
&lt;strong&gt;-sPAPERSIZE&lt;/strong&gt;, &lt;strong&gt;-dDEVICEHEIGHTPOINTS&lt;/strong&gt; and &lt;strong&gt;-dDEVICEWIDTHPOINTS&lt;/strong&gt;, 
&lt;strong&gt;-g&lt;/strong&gt; and possibly the &lt;strong&gt;-dFIXEDMEDIA&lt;/strong&gt; switch.&lt;/p&gt;

  &lt;p&gt;In the absence of any of these Ghostscript uses its &lt;strong&gt;default&lt;/strong&gt; media 
size which will be either &lt;strong&gt;A4&lt;/strong&gt; or &lt;strong&gt;US Letter&lt;/strong&gt;.&lt;/p&gt;

  &lt;p&gt;Or make your program DSC-compliant and use DSC processing, or make it 
an EPS and use -dEPSCrop.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;From:&lt;br /&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/46183868/using-ghostscript-to-export-pngs-at-fixed-size&quot;&gt;Using GhostScript to export PNGs at fixed size&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 5, 2022)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Your problem with EPS files is that they do &lt;strong&gt;not&lt;/strong&gt; request 
a &lt;strong&gt;media size&lt;/strong&gt;.  That’s because EPS files are intended to be included 
in other PostScript programs, so they need to be resized by the 
application generating the PostScript.&lt;/p&gt;

  &lt;p&gt;To that end, EPS files include &lt;strong&gt;comments&lt;/strong&gt; (which are &lt;strong&gt;ignored&lt;/strong&gt; by 
&lt;strong&gt;PostScript interpreters&lt;/strong&gt;) which define the &lt;strong&gt;BoundingBox&lt;/strong&gt; of the 
&lt;strong&gt;EPS&lt;/strong&gt;.  An application which places EPS can quickly scan the EPS to 
find this information, then it sets the CTM appropriately in the final 
PostScript program it is creating and inserts the content of the EPS.&lt;/p&gt;

  &lt;p&gt;The &lt;strong&gt;FitPage&lt;/strong&gt; switch in &lt;strong&gt;Ghostscript&lt;/strong&gt; relies on having 
&lt;em&gt;a known media size&lt;/em&gt; (and you should set &lt;strong&gt;-dFIXEDMEDIA&lt;/strong&gt; when using this) 
and a requested media size, figuring out what scale factor to apply to 
the request in order to make it fit the actual size, and setting up the 
CTM to apply that scaling.&lt;/p&gt;

  &lt;p&gt;If you don’t ever get a media size request (which you &lt;strong&gt;won’t&lt;/strong&gt; with 
an &lt;strong&gt;EPS&lt;/strong&gt;) then &lt;strong&gt;no scaling&lt;/strong&gt; will take place.&lt;/p&gt;

  &lt;p&gt;Now &lt;strong&gt;Ghostscript&lt;/strong&gt; &lt;em&gt;does have&lt;/em&gt; a different switch, &lt;strong&gt;EPSCrop&lt;/strong&gt; which 
picks up the comments from the EPS and uses that to set the media size 
(Ghostscript has mechanisms to permit processing of comments for this 
reason, amongst others).  You could implement a similar mechanism to 
pick up the BoundingBox comments, and scale the EPS so that it fits 
a desired target media size.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;From: &lt;br /&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/40223691/scaling-pdf-file-using-ghostscript&quot;&gt;Scaling PDF file using Ghostscript&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 5, 2022)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Well, Ghostscript uses PostScript as its scripting language, 
so anything you can do in PostScript you can do to a PDF file.&lt;/p&gt;

  &lt;p&gt;I &lt;em&gt;really&lt;/em&gt; wouldn’t use -g with pdfwrite, because -g specifies 
&lt;strong&gt;pixels&lt;/strong&gt;, and since pdfwrite is a vector device that doesn’t really 
work well. Use -dDEVICEHEIGHTPOINTS and -dDEVICEWIDTHPOINTS instead.&lt;/p&gt;

  &lt;p&gt;Don’t set -sPAPERSIZE either, you can’t set the media to be letter in 
one place and something different (the -g switch) elsewhere.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;From:&lt;br /&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/36871015/manual-layout-of-graphs-described-in-graphviz-dot-format&quot;&gt;manual layout of graphs described in graphviz (DOT)&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 5, 2022)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;You can run &lt;strong&gt;dot&lt;/strong&gt; requesting output as another dot file with the command
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dot -Tdot&lt;/code&gt;.  &lt;strong&gt;dot&lt;/strong&gt; will then calculate the layout but instead of 
outputting a pictorial representation, it will output another dot file 
with exactly the same information as the input, with the addition of 
layout information as additional attributes.&lt;br /&gt;
You can then edit the layout information by hand and run it through dot 
a second time to obtain the pictorial representation.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ dot -Tdot input.gv
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From: &lt;br /&gt;
&lt;a href=&quot;https://marc.info/?l=graphviz-devel&amp;amp;m=129418103126092&quot;&gt;Re: [graphviz-devel] File extension .dot or .gv?&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 5, 2022)&lt;/p&gt;

&lt;p&gt;and&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://forum.graphviz.org/t/what-is-the-file-extension-for-dot-file/35/4&quot;&gt;What is the file extension for dot file? - Graphviz Forum&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 5, 2022)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;.gv is preferred. The .dot suffix was stolen by Word.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;PROGRAMS:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;VIEWING:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ps, eps, pdf: zathura&lt;/li&gt;
  &lt;li&gt;png, jpeg: xv&lt;/li&gt;
  &lt;li&gt;svg: Inkscape, web browsers&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;EDITING:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;dot (Graphviz)&lt;/li&gt;
  &lt;li&gt;dotty (comes with Graphviz) - a WYSIWYG tool to aid in the hand-layout process&lt;/li&gt;
  &lt;li&gt;Graphviz Visual Editor&lt;/li&gt;
  &lt;li&gt;PlantUML&lt;/li&gt;
  &lt;li&gt;Kroki&lt;/li&gt;
  &lt;li&gt;kroki-cli&lt;/li&gt;
  &lt;li&gt;Diagrams.net (Drawio) (https://github.com/jgraph/drawio)
    &lt;ul&gt;
      &lt;li&gt;https://github.com/jgraph&lt;/li&gt;
      &lt;li&gt;https://github.com/jgraph/drawio&lt;/li&gt;
      &lt;li&gt;https://github.com/jgraph/drawio-desktop/releases/tag/v17.2.1&lt;/li&gt;
      &lt;li&gt;https://github.com/jgraph/docker-drawio&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;DrawThe.net (https://github.com/cidrblock/drawthe.net)&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Blockdiag  (seqdiag, rackdiag, netdiag, etc.)   (http://blockdiag.com/en/)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;rsvg-convert&lt;/li&gt;
  &lt;li&gt;anytopnm&lt;/li&gt;
  &lt;li&gt;pamfile&lt;/li&gt;
  &lt;li&gt;ppmhist&lt;/li&gt;
  &lt;li&gt;pnm(5), ppm(5), pgm(5), pbm(5), pam(5)&lt;/li&gt;
  &lt;li&gt;pamtosvg&lt;/li&gt;
  &lt;li&gt;pbmclean&lt;/li&gt;
  &lt;li&gt;mscgen_js - turns text into sequence charts  (https://mscgen.js.org/)
    &lt;ul&gt;
      &lt;li&gt;Includes, for example: SMTP Sequence Chart&lt;/li&gt;
      &lt;li&gt;Also, you can:
        &lt;ul&gt;
          &lt;li&gt;animate the chart&lt;/li&gt;
          &lt;li&gt;create a bookmarkable URI (URL)/link&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;epsffit&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;PKG (PACKAGES):
    &lt;ul&gt;
      &lt;li&gt;ghostscript&lt;/li&gt;
      &lt;li&gt;sam2p&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;NOT YET EXPLORED:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://news.ycombinator.com/item?id=23154846&quot;&gt;Diagram as Code (mingrammer.com) - HackerNews&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;Mermaid
        &lt;ul&gt;
          &lt;li&gt;https://mermaid-js.github.io/mermaid-live-editor/&lt;/li&gt;
          &lt;li&gt;https://mermaid-js.github.io/mermaid/#/&lt;/li&gt;
          &lt;li&gt;https://github.com/mermaid-js/mermaid&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;https://isoflow.io/&lt;/li&gt;
  &lt;li&gt;https://diagrams.mingrammer.com/
    &lt;ul&gt;
      &lt;li&gt;https://github.com/mingrammer/diagrams&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;diagram.codes (playground available but Save is available only for paying customers)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;ubigraph (https://github.com/0x4lan/ubigraph_server)&lt;/li&gt;
  &lt;li&gt;Tulip (Data Visualization Software)  https://tulip.labri.fr/site/&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

</description>
        <pubDate>Sat, 05 Mar 2022 09:12:41 -0800</pubDate>
        <link>http://localhost:4000/howto/diagram/graph/graphviz/plaintext/text/tex/latex/visualization/documentation/2022/03/05/tex-latex-inkscape-svg-creating-diagrams.html</link>
        <guid isPermaLink="true">http://localhost:4000/howto/diagram/graph/graphviz/plaintext/text/tex/latex/visualization/documentation/2022/03/05/tex-latex-inkscape-svg-creating-diagrams.html</guid>
        
        
        <category>howto</category>
        
        <category>diagram</category>
        
        <category>graph</category>
        
        <category>graphviz</category>
        
        <category>plaintext</category>
        
        <category>text</category>
        
        <category>tex</category>
        
        <category>latex</category>
        
        <category>visualization</category>
        
        <category>documentation</category>
        
      </item>
    
      <item>
        <title>How To Create a Bootable FreeBSD ZFS Clone</title>
        <description>&lt;p&gt;OS: FreeBSD 13 &lt;br /&gt;
Shell:  csh&lt;br /&gt;
Python version: 3.8.12&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;[TODO]&lt;/strong&gt;  Complete this page&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; &lt;br /&gt;
In code excerpts and examples, the long lines are folded and then 
indented to make sure they fit the page.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Code for a mind map in &lt;a href=&quot;https://github.com/plantuml/plantuml/&quot;&gt;PlantUML&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat zfsbootable.txt
@startmindmap

title Create a Bootable FreeBSD ZFS Machine Clone\n

' Based on
' https://ideashortcut.com/tutorial-convert-you-notes-into-a-wbs-and-gantt-charts-with-plantuml/
'   and
' https://forums.freebsd.org/threads/cloning-a-zfs-boot-disk-on-a-usb-drive.79687/
'   and
' https://github.com/mattjhayes/PlantUML-Examples/blob/master/docs/Diagram-Types/diagram-types.md

scale 0.85

skinparam ArrowColor DarkGrey

&amp;lt;style&amp;gt;
mindmapDiagram {
  node {
    Padding 15
    Margin 15
    BackGroundColor YellowGreen
    FontColor DarkSlateGrey
    LineColor White
    LineThickness 1.0
    MaximumWidth 320
  }
  rootNode {
    Padding 15
    Margin 15
    BackGroundColor YellowGreen
    FontColor DarkSlateGrey
    FontSize 18
    LineColor White
    LineThickness 1.0
  }
  leafNode {
    Padding 15
    Margin 15
    BackGroundColor LightGray
    FontColor DarkSlateGrey
    FontSize 15
    LineColor ForestGreen
    LineThickness 2.0
  }
  ' Styles to apply to tasks based on status:
  ' in progress (i)
  .i {
    BackgroundColor SkyBlue
  }
  ' completed (c)
  .c {
    BackgroundColor LightSlateGray
    FontStyle italic
    FontColor DarkGray
  }
  ' urgent (u)
  .u {
    BackgroundColor OrangeRed
    FontStyle bold
  }
  ' delegated (d)
  .d {
    BackgroundColor Gold
  }
}
&amp;lt;/style&amp;gt;

' Legend colours need to be updated manually :-(
legend
|&amp;lt;back:LightGray&amp;gt;&amp;lt;b&amp;gt;Not Started.&amp;lt;/b&amp;gt;&amp;lt;/back&amp;gt;|
|&amp;lt;back:SkyBlue&amp;gt;&amp;lt;b&amp;gt;In Progress.&amp;lt;/b&amp;gt;&amp;lt;/back&amp;gt;|
|&amp;lt;back:LightSlateGrey&amp;gt;&amp;lt;i&amp;gt;Completed     .&amp;lt;/i&amp;gt;&amp;lt;/back&amp;gt;|
|&amp;lt;back:OrangeRed&amp;gt;&amp;lt;b&amp;gt;Urgent        .&amp;lt;/b&amp;gt;&amp;lt;/back&amp;gt;|
|&amp;lt;back:Gold&amp;gt;&amp;lt;b&amp;gt;Delegated   .&amp;lt;/b&amp;gt;&amp;lt;/back&amp;gt;|
|&amp;lt;back:YellowGreen&amp;gt;&amp;lt;b&amp;gt;Branch        .&amp;lt;/b&amp;gt;&amp;lt;/back&amp;gt;|
|&amp;lt;back:LightGray&amp;gt;&amp;lt;b&amp;gt;[*] The same name as before not required but convenient, unless you have bootfs set in /boot/loader.conf.&amp;lt;/b&amp;gt;&amp;lt;/back&amp;gt;|
|&amp;lt;back:LightGray&amp;gt;&amp;lt;b&amp;gt;[**] If you are creating the same pool and the rest as subsets of that, you need to force the zfs receive in order to tell it to overwrite your existing pool.&amp;lt;/b&amp;gt;&amp;lt;/back&amp;gt;|
|&amp;lt;back:LightGray&amp;gt;&amp;lt;b&amp;gt;[***] On newer installs, this is zroot/ROOT/default or similar.&amp;lt;/b&amp;gt;&amp;lt;/back&amp;gt;|
endlegend

* Full\nsystem\nrestore\nto a\nfresh\ndrive
** Root on ZFS install
** Cloning
** gpart(8)
** dd(1)
** Bare metal backup/restore
** ZFS snapshots
*** zfs send
**** on trusted: nc(1)
**** on untrusted: ssh(1)
*** zfs receive
*** beadm/bectl
**** Boot pool name: zroot
**** Boot BE parent\ndataset name: ROOT
**** Boot datasets:\nROOT/tmp,\nROOT/var/tmp,\nROOT/default
**** **/usr** and **/var** filesystems have\n**canmount** property set to **off**
***** /usr and /var are placed \non the / dataset the\nzroot/ROOT/default BE
** Full\nsystem\nrestore\nto a\nfresh\ndrive
*** Capture the root pool properties\n zpool get all rpool &amp;lt;&amp;lt;c&amp;gt;&amp;gt;
*** GPT layout &amp;lt;&amp;lt;i&amp;gt;&amp;gt;
**** Manually create GPT
*** Boot loader &amp;lt;&amp;lt;u&amp;gt;&amp;gt;
**** Write the boot loader
*** Sufficient size on destinaiton
*** Boot off the\nFreeBSD Live CD/USB
**** Get networking up\nand running
**** Create the new zpool [*]
**** zfs receive the backup [**]
**** Use zpool(1) to set bootfs\nproperty properly [***]
**** Reboot
**** Use gptzfsboot(8)\nto install bootcode
**** Reboot
@endmindmap
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Send a POST request using &lt;a href=&quot;https://httpie.org/&quot;&gt;HTTPie&lt;/a&gt;, &lt;a href=&quot;https://docs.kroki.io/kroki/setup/http-clients/&quot;&gt;HTTP Clients - Kroki documentation&lt;/a&gt; to generate the mind map image.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% http \
 http://localhost:8000/ \
 diagram_type='plantuml' \
 output_format='png' \
 diagram_source='@zfsbootable.txt' \
 &amp;gt; zfsbootable.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/zfsbootable.png&quot; alt=&quot;Displaying a png image of a mind map created with PlantUML invoked via Kroki&quot; title=&quot;Displaying a png image of a mind map created with PlantUML invoked via Kroki&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Alternatively, you can display the image in a web browser.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat \
 zfsbootable.txt | \
 python3.8 -c \
 &quot;import sys; import base64; import zlib; \
 print(base64.urlsafe_b64encode(zlib.\
 compress(sys.stdin.read().encode('utf-8'), 9)).decode('ascii'))&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;eNq9V11v2zYUfdev4FtTobLaDl2zIDA6J01QIG2COEGxzXugRFriQpEaP5I6a__7zqVkx-mSod3DjNggLy_PPbxfZN74wF3olB
---- snip ----
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Copy and paste the output to your web browser:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://localhost:8000/plantuml/svg/eNq9V11v2zYUfdev4FtTobLaDl2zIDA6J01QIG2COEGxzXugRFriQpEaP5I6a_
---- snip ----
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat bootable_os_zfs_activity_diagram.txt
@startuml
' Based on https://waddles.org/2009/11/17/replicating-zfs-root-disks/
' and
' https://github.com/mattjhayes/PlantUML-Examples/blob/master/docs/Diagram-Types/diagram-types.md

skinparam shadowing false

title Create a Bootable FreeBSD ZFS Clone\n- Activity Diagram -\n

start
:Verify status;
:Create recursive ZFS root pool (rpool) snapshot;
:Insert and label new disks;
:Create partition tables;
:Create new zpool;
:Replicate pool's dataset;
:Replicate remaining datasets;
:Set mountpoints;
:Set bootfs property;
:Export the new pool;
:Install boot blocks to both disks;

:Target System
Transfer disks and boot failsafe;

:Import zpool as rpool;
:Export the zpool;

:Boot to single user mode;
:Unconfigure the system;
:Reconfigure the system;
: Cleanup;

stop
@enduml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% http \ 
 http://localhost:8000/ \
 diagram_type='plantuml' \
 output_format='png' \
 diagram_source='@bootable_os_zfs_activity_diagram.txt' \
 &amp;gt; bootable_os_zfs_activity_diagram.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/bootable_os_zfs_activity_diagram.png&quot; alt=&quot;Displaying a png image of an activity diagram created with PlantUML invoked via Kroki&quot; title=&quot;Displaying a png image of an activity diagram created with PlantUML invoked via Kroki&quot; /&gt;&lt;/p&gt;

</description>
        <pubDate>Sat, 05 Mar 2022 08:08:02 -0800</pubDate>
        <link>http://localhost:4000/howto/diagram/graph/graphviz/plaintext/text/tex/latex/visualization/documentation/2022/03/05/freebsd-create-bootable-zfs-clone.html</link>
        <guid isPermaLink="true">http://localhost:4000/howto/diagram/graph/graphviz/plaintext/text/tex/latex/visualization/documentation/2022/03/05/freebsd-create-bootable-zfs-clone.html</guid>
        
        
        <category>howto</category>
        
        <category>diagram</category>
        
        <category>graph</category>
        
        <category>graphviz</category>
        
        <category>plaintext</category>
        
        <category>text</category>
        
        <category>tex</category>
        
        <category>latex</category>
        
        <category>visualization</category>
        
        <category>documentation</category>
        
      </item>
    
      <item>
        <title>How To Create Server Wiring Diagrams with Graphviz and Kroki</title>
        <description>&lt;p&gt;OS: FreeBSD 13 &lt;br /&gt;
Shell:  csh&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat wiring.dot
graph wiring {

  splines=ortho;
  ranksep=&quot;2.0 equally&quot;;

  legend [shape=none, margin=0, label=
  &amp;lt;
    &amp;lt;table border=&quot;0&quot; cellborder=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;4&quot;&amp;gt;
        &amp;lt;tr&amp;gt;&amp;lt;td colspan=&quot;2&quot;&amp;gt;Legend&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
        &amp;lt;tr&amp;gt;&amp;lt;td bgcolor=&quot;red&quot;&amp;gt;red&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=&quot;red&quot;&amp;gt;public&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
        &amp;lt;tr&amp;gt;&amp;lt;td bgcolor=&quot;blue&quot;&amp;gt;blue&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=&quot;blue&quot;&amp;gt;inside&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
        &amp;lt;tr&amp;gt;&amp;lt;td bgcolor=&quot;green&quot;&amp;gt;green&amp;lt;/td&amp;gt;&amp;lt;td bgcolor=&quot;green&quot;&amp;gt;MGMT&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
    &amp;lt;/table&amp;gt;
  &amp;gt;];

  subgraph cluster_pp {
    label=&quot;Patch panel&quot;;
    graph [fillcolor=&quot;burlywood&quot;, style=&quot;filled, rounded&quot;];
    node [shape=&quot;record&quot;, fillcolor=&quot;white&quot;, style=&quot;filled&quot;];
    edge [style=&quot;invis&quot;];

    node [label=&quot;1&quot;] p1;
    node [label=&quot;2&quot;] p2;
    node [label=&quot;3&quot;] p3;

    {rank=&quot;same&quot;; p1; p2; p3;}
    p1 -- p2 -- p3;
  }

  subgraph cluster_webmo {
    label=&quot;WebMO and cluster storage\n[RACK 1]&quot;;
    edge [style=&quot;invis&quot;];
    node [shape=&quot;record&quot;];

    node [label=&quot;ETH1&quot;] webmo1;
    node [label=&quot;ETH2&quot;] webmo2;
    node [label=&quot;ETHM&quot;] webmom;

    {rank=&quot;same&quot;; webmo1; webmo2; webmom;}
    webmo1 -- webmo2 -- webmom;
  }

  subgraph cluster_achassis1 {
    label=&quot;Chassis 1 - Compute nodes 101-114\n[RACK 1]&quot;;
    edge [style=&quot;invis&quot;];
    node [shape=&quot;record&quot;];

    node [label=&quot;MM1&quot;] ac1mm ;
    node [label=&quot;4&quot;] ac1p4;
    node [label=&quot;3&quot;] ac1p3;
    node [label=&quot;2&quot;] ac1p2;
    node [label=&quot;1&quot;] ac1p1;

    {rank=&quot;same&quot;; ac1p1; ac1p2; ac1p3; ac1p4; ac1mm;}
    ac1p1 -- ac1p2 -- ac1p3 -- ac1p4 -- ac1mm;
  }

  subgraph cluster_achassis2 {
    label=&quot;Chassis 2 - Compute nodes 201-214\n[RACK 3]&quot;;
    edge[style=&quot;invis&quot;];
    node [shape=&quot;record&quot;];

    node [label=&quot;MM1&quot;] ac2mm;
    node [label=&quot;1&quot;] ac2p1;
    node [label=&quot;2&quot;] ac2p2;
    node [label=&quot;3&quot;] ac2p3;
    node [label=&quot;4&quot;] ac2p4;

    {rank=&quot;same&quot;; ac2p1; ac2p2; ac2p3; ac2p4; ac2mm}
    ac2p1 -- ac2p2 -- ac2p3 -- ac2p4 -- ac2mm;
  }

  subgraph cluster_compute_mgmt_node {
    label=&quot;Compute management node\n[RACK 2]&quot;;
    edge [style=&quot;invis&quot;];
    node [shape=&quot;record&quot;];

    node [label=&quot;2&quot;] x2 ;
    node [label=&quot;1&quot;] x1 ;

    {rank=&quot;same&quot;; x1; x2;}
    x1 -- x2;
  }

  subgraph cluster_as {
    label=&quot;Compute cluster switch&quot;;
    graph [fillcolor=&quot;burlywood1&quot;, style=&quot;filled&quot;];
    node [shape=&quot;record&quot;, fillcolor=&quot;white&quot;, style=&quot;filled&quot;];
    edge [style=&quot;invis&quot;];

    node [label=&quot;1&quot;] asw1;
    node [label=&quot;2&quot;] asw2;
    node [label=&quot;3&quot;] asw3;
    node [label=&quot;4&quot;] asw4;
    node [label=&quot;5&quot;] asw5;
    node [label=&quot;6&quot;] asw6;
    node [label=&quot;7&quot;] asw7;
    node [label=&quot;8&quot;] asw8;

    {rank=&quot;same&quot;; asw1; asw2; asw3; asw4; asw5; asw6; asw7; asw8;}
    asw1 -- asw2 -- asw3 -- asw4 -- asw5 -- asw6 -- asw7 -- asw8;
  }

  subgraph cluster_cs {
    label=&quot;Cisco switch [RACK 2]&quot;;
    graph [fillcolor=&quot;burlywood1&quot;, style=&quot;filled&quot;];
    node [shape=&quot;record&quot;, fillcolor=&quot;white&quot;, style=&quot;filled&quot;];
    edge [style=&quot;invis&quot;];

    node [label=&quot;1&quot;] cs1;
    node [label=&quot;2&quot;] cs2;
    node [label=&quot;3&quot;] cs3;
    node [label=&quot;4&quot;] cs4;
    node [label=&quot;19&quot;] cs19;

    {rank=&quot;same&quot;; cs1; cs2; cs3; cs4; cs19;}
    cs1 -- cs2 -- cs3 -- cs4 -- cs19;
  }

  align_chassis [style=&quot;invis&quot;];
  align_chassis -- ac1mm [style=&quot;invis&quot;];
  align_chassis -- ac2mm [style=&quot;invis&quot;];

  x1 -- asw1 [color=&quot;blue&quot;];
  p2 -- x2 [color=&quot;red&quot;];
  p1:sw -- cs1 [color=&quot;red&quot;];
  asw3 -- ac1mm [color=&quot;green&quot;, penwidth=2, constraint=&quot;false&quot;];
  asw5 -- webmom [color=&quot;green&quot;, penwidth=2];
  asw7 -- ac2mm [color=&quot;green&quot;, penwidth=2, constraint=&quot;false&quot;];
  webmo1:sw -- cs19:ne [color=&quot;white:red:white&quot;];
  webmo2-- asw6 [color=&quot;blue&quot;];
  ac1p1 -- asw2 [color=&quot;blue&quot;];
  asw4 -- ac2p4 [color=&quot;blue&quot;, constraint=&quot;false&quot;];
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To generate the diagram with &lt;a href=&quot;https://graphviz.org/&quot;&gt;Graphviz&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% dot -Tpng graph.dot -o graph.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To generate the diagram with PlantUML via a self-managed instance of &lt;a href=&quot;https://kroki.io/&quot;&gt;Kroki&lt;/a&gt; (&lt;a href=&quot;http://www.duskopijetlovic.com/freebsd/howto/diagram/java/2022/02/26/freebsd-java-kroki-diagrams.html&quot;&gt;How to Run Kroki on FreeBSD 13 with Java&lt;/a&gt; or &lt;a href=&quot;http://www.duskopijetlovic.com/freebsd/docker/vm/virtualization/howto/diagram/2022/02/25/freebsd-docker-linux-kroki-diagrams.html&quot;&gt;How to Run Kroki on FreeBSD 13 with vm-bhyve and Debian GNU/Linux VM&lt;/a&gt;):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat \
 wiring.dot | \ 
 http \
 http://localhost:8000/plantuml/png \
 Content-Type:text/plain &amp;gt; \
 wiring.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% xv wiring.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/wiring.png&quot; alt=&quot;Displaying a png image a network wiring diagram created by Graphviz invoked via Kroki&quot; title=&quot;Displaying a png image a network wiring diagram created by Graphviz invoked via Kroki&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.webmo.net/&quot;&gt;WebMO&lt;/a&gt; server and cluster storage: 1U (1 rack unit) Lenovo server
    &lt;ul&gt;
      &lt;li&gt;3 Ethernet ports (2 Ethernet ports and an Ethernet Management Port)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Compute management node: 1U (1 rack unit) IBM server
    &lt;ul&gt;
      &lt;li&gt;2 Ethernet ports&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Chassis 1 wtth compute nodes 101-114: IBM blade server with 14 blades
    &lt;ul&gt;
      &lt;li&gt;Module with 4 Ethernet ports&lt;/li&gt;
      &lt;li&gt;Management module with KVM (keyboard, video, monitor) and an Ethernet Managemet Port&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Chassis 2 with compute nodes 201-214: IBM blade server with 14 blades
    &lt;ul&gt;
      &lt;li&gt;Module with 4 Ethernet ports&lt;/li&gt;
      &lt;li&gt;Management module with KVM (keyboard, video, monitor) and an Ethernet Managemet Port&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;NOTE:&lt;br /&gt;
For testing layouts, you can use your own instance of the Graphviz Visual Editor &lt;a href=&quot;http://www.duskopijetlovic.com/freebsd/bhyve/virtualization/graphviz/graph/visualization/2022/02/08/freebsd-bhyve-graph-editors.html&quot;&gt;How To Install Graphviz Visual Editor on FreeBSD in a Linux Guest in Bhyve&lt;/a&gt; or if you prefer use it online provided by its author &lt;a href=&quot;http://magjac.com/graphviz-visual-editor/&quot;&gt;Graphviz Visual Editor - Magnus Jacobsson&lt;/a&gt;.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;References:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/21935109/how-do-i-style-the-ports-of-record-based-nodes-in-graphviz&quot;&gt;How do I style the ports of record based nodes in GraphViz?&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 4, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/1477532/how-to-force-position-of-edges-in-graphviz&quot;&gt;How to force position of edges in graphviz?&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 4, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.graphviz.org/pdf/dotguide.pdf&quot;&gt;Drawing graphs with &lt;em&gt;dot&lt;/em&gt;&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 4, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;http://rtomaszewski.blogspot.com/search/label/diagram&quot;&gt;Physical network diagram generated from dot config language&lt;/a&gt; &lt;br /&gt;
(Posted on Dec30, 2013)&lt;br /&gt;
(Retrieved on Mar 4, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.webmo.net/&quot;&gt;WebMO - a web-based interface to computational chemistry packages&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

</description>
        <pubDate>Fri, 04 Mar 2022 21:08:02 -0800</pubDate>
        <link>http://localhost:4000/howto/diagram/graph/graphviz/plaintext/text/tex/latex/visualization/documentation/2022/03/04/graphviz-and-koki-server-wiring-diagram.html</link>
        <guid isPermaLink="true">http://localhost:4000/howto/diagram/graph/graphviz/plaintext/text/tex/latex/visualization/documentation/2022/03/04/graphviz-and-koki-server-wiring-diagram.html</guid>
        
        
        <category>howto</category>
        
        <category>diagram</category>
        
        <category>graph</category>
        
        <category>graphviz</category>
        
        <category>plaintext</category>
        
        <category>text</category>
        
        <category>tex</category>
        
        <category>latex</category>
        
        <category>visualization</category>
        
        <category>documentation</category>
        
      </item>
    
      <item>
        <title>How To Create Networking Diagrams with Graphviz and Kroki</title>
        <description>&lt;p&gt;OS: FreeBSD 13 &lt;br /&gt;
Shell:  csh&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat graph.dot
graph networkdiagram {

  /*
     Colours for the lines relate to the line speed
     green is for 100 Mbit (100 Mb/s) (IBM Management)
     blue is for Gigabit (1 Gb/s)
     red is for 10 Gigabit (10 Gb/s)
  */

  imagepath=&quot;/usr/home/dusko/scratch/graphviz_network/images&quot;

  label=&quot;\nCompute Cluster Network Diagram&quot;;

  node [shape=&quot;none&quot;, fontname=&quot;arial&quot;, fontsize=10, labelloc=&quot;b&quot;, color=&quot;#ffffff&quot;];
  splines=&quot;compound&quot;;

  fw [label=&quot;Edge firewall&quot;, image=&quot;firewall.png&quot;];
  panel [label=&quot;Patch panel&quot;, image=&quot;patchPanel24Port.png&quot;];
  sw1 [label=&quot;Cisco switch&quot;, image=&quot;gigabitSwitch.png&quot;];
  sw2 [label=&quot;Compute cluster switch&quot;, image=&quot;gigabitSwitch.png&quot;];
  srv1 [label=&quot;WebMO and cluster storage&quot;, image=&quot;rackmountServer1U.png&quot;];
  srv2 [label=&quot;Compute nodes 101-114&quot;, image=&quot;serverBlades.png&quot;];
  srv3 [label=&quot;Compute nodes 201-214&quot;, image=&quot;serverBlades.png&quot;];
  srv4 [label=&quot;Compute management node&quot;, image=&quot;rackmountServer1U.png&quot;];
  cloud [label=&quot;Internet&quot;, image=&quot;cloud.png&quot;];

  cloud -- fw [color=&quot;red&quot;];
  fw -- panel [color=&quot;red&quot;];
  sw1 -- panel [color=&quot;red&quot;];
  panel -- srv4 [color=&quot;blue&quot;];

  {
    rank=&quot;same&quot;;
    srv1; srv2; srv3; srv4;
  }

  srv1 -- sw1 [color=&quot;blue&quot;];
  srv1 -- sw2 [color=&quot;blue&quot;];
  srv1 -- sw2 [color=&quot;green&quot;];
  srv2 -- sw2 [color=&quot;blue&quot;];
  srv2 -- sw2 [color=&quot;green&quot;];
  srv3 -- sw2 [color=&quot;blue&quot;];
  srv3 -- sw2 [color=&quot;green&quot;];
  srv4 -- sw2 [color=&quot;blue&quot;];
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To generate the diagram with &lt;a href=&quot;https://graphviz.org/&quot;&gt;Graphviz&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% dot -Tpng graph.dot -o graph.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To generate the diagram with PlantUML via a self-managed instance of &lt;a href=&quot;https://kroki.io/&quot;&gt;Kroki&lt;/a&gt; (&lt;a href=&quot;http://www.duskopijetlovic.com/freebsd/howto/diagram/java/2022/02/26/freebsd-java-kroki-diagrams.html&quot;&gt;How to Run Kroki on FreeBSD 13 with Java&lt;/a&gt; or &lt;a href=&quot;http://www.duskopijetlovic.com/freebsd/docker/vm/virtualization/howto/diagram/2022/02/25/freebsd-docker-linux-kroki-diagrams.html&quot;&gt;How to Run Kroki on FreeBSD 13 with vm-bhyve and Debian GNU/Linux VM&lt;/a&gt;):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% cat \
 graph.dot | \
 http \
 http://localhost:8000/plantuml/png \
 Content-Type:text/plain &amp;gt; \
 graph.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; &lt;br /&gt;
Supported output formats in PlantUML:  png, svg, jpeg, base64, txt or utxt.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;% xv graph.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/graphviz-network-diagram.png&quot; alt=&quot;Displaying a png image of a network diagram created by Graphviz&quot; title=&quot;Displaying a png image of a network diagram created by Graphviz&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt;  &lt;br /&gt;
Online Graphviz tools&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;For realtime collaboration: &lt;a href=&quot;http://graphvizrepl.com&quot;&gt;http://graphvizrepl.com&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;Repository with the code for graphvizrepl.com:  &lt;a href=&quot;https://github.com/caseywatts/graphviz-repl&quot;&gt;https://github.com/caseywatts/graphviz-repl&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;blockquote&gt;
      &lt;p&gt;Graphviz-REPL gives you a two-pane interface for quickly creating and 
iterating through graphviz diagrams. You type DOT syntax on the left, 
and the image will appear on the right after just a moment.&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;References:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://mikegriffin.ie/blog/20110308-a-graphviz-tutorial&quot;&gt;How to create a network diagram with Graphviz - A graphviz tutorial&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://github.com/mgriffin/graphviz_network&quot;&gt;Repository with the code Mike Griffin used in his graphviz tutorial blog post above&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://mamchenkov.net/wordpress/2015/08/20/graphviz-dot-erds-network-diagrams/&quot;&gt;Using Graphviz dot for ERDs, network diagrams and more&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://kontrolissues.net/2017/02/05/auto-network-diagram-with-graphviz/&quot;&gt;Auto Network Diagram with Graphviz&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://crashedmind.github.io/PlantUMLHitchhikersGuide/NetworkUsersMachines/NetworkUsersMachines.html&quot;&gt;The Hitchhiker’s Guide to PlantUML - Create a Diagram of a Typical Network&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://medium.com/powerof2/graphviz-for-network-visualization-9f45693d69d8&quot;&gt;Graphviz for Network Visualization (Draw network diagrams from config files)&lt;/a&gt;&lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.graphviz.org/doc/info/shapes.html&quot;&gt;Graphviz - Node Shapes&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://renenyffenegger.ch/notes/tools/Graphviz/examples/index&quot;&gt;Graphviz (dot) examples&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://renenyffenegger.ch/notes/development/databases/SQL/data-types/&quot;&gt;Plotting the hierarchy of SQL data types with graphviz/dot&lt;/a&gt;  &lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://renenyffenegger.ch/notes/tools/Graphviz/examples/organization-chart&quot;&gt;Graphviz example: organization chart&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/7374108/graphviz-node-placement-and-rankdir/&quot;&gt;GraphViz Node Placement and Rankdir&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://renenyffenegger.ch/notes/tools/Graphviz/examples/edge-crossing&quot;&gt;Graphviz (dot) examples: crossing of edges - How crosssing of edges can be eliminated&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/9238672/how-does-a-script-optimally-layout-a-pure-hierarchical-graphviz-dot-graph&quot;&gt;How does a script optimally layout a pure hierarchical graphviz/dot graph?&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://mikemol.github.io/jekyll/update/nodes/edges/labels/layout/graphviz/dot/2018/01/13/graphviz-technique-nodes-as-edge-labels.html&quot;&gt;Nodes as Labels&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;http://www.cisco.com/web/about/ac50/ac47/2.html&quot;&gt;The Cisco network topology icons&lt;/a&gt; &lt;br /&gt;
(Retrieved on Mar 3, 2022)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

</description>
        <pubDate>Thu, 03 Mar 2022 20:17:02 -0800</pubDate>
        <link>http://localhost:4000/howto/diagram/java/graph/graphviz/plaintext/text/tex/latex/visualization/sysadmin/documentation/2022/03/03/graphviz-servers-networking-diagram.html</link>
        <guid isPermaLink="true">http://localhost:4000/howto/diagram/java/graph/graphviz/plaintext/text/tex/latex/visualization/sysadmin/documentation/2022/03/03/graphviz-servers-networking-diagram.html</guid>
        
        
        <category>howto</category>
        
        <category>diagram</category>
        
        <category>java</category>
        
        <category>graph</category>
        
        <category>graphviz</category>
        
        <category>plaintext</category>
        
        <category>text</category>
        
        <category>tex</category>
        
        <category>latex</category>
        
        <category>visualization</category>
        
        <category>sysadmin</category>
        
        <category>documentation</category>
        
      </item>
    
  </channel>
</rss>
